<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE Retail Club</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff;
            letter-spacing: normal !important;
            font-size: 1.125rem;
        }
        * {
            font-family: 'Sarabun', sans-serif !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            /* ‡∏õ‡∏£‡∏±‡∏ö font dropdown ‡πÅ‡∏•‡∏∞ input ‡∏•‡∏á 1 ‡∏Ç‡∏±‡πâ‡∏ô */
            font-size: 1rem;
        }
        thead.table-header-gray {
             background-color: #e5e7eb;
        }
        table thead th {
            font-weight: bold !important;
            font-size: 1rem !important;
            /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î font-align center */
            text-align: center !important;
        }
        table tbody tr {
            height: 30px !important;
        }
        .winner-row-animate {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        button:disabled {
            background-color: #f3f4f6 !important;
            color: #9ca3af !important;
            cursor: not-allowed !important;
            box-shadow: none !important;
            transform: none !important;
        }
        .loading-gif {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0); }
            100% { transform: rotate(360deg); }
        }
        .sortable-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .sortable-header:hover {
            background-color: #d1d5db;
        }
        .dashboard-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        /* Pagination Styles */
        .pagination-btn {
            padding: 0.25rem 0.75rem;
            border: 1px solid #d1d5db;
            background-color: #fff;
            color: #374151;
            font-size: 0.875rem;
            border-radius: 0.375rem;
            transition: all 0.2s;
        }
        .pagination-btn:hover:not(:disabled) {
            background-color: #f3f4f6;
        }
        .pagination-btn.active {
            background-color: #0056ff;
            color: #fff;
            border-color: #0056ff;
        }
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[95%] max-w-7xl p-0 bg-white rounded-lg">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6 pt-6 px-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold" style="color: #0056ff;">Recog Night White Elegance</h1>
            </div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-400 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="mb-6 border-b border-gray-200 px-8">
            <nav class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Tabs">
                <button id="tab-dashboard" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-700 bg-gray-300 border-blue-600">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°
                </button>
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>
                <button id="tab-gift-management" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
                <button id="tab-register" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    QR Code
                </button>
                <button id="tab-group-random" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-winners-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
            </nav>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="px-8 pb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                <div class="lg:w-2/5">
                     <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center h-full">
                         <p class="text-gray-600 text-base mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                         <div class="relative w-64 h-64">
                             <canvas id="registrationBreakdownChart"></canvas>
                             <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                 <span id="breakdownCenterTotal" class="text-2xl font-bold text-gray-900">0</span>
                                 <span class="text-base text-gray-500 font-bold">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                             </div>
                         </div>
                     </div>
                </div>
                <div class="lg:w-3/5">
                    <div class="flex gap-6 h-full">
                         <div class="w-2/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-base mb-4 font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
                            <div class="relative w-64 h-64">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                    <span class="text-base text-gray-500 font-bold">%‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                </div>
                            </div>
                        </div>
                         <div class="w-1/3 flex flex-col justify-between space-y-2">
                            <div id="card-total" class="dashboard-card h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-blue-700 text-sm font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                                <p id="targetCount" class="text-2xl font-bold text-blue-800 mt-1">0</p>
                            </div>
                            <div id="card-registered" class="dashboard-card h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-green-700 text-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
                                <p id="participantsCountBox" class="text-2xl font-bold text-green-800 mt-1">0</p>
                            </div>
                            <div id="card-unregistered" class="dashboard-card h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-red-700 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</p>
                                <p id="remainingCount" class="text-2xl font-bold text-red-800 mt-1">0</p>
                            </div>
                            <div id="card-extras" class="dashboard-card h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-yellow-700 text-sm">‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="attendeesCount" class="text-2xl font-bold text-yellow-800 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Timeline Row Updated with Side Stats -->
            <div class="mb-8 w-full">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <!-- Chart Area (Left) -->
                        <div class="flex-grow h-72 w-full md:w-3/4">
                            <canvas id="registrationTimelineChart"></canvas>
                        </div>
                        
                        <!-- Summary Stats (Right) -->
                        <div class="w-full md:w-1/4 flex flex-col gap-4">
                            <div class="bg-blue-50 border-l-4 border-blue-600 p-4 rounded-r-lg">
                                <p class="text-blue-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</p>
                                <p id="timelineTotalInvite" class="text-2xl font-black text-blue-900 mt-1">0</p>
                                <p class="text-[10px] text-blue-400 font-bold uppercase tracking-widest">(‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg">
                                <p class="text-orange-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="timelineTotalExtra" class="text-2xl font-black text-orange-900 mt-1">0</p>
                                <p class="text-[10px] text-orange-400 font-bold uppercase tracking-widest">(‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-xl font-semibold text-gray-800 font-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                     <button id="randomizeButton" class="px-6 py-3 text-base font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow active:scale-95 transition-all font-bold">
                         ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (A1 - A24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart1"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (B1 - B24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart2"></canvas></div>
                    </div>
                </div>
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">Member</th>
                                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á -->
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-100 text-sm">
                            <tr><td colspan="8" class="p-6 text-center text-gray-500 font-bold text-sm">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-8 text-center">
                <button id="downloadCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all">
                    üì• Download CSV Report
                </button>
            </div>
        </div>

        <!-- Team List Content -->
        <div id="team-list-content" class="hidden pb-8 px-0">
            <div class="bg-white overflow-hidden">
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center bg-gray-50">
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm">
                        <p class="text-base text-blue-700 font-bold">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm font-bold">
                        <p class="text-base text-green-700">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ó‡∏µ‡∏°</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border shadow-sm font-bold flex flex-col"> 
                        <p class="text-sm text-gray-400 font-bold mb-1 uppercase tracking-tight">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</p>
                        <textarea id="definedTeamNamesInput" class="!text-xs h-16 resize-none bg-blue-50 border-blue-100 font-mono" placeholder="A,B,C..."></textarea>
                        <button id="updateTeamNamesBtn" class="mt-1 text-[10px] bg-blue-600 text-white py-1 rounded uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</button>
                    </div>
                </div>
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-8 py-3 text-base font-bold text-white bg-red-600 rounded-md hover:bg-red-700 shadow transition-all">Reset System Data</button>
                </div>
                 <div class="p-6">
                     <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                         <div>
                             <h3 class="text-xl font-bold border-l-4 border-blue-600 pl-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h3>
                             <div id="teamStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                                 <span class="px-3 py-1 rounded-md bg-gray-100 text-gray-700 text-sm font-bold border">Total: <span id="teamStatsTotal">0</span></span>
                                 <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">Reg: <span id="teamStatsRegistered">0</span></span>
                             </div>
                         </div>
                         <div class="flex items-center">
                             <label for="teamSelect" class="text-base font-bold text-gray-600 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                                 <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏° --</option>
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-xl shadow-sm">
                        <table class="min-w-full text-lg">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-4 text-center font-bold">#</th>
                                    <th class="px-4 py-4 text-left font-bold">Employee ID</th>
                                    <th class="px-4 py-4 text-left font-bold">Full Name</th>
                                    <th class="px-4 py-4 text-left font-bold">Member</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                    <th class="px-4 py-4 text-left font-bold">Status</th>
                                    <th class="px-4 py-4 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- Group View Content -->
        <div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                <!-- Search Boxes Container -->
                <div class="flex flex-col md:flex-row gap-6 mb-6">
                    <!-- Box 1: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-gray-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchEmployeeIdInput" class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 5-6 ‡∏´‡∏•‡∏±‡∏Å">
                            </div>
                            <button id="searchEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow transition-all active:scale-95">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        <p id="searchEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>

                    <!-- Box 2: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-green-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-green-800 mb-3 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchRegEmployeeIdInput" class="block text-sm font-bold text-green-600 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchRegEmployeeIdInput" class="mt-1 block w-full rounded-md border-green-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">
                            </div>
                            <button id="searchRegEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95 uppercase">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                        </div>
                        <p id="searchRegEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>
                </div>

                <div class="px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                        <div id="gvOverallStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                             <span class="px-3 py-1 rounded-md bg-gray-100 text-sm font-bold border">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="gvOverallStatsTotal">0</span></span>
                             <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß: <span id="gvOverallStatsRegistered">0</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="groupViewManagerFilter" class="text-base font-bold text-gray-600 mr-2">Manager:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                    </div>
                </div>

                <!-- New Layout: Recog Night Header + Seat Grid -->
                <div class="w-full flex justify-center mb-6 px-6">
                    <div class="w-[60%] bg-[#0056ff] text-white text-center py-3 rounded-xl font-bold shadow-md">
                        ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á Recog Night White Elegance
                    </div>
                </div>

                <div class="px-6 flex w-full items-stretch gap-0">
                    <!-- ‡πÇ‡∏ã‡∏ô A (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridA" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á (4%) -->
                    <div class="w-[4%] flex justify-center py-2">
                        <!-- Border 2% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á 4% ‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
                        <div class="w-1 bg-gray-200 rounded-full h-full opacity-50" id="gridDivider"></div>
                    </div>

                    <!-- ‡πÇ‡∏ã‡∏ô B (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridB" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                </div>
                
                <div class="p-10"></div> <!-- Spacer -->
             </div>
        </div>
        
        <!-- Employee List Content -->
        <div id="employee-list-content" class="hidden pb-8 px-0">
             <div class="bg-white overflow-hidden">
                <div class="px-8 py-6 border-b flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <div id="empStatsContainer" class="hidden flex flex-wrap gap-2 mt-3">
                            <span class="px-4 py-1.5 rounded-xl bg-gray-100 text-gray-700 text-sm font-black border shadow-sm">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="empStatsTotal">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-green-50 text-green-700 text-sm font-black border border-green-200 shadow-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="empStatsRegistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á: <span id="empStatsUnregistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-sm font-black border border-blue-200 shadow-sm">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô: <span id="empStatsPercent">0%</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="managerFilterSelect" class="text-base font-bold text-gray-600 mr-2">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</label>
                         <select id="managerFilterSelect" class="rounded-xl border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                     </div>
                </div>
                <div class="overflow-x-auto p-8">
                    <table class="min-w-full text-sm shadow-sm border rounded-2xl overflow-hidden">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold">#</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-id">‡∏£‡∏´‡∏±‡∏™ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-branch">‡∏™‡∏≤‡∏Ç‡∏≤ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-manager">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-nickname">Member ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-gift">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                    </table>
                </div>

                <!-- Pagination Container -->
                <div id="empPaginationContainer" class="flex justify-center items-center gap-2 py-6 border-t border-gray-100"></div>

                <!-- ‡∏õ‡∏∏‡πà‡∏° Download CSV ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                <div class="pb-8 text-center">
                    <button id="downloadEmployeeCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all uppercase">
                        üì• Download Employee CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Gift Management Content -->
        <div id="gift-management-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-blue-600 pl-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
                <div class="bg-gray-50 p-6 rounded-2xl border mb-8 max-w-[1000px] shadow-inner">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-grow" style="max-width: 600px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
                            <input type="text" id="giftNameInput" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                        </div>
                        <div style="width: 90px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="giftQtyInput" class="!text-sm text-center" value="1" min="1">
                        </div>
                        <div class="flex items-end">
                            <button id="addGiftBtn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all active:scale-95 shadow-lg !text-xs">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto border rounded-xl shadow-sm">
                    <table class="min-w-full text-base">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold w-24">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="giftListTableBody" class="divide-y divide-gray-100 bg-white">
                            <tr><td colspan="6" class="p-6 text-center text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Winners List Content -->
        <div id="winners-list-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-green-600 pl-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                <div id="winnersByGiftContainer" class="space-y-12">
                    <div class="p-10 text-center text-gray-400 font-bold italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
                <div class="mt-12 text-center">
                    <button id="downloadWinnersCsvButton" class="px-8 py-3 text-base font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95">
                        üì• Download Winners CSV Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Register Content -->
        <div id="register-content" class="hidden pb-8 px-6 text-center">
             <div class="bg-white p-12 rounded-[3rem] shadow-xl border border-gray-100 flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-800 mb-10 font-black">QR Code</h2>
                <div class="p-6 bg-white border-8 border-blue-600 rounded-[3rem] shadow-2xl mb-4 hover:scale-105 transition-all">
                    <img src="./images/QRcode-CRSG.png" alt="QR Code" class="w-80 h-80" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=REGISTER'">
                </div>
             </div>
        </div>

        <!-- Group Random Content -->
        <div id="group-random-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                
                <div class="flex flex-col md:flex-row gap-4 mb-6 items-stretch">
                    <div class="md:w-[30%] grid grid-cols-1 gap-2">
                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 shadow-sm text-center">
                            <p class="text-sm text-blue-700 uppercase font-black">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p id="grTotalEligible" class="text-xl font-black text-blue-900">0</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 shadow-sm text-center">
                            <p class="text-sm text-orange-700 uppercase font-black">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°</p>
                            <p id="grRemainingEligible" class="text-xl font-black text-orange-900">0</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100 shadow-sm text-center">
                            <p class="text-sm text-green-700 uppercase font-black">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="grTotalWinners" class="text-xl font-black text-green-900">0</p>
                        </div>
                    </div>

                    <div class="md:w-[70%] flex flex-col gap-3">
                        <div class="bg-gray-50 px-4 py-3 rounded-xl border shadow-sm w-full">
                            <label class="block text-sm font-bold text-gray-400 mb-1 uppercase tracking-wider text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
                            <div id="grGiftBox" class="flex items-center justify-between bg-white border-2 border-dashed border-gray-200 rounded-xl p-3 transition-all">
                                <div class="flex flex-col text-left">
                                    <p id="grGiftDisplayName" class="text-base font-black text-gray-400 leading-tight uppercase">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                                    <p id="grGiftDisplayQty" class="text-sm font-bold text-gray-300 mt-1">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                                </div>
                                <button id="openGroupGiftPickerBtn" class="px-4 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-xs font-black border border-blue-200 shadow-sm shrink-0 active:scale-95 transition-all">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                            </div>
                        </div>

                        <div class="flex items-stretch gap-3 w-full flex-grow min-h-[90px]">
                            <div class="w-[30%] bg-gray-50 p-3 rounded-xl border shadow-sm flex flex-col justify-center items-center text-center">
                                <label class="text-sm font-bold text-gray-500 uppercase mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</label>
                                <input type="number" id="grDrawCount" value="0" min="0" class="w-full text-center text-3xl font-black text-blue-600 bg-white border border-blue-100 rounded-lg focus:border-blue-500 focus:ring-0 py-1 shadow-inner">
                            </div>
                            <div class="w-[70%]">
                                <button id="grStartDrawBtn" class="w-full h-full text-xl font-black text-white bg-[#0056ff] rounded-xl hover:bg-blue-700 shadow-lg transition-all active:scale-95 disabled:bg-gray-400 uppercase tracking-widest flex items-center justify-center">
                                    üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border-t border-gray-100 pt-4">
                    <div class="p-4 border-r border-gray-100">
                        <h4 class="text-xl font-black text-blue-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</h4>
                        <div id="grBoxLeft" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                    <div class="p-4">
                        <h4 class="text-xl font-black text-indigo-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h4>
                        <div id="grBoxRight" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- LIGHTBOX: Manual Registration -->
    <div id="manualRegisterModal" class="hidden fixed inset-0 z-[140] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-lg border-t-8 border-green-600">
            <h3 class="text-xl font-bold mb-6 uppercase border-b pb-3 text-gray-800 text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            <div id="regEmpDetail" class="space-y-4 mb-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="regEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="regEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏≤‡∏Ç‡∏≤ (Branch)</label><p id="regEmpBranch" class="text-sm font-bold text-gray-700"></p></div>
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Manager)</label><p id="regEmpManager" class="text-sm font-bold text-gray-700"></p></div>

                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (NickName) -->
                <div>
                    <label class="text-sm font-bold text-gray-400 mb-1 block">Member</label>
                    <input type="text" id="regEmpNickname" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="Member">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                        <input type="text" id="regEmpSeat" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, A2">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="regEmpInviteStatus" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base">
                            <option value="">-- ‡∏ß‡πà‡∏≤‡∏á --</option>
                            <option value="invite">invite</option>
                        </select>
                    </div>
                </div>
                <p id="regManualError" class="text-red-600 text-sm font-black italic h-4"></p>
            </div>
            <div class="flex justify-end gap-3 font-bold">
                <button id="closeManualRegModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveManualRegButton" class="px-8 py-2 bg-green-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-green-700 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Group Detail -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="groupViewModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
                     <div id="groupViewStatsContainer" class="flex flex-wrap gap-2 mt-2">
                         <span class="px-3 py-1 rounded-full bg-gray-100 text-sm font-bold border uppercase">Total: <span id="groupViewStatsTotal">0</span></span>
                         <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-sm font-bold border border-green-200 uppercase">Reg: <span id="groupViewStatsRegistered">0</span></span>
                     </div>
                 </div>
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">ID</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">Member</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Dashboard List Detail -->
    <div id="dashboardListModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="dashboardListModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                     <p class="text-sm text-gray-400 font-bold mt-1 uppercase tracking-tight">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="dashboardListCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                 </div>
                 <button id="closeDashboardListModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
                            <th class="px-4 py-4 text-center font-bold">‡∏£‡∏´‡∏±‡∏™</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-center font-bold">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                            <th class="px-4 py-4 text-center font-bold" id="dashListRegHeader">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                            <th class="px-4 py-4 text-center font-bold">Admin</th>
                        </tr>
                    </thead>
                    <tbody id="dashboardListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- MODAL: Lucky Draw Individual -->
    <div id="randomizeModal" class="hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 w-[75%] h-[80vh] flex flex-col mx-4 border-t-8 border-blue-600 relative">
            <button id="closeRandomizeModalButtonX" class="absolute top-2 right-4 text-gray-400 hover:text-gray-600 text-5xl font-light transition-all z-10">&times;</button>
            <h3 class="text-xl font-bold text-center text-gray-900 mb-6 uppercase">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
            <div class="max-w-lg mx-auto mb-8 w-full">
                <label class="block text-sm font-bold text-gray-400 mb-2 text-center">‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏∏‡πà‡∏°</label>
                <div id="indGiftBox" class="flex items-center justify-between bg-blue-50 border-2 border-dashed border-blue-200 rounded-2xl p-3 transition-colors">
                    <div class="flex flex-col text-left">
                        <p id="indGiftDisplayName" class="text-lg font-black text-blue-400 leading-tight">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                        <p id="indGiftDisplayQty" class="text-sm text-black-400 mt-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    </div>
                    <button id="openGiftPickerBtn" class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-blue-700 uppercase">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p><p id="modalParticipantsCount" class="text-2xl font-bold">0</p></div>
                <div class="bg-green-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-green-700 uppercase">‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß</p><p id="modalDrawnCount" class="text-2xl font-bold">0</p></div>
            </div>
            <div class="flex justify-center space-x-2 mb-6 shrink-0">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
            </div>
            <div class="mb-6 flex flex-col items-center shrink-0">
                <button id="startRandomizeButton" class="w-[40%] px-6 py-4 text-base text-white bg-blue-600 rounded-lg font-bold hover:bg-blue-700 shadow-xl active:scale-95 disabled:bg-gray-400 uppercase" disabled>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</button>
                <p id="randomizeError" class="text-red-600 text-base mt-3 font-bold uppercase"></p>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-xl bg-gray-50 font-bold">
                <table class="min-w-full text-base">
                    <thead class="bg-gray-200 sticky top-0 uppercase text-gray-700">
                        <tr><th class="px-4 py-4 text-left">‡∏£‡∏´‡∏±‡∏™</th><th class="px-4 py-4 text-left">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</th><th class="px-4 py-4 text-left">‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th><th class="px-4 py-4 text-center">Action</th></tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL: Gift Picker -->
    <div id="giftPickerModal" class="hidden fixed inset-0 z-[100] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-[70%] modal-enter flex flex-col border-t-8 border-orange-500">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="giftPickerTitle" class="text-xl font-black text-gray-800 uppercase">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
                <button id="closeGiftPickerBtn" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto max-h-[60vh] space-y-2" id="giftPickerList"></div>
        </div>
    </div>

    <!-- POPUP WINNER Detail -->
    <div id="winnerDetailModal" class="hidden fixed inset-0 z-[200] bg-gray-900 bg-opacity-95 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-xl w-full text-center border-t-8 border-blue-600 transform scale-110">
            <h3 class="text-xl font-black text-blue-600 mb-4 uppercase">üéä WINNER üéä</h3>
            <div class="text-6xl mb-6">üèÜ</div>
            <p id="winnerName" class="text-2xl font-black text-gray-900 my-4 leading-tight uppercase"></p>
            <p id="winnerGiftText" class="text-xl font-bold text-orange-600 mb-6"></p>
            <div class="bg-blue-50 p-6 rounded-[2rem] mb-10 border border-blue-100 shadow-inner text-center">
                <p id="winnerEmployeeId" class="text-xl font-black text-blue-800 font-mono"></p>
                <p id="winnerBU" class="text-lg font-bold text-gray-600 mt-2 uppercase"></p>
                <p id="winnerTeam" class="text-base font-medium text-gray-400 mt-2 uppercase"></p>
            </div>
            <div class="flex flex-col gap-4">
                <button id="cancelWinnerButton" class="text-base font-bold text-red-400 hover:text-red-600 hover:underline transition-all uppercase">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Cancel)</button>
                <button id="closeWinnerModalButton" class="px-12 py-3 text-base font-black bg-blue-600 text-white rounded-[1.5rem] hover:bg-blue-700 shadow-2xl active:scale-95 transition-all">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Profile -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-[120] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="editEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="editEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (NickName) ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
                <div>
                    <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Member</label>
                    <input type="text" id="editEmpNickname" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base" placeholder="Member">
                </div>

                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Manager / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="editEmpManager" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Team / ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label><input type="text" id="editEmpTeam" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <p id="editError" class="text-red-600 text-sm font-black italic mt-2"></p>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditModalButton" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Gift -->
    <div id="editGiftModal" class="hidden fixed inset-0 z-[150] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
            <div class="space-y-6">
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label><input type="text" id="editGiftName" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ 50 ‡∏ô‡∏¥‡πâ‡∏ß"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                        <input type="number" id="editGiftTotalQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="1">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                        <input type="number" id="editGiftRemainingQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="0">
                    </div>
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditGiftModalBtn" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditGiftBtn" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmation Center -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[300] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div id="confirmModalInner" class="bg-white rounded-2xl p-10 max-w-lg w-full shadow-2xl text-center transition-all duration-300">
            <h3 id="confirmTitle" class="text-xl font-black mb-4 uppercase text-red-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?</h3>
            <p id="confirmText" class="text-gray-600 font-bold mb-6 leading-relaxed italic text-base"></p>
            
            <div id="confirmInputContainer" class="hidden mb-10">
                <p class="text-sm text-gray-500 mb-2">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <span class="font-bold text-red-600 uppercase">Reset</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <input type="text" id="confirmInput" class="text-center border-2 border-red-200 rounded-lg p-2 w-full focus:border-red-500 outline-none text-sm font-bold uppercase" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            </div>

            <div class="flex justify-center gap-4">
                <button id="closeConfirmButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm font-bold hover:bg-gray-200 uppercase">‡πÑ‡∏°‡πà</button>
                <button id="confirmActionButton" class="px-8 py-2 bg-red-600 text-white rounded-xl text-sm font-black shadow-lg hover:bg-red-700 uppercase">‡πÉ‡∏ä‡πà</button>
            </div>
        </div>
    </div>

    <!-- Script Section -->
    <script type="module">
const _0x58d982=_0x19b7;(function(_0x47159e,_0x5df0b1){const _0x59d4e4=_0x19b7,_0x42ca10=_0x47159e();while(!![]){try{const _0xba0c3=parseInt(_0x59d4e4(0x23a))/0x1+parseInt(_0x59d4e4(0x1db))/0x2*(-parseInt(_0x59d4e4(0x22f))/0x3)+parseInt(_0x59d4e4(0x2b3))/0x4*(parseInt(_0x59d4e4(0x1e1))/0x5)+parseInt(_0x59d4e4(0x24c))/0x6+-parseInt(_0x59d4e4(0x21c))/0x7+-parseInt(_0x59d4e4(0x24d))/0x8*(-parseInt(_0x59d4e4(0x19a))/0x9)+parseInt(_0x59d4e4(0x1f1))/0xa;if(_0xba0c3===_0x5df0b1)break;else _0x42ca10['push'](_0x42ca10['shift']());}catch(_0x41e0df){_0x42ca10['push'](_0x42ca10['shift']());}}}(_0x130c,0x1fd82));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,collection,onSnapshot,doc,updateDoc,setDoc,addDoc,deleteDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x58d982(0x192),'authDomain':_0x58d982(0x277),'projectId':_0x58d982(0x2c8),'storageBucket':_0x58d982(0x1b9),'messagingSenderId':_0x58d982(0x1d2),'appId':'1:1070273157855:web:5c8120e1df27e233d8676a'};let db,auth,allEmployeesData=[],allGiftsData=[],selectedIndGiftId=null,selectedGroupGiftId=null,giftPickerContext='ind',teamNames=['A1','A2','A3','A4','A5','A6','A7','A8','A9',_0x58d982(0x2ce),'A11','A12',_0x58d982(0x19f),_0x58d982(0x2b6),_0x58d982(0x1ac),_0x58d982(0x21a),_0x58d982(0x222),_0x58d982(0x1ca),_0x58d982(0x1fc),'A20',_0x58d982(0x26f),_0x58d982(0x24f),'A23',_0x58d982(0x198),'B1','B2','B3','B4','B5','B6','B7','B8','B9',_0x58d982(0x2f2),_0x58d982(0x333),_0x58d982(0x288),_0x58d982(0x20a),_0x58d982(0x1da),'B15','B16',_0x58d982(0x295),'B18',_0x58d982(0x331),_0x58d982(0x203),_0x58d982(0x2b0),_0x58d982(0x1b3),_0x58d982(0x25a),_0x58d982(0x1e8)],charts={},currentConfirmAction=null,currentEditingDocId=null,currentEditingGiftId=null,drawInterval=null,empSortField=_0x58d982(0x31d),empSortDir=_0x58d982(0x2c9),empCurrentPage=0x1;const empPageSize=0x64;((async()=>{const _0x280e42=_0x58d982;try{const _0x35270e=initializeApp(firebaseConfig);db=getFirestore(_0x35270e),auth=getAuth(_0x35270e),await signInAnonymously(auth),initCharts(),setupTabs(),setupListeners(),startListening(),startListeningGifts(),document['getElementById'](_0x280e42(0x1ed))[_0x280e42(0x250)]=teamNames[_0x280e42(0x24e)](','),setInterval(()=>{const _0x2cd283=_0x280e42,_0x1def40=new Date();document[_0x2cd283(0x23b)]('currentDateTime')[_0x2cd283(0x26a)]=_0x1def40['toLocaleString'](_0x2cd283(0x199),{'year':_0x2cd283(0x20f),'month':'long','day':_0x2cd283(0x20f),'hour':_0x2cd283(0x289),'minute':_0x2cd283(0x289),'second':_0x2cd283(0x289)});},0x3e8);}catch(_0x4547a3){console[_0x280e42(0x1c5)](_0x4547a3);}})());function setupTabs(){const _0xfeb2c7=_0x58d982,_0x2f794a={'tab-dashboard':_0xfeb2c7(0x296),'tab-team-list':_0xfeb2c7(0x316),'tab-group-view':'group-view-content','tab-employee-list':_0xfeb2c7(0x2c3),'tab-gift-management':'gift-management-content','tab-register':_0xfeb2c7(0x320),'tab-group-random':_0xfeb2c7(0x298),'tab-winners-list':_0xfeb2c7(0x2f1)};Object['keys'](_0x2f794a)[_0xfeb2c7(0x247)](_0x162958=>{const _0x531cf0=_0xfeb2c7,_0x3cc896=document[_0x531cf0(0x23b)](_0x162958);if(!_0x3cc896)return;_0x3cc896['addEventListener']('click',function(){const _0x1747ba=_0x531cf0;Object['keys'](_0x2f794a)[_0x1747ba(0x247)](_0x4f87d0=>{const _0x47782d=_0x1747ba,_0x159bcf=document['getElementById'](_0x4f87d0),_0x44f467=document['getElementById'](_0x2f794a[_0x4f87d0]);if(_0x159bcf)_0x159bcf[_0x47782d(0x2ff)][_0x47782d(0x1de)](_0x47782d(0x2c4),'bg-gray-100');if(_0x44f467)_0x44f467['classList']['add'](_0x47782d(0x2af));}),this[_0x1747ba(0x2ff)]['replace']('bg-gray-100','bg-gray-300'),document['getElementById'](_0x2f794a[_0x162958])?.[_0x1747ba(0x2ff)]['remove'](_0x1747ba(0x2af)),window['dispatchEvent'](new Event(_0x1747ba(0x1cc)));});});}function initCharts(){const _0x4a8a1f=_0x58d982,_0x57d3e1={'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]},'datalabels':{'color':_0x4a8a1f(0x337),'font':{'weight':_0x4a8a1f(0x2f5),'size':0xc},'formatter':_0x19f82b=>_0x19f82b>0x0?_0x19f82b:''}}};charts[_0x4a8a1f(0x2a7)]=new Chart(document['getElementById'](_0x4a8a1f(0x248)),{'type':'doughnut','data':{'labels':[_0x4a8a1f(0x33a),'Non-Invite'],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x4a8a1f(0x236),_0x4a8a1f(0x271)]}]},'options':{..._0x57d3e1,'cutout':_0x4a8a1f(0x29a)},'plugins':[ChartDataLabels]}),charts[_0x4a8a1f(0x311)]=new Chart(document[_0x4a8a1f(0x23b)]('registrationDonutChart'),{'type':_0x4a8a1f(0x1d8),'data':{'labels':[_0x4a8a1f(0x294),_0x4a8a1f(0x1bf)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x4a8a1f(0x23d),'#E5E7EB']}]},'options':{..._0x57d3e1,'cutout':_0x4a8a1f(0x29a)},'plugins':[ChartDataLabels]});const _0x156113={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'stacked':!![]},'y':{'stacked':!![]}},'plugins':{'legend':{'display':!![],'position':_0x4a8a1f(0x216),'labels':{'font':{'size':0xc}}},'datalabels':{'color':'#fff'}}};charts['bar1']=new Chart(document[_0x4a8a1f(0x23b)](_0x4a8a1f(0x1ad)),{'type':_0x4a8a1f(0x205),'data':{'labels':[],'datasets':[{'label':_0x4a8a1f(0x2ec),'data':[],'backgroundColor':_0x4a8a1f(0x236)},{'label':_0x4a8a1f(0x263),'data':[],'backgroundColor':_0x4a8a1f(0x254)}]},'options':_0x156113,'plugins':[ChartDataLabels]}),charts['bar2']=new Chart(document[_0x4a8a1f(0x23b)]('teamBarChart2'),{'type':_0x4a8a1f(0x205),'data':{'labels':[],'datasets':[{'label':_0x4a8a1f(0x2ec),'data':[],'backgroundColor':_0x4a8a1f(0x236)},{'label':_0x4a8a1f(0x263),'data':[],'backgroundColor':_0x4a8a1f(0x254)}]},'options':_0x156113,'plugins':[ChartDataLabels]}),charts[_0x4a8a1f(0x303)]=new Chart(document['getElementById']('registrationTimelineChart'),{'type':'line','data':{'labels':Array[_0x4a8a1f(0x1f9)]({'length':0x18},(_0x4f107e,_0x4b517a)=>_0x4b517a[_0x4a8a1f(0x266)]()[_0x4a8a1f(0x240)](0x2,'0')+_0x4a8a1f(0x29d)),'datasets':[{'label':_0x4a8a1f(0x2b9),'data':Array(0x18)[_0x4a8a1f(0x1fe)](0x0),'borderColor':'#3B82F6','backgroundColor':_0x4a8a1f(0x236),'tension':0.1},{'label':'‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô','data':Array(0x18)[_0x4a8a1f(0x1fe)](0x0),'borderColor':'#F59E0B','backgroundColor':_0x4a8a1f(0x271),'tension':0.1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':!![],'position':_0x4a8a1f(0x22a)},'datalabels':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function startListening(){const _0x3ddef4=_0x58d982;onSnapshot(collection(db,_0x3ddef4(0x2ed)),_0x5db847=>{const _0x34e641=_0x3ddef4;allEmployeesData=_0x5db847[_0x34e641(0x2e3)]['map'](_0x3aaf19=>({'id':_0x3aaf19['id'],..._0x3aaf19[_0x34e641(0x317)]()})),refreshUI();},_0x4c02d8=>console[_0x3ddef4(0x1c5)](_0x4c02d8));}function startListeningGifts(){onSnapshot(collection(db,'crsg_gift'),_0x59e93d=>{const _0x426de0=_0x19b7,_0x2b8b28=_0x59e93d[_0x426de0(0x2e3)][_0x426de0(0x287)](_0x282367=>({'id':_0x282367['id'],..._0x282367[_0x426de0(0x317)]()}));allGiftsData=_0x2b8b28[_0x426de0(0x2ad)]((_0x43264f,_0x59004d)=>(_0x43264f[_0x426de0(0x332)]||0x0)-(_0x59004d[_0x426de0(0x332)]||0x0)),renderGiftTable(),refreshIndGiftState(),refreshGroupGiftState(),updateWinnersList();},_0xfff27c=>console['error'](_0xfff27c));}function refreshUI(){const _0x3d0bc=_0x58d982,_0x1c2149=allEmployeesData[_0x3d0bc(0x2ab)](_0x1d5a19=>_0x1d5a19[_0x3d0bc(0x309)]),_0x9ed2d0=allEmployeesData[_0x3d0bc(0x2ab)](_0x466869=>_0x466869[_0x3d0bc(0x309)]&&_0x466869[_0x3d0bc(0x28f)]===_0x3d0bc(0x28f)),_0xba096a=allEmployeesData[_0x3d0bc(0x2ab)](_0x5af72c=>_0x5af72c[_0x3d0bc(0x309)]&&_0x5af72c[_0x3d0bc(0x28f)]!==_0x3d0bc(0x28f)),_0x2781df=allEmployeesData['filter'](_0x249aaa=>_0x249aaa[_0x3d0bc(0x28f)]==='invite');document[_0x3d0bc(0x23b)](_0x3d0bc(0x260))[_0x3d0bc(0x26a)]=allEmployeesData[_0x3d0bc(0x2ab)](_0x3f7597=>_0x3f7597[_0x3d0bc(0x2d6)])[_0x3d0bc(0x2be)],document[_0x3d0bc(0x23b)](_0x3d0bc(0x1c8))[_0x3d0bc(0x26a)]=allEmployeesData[_0x3d0bc(0x2ab)](_0x446d25=>_0x446d25['Check_Place'])[_0x3d0bc(0x2be)];const _0x31f01b=allEmployeesData['filter'](_0x1a1410=>_0x1a1410[_0x3d0bc(0x31a)]&&_0x1a1410[_0x3d0bc(0x31a)]['trim']()!==''),_0x458a9c=_0x31f01b[_0x3d0bc(0x2be)],_0x41c626=_0x31f01b[_0x3d0bc(0x2ab)](_0x5c6ccb=>_0x5c6ccb[_0x3d0bc(0x309)])[_0x3d0bc(0x2be)],_0x51ff90=_0x458a9c-_0x41c626,_0x55d6e0=_0x458a9c>0x0?Math['round'](_0x41c626/_0x458a9c*0x64):0x0;document['getElementById'](_0x3d0bc(0x2a6))&&(document['getElementById']('empStatsTotal')['textContent']=_0x458a9c,document[_0x3d0bc(0x23b)](_0x3d0bc(0x2c2))[_0x3d0bc(0x26a)]=_0x41c626,document['getElementById'](_0x3d0bc(0x285))[_0x3d0bc(0x26a)]=_0x51ff90,document['getElementById'](_0x3d0bc(0x2d2))['textContent']=_0x55d6e0+'%',document[_0x3d0bc(0x23b)](_0x3d0bc(0x2a6))['classList']['remove'](_0x3d0bc(0x2af)));document[_0x3d0bc(0x23b)](_0x3d0bc(0x2a4))[_0x3d0bc(0x26a)]=_0x2781df[_0x3d0bc(0x2be)],document[_0x3d0bc(0x23b)]('participantsCountBox')[_0x3d0bc(0x26a)]=_0x9ed2d0[_0x3d0bc(0x2be)],document[_0x3d0bc(0x23b)](_0x3d0bc(0x2cd))['textContent']=_0xba096a[_0x3d0bc(0x2be)],document[_0x3d0bc(0x23b)](_0x3d0bc(0x299))[_0x3d0bc(0x26a)]=Math['max'](0x0,_0x2781df[_0x3d0bc(0x2be)]-_0x9ed2d0[_0x3d0bc(0x2be)]),document['getElementById']('breakdownCenterTotal')['textContent']=_0x1c2149[_0x3d0bc(0x2be)],document[_0x3d0bc(0x23b)](_0x3d0bc(0x18f))[_0x3d0bc(0x26a)]=_0x2781df[_0x3d0bc(0x2be)]?Math[_0x3d0bc(0x2ae)](_0x9ed2d0[_0x3d0bc(0x2be)]/_0x2781df[_0x3d0bc(0x2be)]*0x64)+'%':'0%';charts[_0x3d0bc(0x2a7)]&&(charts['breakdown'][_0x3d0bc(0x317)][_0x3d0bc(0x214)][0x0]['data']=[_0x9ed2d0[_0x3d0bc(0x2be)],_0xba096a[_0x3d0bc(0x2be)]],charts['breakdown'][_0x3d0bc(0x273)]());charts[_0x3d0bc(0x311)]&&(charts[_0x3d0bc(0x311)][_0x3d0bc(0x317)][_0x3d0bc(0x214)][0x0]['data']=[_0x9ed2d0['length'],Math[_0x3d0bc(0x26d)](0x0,_0x2781df[_0x3d0bc(0x2be)]-_0x9ed2d0['length'])],charts['goal'][_0x3d0bc(0x273)]());if(charts['timeline']){const _0x224279=Array(0x18)['fill'](0x0),_0x1b1c3c=Array(0x18)[_0x3d0bc(0x1fe)](0x0);let _0x5a72fb=0x0,_0x580c89=0x0;_0x1c2149['forEach'](_0x4b156d=>{const _0x22b658=_0x3d0bc;if(_0x4b156d[_0x22b658(0x309)]){const _0x47726a=new Date(_0x4b156d[_0x22b658(0x309)][_0x22b658(0x1a6)]()),_0x3f9431=_0x47726a[_0x22b658(0x338)]();_0x4b156d['invite']===_0x22b658(0x28f)?(_0x224279[_0x3f9431]++,_0x5a72fb++):(_0x1b1c3c[_0x3f9431]++,_0x580c89++);}}),charts[_0x3d0bc(0x303)][_0x3d0bc(0x317)]['datasets'][0x0]['data']=_0x224279,charts[_0x3d0bc(0x303)][_0x3d0bc(0x317)][_0x3d0bc(0x214)][0x1]['data']=_0x1b1c3c,charts['timeline'][_0x3d0bc(0x273)](),document[_0x3d0bc(0x23b)](_0x3d0bc(0x1f7))[_0x3d0bc(0x26a)]=_0x5a72fb,document[_0x3d0bc(0x23b)](_0x3d0bc(0x2ef))['textContent']=_0x580c89;}const _0x4be370={};teamNames['forEach'](_0x18c095=>_0x4be370[_0x18c095]={'r':0x0,'t':0x0}),allEmployeesData[_0x3d0bc(0x247)](_0x45df5f=>{const _0x10935b=_0x3d0bc;if(_0x45df5f[_0x10935b(0x31a)]&&_0x4be370[_0x45df5f['Check_Place']]){_0x4be370[_0x45df5f[_0x10935b(0x31a)]]['t']++;if(_0x45df5f[_0x10935b(0x309)])_0x4be370[_0x45df5f[_0x10935b(0x31a)]]['r']++;}});const _0x502174=Math[_0x3d0bc(0x1a8)](teamNames[_0x3d0bc(0x2be)]/0x2);charts[_0x3d0bc(0x330)]&&(charts[_0x3d0bc(0x330)]['data'][_0x3d0bc(0x2e0)]=teamNames[_0x3d0bc(0x253)](0x0,_0x502174),charts[_0x3d0bc(0x330)][_0x3d0bc(0x317)][_0x3d0bc(0x214)][0x0][_0x3d0bc(0x317)]=teamNames['slice'](0x0,_0x502174)[_0x3d0bc(0x287)](_0x2db32c=>_0x4be370[_0x2db32c]['r']),charts[_0x3d0bc(0x330)][_0x3d0bc(0x317)][_0x3d0bc(0x214)][0x1]['data']=teamNames[_0x3d0bc(0x253)](0x0,_0x502174)[_0x3d0bc(0x287)](_0x4cad60=>_0x4be370[_0x4cad60]['t']-_0x4be370[_0x4cad60]['r']),charts['bar1']['update']());charts[_0x3d0bc(0x2fd)]&&(charts[_0x3d0bc(0x2fd)][_0x3d0bc(0x317)][_0x3d0bc(0x2e0)]=teamNames[_0x3d0bc(0x253)](_0x502174),charts[_0x3d0bc(0x2fd)][_0x3d0bc(0x317)]['datasets'][0x0][_0x3d0bc(0x317)]=teamNames['slice'](_0x502174)[_0x3d0bc(0x287)](_0x23f2eb=>_0x4be370[_0x23f2eb]['r']),charts[_0x3d0bc(0x2fd)][_0x3d0bc(0x317)][_0x3d0bc(0x214)][0x1][_0x3d0bc(0x317)]=teamNames['slice'](_0x502174)[_0x3d0bc(0x287)](_0x4e5e9a=>_0x4be370[_0x4e5e9a]['t']-_0x4be370[_0x4e5e9a]['r']),charts['bar2'][_0x3d0bc(0x273)]());const _0x469670=[..._0x1c2149]['sort']((_0x50b99a,_0x198ddc)=>(_0x198ddc[_0x3d0bc(0x309)]?.[_0x3d0bc(0x1a6)]()||0x0)-(_0x50b99a['DateLogin']?.['toMillis']()||0x0))['slice'](0x0,0x1e);document[_0x3d0bc(0x23b)](_0x3d0bc(0x314))[_0x3d0bc(0x1c7)]=_0x469670['map'](_0x2b6206=>_0x3d0bc(0x33f)+_0x2b6206[_0x3d0bc(0x325)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20uppercase\x20font-bold\x20text-left\x20text-sm\x22>'+_0x2b6206['FullName_th']+_0x3d0bc(0x196)+(_0x2b6206[_0x3d0bc(0x2d8)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-center\x20text-sm\x20font-bold\x20text-blue-600\x22>'+(_0x2b6206[_0x3d0bc(0x31a)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-left\x20text-sm\x20text-sm\x22>'+(_0x2b6206[_0x3d0bc(0x33c)]||'-')+_0x3d0bc(0x261)+(_0x2b6206[_0x3d0bc(0x2d6)]||'-')+_0x3d0bc(0x24b)+_0x2b6206['id']+_0x3d0bc(0x1b0)+_0x2b6206['FullName_th']+_0x3d0bc(0x1ef))['join'](''),updateTeamTab(),updateGridTab(),updateEmployeeList(),updateGroupRandomUI(),updateLuckyDrawStats(),updateWinnersList();}function updateWinnersList(){const _0xaf023f=_0x58d982,_0x30fe0c=document[_0xaf023f(0x23b)](_0xaf023f(0x2c1));if(!_0x30fe0c)return;const _0x5095c5=allEmployeesData[_0xaf023f(0x2ab)](_0x42a62b=>_0x42a62b[_0xaf023f(0x2ea)]);if(_0x5095c5[_0xaf023f(0x2be)]===0x0){_0x30fe0c[_0xaf023f(0x1c7)]='<div\x20class=\x22p-10\x20text-center\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--</div>';return;}_0x30fe0c[_0xaf023f(0x1c7)]=allGiftsData[_0xaf023f(0x287)](_0x357475=>{const _0x387c8f=_0xaf023f,_0x4f81aa=_0x5095c5['filter'](_0x5241f8=>_0x5241f8[_0x387c8f(0x269)]===_0x357475['id']||_0x5241f8['AwardedGift']===_0x357475['name']&&!_0x5241f8[_0x387c8f(0x269)]);if(_0x4f81aa[_0x387c8f(0x2be)]===0x0)return'';return _0x4f81aa[_0x387c8f(0x2ad)]((_0x3423ec,_0x2754a7)=>(_0x2754a7['RandomTime']?.['toMillis']()||0x0)-(_0x3423ec[_0x387c8f(0x2ea)]?.['toMillis']()||0x0)),_0x387c8f(0x1a1)+_0x357475['name']+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-indigo-600\x20text-white\x20px-3\x20py-1\x20rounded-full\x20text-xs\x20font-bold\x20uppercase\x22>'+_0x4f81aa[_0x387c8f(0x2be)]+_0x387c8f(0x28b)+_0x4f81aa[_0x387c8f(0x287)]((_0xa5aca,_0x14c633)=>{const _0x1e87bd=_0x387c8f,_0x45a34e=_0xa5aca[_0x1e87bd(0x1e3)]?!![]:![],_0x462935=_0x45a34e?'‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß':_0x1e87bd(0x2bd),_0xff29d1=_0x45a34e?_0x1e87bd(0x1d9):_0x1e87bd(0x25e),_0x5a7fc5=_0x45a34e?'':_0x1e87bd(0x232)+_0xa5aca['id']+'\x27)\x22';return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20transition-colors\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-bold\x20text-gray-400\x20text-xs\x22>'+(_0x14c633+0x1)+_0x1e87bd(0x256)+_0xa5aca[_0x1e87bd(0x325)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20uppercase\x20text-left\x22>'+_0xa5aca[_0x1e87bd(0x20d)]+_0x1e87bd(0x237)+(_0xa5aca[_0x1e87bd(0x33c)]||'-')+_0x1e87bd(0x237)+(_0xa5aca[_0x1e87bd(0x2d6)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-blue-600\x20font-bold\x20uppercase\x20text-center\x22>'+(_0xa5aca['Check_Place']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20'+_0x5a7fc5+_0x1e87bd(0x1b2)+_0xff29d1+'\x22>'+_0x462935+_0x1e87bd(0x2f0)+_0xa5aca['id']+_0x1e87bd(0x292);})['join']('')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';})[_0xaf023f(0x24e)]('');}window[_0x58d982(0x1aa)]=async _0x5c425b=>{const _0x5f3168=_0x58d982;try{await updateDoc(doc(db,_0x5f3168(0x2ed),_0x5c425b),{'ReceivedTime':serverTimestamp()});}catch(_0x505b26){console[_0x5f3168(0x1c5)](_0x505b26);}},window[_0x58d982(0x2d4)]=_0x34c6a3=>{const _0x4cbddb=_0x58d982;let _0x1d8042='',_0x5b37ac=[];if(_0x34c6a3===_0x4cbddb(0x255))_0x1d8042=_0x4cbddb(0x26e),_0x5b37ac=allEmployeesData[_0x4cbddb(0x2ab)](_0x3b422a=>_0x3b422a[_0x4cbddb(0x28f)]===_0x4cbddb(0x28f));else{if(_0x34c6a3===_0x4cbddb(0x2d3))_0x1d8042=_0x4cbddb(0x1c3),_0x5b37ac=allEmployeesData[_0x4cbddb(0x2ab)](_0x4e142a=>_0x4e142a[_0x4cbddb(0x309)]&&_0x4e142a[_0x4cbddb(0x28f)]===_0x4cbddb(0x28f));else{if(_0x34c6a3==='unregistered')_0x1d8042=_0x4cbddb(0x19d),_0x5b37ac=allEmployeesData[_0x4cbddb(0x2ab)](_0xd0f8b8=>!_0xd0f8b8['DateLogin']&&_0xd0f8b8[_0x4cbddb(0x28f)]==='invite');else _0x34c6a3==='extras'&&(_0x1d8042=_0x4cbddb(0x1af),_0x5b37ac=allEmployeesData[_0x4cbddb(0x2ab)](_0x513efc=>_0x513efc[_0x4cbddb(0x309)]&&_0x513efc['invite']!==_0x4cbddb(0x28f)));}}document[_0x4cbddb(0x23b)](_0x4cbddb(0x2e5))[_0x4cbddb(0x26a)]=_0x1d8042,document['getElementById'](_0x4cbddb(0x22c))[_0x4cbddb(0x26a)]=_0x5b37ac[_0x4cbddb(0x2be)];const _0x17049c=document['getElementById'](_0x4cbddb(0x1f5));_0x17049c['innerHTML']=_0x5b37ac[_0x4cbddb(0x287)]((_0x2da765,_0x51fa37)=>{const _0x55b822=_0x4cbddb,_0x55e726=_0x2da765[_0x55b822(0x309)]?!![]:![],_0x23244a=_0x55e726?_0x55b822(0x2d9):'-';return _0x55b822(0x27e)+(_0x51fa37+0x1)+_0x55b822(0x238)+_0x2da765[_0x55b822(0x325)]+_0x55b822(0x245)+_0x2da765['FullName_th']+_0x55b822(0x274)+(_0x2da765[_0x55b822(0x33c)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>'+(_0x2da765[_0x55b822(0x2d6)]||'-')+_0x55b822(0x223)+(_0x2da765[_0x55b822(0x31a)]||'-')+_0x55b822(0x21f)+_0x23244a+_0x55b822(0x215)+_0x2da765['id']+'\x27,\x20\x27'+_0x2da765[_0x55b822(0x20d)]+_0x55b822(0x1d5)+(_0x55e726?'':_0x55b822(0x246))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22'+(_0x55e726?_0x55b822(0x22e):_0x55b822(0x2f6))+_0x55b822(0x2de);})[_0x4cbddb(0x24e)]('')||_0x4cbddb(0x2ac),document[_0x4cbddb(0x23b)](_0x4cbddb(0x2c5))[_0x4cbddb(0x2ff)][_0x4cbddb(0x230)](_0x4cbddb(0x2af));};function _0x19b7(_0xc4a48e,_0x5a9984){_0xc4a48e=_0xc4a48e-0x18e;const _0x130ce0=_0x130c();let _0x19b72a=_0x130ce0[_0xc4a48e];return _0x19b72a;}async function addGift(){const _0x4d7815=_0x58d982,_0x244157=document['getElementById'](_0x4d7815(0x1bb))[_0x4d7815(0x250)][_0x4d7815(0x31f)](),_0x482c79=parseInt(document[_0x4d7815(0x23b)]('giftQtyInput')[_0x4d7815(0x250)]);if(!_0x244157||isNaN(_0x482c79))return;const _0x1514c1=allGiftsData['reduce']((_0x19de37,_0x3cd807)=>Math[_0x4d7815(0x26d)](_0x19de37,_0x3cd807[_0x4d7815(0x332)]||0x0),0x0);await addDoc(collection(db,_0x4d7815(0x30e)),{'name':_0x244157,'totalQty':_0x482c79,'remainingQty':_0x482c79,'status':'on','order':_0x1514c1+0x1,'createdAt':serverTimestamp()}),document[_0x4d7815(0x23b)](_0x4d7815(0x1bb))[_0x4d7815(0x250)]='',document[_0x4d7815(0x23b)](_0x4d7815(0x1c4))[_0x4d7815(0x250)]='1';}function renderGiftTable(){const _0x30dccf=_0x58d982,_0x4f1bde=document[_0x30dccf(0x23b)]('giftListTableBody');if(allGiftsData[_0x30dccf(0x2be)]===0x0){_0x4f1bde[_0x30dccf(0x1c7)]=_0x30dccf(0x323);return;}_0x4f1bde[_0x30dccf(0x1c7)]=allGiftsData[_0x30dccf(0x287)]((_0x4ec1f7,_0x1ee64d)=>_0x30dccf(0x2b2)+(_0x4ec1f7[_0x30dccf(0x332)]||_0x1ee64d+0x1)+'\x22\x20onchange=\x22updateGiftOrder(\x27'+_0x4ec1f7['id']+_0x30dccf(0x252)+_0x4ec1f7[_0x30dccf(0x33b)]+_0x30dccf(0x1b8)+_0x4ec1f7[_0x30dccf(0x28d)]+_0x30dccf(0x197)+_0x4ec1f7['remainingQty']+_0x30dccf(0x2e9)+_0x4ec1f7['id']+_0x30dccf(0x1b0)+_0x4ec1f7[_0x30dccf(0x31d)]+_0x30dccf(0x32e)+(_0x4ec1f7[_0x30dccf(0x31d)]==='on'?_0x30dccf(0x1ba):_0x30dccf(0x2e6))+'\x22>'+(_0x4ec1f7[_0x30dccf(0x31d)]==='on'?'ON':_0x30dccf(0x1e9))+_0x30dccf(0x1ab)+_0x4ec1f7['id']+_0x30dccf(0x32b)+_0x4ec1f7['id']+_0x30dccf(0x1b0)+_0x4ec1f7[_0x30dccf(0x33b)]+'\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20font-bold\x20text-xs\x20uppercase\x20text-sm\x22>Delete</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20')[_0x30dccf(0x24e)]('');}window[_0x58d982(0x22b)]=async(_0x5e349c,_0xed68e)=>{const _0x279df4=_0x58d982,_0x347acb=parseInt(_0xed68e);if(!isNaN(_0x347acb))await updateDoc(doc(db,_0x279df4(0x30e),_0x5e349c),{'order':_0x347acb});},window[_0x58d982(0x1a5)]=async(_0x37e61c,_0x2221de)=>{const _0x25ab03=_0x58d982;await updateDoc(doc(db,'crsg_gift',_0x37e61c),{'status':_0x2221de==='on'?_0x25ab03(0x322):'on'});},window[_0x58d982(0x2bf)]=_0x1d6aaf=>{const _0x4a4f73=_0x58d982,_0x1224fe=allGiftsData[_0x4a4f73(0x268)](_0x232cac=>_0x232cac['id']===_0x1d6aaf);if(!_0x1224fe)return;currentEditingGiftId=_0x1d6aaf,document[_0x4a4f73(0x23b)](_0x4a4f73(0x2b4))['value']=_0x1224fe[_0x4a4f73(0x33b)],document['getElementById'](_0x4a4f73(0x204))[_0x4a4f73(0x250)]=_0x1224fe['totalQty'],document[_0x4a4f73(0x23b)](_0x4a4f73(0x313))[_0x4a4f73(0x250)]=_0x1224fe[_0x4a4f73(0x2a2)],document[_0x4a4f73(0x23b)]('editGiftModal')[_0x4a4f73(0x2ff)]['remove']('hidden');},window[_0x58d982(0x33e)]=(_0x2e44eb,_0x44c8ff)=>{const _0x1cb842=_0x58d982,_0x3bcd9e=document[_0x1cb842(0x23b)](_0x1cb842(0x26c));_0x3bcd9e[_0x1cb842(0x18e)]='bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center\x20transition-all\x20duration-300',currentConfirmAction=async()=>{const _0x1d63d7=_0x1cb842;await deleteDoc(doc(db,_0x1d63d7(0x30e),_0x2e44eb)),document[_0x1d63d7(0x23b)]('confirmModal')[_0x1d63d7(0x2ff)][_0x1d63d7(0x1e4)](_0x1d63d7(0x2af));},document[_0x1cb842(0x23b)](_0x1cb842(0x2f3))['textContent']=_0x1cb842(0x2f8),document[_0x1cb842(0x23b)](_0x1cb842(0x221))[_0x1cb842(0x26a)]='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö\x20['+_0x44c8ff+_0x1cb842(0x219),document[_0x1cb842(0x23b)](_0x1cb842(0x2aa))[_0x1cb842(0x2ff)][_0x1cb842(0x1e4)](_0x1cb842(0x2af)),document[_0x1cb842(0x23b)]('confirmModal')[_0x1cb842(0x2ff)][_0x1cb842(0x230)]('hidden');};function renderGiftPicker(){const _0x12ee83=_0x58d982,_0x448339=document[_0x12ee83(0x23b)](_0x12ee83(0x1b1)),_0x4ece54=allGiftsData[_0x12ee83(0x2ab)](_0x3fc82d=>_0x3fc82d[_0x12ee83(0x31d)]==='on'&&_0x3fc82d[_0x12ee83(0x2a2)]>0x0);document['getElementById'](_0x12ee83(0x2b8))[_0x12ee83(0x26a)]=giftPickerContext===_0x12ee83(0x32c)?'‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•':'‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•';if(!_0x4ece54[_0x12ee83(0x2be)]){_0x448339[_0x12ee83(0x1c7)]=_0x12ee83(0x1e2);return;}const _0x191f21=giftPickerContext===_0x12ee83(0x32c)?selectedIndGiftId:selectedGroupGiftId;_0x448339[_0x12ee83(0x1c7)]=_0x4ece54['map'](_0xfae677=>{const _0x1b777c=_0x12ee83,_0x17c0aa=_0xfae677['id']===_0x191f21;return'<div\x20onclick=\x22pickGift(\x27'+_0xfae677['id']+'\x27)\x22\x20class=\x22flex\x20items-center\x20justify-between\x20p-4\x20border\x20rounded-xl\x20hover:bg-blue-50\x20cursor-pointer\x20transition-all\x20'+(_0x17c0aa?_0x1b777c(0x1d4):'bg-white\x20border-gray-100')+_0x1b777c(0x1d0)+(_0x17c0aa?_0x1b777c(0x28a):'text-base\x20text-gray-800')+'\x20uppercase\x20text-sm\x22>'+_0xfae677[_0x1b777c(0x33b)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22'+(_0x17c0aa?_0x1b777c(0x2a8):_0x1b777c(0x28e))+_0x1b777c(0x1f2)+_0xfae677[_0x1b777c(0x2a2)]+_0x1b777c(0x30f)+(_0x17c0aa?_0x1b777c(0x30d):'bg-gray-100\x20text-gray-500')+_0x1b777c(0x19b)+(_0x17c0aa?_0x1b777c(0x2cc):_0x1b777c(0x2b1))+_0x1b777c(0x1c0);})['join']('');}window[_0x58d982(0x319)]=_0x424484=>{const _0x1d5c8e=_0x58d982;giftPickerContext===_0x1d5c8e(0x32c)?(selectedIndGiftId=_0x424484,refreshIndGiftState()):(selectedGroupGiftId=_0x424484,document[_0x1d5c8e(0x23b)](_0x1d5c8e(0x306))[_0x1d5c8e(0x1c7)]='',document[_0x1d5c8e(0x23b)](_0x1d5c8e(0x1d7))['innerHTML']='',refreshGroupGiftState()),document[_0x1d5c8e(0x23b)](_0x1d5c8e(0x190))[_0x1d5c8e(0x2ff)][_0x1d5c8e(0x1e4)](_0x1d5c8e(0x2af));};function refreshIndGiftState(){const _0x491e8b=_0x58d982,_0x48541f=document['getElementById'](_0x491e8b(0x27b)),_0x390675=document['getElementById'](_0x491e8b(0x1a7)),_0x2f94f9=document['getElementById'](_0x491e8b(0x195));if(!selectedIndGiftId){_0x48541f['textContent']='--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--',_0x390675[_0x491e8b(0x26a)]=_0x491e8b(0x206),_0x2f94f9[_0x491e8b(0x246)]=!![];return;}const _0x48447f=allGiftsData['find'](_0x39d143=>_0x39d143['id']===selectedIndGiftId);!_0x48447f||_0x48447f[_0x491e8b(0x2a2)]<=0x0?(_0x48541f['textContent']=_0x48447f?_0x48447f[_0x491e8b(0x33b)]+_0x491e8b(0x272):_0x491e8b(0x2f4),_0x390675[_0x491e8b(0x26a)]=_0x491e8b(0x33d),_0x2f94f9[_0x491e8b(0x246)]=!![]):(_0x48541f[_0x491e8b(0x26a)]=_0x48447f['name'],_0x390675['textContent']='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20'+_0x48447f[_0x491e8b(0x2a2)]+_0x491e8b(0x243),_0x2f94f9[_0x491e8b(0x246)]=![]);}function refreshGroupGiftState(){const _0x1cdb89=_0x58d982,_0x58622e=document[_0x1cdb89(0x23b)](_0x1cdb89(0x231)),_0x5ca359=document[_0x1cdb89(0x23b)](_0x1cdb89(0x1f0)),_0x23168c=document[_0x1cdb89(0x23b)](_0x1cdb89(0x1fd)),_0x2cc76b=document['getElementById'](_0x1cdb89(0x1ec)),_0x4252f1=document[_0x1cdb89(0x23b)](_0x1cdb89(0x305));if(!selectedGroupGiftId){_0x58622e[_0x1cdb89(0x26a)]=_0x1cdb89(0x1ce),_0x58622e['className']=_0x1cdb89(0x2c7),_0x5ca359[_0x1cdb89(0x26a)]=_0x1cdb89(0x206),_0x5ca359[_0x1cdb89(0x18e)]=_0x1cdb89(0x2fa),_0x23168c[_0x1cdb89(0x18e)]=_0x1cdb89(0x32d),_0x4252f1[_0x1cdb89(0x250)]=0x0,_0x2cc76b[_0x1cdb89(0x246)]=!![];return;}const _0x3a4b8e=allGiftsData[_0x1cdb89(0x268)](_0x5db32a=>_0x5db32a['id']===selectedGroupGiftId);!_0x3a4b8e||_0x3a4b8e[_0x1cdb89(0x2a2)]<=0x0?(_0x58622e[_0x1cdb89(0x26a)]=_0x3a4b8e?_0x3a4b8e[_0x1cdb89(0x33b)]+_0x1cdb89(0x272):_0x1cdb89(0x2f4),_0x58622e[_0x1cdb89(0x18e)]=_0x1cdb89(0x258),_0x5ca359[_0x1cdb89(0x26a)]='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200',_0x23168c['className']=_0x1cdb89(0x304),_0x4252f1[_0x1cdb89(0x250)]=0x0,_0x2cc76b[_0x1cdb89(0x246)]=!![]):(_0x58622e[_0x1cdb89(0x26a)]=_0x3a4b8e['name'],_0x58622e['className']='text-base\x20font-black\x20text-blue-600\x20leading-tight\x20uppercase\x20text-sm',_0x5ca359['textContent']='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20'+_0x3a4b8e[_0x1cdb89(0x2a2)]+_0x1cdb89(0x243),_0x5ca359[_0x1cdb89(0x18e)]='text-sm\x20font-bold\x20text-gray-600\x20mt-1\x20text-sm',_0x23168c[_0x1cdb89(0x18e)]=_0x1cdb89(0x20b),_0x4252f1[_0x1cdb89(0x250)]=_0x3a4b8e[_0x1cdb89(0x2a2)],_0x4252f1[_0x1cdb89(0x26d)]=_0x3a4b8e[_0x1cdb89(0x2a2)],_0x2cc76b[_0x1cdb89(0x246)]=![]);}async function startGroupRandomDraw(){const _0x289354=_0x58d982,_0x318a1b=parseInt(document[_0x289354(0x23b)]('grDrawCount')[_0x289354(0x250)])||0x0,_0x499d92=allEmployeesData[_0x289354(0x2ab)](_0x2ea454=>_0x2ea454['DateLogin']&&_0x2ea454[_0x289354(0x28f)]===_0x289354(0x28f)&&!_0x2ea454['RandomTime']);if(!selectedGroupGiftId)return;const _0x3c69f5=allGiftsData[_0x289354(0x268)](_0x9936ac=>_0x9936ac['id']===selectedGroupGiftId);if(_0x318a1b<=0x0||_0x499d92[_0x289354(0x2be)]<_0x318a1b||_0x3c69f5[_0x289354(0x2a2)]<_0x318a1b)return;const _0x188dba=document[_0x289354(0x23b)](_0x289354(0x1ec));_0x188dba['disabled']=!![];const _0x5509cf=document[_0x289354(0x23b)](_0x289354(0x242)),_0x282eac=document['getElementById'](_0x289354(0x339));_0x5509cf[_0x289354(0x1c7)]='',_0x282eac[_0x289354(0x1c7)]='';const _0x1af4ea=[..._0x499d92][_0x289354(0x2ad)](()=>0.5-Math[_0x289354(0x310)]())['slice'](0x0,_0x318a1b);await updateDoc(doc(db,_0x289354(0x30e),selectedGroupGiftId),{'remainingQty':_0x3c69f5['remainingQty']-_0x318a1b});const _0x184efb=Math[_0x289354(0x1a8)](_0x318a1b/0x2),_0x191e74=_0x1af4ea[_0x289354(0x253)](0x0,_0x184efb),_0x6677d5=_0x1af4ea['slice'](_0x184efb),_0x276b5a=_0x2ba3e9=>{const _0x13fa13=_0x289354,_0x56636f=document[_0x13fa13(0x2c0)](_0x13fa13(0x1fa));_0x56636f['id']=_0x13fa13(0x27f),_0x56636f[_0x13fa13(0x18e)]='loading-gif',_0x2ba3e9['appendChild'](_0x56636f);},_0x204b70=_0x28dda8=>{const _0x3e1add=_0x289354,_0x39596e=_0x28dda8[_0x3e1add(0x23c)](_0x3e1add(0x265));if(_0x39596e)_0x39596e[_0x3e1add(0x230)]();};for(let _0x5d2c0c=0x0;_0x5d2c0c<_0x191e74[_0x289354(0x2be)];_0x5d2c0c++){_0x276b5a(_0x5509cf),await new Promise(_0x48457d=>setTimeout(_0x48457d,0x3e8)),_0x204b70(_0x5509cf);const _0x388ed2=_0x191e74[_0x5d2c0c];_0x5509cf[_0x289354(0x1c7)]+=createWinnerItemHTML(_0x5d2c0c+0x1,_0x388ed2),await updateWinnerInDB(_0x388ed2,_0x3c69f5['name'],selectedGroupGiftId);}for(let _0x4babb7=0x0;_0x4babb7<_0x6677d5[_0x289354(0x2be)];_0x4babb7++){_0x276b5a(_0x282eac),await new Promise(_0x5d6a1e=>setTimeout(_0x5d6a1e,0x3e8)),_0x204b70(_0x282eac);const _0x4b4d63=_0x6677d5[_0x4babb7];_0x282eac['innerHTML']+=createWinnerItemHTML(_0x184efb+_0x4babb7+0x1,_0x4b4d63),await updateWinnerInDB(_0x4b4d63,_0x3c69f5[_0x289354(0x33b)],selectedGroupGiftId);}_0x188dba[_0x289354(0x246)]=![],confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}});}function _0x130c(){const _0x2114fa=['</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-center\x20text-orange-600\x20text-sm\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-sm\x22>','ttb-register.firebasestorage.app','bg-green-400\x20text-white\x20border-green-600','giftNameInput','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20','<tr><td\x20colspan=\x228\x22\x20class=\x22p-10\x20text-center\x20text-sm\x20text-sm\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</td></tr>','editEmpManager','Remaining','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','change','startsWith','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß','giftQtyInput','error','groupViewModal','innerHTML','teamMemberCountElem','manager','A18','empPaginationContainer','resize','groupViewStatsTotal','--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--','openGiftPickerBtn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-black\x20','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?\x20(‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)','1070273157855','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x20text-[10px]\x20font-normal\x20text-xs\x20text-sm\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','bg-blue-100\x20border-blue-500\x20shadow-md','\x27)\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','regEmpInviteStatus','teamGridB','doughnut','bg-green-500\x20text-white','B14','878aqfZXD',')\x22>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','searchRegEmployeeButton','replace','Employee_List_Report.csv','resetTeamButton','665535anbXdJ','<p\x20class=\x22text-center\x20py-10\x20text-gray-400\x20font-bold\x20italic\x20text-sm\x22>--\x20‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠\x20--</p>','ReceivedTime','add','teamStatsTotal','sort-emp-status','winnerDetailModal','B24','OFF','<option\x20value=\x22','managerFilterSelect','grStartDrawBtn','definedTeamNamesInput','asc','\x27)\x22\x20class=\x22text-red-600\x20hover:text-red-700\x20cursor-pointer\x20font-black\x20text-xs\x22>‡∏•‡∏ö</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','grGiftDisplayQty','1276610CniIxz','\x20font-bold\x20text-sm\x22>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','modalDrawnCount','<button\x20class=\x22pagination-btn\x20','dashboardListTableBody','sort-emp-name','timelineTotalInvite','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','from','div','active','A19','grGiftBox','fill','localeCompare','winnerName','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-400\x20text-center\x20text-xs\x22>','\x20aspect-square\x20rounded-full\x20border\x20border-gray-200\x20flex\x20flex-col\x20items-center\x20justify-center\x20cursor-pointer\x20hover:shadow-lg\x20hover:scale-105\x20transition-all\x20active:scale-95\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-[12px]\x20font-bold\x20text-blue-700\x20leading-none\x20text-xs\x20font-bold\x22>','B20','editGiftTotalQty','bar','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','unregistered','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20font-bold\x20text-left\x20text-sm\x22>','B13','flex\x20items-center\x20justify-between\x20bg-blue-50\x20border-2\x20border-blue-300\x20rounded-xl\x20p-3\x20transition-all','createObjectURL','FullName_th','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','numeric','searchEmployeeButton','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22','gift','AwardedGift','datasets','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27','bottom','bg-green-100','click',']\x20?','A16','<option\x20value=\x22\x22>--\x20‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','412055iyooaW','openGroupDetail','randomizeModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-center\x22>','\x27)\x22\x20class=\x22bg-red-50\x20text-white\x20px-3\x20py-1\x20rounded\x20cursor-pointer\x20text-sm\x20font-bold\x22>‡∏•‡∏ö</span></td></tr>','confirmText','A17','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x22>','‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß','editEmployeeModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-black\x20uppercase\x20text-xs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','saveEditGiftBtn','‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:\x20','digit','top','updateGiftOrder','dashboardListCount','<span\x20class=\x22px-1\x20text-gray-400\x22>...</span>','bg-red-600\x20text-white\x20hover:bg-red-700','1158PivcBi','remove','grGiftDisplayName','onclick=\x22markAsReceived(\x27','groupViewTableBody','</span>','\x20px-3\x20py-1\x20rounded\x20text-[10px]\x20font-normal\x20uppercase\x20cursor-pointer\x20transition-all\x20text-xs\x20text-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#3B82F6','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-left\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-mono\x20font-bold\x20text-blue-700\x20text-center\x22>','randomizeError','85259LWDrQH','getElementById','querySelector','#10B981','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x22>','\x20onclick=\x22changeEmpPage(','padStart','confirmModal','grBoxLeft','\x20‡∏ä‡∏¥‡πâ‡∏ô','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-2\x20py-0.5\x20rounded\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-left\x20uppercase\x22>','disabled','forEach','registrationBreakdownChart','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27','href','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20class=\x22px-3\x20py-0\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-[10px]\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22cancelReg(\x27','40344CCfEDz','24008ahSuEG','join','A22','value','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x27,\x20this.value)\x22\x20class=\x22w-16\x20p-1\x20text-center\x20border\x20rounded\x20font-bold\x20text-blue-600\x22\x20min=\x221\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20font-normal\x22>','slice','#BFDBFE','total','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-mono\x20font-black\x20text-blue-700\x22>','\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á,‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\x0a','text-base\x20font-black\x20text-red-400\x20leading-tight\x20uppercase\x20text-sm','removeLuckyWinner','B23','sort-emp-id','updateTeamNamesBtn','bg-red-100\x20text-red-700\x20hover:bg-red-200','bg-red-500\x20text-white\x20cursor-pointer\x20hover:bg-red-600','searchRegEmployeeIdInput','managerEmployeeCount','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-left\x20text-sm\x20text-sm\x22>','searchRegEmployeeError','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','#loader','toString','‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ç‡∏≠‡∏á\x20[','find','AwardedGiftId','textContent','gvOverallStatsContainer','confirmModalInner','max','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î','A21','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','#F59E0B','\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)','update','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>','gvOverallStatsTotal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x22>','ttb-register.firebaseapp.com','download','regEmpSeat','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','indGiftDisplayName','teamSelect','\ufeff‡∏•‡∏≥‡∏î‡∏±‡∏ö,‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-gray-400\x20font-bold\x20text-xs\x22>','loader','manualRegisterModal','</td><td\x20class=\x22px-4\x20py-4\x20uppercase\x20font-bold\x20text-xm\x20text-left\x20text-sm\x20text-sm\x20text-sm\x22>','downloadEmployeeCsvButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x22>','empStatsTotal','empStatsUnregistered','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x20text-center\x20text-sm\x22>','map','B12','2-digit','text-blue-800','\x20‡∏ó‡πà‡∏≤‡∏ô</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22overflow-x-auto\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22min-w-full\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-header-gray\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏£‡∏´‡∏±‡∏™</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏≤‡∏Ç‡∏≤</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20class=\x22divide-y\x20divide-gray-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Winners_Report.csv','totalQty','text-gray-500','invite','‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô','closeRandomizeModalButtonX','\x27)\x22\x20class=\x22px-3\x20py-0\x20bg-red-100\x20text-red-600\x20rounded-lg\x20text-xs\x20font-black\x20hover:bg-red-600\x20hover:text-white\x20transition-all\x20uppercase\x22>‡∏•‡∏ö</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','editEmpName','Registered','B17','dashboard-content','<tr><td\x20class=\x22px-4\x20py-4\x20font-mono\x20font-black\x20text-blue-700\x20text-center\x20text-sm\x22>','group-random-content','remainingCount','75%','\x27)\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Registration_Report.csv',':00','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>','regEmpManager','winnerTeam','‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß','remainingQty','‡∏™‡∏≤‡∏Ç‡∏≤:\x20','targetCount','modalParticipantsCount','empStatsContainer','breakdown','text-blue-600','floor','confirmInputContainer','filter','<tr><td\x20colspan=\x228\x22\x20class=\x22p-10\x20text-center\x20text-gray-400\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>','sort','round','hidden','B21','Select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><input\x20type=\x22number\x22\x20value=\x22','4gDGply','editGiftName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27','A14','toUpperCase','giftPickerTitle','‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢','regEmpNickname','nickname','\x27)\x22\x20class=\x22','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö','length','editGift','createElement','winnersByGiftContainer','empStatsRegistered','employee-list-content','bg-gray-300','dashboardListModal','extras','text-base\x20font-black\x20text-gray-400\x20leading-tight\x20uppercase\x20text-sm','ttb-register','desc','selectedTeamTableBody','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xm\x20font-black\x20text-gray-800\x20uppercase\x20text-left\x22>','Selected','attendeesCount','A10','winnerEmployeeId','cancelReg','sort-emp-nickname','empStatsPercent','registered','openDashboardList','closeDashboardListModalButton','Check_Manager','closeManualRegModalButton','NickName','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-3\x20py-0.5\x20rounded-full\x20text-[10px]\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','confirmInput','bg-yellow-50','\x22\x20onclick=\x22changeEmpPage(','\x20px-4\x20py-1\x20rounded\x20text-[10px]\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xs\x20uppercase\x20shadow-sm\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','labels','RESET','card-unregistered','docs','closeEditGiftModalBtn','dashboardListModalTitle','bg-gray-200\x20text-gray-600','gvOverallStatsRegistered','closeGiftPickerBtn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><button\x20onclick=\x22toggleGiftStatus(\x27','RandomTime','</option>','‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','crsg','searchEmployeeIdInput','timelineTotalExtra','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22removeLuckyWinner(\x27','winners-list-content','B10','confirmTitle','--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--','bold','bg-gray-100\x20text-gray-400','card-registered','‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','</button>','text-sm\x20font-bold\x20text-gray-300\x20mt-1\x20text-sm','\x22,\x22‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô\x22\x0a','commit','bar2','card-extras','classList','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å','<option\x20value=\x22\x22>--\x20‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','grTotalWinners','timeline','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all','grDrawCount','teamGridA','regEmpBranch','card-total','DateLogin','downloadWinnersCsvButton','branch','saveManualRegButton','bg-blue-600\x20text-white','crsg_gift','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22px-4\x20py-1\x20','random','goal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','editGiftRemainingQty','latestRegistrationsTableBody','\x22,\x22','team-list-content','data','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x20text-sm\x20text-sm\x22>','pickGift','Check_Place','\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-bold\x20uppercase\x20cursor-pointer\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','text/csv;charset=utf-8;','status','editEmpTeam','trim','register-content','grTotalEligible','off','<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-400\x20font-bold\x22>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>','regEmpName','employeeId','‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:\x20','bg-orange-100','randomizeButton','<tr\x20class=\x22','teamStatsContainer','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20mr-2\x20text-sm\x22>Edit</span>|\x20<span\x20onclick=\x22deleteGift(\x27','ind','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all\x20text-sm','\x27)\x22\x20class=\x22px-4\x20py-1\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x20border\x20','employeeListTableBody','bar1','B19','order','B11','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','addEventListener','#fff','getHours','grBoxRight','Invite','name','Branch_eng','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200','deleteGift','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö','groupViewModalTitle','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>','addGiftBtn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-600\x20text-sm\x20text-sm\x22>','className','donutPercentage','giftPickerModal','regManualError','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','split',')\x22>','startRandomizeButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-left\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-blue-600\x20font-bold\x20text-sm\x22>','A24','th-TH','18OsEhjZ','\x20rounded-lg\x20text-sm\x20font-black\x20uppercase\x22>','groupViewManagerFilter','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','closeWinnerModalButton','A13','‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-white\x20border\x20border-gray-100\x20rounded-2xl\x20overflow-hidden\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-gray-50\x20px-6\x20py-4\x20border-b\x20flex\x20justify-between\x20items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-black\x20text-indigo-700\x20uppercase\x22>üéÅ\x20‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','group',']\x20‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\x20(‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á)','includes','toggleGiftStatus','toMillis','indGiftDisplayQty','ceil','searchEmployeeError','markAsReceived','</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><span\x20onclick=\x22editGift(\x27','A15','teamBarChart1','‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°\x20','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô','\x27,\x20\x27','giftPickerList','\x20class=\x22px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-black\x20transition-all\x20shadow-sm\x20','B22','drawnWinnersTableBody','editEmpId','openGroupGiftPickerBtn'];_0x130c=function(){return _0x2114fa;};return _0x130c();}function createWinnerItemHTML(_0x11a2a9,_0x1b6991){const _0x4cc101=_0x58d982;return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20bg-blue-50\x20p-2.5\x20rounded-xl\x20border\x20border-blue-100\x20winner-row-animate\x20shadow-sm\x20mb-1.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-blue-600\x20text-white\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center\x20rounded-full\x20text-[9px]\x20font-bold\x22>'+_0x11a2a9+_0x4cc101(0x2cb)+_0x1b6991[_0x4cc101(0x20d)]+'\x20('+_0x1b6991['employeeId']+')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22removeLuckyWinner(\x27'+_0x1b6991['id']+'\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20cursor-pointer\x20font-bold\x20text-lg\x20ml-3\x20text-sm\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}async function updateWinnerInDB(_0xcc838c,_0x506ca3,_0x3c1e7f){const _0x47255d=_0x58d982;await updateDoc(doc(db,_0x47255d(0x2ed),_0xcc838c['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x506ca3,'AwardedGiftId':_0x3c1e7f});}async function runIndividualLuckyDraw(){const _0x49b2c0=_0x58d982,_0x59ff10=document[_0x49b2c0(0x23b)](_0x49b2c0(0x239));_0x59ff10[_0x49b2c0(0x26a)]='';const _0x53541b=allEmployeesData[_0x49b2c0(0x2ab)](_0x215b88=>_0x215b88[_0x49b2c0(0x309)]&&_0x215b88['invite']===_0x49b2c0(0x28f)&&!_0x215b88['RandomTime']);if(!selectedIndGiftId){_0x59ff10[_0x49b2c0(0x26a)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô';return;}if(!_0x53541b[_0x49b2c0(0x2be)]){_0x59ff10['textContent']=_0x49b2c0(0x290);return;}const _0x5598a9=allGiftsData[_0x49b2c0(0x268)](_0x448bc0=>_0x448bc0['id']===selectedIndGiftId);if(!_0x5598a9||_0x5598a9[_0x49b2c0(0x2a2)]<=0x0){_0x59ff10[_0x49b2c0(0x26a)]=_0x49b2c0(0x2a1);return;}const _0x46cb09=document[_0x49b2c0(0x23b)]('startRandomizeButton');_0x46cb09[_0x49b2c0(0x246)]=!![];const _0x3e7ced=[0x1,0x2,0x3,0x4,0x5][_0x49b2c0(0x287)](_0x37b479=>document[_0x49b2c0(0x23b)](_0x49b2c0(0x229)+_0x37b479));let _0x400f54=0x0;drawInterval=setInterval(()=>{const _0x5bc1ab=_0x49b2c0;_0x3e7ced[_0x5bc1ab(0x247)](_0x10596e=>_0x10596e[_0x5bc1ab(0x26a)]=Math[_0x5bc1ab(0x2a9)](Math[_0x5bc1ab(0x310)]()*0xa));if(++_0x400f54>0x28){clearInterval(drawInterval);const _0x5490fc=_0x53541b[Math[_0x5bc1ab(0x2a9)](Math[_0x5bc1ab(0x310)]()*_0x53541b[_0x5bc1ab(0x2be)])],_0x20bc3e=String(_0x5490fc['employeeId'])[_0x5bc1ab(0x253)](-0x5)[_0x5bc1ab(0x240)](0x5,'0');_0x3e7ced['forEach']((_0x3e631e,_0x4f08ea)=>_0x3e631e[_0x5bc1ab(0x26a)]=_0x20bc3e[_0x4f08ea]),setTimeout(async()=>{const _0xbdb09=_0x5bc1ab;await updateDoc(doc(db,'crsg_gift',selectedIndGiftId),{'remainingQty':_0x5598a9['remainingQty']-0x1}),await updateDoc(doc(db,_0xbdb09(0x2ed),_0x5490fc['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x5598a9['name'],'AwardedGiftId':selectedIndGiftId}),document['getElementById'](_0xbdb09(0x200))['textContent']=_0x5490fc['FullName_th']+'\x20('+_0x5490fc[_0xbdb09(0x325)]+')',document['getElementById']('winnerGiftText')[_0xbdb09(0x26a)]=_0xbdb09(0x1f8)+_0x5598a9[_0xbdb09(0x33b)],document[_0xbdb09(0x23b)](_0xbdb09(0x2cf))['textContent']=_0xbdb09(0x228)+_0x5490fc[_0xbdb09(0x325)],document[_0xbdb09(0x23b)]('winnerBU')[_0xbdb09(0x26a)]=_0xbdb09(0x2a3)+(_0x5490fc[_0xbdb09(0x33c)]||'-'),document[_0xbdb09(0x23b)](_0xbdb09(0x2a0))[_0xbdb09(0x26a)]=_0xbdb09(0x326)+(_0x5490fc[_0xbdb09(0x2d6)]||'-'),document[_0xbdb09(0x23b)](_0xbdb09(0x1e7))[_0xbdb09(0x2ff)][_0xbdb09(0x230)]('hidden'),confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}}),_0x46cb09[_0xbdb09(0x246)]=![],updateLuckyDrawStats();},0x1f4);}},0x32);}window[_0x58d982(0x259)]=async _0x4b0818=>{const _0x5d17f1=_0x58d982,_0xf35ac1=allEmployeesData[_0x5d17f1(0x268)](_0x40e4d5=>_0x40e4d5['id']===_0x4b0818);if(!_0xf35ac1)return;if(_0xf35ac1[_0x5d17f1(0x269)]){const _0x3a204f=allGiftsData['find'](_0x1e1ecc=>_0x1e1ecc['id']===_0xf35ac1[_0x5d17f1(0x269)]);if(_0x3a204f)await updateDoc(doc(db,_0x5d17f1(0x30e),_0x3a204f['id']),{'remainingQty':_0x3a204f['remainingQty']+0x1});}await updateDoc(doc(db,_0x5d17f1(0x2ed),_0x4b0818),{'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null}),document[_0x5d17f1(0x23b)](_0x5d17f1(0x1e7))[_0x5d17f1(0x2ff)][_0x5d17f1(0x1e4)](_0x5d17f1(0x2af));};function updateLuckyDrawStats(){const _0x4e1048=_0x58d982,_0xcd7e78=allEmployeesData[_0x4e1048(0x2ab)](_0x22e1ea=>_0x22e1ea[_0x4e1048(0x309)]&&_0x22e1ea[_0x4e1048(0x28f)]===_0x4e1048(0x28f)),_0x589af5=_0xcd7e78[_0x4e1048(0x2ab)](_0x1ffc70=>_0x1ffc70[_0x4e1048(0x2ea)])['sort']((_0x1bd17b,_0x43664a)=>(_0x43664a[_0x4e1048(0x2ea)]?.[_0x4e1048(0x1a6)]()||0x0)-(_0x1bd17b['RandomTime']?.['toMillis']()||0x0));document['getElementById'](_0x4e1048(0x2a5))[_0x4e1048(0x26a)]=_0xcd7e78[_0x4e1048(0x2ab)](_0x49d45c=>!_0x49d45c[_0x4e1048(0x2ea)])[_0x4e1048(0x2be)],document['getElementById'](_0x4e1048(0x1f3))[_0x4e1048(0x26a)]=_0x589af5['length'],document[_0x4e1048(0x23b)](_0x4e1048(0x1b4))[_0x4e1048(0x1c7)]=_0x589af5[_0x4e1048(0x287)](_0x4dc99d=>_0x4e1048(0x297)+_0x4dc99d[_0x4e1048(0x325)]+_0x4e1048(0x281)+_0x4dc99d[_0x4e1048(0x20d)]+(_0x4dc99d[_0x4e1048(0x213)]?'<br/><span\x20class=\x22text-sm\x20text-orange-600\x20text-xs\x22>üéÅ\x20'+_0x4dc99d[_0x4e1048(0x213)]+_0x4e1048(0x234):'')+'</td><td\x20class=\x22px-4\x20py-4\x20text-xm\x20font-bold\x20text-gray-500\x20uppercase\x20text-left\x20text-sm\x22>'+(_0x4dc99d[_0x4e1048(0x33c)]||'-')+'</td><td\x20class=\x22px-4\x20py-4\x20text-center\x22><span\x20onclick=\x22removeLuckyWinner(\x27'+_0x4dc99d['id']+_0x4e1048(0x220))['join']('');}function updateTeamTab(){const _0x2c1ed9=_0x58d982,_0x127f96=document[_0x2c1ed9(0x23b)](_0x2c1ed9(0x27c)),_0x3127a2=_0x127f96['value'];_0x127f96[_0x2c1ed9(0x1c7)]='<option\x20value=\x22\x22>--\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°\x20--</option>'+teamNames[_0x2c1ed9(0x287)](_0x14ed57=>_0x2c1ed9(0x1ea)+_0x14ed57+'\x22>'+_0x14ed57+_0x2c1ed9(0x2eb))['join'](''),_0x127f96[_0x2c1ed9(0x250)]=teamNames[_0x2c1ed9(0x1a4)](_0x3127a2)?_0x3127a2:'';if(_0x127f96[_0x2c1ed9(0x250)]){const _0x35384b=allEmployeesData[_0x2c1ed9(0x2ab)](_0x48a76d=>_0x48a76d[_0x2c1ed9(0x31a)]===_0x127f96[_0x2c1ed9(0x250)]);document['getElementById'](_0x2c1ed9(0x1e5))['textContent']=_0x35384b[_0x2c1ed9(0x2be)],document[_0x2c1ed9(0x23b)]('teamStatsRegistered')['textContent']=_0x35384b['filter'](_0x462568=>_0x462568[_0x2c1ed9(0x309)])[_0x2c1ed9(0x2be)],document[_0x2c1ed9(0x23b)](_0x2c1ed9(0x32a))[_0x2c1ed9(0x2ff)][_0x2c1ed9(0x230)](_0x2c1ed9(0x2af)),document[_0x2c1ed9(0x23b)](_0x2c1ed9(0x2ca))['innerHTML']=_0x35384b[_0x2c1ed9(0x287)]((_0x41c42f,_0xb6fb14)=>'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22'+(_0x41c42f[_0x2c1ed9(0x309)]?_0x2c1ed9(0x2dc):'')+_0x2c1ed9(0x23e)+(_0xb6fb14+0x1)+_0x2c1ed9(0x276)+_0x41c42f[_0x2c1ed9(0x325)]+_0x2c1ed9(0x283)+_0x41c42f[_0x2c1ed9(0x20d)]+_0x2c1ed9(0x29e)+(_0x41c42f[_0x2c1ed9(0x2d8)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>'+(_0x41c42f[_0x2c1ed9(0x33c)]||'-')+_0x2c1ed9(0x29e)+(_0x41c42f[_0x2c1ed9(0x2d6)]||'-')+_0x2c1ed9(0x226)+(_0x41c42f[_0x2c1ed9(0x309)]?_0x2c1ed9(0x335):'-')+_0x2c1ed9(0x2b5)+_0x41c42f['id']+_0x2c1ed9(0x2df))[_0x2c1ed9(0x24e)]('');}else document[_0x2c1ed9(0x23b)](_0x2c1ed9(0x32a))[_0x2c1ed9(0x2ff)]['add'](_0x2c1ed9(0x2af));}function updateGridTab(){const _0x3e5799=_0x58d982,_0x2232eb=document[_0x3e5799(0x23b)](_0x3e5799(0x19c))['value'],_0x35c61a=[...new Set(allEmployeesData['map'](_0x1f8976=>_0x1f8976['Check_Manager'])[_0x3e5799(0x2ab)](Boolean))][_0x3e5799(0x2ad)](),_0x4b5a6a=document[_0x3e5799(0x23b)](_0x3e5799(0x19c));_0x4b5a6a['options'][_0x3e5799(0x2be)]!==_0x35c61a[_0x3e5799(0x2be)]+0x1&&(_0x4b5a6a['innerHTML']=_0x3e5799(0x21b)+_0x35c61a[_0x3e5799(0x287)](_0x519d89=>_0x3e5799(0x1ea)+_0x519d89+'\x22>'+_0x519d89+_0x3e5799(0x2eb))[_0x3e5799(0x24e)](''));_0x4b5a6a[_0x3e5799(0x250)]=_0x2232eb;const _0x773177=_0x2232eb?allEmployeesData['filter'](_0x21aace=>_0x21aace[_0x3e5799(0x2d6)]===_0x2232eb):allEmployeesData,_0x5ba190=_0x773177[_0x3e5799(0x2ab)](_0x1353f2=>_0x1353f2['invite']===_0x3e5799(0x28f));document[_0x3e5799(0x23b)](_0x3e5799(0x275))['textContent']=_0x5ba190[_0x3e5799(0x2be)],document[_0x3e5799(0x23b)](_0x3e5799(0x2e7))[_0x3e5799(0x26a)]=_0x5ba190[_0x3e5799(0x2ab)](_0x17d3ab=>_0x17d3ab[_0x3e5799(0x309)])['length'],document[_0x3e5799(0x23b)](_0x3e5799(0x26b))[_0x3e5799(0x2ff)]['remove']('hidden');const _0x29b089={};teamNames[_0x3e5799(0x247)](_0x14cf9b=>_0x29b089[_0x14cf9b]={'r':0x0,'t':0x0}),_0x773177[_0x3e5799(0x2ab)](_0x6dde52=>_0x6dde52['Check_Place'])[_0x3e5799(0x247)](_0x250c68=>{const _0x694176=_0x3e5799;if(_0x29b089[_0x250c68[_0x694176(0x31a)]]){_0x29b089[_0x250c68[_0x694176(0x31a)]]['t']++;if(_0x250c68[_0x694176(0x309)])_0x29b089[_0x250c68[_0x694176(0x31a)]]['r']++;}});const _0x5aed38=document[_0x3e5799(0x23b)](_0x3e5799(0x306)),_0x98438e=document['getElementById'](_0x3e5799(0x1d7));_0x5aed38[_0x3e5799(0x1c7)]='',_0x98438e[_0x3e5799(0x1c7)]='',teamNames['forEach'](_0x51f2cd=>{const _0x5ec9bd=_0x3e5799,_0x34871d=_0x29b089[_0x51f2cd];let _0x241b4a='bg-gray-100';if(_0x34871d['t']>0x0){if(_0x34871d['r']===_0x34871d['t'])_0x241b4a=_0x5ec9bd(0x217);else{if(_0x34871d['r']>0x0)_0x241b4a=_0x5ec9bd(0x327);}}const _0x8007eb='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20onclick=\x22openGroupDetail(\x27'+_0x51f2cd+_0x5ec9bd(0x2bc)+_0x241b4a+_0x5ec9bd(0x202)+_0x51f2cd+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20font-black\x20text-gray-900\x20mt-0.5\x20text-sm\x22>'+_0x34871d['r']+'/'+_0x34871d['t']+_0x5ec9bd(0x334);if(_0x51f2cd[_0x5ec9bd(0x1c2)]('A'))_0x5aed38[_0x5ec9bd(0x1c7)]+=_0x8007eb;else{if(_0x51f2cd['startsWith']('B'))_0x98438e['innerHTML']+=_0x8007eb;}});}function updateEmployeeList(){const _0x434316=_0x58d982,_0x1370a4=document[_0x434316(0x23b)](_0x434316(0x1eb))[_0x434316(0x250)],_0x126390=[...new Set(allEmployeesData[_0x434316(0x287)](_0x5f463e=>_0x5f463e[_0x434316(0x2d6)])[_0x434316(0x2ab)](Boolean))][_0x434316(0x2ad)](),_0x15c32a=document[_0x434316(0x23b)]('managerFilterSelect');_0x15c32a['options'][_0x434316(0x2be)]!==_0x126390[_0x434316(0x2be)]+0x1&&(_0x15c32a[_0x434316(0x1c7)]=_0x434316(0x301)+_0x126390['map'](_0x552615=>_0x434316(0x1ea)+_0x552615+'\x22>'+_0x552615+_0x434316(0x2eb))[_0x434316(0x24e)](''));_0x15c32a['value']=_0x1370a4;let _0x4b4b4e=allEmployeesData[_0x434316(0x2ab)](_0x5426dd=>_0x5426dd['Check_Place']&&_0x5426dd[_0x434316(0x31a)][_0x434316(0x31f)]()!==''||_0x5426dd[_0x434316(0x309)]);if(_0x1370a4)_0x4b4b4e=_0x4b4b4e[_0x434316(0x2ab)](_0x1b5be0=>_0x1b5be0[_0x434316(0x2d6)]===_0x1370a4);_0x4b4b4e[_0x434316(0x2ad)]((_0x34db34,_0x11754a)=>{const _0x51fbe1=_0x434316;let _0x5202f1,_0x13f4fa;switch(empSortField){case _0x51fbe1(0x31d):_0x5202f1=_0x34db34[_0x51fbe1(0x309)]?0x1:0x0,_0x13f4fa=_0x11754a[_0x51fbe1(0x309)]?0x1:0x0;break;case _0x51fbe1(0x33b):return empSortDir===_0x51fbe1(0x1ee)?_0x34db34[_0x51fbe1(0x20d)][_0x51fbe1(0x1ff)](_0x11754a[_0x51fbe1(0x20d)],'th'):_0x11754a[_0x51fbe1(0x20d)][_0x51fbe1(0x1ff)](_0x34db34['FullName_th'],'th');case _0x51fbe1(0x30b):_0x5202f1=_0x34db34[_0x51fbe1(0x33c)]||'',_0x13f4fa=_0x11754a[_0x51fbe1(0x33c)]||'';break;case _0x51fbe1(0x1c9):_0x5202f1=_0x34db34[_0x51fbe1(0x2d6)]||'',_0x13f4fa=_0x11754a[_0x51fbe1(0x2d6)]||'';break;case _0x51fbe1(0x2bb):_0x5202f1=_0x34db34['NickName']||'',_0x13f4fa=_0x11754a[_0x51fbe1(0x2d8)]||'';break;case _0x51fbe1(0x212):_0x5202f1=_0x34db34[_0x51fbe1(0x213)]?0x1:0x0,_0x13f4fa=_0x11754a[_0x51fbe1(0x213)]?0x1:0x0;break;default:_0x5202f1=_0x34db34['employeeId'],_0x13f4fa=_0x11754a[_0x51fbe1(0x325)];}if(_0x5202f1<_0x13f4fa)return empSortDir===_0x51fbe1(0x1ee)?-0x1:0x1;if(_0x5202f1>_0x13f4fa)return empSortDir===_0x51fbe1(0x1ee)?0x1:-0x1;return 0x0;});const _0x1e2474=_0x4b4b4e[_0x434316(0x2be)],_0x33ab5c=_0x4b4b4e[_0x434316(0x2ab)](_0x24e24a=>_0x24e24a['DateLogin'])[_0x434316(0x2be)],_0x3d9a3c=_0x1e2474-_0x33ab5c,_0x2fadab=_0x1e2474>0x0?Math['round'](_0x33ab5c/_0x1e2474*0x64):0x0;document[_0x434316(0x23b)](_0x434316(0x284))[_0x434316(0x26a)]=_0x1e2474,document[_0x434316(0x23b)](_0x434316(0x2c2))[_0x434316(0x26a)]=_0x33ab5c,document[_0x434316(0x23b)](_0x434316(0x285))[_0x434316(0x26a)]=_0x3d9a3c,document[_0x434316(0x23b)](_0x434316(0x2d2))['textContent']=_0x2fadab+'%',document[_0x434316(0x23b)](_0x434316(0x2a6))[_0x434316(0x2ff)][_0x434316(0x230)](_0x434316(0x2af));const _0x1fb5e4=Math[_0x434316(0x1a8)](_0x1e2474/empPageSize);if(empCurrentPage>_0x1fb5e4&&_0x1fb5e4>0x0)empCurrentPage=_0x1fb5e4;const _0x34d397=_0x4b4b4e['slice']((empCurrentPage-0x1)*empPageSize,empCurrentPage*empPageSize);document[_0x434316(0x23b)](_0x434316(0x32f))[_0x434316(0x1c7)]=_0x34d397[_0x434316(0x287)]((_0x5a041b,_0x466e39)=>{const _0x485d97=_0x434316,_0x14f458=_0x5a041b[_0x485d97(0x309)]?!![]:![];return _0x485d97(0x264)+(_0x14f458?_0x485d97(0x2dc):'')+_0x485d97(0x201)+((empCurrentPage-0x1)*empPageSize+(_0x466e39+0x1))+_0x485d97(0x286)+_0x5a041b[_0x485d97(0x325)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x20text-sm\x20text-sm\x22>'+_0x5a041b[_0x485d97(0x20d)]+_0x485d97(0x344)+(_0x5a041b[_0x485d97(0x33c)]||'-')+_0x485d97(0x344)+(_0x5a041b[_0x485d97(0x2d6)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-400\x20text-sm\x20text-sm\x22>'+(_0x5a041b['NickName']||'-')+_0x485d97(0x1b7)+(_0x5a041b[_0x485d97(0x213)]?'‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•':'-')+_0x485d97(0x318)+(_0x5a041b[_0x485d97(0x31a)]||'-')+_0x485d97(0x251)+(_0x14f458?_0x485d97(0x1d3):'-')+_0x485d97(0x249)+_0x5a041b['id']+'\x27,\x20\x27'+_0x5a041b[_0x485d97(0x20d)]+_0x485d97(0x29b)+(_0x14f458?'':'disabled')+_0x485d97(0x211)+(_0x14f458?_0x485d97(0x25d):_0x485d97(0x2f6))+_0x485d97(0x235);})[_0x434316(0x24e)](''),renderEmpPagination(_0x1fb5e4);}function renderEmpPagination(_0x4f1e92){const _0xb16483=_0x58d982,_0x4d88e6=document[_0xb16483(0x23b)](_0xb16483(0x1cb));if(_0x4f1e92<=0x1){_0x4d88e6['innerHTML']='';return;}let _0x72a14b=_0xb16483(0x1bc)+(empCurrentPage===0x1?'disabled':'')+_0xb16483(0x23f)+(empCurrentPage-0x1)+_0xb16483(0x1dc);for(let _0xfa4592=0x1;_0xfa4592<=_0x4f1e92;_0xfa4592++){if(_0xfa4592===0x1||_0xfa4592===_0x4f1e92||_0xfa4592>=empCurrentPage-0x2&&_0xfa4592<=empCurrentPage+0x2)_0x72a14b+=_0xb16483(0x1f4)+(_0xfa4592===empCurrentPage?_0xb16483(0x1fb):'')+_0xb16483(0x2dd)+_0xfa4592+_0xb16483(0x194)+_0xfa4592+_0xb16483(0x2f9);else(_0xfa4592===empCurrentPage-0x3||_0xfa4592===empCurrentPage+0x3)&&(_0x72a14b+=_0xb16483(0x22d));}_0x72a14b+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20'+(empCurrentPage===_0x4f1e92?_0xb16483(0x246):'')+'\x20onclick=\x22changeEmpPage('+(empCurrentPage+0x1)+')\x22>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d88e6[_0xb16483(0x1c7)]=_0x72a14b;}window['changeEmpPage']=_0x1772cc=>{empCurrentPage=_0x1772cc,updateEmployeeList();},window[_0x58d982(0x2d0)]=(_0xa42455,_0x3a9db1)=>{const _0x27c981=_0x58d982,_0x44b531=allEmployeesData[_0x27c981(0x268)](_0x6c49d0=>_0x6c49d0['id']===_0xa42455);if(!_0x44b531)return;const _0x520ffe=document[_0x27c981(0x23b)](_0x27c981(0x26c));_0x520ffe['className']='bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center',currentConfirmAction=async()=>{const _0x408d7c=_0x27c981;try{const _0xe1816c={'DateLogin':null,'MobileId':'','AwardedGift':'','AwardedGiftId':null,'RandomTime':null,'ReceivedTime':null};if(_0x44b531['AwardedGiftId']){const _0xb45ea7=allGiftsData['find'](_0x1e28a0=>_0x1e28a0['id']===_0x44b531[_0x408d7c(0x269)]);_0xb45ea7&&await updateDoc(doc(db,_0x408d7c(0x30e),_0xb45ea7['id']),{'remainingQty':(_0xb45ea7[_0x408d7c(0x2a2)]||0x0)+0x1});}await updateDoc(doc(db,'crsg',_0xa42455),_0xe1816c),document[_0x408d7c(0x23b)](_0x408d7c(0x241))['classList'][_0x408d7c(0x1e4)]('hidden');}catch(_0x4b473b){console[_0x408d7c(0x1c5)](_0x4b473b);}},document[_0x27c981(0x23b)](_0x27c981(0x2f3))[_0x27c981(0x26a)]=_0x27c981(0x27a),document[_0x27c981(0x23b)](_0x27c981(0x221))[_0x27c981(0x26a)]=_0x27c981(0x267)+_0x3a9db1+_0x27c981(0x1a3),document[_0x27c981(0x23b)](_0x27c981(0x2aa))['classList'][_0x27c981(0x1e4)](_0x27c981(0x2af)),document[_0x27c981(0x23b)]('confirmModal')[_0x27c981(0x2ff)]['remove'](_0x27c981(0x2af));},window[_0x58d982(0x21d)]=_0x54bfdc=>{const _0x1f9e2c=_0x58d982,_0x142fd9=allEmployeesData[_0x1f9e2c(0x2ab)](_0x47ff03=>_0x47ff03['Check_Place']===_0x54bfdc);document[_0x1f9e2c(0x23b)](_0x1f9e2c(0x341))['textContent']=_0x1f9e2c(0x1ae)+_0x54bfdc,document[_0x1f9e2c(0x23b)](_0x1f9e2c(0x1cd))[_0x1f9e2c(0x26a)]=_0x142fd9[_0x1f9e2c(0x2be)],document[_0x1f9e2c(0x23b)]('groupViewStatsRegistered')[_0x1f9e2c(0x26a)]=_0x142fd9['filter'](_0x437cdd=>_0x437cdd['DateLogin'])[_0x1f9e2c(0x2be)],document[_0x1f9e2c(0x23b)](_0x1f9e2c(0x233))[_0x1f9e2c(0x1c7)]=_0x142fd9['map']((_0x17e8e7,_0x1b3ad0)=>{const _0x147c65=_0x1f9e2c;return _0x147c65(0x329)+(_0x17e8e7[_0x147c65(0x309)]?_0x147c65(0x2dc):'')+'\x20hover:bg-gray-50\x20text-center\x20text-sm\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-gray-400\x20text-xs\x22>'+(_0x1b3ad0+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-700\x20text-center\x20text-sm\x22>'+_0x17e8e7[_0x147c65(0x325)]+_0x147c65(0x209)+_0x17e8e7[_0x147c65(0x20d)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>'+(_0x17e8e7[_0x147c65(0x2d8)]||'-')+_0x147c65(0x342)+(_0x17e8e7['Branch_eng']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>'+(_0x17e8e7['Check_Manager']||'-')+_0x147c65(0x312)+(_0x17e8e7['DateLogin']?_0x147c65(0x244):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22editEmp(\x27'+_0x17e8e7['id']+_0x147c65(0x31b);})[_0x1f9e2c(0x24e)]('')||_0x1f9e2c(0x1bd),document[_0x1f9e2c(0x23b)](_0x1f9e2c(0x1c6))[_0x1f9e2c(0x2ff)]['remove']('hidden');},window['editEmp']=_0x1755ce=>{const _0x45ae80=_0x58d982,_0x1bdedc=allEmployeesData[_0x45ae80(0x268)](_0x2be15a=>_0x2be15a['id']===_0x1755ce);if(!_0x1bdedc)return;currentEditingDocId=_0x1755ce,document[_0x45ae80(0x23b)](_0x45ae80(0x1b5))[_0x45ae80(0x26a)]=_0x1bdedc[_0x45ae80(0x325)],document[_0x45ae80(0x23b)](_0x45ae80(0x293))['textContent']=_0x1bdedc[_0x45ae80(0x20d)],document['getElementById']('editEmpNickname')['value']=_0x1bdedc[_0x45ae80(0x2d8)]||'',document[_0x45ae80(0x23b)](_0x45ae80(0x1be))[_0x45ae80(0x250)]=_0x1bdedc['Check_Manager']||'',document['getElementById'](_0x45ae80(0x31e))[_0x45ae80(0x250)]=_0x1bdedc[_0x45ae80(0x31a)]||'',document[_0x45ae80(0x23b)]('editEmployeeModal')[_0x45ae80(0x2ff)][_0x45ae80(0x230)](_0x45ae80(0x2af));};function searchForRegistration(){const _0x5d9bb0=_0x58d982,_0x3c19b6=document['getElementById'](_0x5d9bb0(0x25f))['value'][_0x5d9bb0(0x31f)](),_0x35cd76=document['getElementById'](_0x5d9bb0(0x262));_0x35cd76[_0x5d9bb0(0x26a)]='';if(!_0x3c19b6){_0x35cd76[_0x5d9bb0(0x26a)]=_0x5d9bb0(0x20e);return;}const _0x54ce4f=allEmployeesData['find'](_0x2d3872=>_0x2d3872[_0x5d9bb0(0x325)]===_0x3c19b6);_0x54ce4f?(currentEditingDocId=_0x54ce4f['id'],document[_0x5d9bb0(0x23b)]('regEmpId')[_0x5d9bb0(0x26a)]=_0x54ce4f['employeeId'],document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x324))['textContent']=_0x54ce4f[_0x5d9bb0(0x20d)],document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x307))['textContent']=_0x54ce4f[_0x5d9bb0(0x33c)]||'-',document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x29f))['textContent']=_0x54ce4f[_0x5d9bb0(0x2d6)]||'-',document['getElementById'](_0x5d9bb0(0x2ba))[_0x5d9bb0(0x250)]=_0x54ce4f['NickName']||'',document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x279))[_0x5d9bb0(0x250)]=_0x54ce4f[_0x5d9bb0(0x31a)]||'',document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x1d6))[_0x5d9bb0(0x250)]=_0x54ce4f[_0x5d9bb0(0x28f)]||'',document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x280))['classList'][_0x5d9bb0(0x230)](_0x5d9bb0(0x2af)),document[_0x5d9bb0(0x23b)](_0x5d9bb0(0x191))['textContent']=''):_0x35cd76[_0x5d9bb0(0x26a)]=_0x5d9bb0(0x340);}async function saveManualRegistration(){const _0xc9164e=_0x58d982,_0x477152=document[_0xc9164e(0x23b)]('regEmpNickname')[_0xc9164e(0x250)][_0xc9164e(0x31f)](),_0xef714a=document[_0xc9164e(0x23b)]('regEmpSeat')[_0xc9164e(0x250)][_0xc9164e(0x31f)](),_0x229d22=document[_0xc9164e(0x23b)](_0xc9164e(0x1d6))[_0xc9164e(0x250)],_0x27cceb=document[_0xc9164e(0x23b)](_0xc9164e(0x191));try{await updateDoc(doc(db,_0xc9164e(0x2ed),currentEditingDocId),{'NickName':_0x477152,'Check_Place':_0xef714a,'invite':_0x229d22,'DateLogin':serverTimestamp()}),document[_0xc9164e(0x23b)](_0xc9164e(0x280))[_0xc9164e(0x2ff)][_0xc9164e(0x1e4)](_0xc9164e(0x2af)),document[_0xc9164e(0x23b)](_0xc9164e(0x25f))[_0xc9164e(0x250)]='';}catch(_0x33acae){console['error'](_0x33acae),_0x27cceb[_0xc9164e(0x26a)]=_0xc9164e(0x300);}}function handleEmpSort(_0x7f157f){const _0x359d3b=_0x58d982;empSortField===_0x7f157f?empSortDir=empSortDir===_0x359d3b(0x1ee)?_0x359d3b(0x2c9):_0x359d3b(0x1ee):(empSortField=_0x7f157f,empSortDir=_0x359d3b(0x1ee)),empCurrentPage=0x1,updateEmployeeList();}function setupListeners(){const _0x34d68a=_0x58d982;document['getElementById'](_0x34d68a(0x328))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>{const _0x26bd12=_0x34d68a;updateLuckyDrawStats(),document[_0x26bd12(0x23b)](_0x26bd12(0x21e))[_0x26bd12(0x2ff)]['remove'](_0x26bd12(0x2af));}),document['getElementById'](_0x34d68a(0x291))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>document[_0x34d68a(0x23b)](_0x34d68a(0x21e))[_0x34d68a(0x2ff)][_0x34d68a(0x1e4)](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)](_0x34d68a(0x195))[_0x34d68a(0x336)](_0x34d68a(0x218),runIndividualLuckyDraw),document[_0x34d68a(0x23b)](_0x34d68a(0x1ec))[_0x34d68a(0x336)]('click',startGroupRandomDraw),document[_0x34d68a(0x23b)]('closeGroupViewModalButton')[_0x34d68a(0x336)](_0x34d68a(0x218),()=>document['getElementById'](_0x34d68a(0x1c6))[_0x34d68a(0x2ff)]['add'](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)](_0x34d68a(0x19e))['addEventListener']('click',()=>document[_0x34d68a(0x23b)](_0x34d68a(0x1e7))[_0x34d68a(0x2ff)][_0x34d68a(0x1e4)](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)]('closeEditModalButton')['addEventListener'](_0x34d68a(0x218),()=>document[_0x34d68a(0x23b)](_0x34d68a(0x225))['classList']['add'](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)]('closeConfirmButton')['addEventListener'](_0x34d68a(0x218),()=>document['getElementById'](_0x34d68a(0x241))[_0x34d68a(0x2ff)]['add'](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)](_0x34d68a(0x308))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>openDashboardList(_0x34d68a(0x255))),document[_0x34d68a(0x23b)](_0x34d68a(0x2f7))['addEventListener']('click',()=>openDashboardList(_0x34d68a(0x2d3))),document[_0x34d68a(0x23b)](_0x34d68a(0x2e2))['addEventListener'](_0x34d68a(0x218),()=>openDashboardList(_0x34d68a(0x208))),document[_0x34d68a(0x23b)](_0x34d68a(0x2fe))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>openDashboardList(_0x34d68a(0x2c6))),document[_0x34d68a(0x23b)](_0x34d68a(0x2d5))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>document[_0x34d68a(0x23b)]('dashboardListModal')[_0x34d68a(0x2ff)]['add']('hidden')),document[_0x34d68a(0x23b)](_0x34d68a(0x25b))[_0x34d68a(0x336)]('click',()=>handleEmpSort('id')),document[_0x34d68a(0x23b)](_0x34d68a(0x1f6))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>handleEmpSort(_0x34d68a(0x33b))),document[_0x34d68a(0x23b)]('sort-emp-branch')[_0x34d68a(0x336)](_0x34d68a(0x218),()=>handleEmpSort('branch')),document[_0x34d68a(0x23b)]('sort-emp-manager')['addEventListener'](_0x34d68a(0x218),()=>handleEmpSort(_0x34d68a(0x1c9))),document[_0x34d68a(0x23b)](_0x34d68a(0x2d1))['addEventListener'](_0x34d68a(0x218),()=>handleEmpSort('nickname')),document[_0x34d68a(0x23b)]('sort-emp-gift')[_0x34d68a(0x336)](_0x34d68a(0x218),()=>handleEmpSort(_0x34d68a(0x212))),document[_0x34d68a(0x23b)](_0x34d68a(0x1e6))[_0x34d68a(0x336)]('click',()=>handleEmpSort('status')),document[_0x34d68a(0x23b)](_0x34d68a(0x1dd))['addEventListener'](_0x34d68a(0x218),searchForRegistration),document[_0x34d68a(0x23b)](_0x34d68a(0x2d7))['addEventListener']('click',()=>document[_0x34d68a(0x23b)](_0x34d68a(0x280))[_0x34d68a(0x2ff)][_0x34d68a(0x1e4)](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)](_0x34d68a(0x30c))['addEventListener'](_0x34d68a(0x218),saveManualRegistration),document['getElementById']('confirmActionButton')[_0x34d68a(0x336)](_0x34d68a(0x218),async()=>{if(currentConfirmAction)await currentConfirmAction();}),document[_0x34d68a(0x23b)](_0x34d68a(0x343))['addEventListener'](_0x34d68a(0x218),addGift),document[_0x34d68a(0x23b)](_0x34d68a(0x1cf))[_0x34d68a(0x336)]('click',()=>{const _0x4de89d=_0x34d68a;giftPickerContext='ind',renderGiftPicker(),document[_0x4de89d(0x23b)]('giftPickerModal')['classList']['remove'](_0x4de89d(0x2af));}),document['getElementById'](_0x34d68a(0x1b6))['addEventListener'](_0x34d68a(0x218),()=>{const _0x1d58c4=_0x34d68a;giftPickerContext=_0x1d58c4(0x1a2),renderGiftPicker(),document[_0x1d58c4(0x23b)](_0x1d58c4(0x190))['classList'][_0x1d58c4(0x230)](_0x1d58c4(0x2af));}),document['getElementById'](_0x34d68a(0x2e8))[_0x34d68a(0x336)]('click',()=>document[_0x34d68a(0x23b)](_0x34d68a(0x190))[_0x34d68a(0x2ff)][_0x34d68a(0x1e4)](_0x34d68a(0x2af))),document['getElementById'](_0x34d68a(0x2e4))['addEventListener'](_0x34d68a(0x218),()=>document[_0x34d68a(0x23b)]('editGiftModal')[_0x34d68a(0x2ff)][_0x34d68a(0x1e4)](_0x34d68a(0x2af))),document[_0x34d68a(0x23b)](_0x34d68a(0x227))[_0x34d68a(0x336)](_0x34d68a(0x218),async()=>{const _0x62a297=_0x34d68a,_0x3c48dc=document[_0x62a297(0x23b)](_0x62a297(0x2b4))[_0x62a297(0x250)]['trim'](),_0x25e126=parseInt(document['getElementById']('editGiftTotalQty')['value']),_0x35bbf3=parseInt(document['getElementById']('editGiftRemainingQty')['value']);if(!_0x3c48dc||isNaN(_0x25e126)||isNaN(_0x35bbf3))return;await updateDoc(doc(db,_0x62a297(0x30e),currentEditingGiftId),{'name':_0x3c48dc,'totalQty':_0x25e126,'remainingQty':_0x35bbf3}),document['getElementById']('editGiftModal')[_0x62a297(0x2ff)][_0x62a297(0x1e4)](_0x62a297(0x2af));}),document[_0x34d68a(0x23b)]('saveEditModalButton')[_0x34d68a(0x336)](_0x34d68a(0x218),async()=>{const _0xbccdd9=_0x34d68a;await updateDoc(doc(db,'crsg',currentEditingDocId),{'NickName':document['getElementById']('editEmpNickname')[_0xbccdd9(0x250)],'Check_Manager':document['getElementById']('editEmpManager')[_0xbccdd9(0x250)],'Check_Place':document[_0xbccdd9(0x23b)](_0xbccdd9(0x31e))[_0xbccdd9(0x250)]}),document[_0xbccdd9(0x23b)](_0xbccdd9(0x225))[_0xbccdd9(0x2ff)]['add'](_0xbccdd9(0x2af));}),document['getElementById'](_0x34d68a(0x210))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>{const _0x111d9c=_0x34d68a,_0x4950b1=document[_0x111d9c(0x23b)](_0x111d9c(0x1a9));_0x4950b1[_0x111d9c(0x26a)]='';const _0x49c827=document[_0x111d9c(0x23b)](_0x111d9c(0x2ee))['value'][_0x111d9c(0x31f)]();if(!_0x49c827){_0x4950b1['textContent']=_0x111d9c(0x20e);return;}const _0xbd8095=allEmployeesData[_0x111d9c(0x268)](_0x5d0a60=>_0x5d0a60[_0x111d9c(0x325)]===_0x49c827);_0xbd8095?(editEmp(_0xbd8095['id']),document['getElementById'](_0x111d9c(0x2ee))[_0x111d9c(0x250)]=''):_0x4950b1[_0x111d9c(0x26a)]=_0x111d9c(0x270);}),document[_0x34d68a(0x23b)](_0x34d68a(0x27c))[_0x34d68a(0x336)](_0x34d68a(0x1c1),updateTeamTab),document[_0x34d68a(0x23b)](_0x34d68a(0x19c))['addEventListener'](_0x34d68a(0x1c1),updateGridTab),document[_0x34d68a(0x23b)](_0x34d68a(0x1eb))[_0x34d68a(0x336)](_0x34d68a(0x1c1),()=>{empCurrentPage=0x1,updateEmployeeList();}),document[_0x34d68a(0x23b)](_0x34d68a(0x25c))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>{const _0x36c225=_0x34d68a,_0x5e3f1d=document[_0x36c225(0x23b)](_0x36c225(0x1ed))[_0x36c225(0x250)][_0x36c225(0x31f)]();if(!_0x5e3f1d)return;teamNames=_0x5e3f1d[_0x36c225(0x193)](',')[_0x36c225(0x287)](_0x324bac=>_0x324bac[_0x36c225(0x31f)]())[_0x36c225(0x2ab)](Boolean),refreshUI();}),document[_0x34d68a(0x23b)]('downloadCsvButton')[_0x34d68a(0x336)](_0x34d68a(0x218),()=>{const _0x32a5bc=_0x34d68a;let _0x3e5f2f='\ufeff‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,\x20NickName,\x20‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,\x20‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a';allEmployeesData['filter'](_0x1d038a=>_0x1d038a[_0x32a5bc(0x309)])[_0x32a5bc(0x247)](_0x391ce2=>{const _0xa836cc=_0x32a5bc;_0x3e5f2f+='\x22'+_0x391ce2[_0xa836cc(0x325)]+_0xa836cc(0x315)+_0x391ce2['FullName_th']+_0xa836cc(0x315)+(_0x391ce2[_0xa836cc(0x2d8)]||'')+_0xa836cc(0x315)+(_0x391ce2['Check_Place']||'')+_0xa836cc(0x315)+(_0x391ce2[_0xa836cc(0x33c)]||'')+_0xa836cc(0x315)+(_0x391ce2[_0xa836cc(0x2d6)]||'')+_0xa836cc(0x2fb);});const _0x5553fe=new Blob([_0x3e5f2f],{'type':'text/csv;charset=utf-8;'}),_0x3b088d=document[_0x32a5bc(0x2c0)]('a');_0x3b088d['href']=URL['createObjectURL'](_0x5553fe),_0x3b088d[_0x32a5bc(0x278)]=_0x32a5bc(0x29c),_0x3b088d[_0x32a5bc(0x218)]();}),document['getElementById'](_0x34d68a(0x282))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>{const _0x31def4=_0x34d68a,_0x5403c6=document[_0x31def4(0x23b)]('managerFilterSelect')[_0x31def4(0x250)];let _0x57fe90=allEmployeesData[_0x31def4(0x2ab)](_0x5a2993=>_0x5a2993['Check_Place']&&_0x5a2993[_0x31def4(0x31a)]['trim']()!==''||_0x5a2993[_0x31def4(0x309)]);if(_0x5403c6)_0x57fe90=_0x57fe90[_0x31def4(0x2ab)](_0x555af2=>_0x555af2[_0x31def4(0x2d6)]===_0x5403c6);let _0x217c97=_0x31def4(0x27d);_0x57fe90[_0x31def4(0x247)]((_0x1857b5,_0x17b8d9)=>{const _0x146eff=_0x31def4,_0x336ea8=_0x1857b5[_0x146eff(0x309)]?_0x146eff(0x2da):'-',_0x14f81a=_0x1857b5[_0x146eff(0x2d8)]||'-',_0x115669=_0x1857b5[_0x146eff(0x213)]?_0x146eff(0x207):'-';_0x217c97+='\x22'+(_0x17b8d9+0x1)+_0x146eff(0x315)+_0x1857b5[_0x146eff(0x325)]+_0x146eff(0x315)+_0x1857b5[_0x146eff(0x20d)]+_0x146eff(0x315)+(_0x1857b5[_0x146eff(0x33c)]||'-')+'\x22,\x22'+(_0x1857b5[_0x146eff(0x2d6)]||'-')+'\x22,\x22'+_0x14f81a+'\x22,\x22'+_0x115669+_0x146eff(0x315)+(_0x1857b5[_0x146eff(0x31a)]||'-')+_0x146eff(0x315)+_0x336ea8+'\x22\x0a';});const _0x2c66d1=new Blob([_0x217c97],{'type':'text/csv;charset=utf-8;'}),_0x19d9ec=document[_0x31def4(0x2c0)]('a');_0x19d9ec[_0x31def4(0x24a)]=URL[_0x31def4(0x20c)](_0x2c66d1),_0x19d9ec['download']=_0x31def4(0x1df),_0x19d9ec[_0x31def4(0x218)]();}),document[_0x34d68a(0x23b)](_0x34d68a(0x30a))[_0x34d68a(0x336)](_0x34d68a(0x218),()=>{const _0xb08b1b=_0x34d68a,_0x4e5498=allEmployeesData[_0xb08b1b(0x2ab)](_0x27e8a4=>_0x27e8a4[_0xb08b1b(0x2ea)])[_0xb08b1b(0x2ad)]((_0x25aa1f,_0x1424de)=>(_0x1424de[_0xb08b1b(0x2ea)]?.[_0xb08b1b(0x1a6)]()||0x0)-(_0x25aa1f[_0xb08b1b(0x2ea)]?.[_0xb08b1b(0x1a6)]()||0x0));let _0x4ffccd=_0xb08b1b(0x257);_0x4e5498[_0xb08b1b(0x247)](_0x5e7d75=>{const _0xe8ccaa=_0xb08b1b,_0x18ba51=_0x5e7d75[_0xe8ccaa(0x2ea)]?.['toMillis']()?new Date(_0x5e7d75[_0xe8ccaa(0x2ea)][_0xe8ccaa(0x1a6)]())['toLocaleString']('th-TH'):'-',_0x32e077=_0x5e7d75[_0xe8ccaa(0x1e3)]?_0xe8ccaa(0x224):'‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö';_0x4ffccd+='\x22'+_0x5e7d75[_0xe8ccaa(0x325)]+_0xe8ccaa(0x315)+_0x5e7d75[_0xe8ccaa(0x20d)]+_0xe8ccaa(0x315)+(_0x5e7d75[_0xe8ccaa(0x213)]||'')+_0xe8ccaa(0x315)+(_0x5e7d75['Branch_eng']||'')+_0xe8ccaa(0x315)+(_0x5e7d75[_0xe8ccaa(0x2d6)]||'')+_0xe8ccaa(0x315)+(_0x5e7d75[_0xe8ccaa(0x31a)]||'')+_0xe8ccaa(0x315)+_0x32e077+'\x22,\x22'+_0x18ba51+'\x22\x0a';});const _0x51dcb1=new Blob([_0x4ffccd],{'type':_0xb08b1b(0x31c)}),_0x1fd034=document[_0xb08b1b(0x2c0)]('a');_0x1fd034[_0xb08b1b(0x24a)]=URL[_0xb08b1b(0x20c)](_0x51dcb1),_0x1fd034[_0xb08b1b(0x278)]=_0xb08b1b(0x28c),_0x1fd034[_0xb08b1b(0x218)]();}),document['getElementById'](_0x34d68a(0x1e0))[_0x34d68a(0x336)]('click',()=>{const _0x29bcb2=_0x34d68a,_0x61d2f0=document[_0x29bcb2(0x23b)](_0x29bcb2(0x26c)),_0x525164=document[_0x29bcb2(0x23b)](_0x29bcb2(0x2aa)),_0x120db0=document[_0x29bcb2(0x23b)](_0x29bcb2(0x2db));_0x525164[_0x29bcb2(0x2ff)][_0x29bcb2(0x230)](_0x29bcb2(0x2af)),_0x120db0[_0x29bcb2(0x250)]='',currentConfirmAction=async()=>{const _0x112f96=_0x29bcb2;if(_0x120db0[_0x112f96(0x250)]['trim']()[_0x112f96(0x2b7)]()!==_0x112f96(0x2e1))return;const _0x501310=writeBatch(db);allEmployeesData[_0x112f96(0x247)](_0x3c88fd=>{const _0x20ead4=_0x112f96;_0x501310[_0x20ead4(0x273)](doc(db,_0x20ead4(0x2ed),_0x3c88fd['id']),{'DateLogin':null,'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null,'MobileId':''});}),allGiftsData[_0x112f96(0x247)](_0x4e950f=>{const _0x900f7a=_0x112f96;_0x501310[_0x900f7a(0x273)](doc(db,_0x900f7a(0x30e),_0x4e950f['id']),{'remainingQty':_0x4e950f[_0x900f7a(0x28d)]||0x1});}),await _0x501310[_0x112f96(0x2fc)](),document[_0x112f96(0x23b)](_0x112f96(0x241))[_0x112f96(0x2ff)]['add'](_0x112f96(0x2af));},document[_0x29bcb2(0x23b)](_0x29bcb2(0x2f3))[_0x29bcb2(0x26a)]=_0x29bcb2(0x1a0),document['getElementById'](_0x29bcb2(0x221))['textContent']=_0x29bcb2(0x1d1),document[_0x29bcb2(0x23b)](_0x29bcb2(0x241))[_0x29bcb2(0x2ff)]['remove']('hidden');});}function updateGroupRandomUI(){const _0x5655a9=_0x58d982,_0x5f047a=allEmployeesData['filter'](_0xdd8f0a=>_0xdd8f0a['DateLogin']&&_0xdd8f0a[_0x5655a9(0x28f)]===_0x5655a9(0x28f)),_0x2b6bb3=_0x5f047a[_0x5655a9(0x2ab)](_0x4197fb=>_0x4197fb[_0x5655a9(0x2ea)])[_0x5655a9(0x2ad)]((_0x376957,_0x2c1ad6)=>(_0x2c1ad6[_0x5655a9(0x2ea)]?.[_0x5655a9(0x1a6)]()||0x0)-(_0x376957[_0x5655a9(0x2ea)]?.[_0x5655a9(0x1a6)]()||0x0)),_0x5a39f3=_0x5f047a[_0x5655a9(0x2ab)](_0x5bed37=>!_0x5bed37[_0x5655a9(0x2ea)]);if(document[_0x5655a9(0x23b)]('grTotalEligible'))document[_0x5655a9(0x23b)](_0x5655a9(0x321))[_0x5655a9(0x26a)]=_0x5f047a[_0x5655a9(0x2be)];if(document[_0x5655a9(0x23b)]('grRemainingEligible'))document[_0x5655a9(0x23b)]('grRemainingEligible')[_0x5655a9(0x26a)]=_0x5a39f3[_0x5655a9(0x2be)];if(document[_0x5655a9(0x23b)](_0x5655a9(0x302)))document[_0x5655a9(0x23b)](_0x5655a9(0x302))[_0x5655a9(0x26a)]=_0x2b6bb3['length'];}
    </script>
</body>

</html>