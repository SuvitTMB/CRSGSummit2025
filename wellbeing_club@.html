<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE Retail Club</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff;
            letter-spacing: normal !important;
            font-size: 1.125rem;
        }
        * {
            font-family: 'Sarabun', sans-serif !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            /* ‡∏õ‡∏£‡∏±‡∏ö font dropdown ‡πÅ‡∏•‡∏∞ input ‡∏•‡∏á 1 ‡∏Ç‡∏±‡πâ‡∏ô */
            font-size: 1rem;
        }
        thead.table-header-gray {
             background-color: #e5e7eb;
        }
        table thead th {
            font-weight: bold !important;
            font-size: 1rem !important;
            /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î font-align center */
            text-align: center !important;
        }
        table tbody tr {
            height: 30px !important;
        }
        .winner-row-animate {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        button:disabled {
            background-color: #f3f4f6 !important;
            color: #9ca3af !important;
            cursor: not-allowed !important;
            box-shadow: none !important;
            transform: none !important;
        }
        .loading-gif {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0); }
            100% { transform: rotate(360deg); }
        }
        .sortable-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .sortable-header:hover {
            background-color: #d1d5db;
        }
        .dashboard-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        /* Pagination Styles */
        .pagination-btn {
            padding: 0.25rem 0.75rem;
            border: 1px solid #d1d5db;
            background-color: #fff;
            color: #374151;
            font-size: 0.875rem;
            border-radius: 0.375rem;
            transition: all 0.2s;
        }
        .pagination-btn:hover:not(:disabled) {
            background-color: #f3f4f6;
        }
        .pagination-btn.active {
            background-color: #0056ff;
            color: #fff;
            border-color: #0056ff;
        }
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[95%] max-w-7xl p-0 bg-white rounded-lg">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6 pt-6 px-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold" style="color: #0056ff;">Recog Night White Elegance</h1>
            </div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-400 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="mb-6 border-b border-gray-200 px-8">
            <nav class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Tabs">
                <button id="tab-dashboard" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-700 bg-gray-300 border-blue-600">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°
                </button>
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>
                <button id="tab-gift-management" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
                <button id="tab-register" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    QR Code
                </button>
                <button id="tab-group-random" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-winners-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
            </nav>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="px-8 pb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                <div class="lg:w-2/5">
                     <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center h-full">
                         <p class="text-gray-600 text-base mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                         <div class="relative w-64 h-64">
                             <canvas id="registrationBreakdownChart"></canvas>
                             <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                 <span id="breakdownCenterTotal" class="text-2xl font-bold text-gray-900">0</span>
                                 <span class="text-base text-gray-500 font-bold">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                             </div>
                         </div>
                     </div>
                </div>
                <div class="lg:w-3/5">
                    <div class="flex gap-6 h-full">
                         <div class="w-2/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-base mb-4 font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
                            <div class="relative w-64 h-64">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                    <span class="text-base text-gray-500 font-bold">%‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                </div>
                            </div>
                        </div>
                         <div class="w-1/3 flex flex-col justify-between space-y-2">
                            <div id="card-total" class="dashboard-card h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-blue-700 text-sm font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                                <p id="targetCount" class="text-2xl font-bold text-blue-800 mt-1">0</p>
                            </div>
                            <div id="card-registered" class="dashboard-card h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-green-700 text-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
                                <p id="participantsCountBox" class="text-2xl font-bold text-green-800 mt-1">0</p>
                            </div>
                            <div id="card-unregistered" class="dashboard-card h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-red-700 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</p>
                                <p id="remainingCount" class="text-2xl font-bold text-red-800 mt-1">0</p>
                            </div>
                            <div id="card-extras" class="dashboard-card h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-yellow-700 text-sm">‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="attendeesCount" class="text-2xl font-bold text-yellow-800 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Timeline Row Updated with Side Stats -->
            <div class="mb-8 w-full">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <!-- Chart Area (Left) -->
                        <div class="flex-grow h-72 w-full md:w-3/4">
                            <canvas id="registrationTimelineChart"></canvas>
                        </div>
                        
                        <!-- Summary Stats (Right) -->
                        <div class="w-full md:w-1/4 flex flex-col gap-4">
                            <div class="bg-blue-50 border-l-4 border-blue-600 p-4 rounded-r-lg">
                                <p class="text-blue-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</p>
                                <p id="timelineTotalInvite" class="text-2xl font-black text-blue-900 mt-1">0</p>
                                <p class="text-[10px] text-blue-400 font-bold uppercase tracking-widest">(‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg">
                                <p class="text-orange-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="timelineTotalExtra" class="text-2xl font-black text-orange-900 mt-1">0</p>
                                <p class="text-[10px] text-orange-400 font-bold uppercase tracking-widest">(‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-xl font-semibold text-gray-800 font-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                     <button id="randomizeButton" class="px-6 py-3 text-base font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow active:scale-95 transition-all font-bold">
                         ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (A1 - A24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart1"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (B1 - B24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart2"></canvas></div>
                    </div>
                </div>
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-100 text-sm">
                            <tr><td colspan="6" class="p-6 text-center text-gray-500 font-bold text-sm">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-8 text-center">
                <button id="downloadCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all">
                    üì• Download CSV Report
                </button>
            </div>
        </div>

        <!-- Team List Content -->
        <div id="team-list-content" class="hidden pb-8 px-0">
            <div class="bg-white overflow-hidden">
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center bg-gray-50">
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm">
                        <p class="text-base text-blue-700 font-bold">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm font-bold">
                        <p class="text-base text-green-700">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ó‡∏µ‡∏°</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border shadow-sm font-bold flex flex-col"> 
                        <p class="text-sm text-gray-400 font-bold mb-1 uppercase tracking-tight">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</p>
                        <textarea id="definedTeamNamesInput" class="!text-xs h-16 resize-none bg-blue-50 border-blue-100 font-mono" placeholder="A,B,C..."></textarea>
                        <button id="updateTeamNamesBtn" class="mt-1 text-[10px] bg-blue-600 text-white py-1 rounded uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</button>
                    </div>
                </div>
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-8 py-3 text-base font-bold text-white bg-red-600 rounded-md hover:bg-red-700 shadow transition-all">Reset System Data</button>
                </div>
                 <div class="p-6">
                     <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                         <div>
                             <h3 class="text-xl font-bold border-l-4 border-blue-600 pl-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h3>
                             <div id="teamStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                                 <span class="px-3 py-1 rounded-md bg-gray-100 text-gray-700 text-sm font-bold border">Total: <span id="teamStatsTotal">0</span></span>
                                 <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">Reg: <span id="teamStatsRegistered">0</span></span>
                             </div>
                         </div>
                         <div class="flex items-center">
                             <label for="teamSelect" class="text-base font-bold text-gray-600 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                                 <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏° --</option>
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-xl shadow-sm">
                        <table class="min-w-full text-lg">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-4 text-center font-bold">#</th>
                                    <th class="px-4 py-4 text-left font-bold">Employee ID</th>
                                    <th class="px-4 py-4 text-left font-bold">Full Name</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                    <th class="px-4 py-4 text-left font-bold">Status</th>
                                    <th class="px-4 py-4 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- Group View Content -->
        <div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                <!-- Search Boxes Container -->
                <div class="flex flex-col md:flex-row gap-6 mb-6">
                    <!-- Box 1: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-gray-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchEmployeeIdInput" class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 5-6 ‡∏´‡∏•‡∏±‡∏Å">
                            </div>
                            <button id="searchEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow transition-all active:scale-95">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        <p id="searchEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>

                    <!-- Box 2: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-green-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-green-800 mb-3 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchRegEmployeeIdInput" class="block text-sm font-bold text-green-600 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchRegEmployeeIdInput" class="mt-1 block w-full rounded-md border-green-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">
                            </div>
                            <button id="searchRegEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95 uppercase">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                        </div>
                        <p id="searchRegEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>
                </div>

                <div class="px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (Grid)</h2>
                        <div id="gvOverallStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                             <span class="px-3 py-1 rounded-md bg-gray-100 text-sm font-bold border">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="gvOverallStatsTotal">0</span></span>
                             <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß: <span id="gvOverallStatsRegistered">0</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="groupViewManagerFilter" class="text-base font-bold text-gray-600 mr-2">Manager:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                    </div>
                </div>

                <!-- New Layout: Recog Night Header + Seat Grid -->
                <div class="w-full flex justify-center mb-6 px-6">
                    <div class="w-[60%] bg-[#0056ff] text-white text-center py-3 rounded-xl font-bold shadow-md">
                        ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á Recog Night White Elegance
                    </div>
                </div>

                <div class="px-6 flex w-full items-stretch gap-0">
                    <!-- ‡πÇ‡∏ã‡∏ô A (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridA" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á (4%) -->
                    <div class="w-[4%] flex justify-center py-2">
                        <!-- Border 2% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á 4% ‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
                        <div class="w-1 bg-gray-200 rounded-full h-full opacity-50" id="gridDivider"></div>
                    </div>

                    <!-- ‡πÇ‡∏ã‡∏ô B (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridB" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                </div>
                
                <div class="p-10"></div> <!-- Spacer -->
             </div>
        </div>
        
        <!-- Employee List Content -->
        <div id="employee-list-content" class="hidden pb-8 px-0">
             <div class="bg-white overflow-hidden">
                <div class="px-8 py-6 border-b flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <div id="empStatsContainer" class="hidden flex flex-wrap gap-2 mt-3">
                            <span class="px-4 py-1.5 rounded-xl bg-gray-100 text-gray-700 text-sm font-black border shadow-sm">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="empStatsTotal">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-green-50 text-green-700 text-sm font-black border border-green-200 shadow-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="empStatsRegistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á: <span id="empStatsUnregistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-sm font-black border border-blue-200 shadow-sm">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô: <span id="empStatsPercent">0%</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="managerFilterSelect" class="text-base font-bold text-gray-600 mr-2">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</label>
                         <select id="managerFilterSelect" class="rounded-xl border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                     </div>
                </div>
                <div class="overflow-x-auto p-8">
                    <table class="min-w-full text-sm shadow-sm border rounded-2xl overflow-hidden">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold">#</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-id">‡∏£‡∏´‡∏±‡∏™ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-branch">‡∏™‡∏≤‡∏Ç‡∏≤ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-manager">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-member">Member ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-gift">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                    </table>
                </div>

                <!-- Pagination Container -->
                <div id="empPaginationContainer" class="flex justify-center items-center gap-2 py-6 border-t border-gray-100"></div>

                <!-- ‡∏õ‡∏∏‡πà‡∏° Download CSV ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                <div class="pb-8 text-center">
                    <button id="downloadEmployeeCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all uppercase">
                        üì• Download Employee CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Gift Management Content -->
        <div id="gift-management-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-blue-600 pl-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
                <div class="bg-gray-50 p-6 rounded-2xl border mb-8 max-w-[1000px] shadow-inner">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-grow" style="max-width: 600px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
                            <input type="text" id="giftNameInput" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                        </div>
                        <div style="width: 90px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="giftQtyInput" class="!text-sm text-center" value="1" min="1">
                        </div>
                        <div class="flex items-end">
                            <button id="addGiftBtn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all active:scale-95 shadow-lg !text-xs">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto border rounded-xl shadow-sm">
                    <table class="min-w-full text-base">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold w-24">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="giftListTableBody" class="divide-y divide-gray-100 bg-white">
                            <tr><td colspan="6" class="p-6 text-center text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Winners List Content -->
        <div id="winners-list-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-green-600 pl-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                <div id="winnersByGiftContainer" class="space-y-12">
                    <div class="p-10 text-center text-gray-400 font-bold italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
                <div class="mt-12 text-center">
                    <button id="downloadWinnersCsvButton" class="px-8 py-3 text-base font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95">
                        üì• Download Winners CSV Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Register Content -->
        <div id="register-content" class="hidden pb-8 px-6 text-center">
             <div class="bg-white p-12 rounded-[3rem] shadow-xl border border-gray-100 flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-800 mb-10 font-black">QR Code</h2>
                <div class="p-6 bg-white border-8 border-blue-600 rounded-[3rem] shadow-2xl mb-4 hover:scale-105 transition-all">
                    <img src="./images/QRcode-CRSG.png" alt="QR Code" class="w-80 h-80" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=REGISTER'">
                </div>
             </div>
        </div>

        <!-- Group Random Content -->
        <div id="group-random-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                
                <div class="flex flex-col md:flex-row gap-4 mb-6 items-stretch">
                    <div class="md:w-[30%] grid grid-cols-1 gap-2">
                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 shadow-sm text-center">
                            <p class="text-sm text-blue-700 uppercase font-black">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p id="grTotalEligible" class="text-xl font-black text-blue-900">0</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 shadow-sm text-center">
                            <p class="text-sm text-orange-700 uppercase font-black">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°</p>
                            <p id="grRemainingEligible" class="text-xl font-black text-orange-900">0</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100 shadow-sm text-center">
                            <p class="text-sm text-green-700 uppercase font-black">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="grTotalWinners" class="text-xl font-black text-green-900">0</p>
                        </div>
                    </div>

                    <div class="md:w-[70%] flex flex-col gap-3">
                        <div class="bg-gray-50 px-4 py-3 rounded-xl border shadow-sm w-full">
                            <label class="block text-sm font-bold text-gray-400 mb-1 uppercase tracking-wider text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
                            <div id="grGiftBox" class="flex items-center justify-between bg-white border-2 border-dashed border-gray-200 rounded-xl p-3 transition-all">
                                <div class="flex flex-col text-left">
                                    <p id="grGiftDisplayName" class="text-base font-black text-gray-400 leading-tight uppercase">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                                    <p id="grGiftDisplayQty" class="text-sm font-bold text-gray-300 mt-1">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                                </div>
                                <button id="openGroupGiftPickerBtn" class="px-4 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-xs font-black border border-blue-200 shadow-sm shrink-0 active:scale-95 transition-all">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                            </div>
                        </div>

                        <div class="flex items-stretch gap-3 w-full flex-grow min-h-[90px]">
                            <div class="w-[30%] bg-gray-50 p-3 rounded-xl border shadow-sm flex flex-col justify-center items-center text-center">
                                <label class="text-sm font-bold text-gray-500 uppercase mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</label>
                                <input type="number" id="grDrawCount" value="0" min="0" class="w-full text-center text-3xl font-black text-blue-600 bg-white border border-blue-100 rounded-lg focus:border-blue-500 focus:ring-0 py-1 shadow-inner">
                            </div>
                            <div class="w-[70%]">
                                <button id="grStartDrawBtn" class="w-full h-full text-xl font-black text-white bg-[#0056ff] rounded-xl hover:bg-blue-700 shadow-lg transition-all active:scale-95 disabled:bg-gray-400 uppercase tracking-widest flex items-center justify-center">
                                    üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border-t border-gray-100 pt-4">
                    <div class="p-4 border-r border-gray-100">
                        <h4 class="text-xl font-black text-blue-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</h4>
                        <div id="grBoxLeft" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                    <div class="p-4">
                        <h4 class="text-xl font-black text-indigo-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h4>
                        <div id="grBoxRight" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- LIGHTBOX: Manual Registration -->
    <div id="manualRegisterModal" class="hidden fixed inset-0 z-[140] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-lg border-t-8 border-green-600">
            <h3 class="text-xl font-bold mb-6 uppercase border-b pb-3 text-gray-800 text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            <div id="regEmpDetail" class="space-y-4 mb-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="regEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="regEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏™‡∏≤‡∏Ç‡∏≤ ‡πÅ‡∏•‡∏∞ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏≤‡∏Ç‡∏≤ (Branch)</label><p id="regEmpBranch" class="text-sm font-bold text-gray-700"></p></div>
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Manager)</label><p id="regEmpManager" class="text-sm font-bold text-gray-700"></p></div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                        <input type="text" id="regEmpSeat" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, A2">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="regEmpInviteStatus" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base">
                            <option value="">-- ‡∏ß‡πà‡∏≤‡∏á --</option>
                            <option value="invite">invite</option>
                        </select>
                    </div>
                </div>
                <p id="regManualError" class="text-red-600 text-sm font-black italic h-4"></p>
            </div>
            <div class="flex justify-end gap-3 font-bold">
                <button id="closeManualRegModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveManualRegButton" class="px-8 py-2 bg-green-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-green-700 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Group Detail -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="groupViewModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
                     <div id="groupViewStatsContainer" class="flex flex-wrap gap-2 mt-2">
                         <span class="px-3 py-1 rounded-full bg-gray-100 text-sm font-bold border uppercase">Total: <span id="groupViewStatsTotal">0</span></span>
                         <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-sm font-bold border border-green-200 uppercase">Reg: <span id="groupViewStatsRegistered">0</span></span>
                     </div>
                 </div>
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">ID</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Dashboard List Detail -->
    <div id="dashboardListModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="dashboardListModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                     <p class="text-sm text-gray-400 font-bold mt-1 uppercase tracking-tight">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="dashboardListCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                 </div>
                 <button id="closeDashboardListModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
                            <th class="px-4 py-4 text-center font-bold">‡∏£‡∏´‡∏±‡∏™</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-center font-bold">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                            <th class="px-4 py-4 text-center font-bold" id="dashListRegHeader">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                            <th class="px-4 py-4 text-center font-bold">Admin</th>
                        </tr>
                    </thead>
                    <tbody id="dashboardListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- MODAL: Lucky Draw Individual -->
    <div id="randomizeModal" class="hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 w-[75%] h-[80vh] flex flex-col mx-4 border-t-8 border-blue-600 relative">
            <button id="closeRandomizeModalButtonX" class="absolute top-2 right-4 text-gray-400 hover:text-gray-600 text-5xl font-light transition-all z-10">&times;</button>
            <h3 class="text-xl font-bold text-center text-gray-900 mb-6 uppercase">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
            <div class="max-w-lg mx-auto mb-8 w-full">
                <label class="block text-sm font-bold text-gray-400 mb-2 text-center">‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏∏‡πà‡∏°</label>
                <div id="indGiftBox" class="flex items-center justify-between bg-blue-50 border-2 border-dashed border-blue-200 rounded-2xl p-3 transition-colors">
                    <div class="flex flex-col text-left">
                        <p id="indGiftDisplayName" class="text-lg font-black text-blue-400 leading-tight">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                        <p id="indGiftDisplayQty" class="text-sm text-black-400 mt-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    </div>
                    <button id="openGiftPickerBtn" class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-blue-700 uppercase">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p><p id="modalParticipantsCount" class="text-2xl font-bold">0</p></div>
                <div class="bg-green-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-green-700 uppercase">‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß</p><p id="modalDrawnCount" class="text-2xl font-bold">0</p></div>
            </div>
            <div class="flex justify-center space-x-2 mb-6 shrink-0">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
            </div>
            <div class="mb-6 flex flex-col items-center shrink-0">
                <button id="startRandomizeButton" class="w-[40%] px-6 py-4 text-base text-white bg-blue-600 rounded-lg font-bold hover:bg-blue-700 shadow-xl active:scale-95 disabled:bg-gray-400 uppercase" disabled>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</button>
                <p id="randomizeError" class="text-red-600 text-base mt-3 font-bold uppercase"></p>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-xl bg-gray-50 font-bold">
                <table class="min-w-full text-base">
                    <thead class="bg-gray-200 sticky top-0 uppercase text-gray-700">
                        <tr><th class="px-4 py-4 text-left">‡∏£‡∏´‡∏±‡∏™</th><th class="px-4 py-4 text-left">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</th><th class="px-4 py-4 text-left">‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th><th class="px-4 py-4 text-center">Action</th></tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL: Gift Picker -->
    <div id="giftPickerModal" class="hidden fixed inset-0 z-[100] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-[70%] modal-enter flex flex-col border-t-8 border-orange-500">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="giftPickerTitle" class="text-xl font-black text-gray-800 uppercase">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
                <button id="closeGiftPickerBtn" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto max-h-[60vh] space-y-2" id="giftPickerList"></div>
        </div>
    </div>

    <!-- POPUP WINNER Detail -->
    <div id="winnerDetailModal" class="hidden fixed inset-0 z-[200] bg-gray-900 bg-opacity-95 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-xl w-full text-center border-t-8 border-blue-600 transform scale-110">
            <h3 class="text-xl font-black text-blue-600 mb-4 uppercase">üéä WINNER üéä</h3>
            <div class="text-6xl mb-6">üèÜ</div>
            <p id="winnerName" class="text-2xl font-black text-gray-900 my-4 leading-tight uppercase"></p>
            <p id="winnerGiftText" class="text-xl font-bold text-orange-600 mb-6"></p>
            <div class="bg-blue-50 p-6 rounded-[2rem] mb-10 border border-blue-100 shadow-inner text-center">
                <p id="winnerEmployeeId" class="text-xl font-black text-blue-800 font-mono"></p>
                <p id="winnerBU" class="text-lg font-bold text-gray-600 mt-2 uppercase"></p>
                <p id="winnerTeam" class="text-base font-medium text-gray-400 mt-2 uppercase"></p>
            </div>
            <div class="flex flex-col gap-4">
                <button id="cancelWinnerButton" class="text-base font-bold text-red-400 hover:text-red-600 hover:underline transition-all uppercase">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Cancel)</button>
                <button id="closeWinnerModalButton" class="px-12 py-3 text-base font-black bg-blue-600 text-white rounded-[1.5rem] hover:bg-blue-700 shadow-2xl active:scale-95 transition-all">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Profile -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-[120] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="editEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="editEmpName" class="font-black text-gray-900 text-lg"></p></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Manager / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="editEmpManager" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Team / ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label><input type="text" id="editEmpTeam" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <p id="editError" class="text-red-600 text-sm font-black italic mt-2"></p>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditModalButton" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Gift -->
    <div id="editGiftModal" class="hidden fixed inset-0 z-[150] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
            <div class="space-y-6">
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label><input type="text" id="editGiftName" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ 50 ‡∏ô‡∏¥‡πâ‡∏ß"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                        <input type="number" id="editGiftTotalQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="1">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                        <input type="number" id="editGiftRemainingQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="0">
                    </div>
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditGiftModalBtn" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditGiftBtn" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmation Center -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[300] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div id="confirmModalInner" class="bg-white rounded-2xl p-10 max-w-lg w-full shadow-2xl text-center transition-all duration-300">
            <h3 id="confirmTitle" class="text-xl font-black mb-4 uppercase text-red-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?</h3>
            <p id="confirmText" class="text-gray-600 font-bold mb-6 leading-relaxed italic text-base"></p>
            
            <div id="confirmInputContainer" class="hidden mb-10">
                <p class="text-sm text-gray-500 mb-2">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <span class="font-bold text-red-600 uppercase">Reset</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <input type="text" id="confirmInput" class="text-center border-2 border-red-200 rounded-lg p-2 w-full focus:border-red-500 outline-none text-sm font-bold uppercase" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            </div>

            <div class="flex justify-center gap-4">
                <button id="closeConfirmButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm font-bold hover:bg-gray-200 uppercase">‡πÑ‡∏°‡πà</button>
                <button id="confirmActionButton" class="px-8 py-2 bg-red-600 text-white rounded-xl text-sm font-black shadow-lg hover:bg-red-700 uppercase">‡πÉ‡∏ä‡πà</button>
            </div>
        </div>
    </div>

    <!-- Script Section -->
    <script type="module">
const _0x2e49bf=_0xdf8a;(function(_0xa351a6,_0x4d4c2d){const _0x51b6a1=_0xdf8a,_0x18991b=_0xa351a6();while(!![]){try{const _0x1e10dd=-parseInt(_0x51b6a1(0x253))/0x1*(parseInt(_0x51b6a1(0x2b2))/0x2)+parseInt(_0x51b6a1(0x2a1))/0x3*(-parseInt(_0x51b6a1(0x19e))/0x4)+parseInt(_0x51b6a1(0x1ca))/0x5*(parseInt(_0x51b6a1(0x1a9))/0x6)+-parseInt(_0x51b6a1(0x1e4))/0x7+-parseInt(_0x51b6a1(0x133))/0x8*(parseInt(_0x51b6a1(0x187))/0x9)+parseInt(_0x51b6a1(0x232))/0xa+parseInt(_0x51b6a1(0x206))/0xb;if(_0x1e10dd===_0x4d4c2d)break;else _0x18991b['push'](_0x18991b['shift']());}catch(_0x54a0c9){_0x18991b['push'](_0x18991b['shift']());}}}(_0x54a8,0x9d776));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,collection,onSnapshot,doc,updateDoc,setDoc,addDoc,deleteDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x2e49bf(0x273),'authDomain':_0x2e49bf(0x1bf),'projectId':_0x2e49bf(0x26d),'storageBucket':_0x2e49bf(0x19f),'messagingSenderId':'1070273157855','appId':_0x2e49bf(0x163)};let db,auth,allEmployeesData=[],allGiftsData=[],selectedIndGiftId=null,selectedGroupGiftId=null,giftPickerContext=_0x2e49bf(0x275),teamNames=['A1','A2','A3','A4','A5','A6','A7','A8','A9','A10',_0x2e49bf(0x284),'A12',_0x2e49bf(0x269),_0x2e49bf(0x239),'A15','A16',_0x2e49bf(0x1e0),_0x2e49bf(0x296),_0x2e49bf(0x1e9),_0x2e49bf(0x18b),_0x2e49bf(0x1a2),'A22',_0x2e49bf(0x2a9),_0x2e49bf(0x194),'B1','B2','B3','B4','B5','B6','B7','B8','B9',_0x2e49bf(0x180),_0x2e49bf(0x242),_0x2e49bf(0x2b4),_0x2e49bf(0x2ac),_0x2e49bf(0x12a),_0x2e49bf(0x18d),_0x2e49bf(0x23f),'B17','B18',_0x2e49bf(0x22b),_0x2e49bf(0x1b6),'B21',_0x2e49bf(0x26c),_0x2e49bf(0x235),_0x2e49bf(0x272)],charts={},currentConfirmAction=null,currentEditingDocId=null,currentEditingGiftId=null,drawInterval=null,empSortField=_0x2e49bf(0x24a),empSortDir=_0x2e49bf(0x171),empCurrentPage=0x1;function _0xdf8a(_0x31a58d,_0x4289c1){_0x31a58d=_0x31a58d-0x126;const _0x54a8fa=_0x54a8();let _0xdf8aa8=_0x54a8fa[_0x31a58d];return _0xdf8aa8;}const empPageSize=0x64;((async()=>{const _0x3c0aed=_0x2e49bf;try{const _0x4299d4=initializeApp(firebaseConfig);db=getFirestore(_0x4299d4),auth=getAuth(_0x4299d4),await signInAnonymously(auth),initCharts(),setupTabs(),setupListeners(),startListening(),startListeningGifts(),document['getElementById']('definedTeamNamesInput')['value']=teamNames['join'](','),setInterval(()=>{const _0x351875=_0xdf8a,_0x27f1be=new Date();document[_0x351875(0x233)](_0x351875(0x1a4))[_0x351875(0x1e7)]=_0x27f1be[_0x351875(0x15b)](_0x351875(0x1ad),{'year':_0x351875(0x28b),'month':_0x351875(0x278),'day':_0x351875(0x28b),'hour':_0x351875(0x2da),'minute':_0x351875(0x2da),'second':'2-digit'});},0x3e8);}catch(_0x8ed653){console[_0x3c0aed(0x12e)](_0x8ed653);}})());function setupTabs(){const _0x3ebadf=_0x2e49bf,_0x371233={'tab-dashboard':_0x3ebadf(0x27f),'tab-team-list':_0x3ebadf(0x250),'tab-group-view':_0x3ebadf(0x2a2),'tab-employee-list':'employee-list-content','tab-gift-management':_0x3ebadf(0x1fd),'tab-register':_0x3ebadf(0x255),'tab-group-random':_0x3ebadf(0x1d6),'tab-winners-list':_0x3ebadf(0x195)};Object[_0x3ebadf(0x1b0)](_0x371233)[_0x3ebadf(0x143)](_0x1bb827=>{const _0x496355=_0x3ebadf,_0x3f7af4=document[_0x496355(0x233)](_0x1bb827);if(!_0x3f7af4)return;_0x3f7af4[_0x496355(0x144)](_0x496355(0x282),function(){const _0x1126e9=_0x496355;Object[_0x1126e9(0x1b0)](_0x371233)['forEach'](_0x1b3402=>{const _0x205c78=_0x1126e9,_0x571d51=document['getElementById'](_0x1b3402),_0x2a8a03=document[_0x205c78(0x233)](_0x371233[_0x1b3402]);if(_0x571d51)_0x571d51[_0x205c78(0x161)][_0x205c78(0x1d1)](_0x205c78(0x197),'bg-gray-100');if(_0x2a8a03)_0x2a8a03[_0x205c78(0x161)][_0x205c78(0x24f)](_0x205c78(0x25e));}),this[_0x1126e9(0x161)][_0x1126e9(0x1d1)](_0x1126e9(0x1f0),'bg-gray-300'),document[_0x1126e9(0x233)](_0x371233[_0x1bb827])?.[_0x1126e9(0x161)][_0x1126e9(0x27d)](_0x1126e9(0x25e)),window[_0x1126e9(0x26b)](new Event(_0x1126e9(0x2bb)));});});}function initCharts(){const _0xeb5399=_0x2e49bf,_0x55dd2a={'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]},'datalabels':{'color':_0xeb5399(0x2aa),'font':{'weight':_0xeb5399(0x176),'size':0xc},'formatter':_0x4ccf53=>_0x4ccf53>0x0?_0x4ccf53:''}}};charts['breakdown']=new Chart(document['getElementById'](_0xeb5399(0x2c1)),{'type':_0xeb5399(0x1d2),'data':{'labels':[_0xeb5399(0x2d9),'Non-Invite'],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0xeb5399(0x1de),'#F59E0B']}]},'options':{..._0x55dd2a,'cutout':_0xeb5399(0x29c)},'plugins':[ChartDataLabels]}),charts['goal']=new Chart(document[_0xeb5399(0x233)](_0xeb5399(0x22a)),{'type':'doughnut','data':{'labels':['Registered',_0xeb5399(0x268)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0xeb5399(0x20c),'#E5E7EB']}]},'options':{..._0x55dd2a,'cutout':_0xeb5399(0x29c)},'plugins':[ChartDataLabels]});const _0x264cf8={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'stacked':!![]},'y':{'stacked':!![]}},'plugins':{'legend':{'display':!![],'position':_0xeb5399(0x1f6),'labels':{'font':{'size':0xc}}},'datalabels':{'color':_0xeb5399(0x2aa)}}};charts[_0xeb5399(0x13d)]=new Chart(document[_0xeb5399(0x233)](_0xeb5399(0x1a8)),{'type':_0xeb5399(0x21e),'data':{'labels':[],'datasets':[{'label':_0xeb5399(0x1d4),'data':[],'backgroundColor':_0xeb5399(0x1de)},{'label':_0xeb5399(0x201),'data':[],'backgroundColor':_0xeb5399(0x28e)}]},'options':_0x264cf8,'plugins':[ChartDataLabels]}),charts['bar2']=new Chart(document[_0xeb5399(0x233)](_0xeb5399(0x291)),{'type':_0xeb5399(0x21e),'data':{'labels':[],'datasets':[{'label':_0xeb5399(0x1d4),'data':[],'backgroundColor':'#3B82F6'},{'label':_0xeb5399(0x201),'data':[],'backgroundColor':_0xeb5399(0x28e)}]},'options':_0x264cf8,'plugins':[ChartDataLabels]}),charts['timeline']=new Chart(document[_0xeb5399(0x233)](_0xeb5399(0x277)),{'type':_0xeb5399(0x1b3),'data':{'labels':Array[_0xeb5399(0x154)]({'length':0x18},(_0x2ab43d,_0x1de70d)=>_0x1de70d[_0xeb5399(0x2ad)]()[_0xeb5399(0x2d6)](0x2,'0')+_0xeb5399(0x202)),'datasets':[{'label':_0xeb5399(0x174),'data':Array(0x18)[_0xeb5399(0x1cc)](0x0),'borderColor':_0xeb5399(0x1de),'backgroundColor':_0xeb5399(0x1de),'tension':0.1},{'label':'‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô','data':Array(0x18)[_0xeb5399(0x1cc)](0x0),'borderColor':'#F59E0B','backgroundColor':_0xeb5399(0x142),'tension':0.1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':!![],'position':_0xeb5399(0x2a0)},'datalabels':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function startListening(){const _0x5024b1=_0x2e49bf;onSnapshot(collection(db,_0x5024b1(0x1ee)),_0x38b823=>{const _0x3676ec=_0x5024b1;allEmployeesData=_0x38b823[_0x3676ec(0x138)][_0x3676ec(0x2e1)](_0x43f21e=>({'id':_0x43f21e['id'],..._0x43f21e[_0x3676ec(0x2cd)]()})),refreshUI();},_0x30dd98=>console['error'](_0x30dd98));}function startListeningGifts(){const _0x1ddb99=_0x2e49bf;onSnapshot(collection(db,_0x1ddb99(0x2ce)),_0x229408=>{const _0xb9fcb2=_0x1ddb99,_0x3ce995=_0x229408[_0xb9fcb2(0x138)][_0xb9fcb2(0x2e1)](_0x1030e8=>({'id':_0x1030e8['id'],..._0x1030e8[_0xb9fcb2(0x2cd)]()}));allGiftsData=_0x3ce995[_0xb9fcb2(0x131)]((_0x4438b4,_0x4d2959)=>(_0x4438b4[_0xb9fcb2(0x28a)]||0x0)-(_0x4d2959[_0xb9fcb2(0x28a)]||0x0)),renderGiftTable(),refreshIndGiftState(),refreshGroupGiftState(),updateWinnersList();},_0x2d7d47=>console[_0x1ddb99(0x12e)](_0x2d7d47));}function refreshUI(){const _0x14e688=_0x2e49bf,_0x4c00ac=allEmployeesData[_0x14e688(0x1e6)](_0x1c865d=>_0x1c865d[_0x14e688(0x2db)]),_0x1b886a=allEmployeesData[_0x14e688(0x1e6)](_0x17a9ad=>_0x17a9ad[_0x14e688(0x2db)]&&_0x17a9ad[_0x14e688(0x213)]===_0x14e688(0x213)),_0x2e115e=allEmployeesData[_0x14e688(0x1e6)](_0x2ed4fd=>_0x2ed4fd[_0x14e688(0x2db)]&&_0x2ed4fd[_0x14e688(0x213)]!=='invite'),_0xe3b1de=allEmployeesData[_0x14e688(0x1e6)](_0x267f62=>_0x267f62[_0x14e688(0x213)]===_0x14e688(0x213));document['getElementById']('managerEmployeeCount')[_0x14e688(0x1e7)]=allEmployeesData[_0x14e688(0x1e6)](_0x5a8530=>_0x5a8530[_0x14e688(0x234)])['length'],document[_0x14e688(0x233)]('teamMemberCountElem')[_0x14e688(0x1e7)]=allEmployeesData[_0x14e688(0x1e6)](_0x7112d5=>_0x7112d5[_0x14e688(0x23a)])[_0x14e688(0x13b)];const _0x23ea99=allEmployeesData[_0x14e688(0x1e6)](_0x88b8dd=>_0x88b8dd[_0x14e688(0x23a)]&&_0x88b8dd[_0x14e688(0x23a)][_0x14e688(0x1ec)]()!==''),_0x38d043=_0x23ea99[_0x14e688(0x13b)],_0x1ab29f=_0x23ea99['filter'](_0x3fe27b=>_0x3fe27b[_0x14e688(0x2db)])[_0x14e688(0x13b)],_0x4be3e9=_0x38d043-_0x1ab29f,_0x7b4ea7=_0x38d043>0x0?Math[_0x14e688(0x1b4)](_0x1ab29f/_0x38d043*0x64):0x0;document[_0x14e688(0x233)]('empStatsContainer')&&(document[_0x14e688(0x233)](_0x14e688(0x297))[_0x14e688(0x1e7)]=_0x38d043,document['getElementById'](_0x14e688(0x17f))[_0x14e688(0x1e7)]=_0x1ab29f,document[_0x14e688(0x233)](_0x14e688(0x1a7))[_0x14e688(0x1e7)]=_0x4be3e9,document[_0x14e688(0x233)](_0x14e688(0x13a))[_0x14e688(0x1e7)]=_0x7b4ea7+'%',document['getElementById'](_0x14e688(0x1cd))[_0x14e688(0x161)]['remove'](_0x14e688(0x25e)));document[_0x14e688(0x233)](_0x14e688(0x212))[_0x14e688(0x1e7)]=_0xe3b1de['length'],document[_0x14e688(0x233)]('participantsCountBox')[_0x14e688(0x1e7)]=_0x1b886a[_0x14e688(0x13b)],document['getElementById']('attendeesCount')[_0x14e688(0x1e7)]=_0x2e115e[_0x14e688(0x13b)],document['getElementById'](_0x14e688(0x140))[_0x14e688(0x1e7)]=Math[_0x14e688(0x293)](0x0,_0xe3b1de['length']-_0x1b886a['length']),document['getElementById'](_0x14e688(0x266))['textContent']=_0x4c00ac[_0x14e688(0x13b)],document['getElementById'](_0x14e688(0x16b))[_0x14e688(0x1e7)]=_0xe3b1de[_0x14e688(0x13b)]?Math['round'](_0x1b886a[_0x14e688(0x13b)]/_0xe3b1de[_0x14e688(0x13b)]*0x64)+'%':'0%';charts[_0x14e688(0x16a)]&&(charts[_0x14e688(0x16a)][_0x14e688(0x2cd)][_0x14e688(0x2c4)][0x0][_0x14e688(0x2cd)]=[_0x1b886a['length'],_0x2e115e[_0x14e688(0x13b)]],charts[_0x14e688(0x16a)][_0x14e688(0x128)]());charts[_0x14e688(0x286)]&&(charts[_0x14e688(0x286)][_0x14e688(0x2cd)]['datasets'][0x0]['data']=[_0x1b886a['length'],Math[_0x14e688(0x293)](0x0,_0xe3b1de[_0x14e688(0x13b)]-_0x1b886a['length'])],charts['goal'][_0x14e688(0x128)]());if(charts[_0x14e688(0x181)]){const _0x361a02=Array(0x18)[_0x14e688(0x1cc)](0x0),_0x324790=Array(0x18)[_0x14e688(0x1cc)](0x0);let _0x50b33c=0x0,_0x4afb5f=0x0;_0x4c00ac[_0x14e688(0x143)](_0x622bb0=>{const _0x3a7ae4=_0x14e688;if(_0x622bb0[_0x3a7ae4(0x2db)]){const _0x38e9b7=new Date(_0x622bb0['DateLogin'][_0x3a7ae4(0x248)]()),_0x5d3f4f=_0x38e9b7[_0x3a7ae4(0x1e2)]();_0x622bb0[_0x3a7ae4(0x213)]==='invite'?(_0x361a02[_0x5d3f4f]++,_0x50b33c++):(_0x324790[_0x5d3f4f]++,_0x4afb5f++);}}),charts[_0x14e688(0x181)][_0x14e688(0x2cd)]['datasets'][0x0][_0x14e688(0x2cd)]=_0x361a02,charts[_0x14e688(0x181)][_0x14e688(0x2cd)][_0x14e688(0x2c4)][0x1]['data']=_0x324790,charts[_0x14e688(0x181)]['update'](),document[_0x14e688(0x233)](_0x14e688(0x236))['textContent']=_0x50b33c,document[_0x14e688(0x233)](_0x14e688(0x241))['textContent']=_0x4afb5f;}const _0x1a2c2c={};teamNames[_0x14e688(0x143)](_0x1910f6=>_0x1a2c2c[_0x1910f6]={'r':0x0,'t':0x0}),allEmployeesData[_0x14e688(0x143)](_0x8f30c6=>{const _0x4764aa=_0x14e688;if(_0x8f30c6[_0x4764aa(0x23a)]&&_0x1a2c2c[_0x8f30c6['Check_Place']]){_0x1a2c2c[_0x8f30c6[_0x4764aa(0x23a)]]['t']++;if(_0x8f30c6[_0x4764aa(0x2db)])_0x1a2c2c[_0x8f30c6[_0x4764aa(0x23a)]]['r']++;}});const _0x4c1460=Math[_0x14e688(0x2d7)](teamNames[_0x14e688(0x13b)]/0x2);charts[_0x14e688(0x13d)]&&(charts[_0x14e688(0x13d)][_0x14e688(0x2cd)]['labels']=teamNames[_0x14e688(0x14d)](0x0,_0x4c1460),charts['bar1'][_0x14e688(0x2cd)][_0x14e688(0x2c4)][0x0][_0x14e688(0x2cd)]=teamNames[_0x14e688(0x14d)](0x0,_0x4c1460)[_0x14e688(0x2e1)](_0x2b04f3=>_0x1a2c2c[_0x2b04f3]['r']),charts['bar1'][_0x14e688(0x2cd)][_0x14e688(0x2c4)][0x1][_0x14e688(0x2cd)]=teamNames[_0x14e688(0x14d)](0x0,_0x4c1460)[_0x14e688(0x2e1)](_0x5c451f=>_0x1a2c2c[_0x5c451f]['t']-_0x1a2c2c[_0x5c451f]['r']),charts['bar1'][_0x14e688(0x128)]());charts['bar2']&&(charts['bar2'][_0x14e688(0x2cd)][_0x14e688(0x15e)]=teamNames[_0x14e688(0x14d)](_0x4c1460),charts[_0x14e688(0x225)][_0x14e688(0x2cd)][_0x14e688(0x2c4)][0x0][_0x14e688(0x2cd)]=teamNames['slice'](_0x4c1460)['map'](_0x2e1ab5=>_0x1a2c2c[_0x2e1ab5]['r']),charts[_0x14e688(0x225)]['data'][_0x14e688(0x2c4)][0x1][_0x14e688(0x2cd)]=teamNames['slice'](_0x4c1460)[_0x14e688(0x2e1)](_0x2f02c9=>_0x1a2c2c[_0x2f02c9]['t']-_0x1a2c2c[_0x2f02c9]['r']),charts[_0x14e688(0x225)][_0x14e688(0x128)]());const _0x36a898=[..._0x4c00ac][_0x14e688(0x131)]((_0x177afd,_0x1143ee)=>(_0x1143ee['DateLogin']?.['toMillis']()||0x0)-(_0x177afd[_0x14e688(0x2db)]?.[_0x14e688(0x248)]()||0x0))['slice'](0x0,0x1e);document[_0x14e688(0x233)](_0x14e688(0x222))[_0x14e688(0x224)]=_0x36a898[_0x14e688(0x2e1)](_0x4da47f=>_0x14e688(0x1c8)+_0x4da47f[_0x14e688(0x220)]+_0x14e688(0x219)+_0x4da47f[_0x14e688(0x259)]+_0x14e688(0x189)+(_0x4da47f['Branch_eng']||'-')+_0x14e688(0x189)+(_0x4da47f[_0x14e688(0x234)]||'-')+'</td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20class=\x22px-3\x20py-0\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span></td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22cancelReg(\x27'+_0x4da47f['id']+_0x14e688(0x1f8)+_0x4da47f[_0x14e688(0x259)]+_0x14e688(0x15a))['join'](''),updateTeamTab(),updateGridTab(),updateEmployeeList(),updateGroupRandomUI(),updateLuckyDrawStats(),updateWinnersList();}function updateWinnersList(){const _0x110e8a=_0x2e49bf,_0x4e32a6=document[_0x110e8a(0x233)](_0x110e8a(0x177));if(!_0x4e32a6)return;const _0x39e098=allEmployeesData[_0x110e8a(0x1e6)](_0x147059=>_0x147059['RandomTime']);if(_0x39e098[_0x110e8a(0x13b)]===0x0){_0x4e32a6[_0x110e8a(0x224)]=_0x110e8a(0x23b);return;}_0x4e32a6[_0x110e8a(0x224)]=allGiftsData[_0x110e8a(0x2e1)](_0x179173=>{const _0x2b01fd=_0x110e8a,_0x532084=_0x39e098[_0x2b01fd(0x1e6)](_0x2dfae9=>_0x2dfae9[_0x2b01fd(0x29a)]===_0x179173['id']||_0x2dfae9[_0x2b01fd(0x28f)]===_0x179173[_0x2b01fd(0x228)]&&!_0x2dfae9[_0x2b01fd(0x29a)]);if(_0x532084['length']===0x0)return'';return _0x532084[_0x2b01fd(0x131)]((_0x45bd9a,_0x55c375)=>(_0x55c375[_0x2b01fd(0x23e)]?.['toMillis']()||0x0)-(_0x45bd9a[_0x2b01fd(0x23e)]?.[_0x2b01fd(0x248)]()||0x0)),_0x2b01fd(0x245)+_0x179173[_0x2b01fd(0x228)]+_0x2b01fd(0x198)+_0x532084[_0x2b01fd(0x13b)]+'\x20‡∏ó‡πà‡∏≤‡∏ô</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22overflow-x-auto\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22min-w-full\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-header-gray\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏£‡∏´‡∏±‡∏™</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏≤‡∏Ç‡∏≤</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20class=\x22divide-y\x20divide-gray-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x532084[_0x2b01fd(0x2e1)]((_0x528849,_0x7e9727)=>{const _0x401005=_0x2b01fd,_0x2d6ceb=_0x528849[_0x401005(0x2bf)]?!![]:![],_0x12fcae=_0x2d6ceb?_0x401005(0x2a7):_0x401005(0x156),_0x2dcbd4=_0x2d6ceb?_0x401005(0x240):'bg-red-500\x20text-white\x20cursor-pointer\x20hover:bg-red-600',_0x15bbfb=_0x2d6ceb?'':_0x401005(0x136)+_0x528849['id']+'\x27)\x22';return _0x401005(0x2d0)+(_0x7e9727+0x1)+_0x401005(0x166)+_0x528849[_0x401005(0x220)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20uppercase\x20text-left\x22>'+_0x528849['FullName_th']+_0x401005(0x25a)+(_0x528849[_0x401005(0x263)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-left\x22>'+(_0x528849[_0x401005(0x234)]||'-')+_0x401005(0x2a8)+(_0x528849[_0x401005(0x23a)]||'-')+_0x401005(0x21f)+_0x15bbfb+_0x401005(0x294)+_0x2dcbd4+'\x22>'+_0x12fcae+_0x401005(0x15d)+_0x528849['id']+_0x401005(0x2df);})[_0x2b01fd(0x2b1)]('')+_0x2b01fd(0x17c);})[_0x110e8a(0x2b1)]('');}window['markAsReceived']=async _0x1a102c=>{const _0x1aa13f=_0x2e49bf;try{await updateDoc(doc(db,_0x1aa13f(0x1ee),_0x1a102c),{'ReceivedTime':serverTimestamp()});}catch(_0x1409f6){console[_0x1aa13f(0x12e)](_0x1409f6);}},window['openDashboardList']=_0x41f808=>{const _0x3fc0ee=_0x2e49bf;let _0x3923bb='',_0x41f1ea=[];if(_0x41f808===_0x3fc0ee(0x12d))_0x3923bb=_0x3fc0ee(0x14b),_0x41f1ea=allEmployeesData['filter'](_0x418f89=>_0x418f89[_0x3fc0ee(0x213)]===_0x3fc0ee(0x213));else{if(_0x41f808===_0x3fc0ee(0x270))_0x3923bb=_0x3fc0ee(0x25f),_0x41f1ea=allEmployeesData[_0x3fc0ee(0x1e6)](_0x5615f5=>_0x5615f5[_0x3fc0ee(0x2db)]&&_0x5615f5[_0x3fc0ee(0x213)]==='invite');else{if(_0x41f808===_0x3fc0ee(0x244))_0x3923bb=_0x3fc0ee(0x29e),_0x41f1ea=allEmployeesData['filter'](_0xe21704=>!_0xe21704[_0x3fc0ee(0x2db)]&&_0xe21704[_0x3fc0ee(0x213)]===_0x3fc0ee(0x213));else _0x41f808===_0x3fc0ee(0x14a)&&(_0x3923bb='‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô',_0x41f1ea=allEmployeesData[_0x3fc0ee(0x1e6)](_0x39c95c=>_0x39c95c[_0x3fc0ee(0x2db)]&&_0x39c95c[_0x3fc0ee(0x213)]!==_0x3fc0ee(0x213)));}}document[_0x3fc0ee(0x233)](_0x3fc0ee(0x14f))['textContent']=_0x3923bb,document[_0x3fc0ee(0x233)](_0x3fc0ee(0x2a4))[_0x3fc0ee(0x1e7)]=_0x41f1ea['length'];const _0x4a171b=document['getElementById'](_0x3fc0ee(0x12b));_0x4a171b[_0x3fc0ee(0x224)]=_0x41f1ea[_0x3fc0ee(0x2e1)]((_0x2d90ad,_0x299694)=>{const _0xafa00b=_0x3fc0ee,_0xa31ece=_0x2d90ad['DateLogin']?!![]:![],_0x5ba016=_0xa31ece?'<span\x20class=\x22bg-green-100\x20text-green-700\x20px-3\x20py-0.5\x20rounded-full\x20text-[10px]\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>':'-';return _0xafa00b(0x16e)+(_0x299694+0x1)+_0xafa00b(0x153)+_0x2d90ad[_0xafa00b(0x220)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-left\x20uppercase\x22>'+_0x2d90ad['FullName_th']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>'+(_0x2d90ad[_0xafa00b(0x263)]||'-')+_0xafa00b(0x200)+(_0x2d90ad[_0xafa00b(0x234)]||'-')+_0xafa00b(0x193)+(_0x2d90ad['Check_Place']||'-')+_0xafa00b(0x1a5)+_0x5ba016+_0xafa00b(0x2cb)+_0x2d90ad['id']+_0xafa00b(0x1f8)+_0x2d90ad[_0xafa00b(0x259)]+_0xafa00b(0x247)+(_0xa31ece?'':_0xafa00b(0x126))+_0xafa00b(0x160)+(_0xa31ece?_0xafa00b(0x1d5):_0xafa00b(0x22c))+_0xafa00b(0x1a0);})[_0x3fc0ee(0x2b1)]('')||'<tr><td\x20colspan=\x228\x22\x20class=\x22p-10\x20text-center\x20text-gray-400\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>',document[_0x3fc0ee(0x233)]('dashboardListModal')['classList'][_0x3fc0ee(0x27d)](_0x3fc0ee(0x25e));};async function addGift(){const _0x12f514=_0x2e49bf,_0x37152c=document[_0x12f514(0x233)](_0x12f514(0x29d))[_0x12f514(0x261)][_0x12f514(0x1ec)](),_0x410184=parseInt(document[_0x12f514(0x233)](_0x12f514(0x1c4))[_0x12f514(0x261)]);if(!_0x37152c||isNaN(_0x410184))return;const _0x181e4b=allGiftsData['reduce']((_0x22a737,_0x1ec0cd)=>Math[_0x12f514(0x293)](_0x22a737,_0x1ec0cd[_0x12f514(0x28a)]||0x0),0x0);await addDoc(collection(db,_0x12f514(0x2ce)),{'name':_0x37152c,'totalQty':_0x410184,'remainingQty':_0x410184,'status':'on','order':_0x181e4b+0x1,'createdAt':serverTimestamp()}),document[_0x12f514(0x233)](_0x12f514(0x29d))[_0x12f514(0x261)]='',document[_0x12f514(0x233)](_0x12f514(0x1c4))[_0x12f514(0x261)]='1';}function renderGiftTable(){const _0x5aab1c=_0x2e49bf,_0x1c8867=document[_0x5aab1c(0x233)](_0x5aab1c(0x17b));if(allGiftsData[_0x5aab1c(0x13b)]===0x0){_0x1c8867[_0x5aab1c(0x224)]=_0x5aab1c(0x1c0);return;}_0x1c8867[_0x5aab1c(0x224)]=allGiftsData['map']((_0x440322,_0x3d1b42)=>_0x5aab1c(0x21b)+(_0x440322[_0x5aab1c(0x28a)]||_0x3d1b42+0x1)+'\x22\x20onchange=\x22updateGiftOrder(\x27'+_0x440322['id']+'\x27,\x20this.value)\x22\x20class=\x22w-16\x20p-1\x20text-center\x20border\x20rounded\x20font-bold\x20text-blue-600\x22\x20min=\x221\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20font-normal\x22>'+_0x440322['name']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-sm\x22>'+_0x440322['totalQty']+_0x5aab1c(0x283)+_0x440322[_0x5aab1c(0x1c5)]+_0x5aab1c(0x1f9)+_0x440322['id']+_0x5aab1c(0x1f8)+_0x440322[_0x5aab1c(0x24a)]+_0x5aab1c(0x12c)+(_0x440322[_0x5aab1c(0x24a)]==='on'?_0x5aab1c(0x19b):_0x5aab1c(0x217))+'\x22>'+(_0x440322['status']==='on'?'ON':_0x5aab1c(0x20d))+'</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><span\x20onclick=\x22editGift(\x27'+_0x440322['id']+_0x5aab1c(0x19d)+_0x440322['id']+'\x27,\x20\x27'+_0x440322['name']+_0x5aab1c(0x1a3))[_0x5aab1c(0x2b1)]('');}window[_0x2e49bf(0x227)]=async(_0x1eda48,_0x5f3b41)=>{const _0x567a06=_0x2e49bf,_0x36ff7e=parseInt(_0x5f3b41);if(!isNaN(_0x36ff7e))await updateDoc(doc(db,_0x567a06(0x2ce),_0x1eda48),{'order':_0x36ff7e});},window[_0x2e49bf(0x18a)]=async(_0x1c09e3,_0x47ce42)=>{const _0x1e9145=_0x2e49bf;await updateDoc(doc(db,_0x1e9145(0x2ce),_0x1c09e3),{'status':_0x47ce42==='on'?_0x1e9145(0x1e8):'on'});},window[_0x2e49bf(0x1cb)]=_0x422019=>{const _0x940c66=_0x2e49bf,_0x25c168=allGiftsData[_0x940c66(0x237)](_0x37fe1f=>_0x37fe1f['id']===_0x422019);if(!_0x25c168)return;currentEditingGiftId=_0x422019,document[_0x940c66(0x233)](_0x940c66(0x2ab))[_0x940c66(0x261)]=_0x25c168[_0x940c66(0x228)],document[_0x940c66(0x233)]('editGiftTotalQty')[_0x940c66(0x261)]=_0x25c168[_0x940c66(0x22e)],document[_0x940c66(0x233)](_0x940c66(0x20a))[_0x940c66(0x261)]=_0x25c168[_0x940c66(0x1c5)],document[_0x940c66(0x233)](_0x940c66(0x1e1))[_0x940c66(0x161)]['remove']('hidden');},window['deleteGift']=(_0x493e34,_0x59009f)=>{const _0x198269=_0x2e49bf,_0x1f2073=document[_0x198269(0x233)](_0x198269(0x2dc));_0x1f2073[_0x198269(0x2af)]=_0x198269(0x251),currentConfirmAction=async()=>{const _0x4a11de=_0x198269;await deleteDoc(doc(db,_0x4a11de(0x2ce),_0x493e34)),document['getElementById'](_0x4a11de(0x157))[_0x4a11de(0x161)][_0x4a11de(0x24f)](_0x4a11de(0x25e));},document[_0x198269(0x233)]('confirmTitle')[_0x198269(0x1e7)]='‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•',document[_0x198269(0x233)]('confirmText')[_0x198269(0x1e7)]=_0x198269(0x1c1)+_0x59009f+']\x20?',document[_0x198269(0x233)](_0x198269(0x223))['classList'][_0x198269(0x24f)](_0x198269(0x25e)),document['getElementById']('confirmModal')[_0x198269(0x161)][_0x198269(0x27d)](_0x198269(0x25e));};function renderGiftPicker(){const _0x952ee3=_0x2e49bf,_0x8997f4=document['getElementById'](_0x952ee3(0x165)),_0x36f32a=allGiftsData[_0x952ee3(0x1e6)](_0xc832cc=>_0xc832cc[_0x952ee3(0x24a)]==='on'&&_0xc832cc[_0x952ee3(0x1c5)]>0x0);document[_0x952ee3(0x233)]('giftPickerTitle')['textContent']=giftPickerContext===_0x952ee3(0x275)?_0x952ee3(0x1bb):_0x952ee3(0x260);if(!_0x36f32a[_0x952ee3(0x13b)]){_0x8997f4[_0x952ee3(0x224)]='<p\x20class=\x22text-center\x20py-10\x20text-gray-400\x20font-bold\x20italic\x20text-sm\x22>--\x20‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠\x20--</p>';return;}const _0x5cb9b5=giftPickerContext===_0x952ee3(0x275)?selectedIndGiftId:selectedGroupGiftId;_0x8997f4['innerHTML']=_0x36f32a[_0x952ee3(0x2e1)](_0x2381f6=>{const _0x19b692=_0x952ee3,_0x3820e8=_0x2381f6['id']===_0x5cb9b5;return _0x19b692(0x287)+_0x2381f6['id']+_0x19b692(0x2c0)+(_0x3820e8?_0x19b692(0x196):_0x19b692(0x1a6))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-black\x20'+(_0x3820e8?_0x19b692(0x2cf):_0x19b692(0x17d))+_0x19b692(0x203)+_0x2381f6[_0x19b692(0x228)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22'+(_0x3820e8?_0x19b692(0x2a3):'text-gray-500')+_0x19b692(0x1af)+_0x2381f6[_0x19b692(0x1c5)]+_0x19b692(0x14e)+(_0x3820e8?_0x19b692(0x264):_0x19b692(0x229))+'\x20rounded-lg\x20text-sm\x20font-black\x20uppercase\x22>'+(_0x3820e8?'Selected':_0x19b692(0x2de))+_0x19b692(0x2e3);})['join']('');}window[_0x2e49bf(0x298)]=_0x5653e6=>{const _0x452f3b=_0x2e49bf;giftPickerContext===_0x452f3b(0x275)?(selectedIndGiftId=_0x5653e6,refreshIndGiftState()):(selectedGroupGiftId=_0x5653e6,document[_0x452f3b(0x233)](_0x452f3b(0x12f))['innerHTML']='',document[_0x452f3b(0x233)](_0x452f3b(0x29f))[_0x452f3b(0x224)]='',refreshGroupGiftState()),document['getElementById']('giftPickerModal')[_0x452f3b(0x161)][_0x452f3b(0x24f)](_0x452f3b(0x25e));};function refreshIndGiftState(){const _0x48e5e9=_0x2e49bf,_0xad2834=document[_0x48e5e9(0x233)](_0x48e5e9(0x1bd)),_0x43ba2b=document[_0x48e5e9(0x233)]('indGiftDisplayQty'),_0x3b6a27=document[_0x48e5e9(0x233)](_0x48e5e9(0x1b1));if(!selectedIndGiftId){_0xad2834[_0x48e5e9(0x1e7)]=_0x48e5e9(0x1ac),_0x43ba2b[_0x48e5e9(0x1e7)]=_0x48e5e9(0x2e4),_0x3b6a27[_0x48e5e9(0x126)]=!![];return;}const _0x244207=allGiftsData[_0x48e5e9(0x237)](_0x47b093=>_0x47b093['id']===selectedIndGiftId);!_0x244207||_0x244207[_0x48e5e9(0x1c5)]<=0x0?(_0xad2834[_0x48e5e9(0x1e7)]=_0x244207?_0x244207[_0x48e5e9(0x228)]+_0x48e5e9(0x252):_0x48e5e9(0x1ef),_0x43ba2b[_0x48e5e9(0x1e7)]='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200',_0x3b6a27[_0x48e5e9(0x126)]=!![]):(_0xad2834['textContent']=_0x244207[_0x48e5e9(0x228)],_0x43ba2b[_0x48e5e9(0x1e7)]=_0x48e5e9(0x20e)+_0x244207[_0x48e5e9(0x1c5)]+_0x48e5e9(0x159),_0x3b6a27[_0x48e5e9(0x126)]=![]);}function refreshGroupGiftState(){const _0x3e82c1=_0x2e49bf,_0x3f78dc=document[_0x3e82c1(0x233)](_0x3e82c1(0x1c2)),_0x1f615a=document[_0x3e82c1(0x233)](_0x3e82c1(0x208)),_0x127ae0=document[_0x3e82c1(0x233)](_0x3e82c1(0x207)),_0x3013d5=document[_0x3e82c1(0x233)](_0x3e82c1(0x276)),_0x848ba6=document['getElementById'](_0x3e82c1(0x2d2));if(!selectedGroupGiftId){_0x3f78dc['textContent']=_0x3e82c1(0x1ac),_0x3f78dc[_0x3e82c1(0x2af)]=_0x3e82c1(0x218),_0x1f615a['textContent']=_0x3e82c1(0x2e4),_0x1f615a[_0x3e82c1(0x2af)]=_0x3e82c1(0x19a),_0x127ae0[_0x3e82c1(0x2af)]=_0x3e82c1(0x175),_0x848ba6[_0x3e82c1(0x261)]=0x0,_0x3013d5[_0x3e82c1(0x126)]=!![];return;}const _0x2bd753=allGiftsData['find'](_0x321f73=>_0x321f73['id']===selectedGroupGiftId);!_0x2bd753||_0x2bd753[_0x3e82c1(0x1c5)]<=0x0?(_0x3f78dc[_0x3e82c1(0x1e7)]=_0x2bd753?_0x2bd753[_0x3e82c1(0x228)]+_0x3e82c1(0x252):_0x3e82c1(0x1ef),_0x3f78dc[_0x3e82c1(0x2af)]=_0x3e82c1(0x23d),_0x1f615a[_0x3e82c1(0x1e7)]=_0x3e82c1(0x1e5),_0x127ae0[_0x3e82c1(0x2af)]='flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all',_0x848ba6[_0x3e82c1(0x261)]=0x0,_0x3013d5[_0x3e82c1(0x126)]=!![]):(_0x3f78dc[_0x3e82c1(0x1e7)]=_0x2bd753[_0x3e82c1(0x228)],_0x3f78dc['className']='text-base\x20font-black\x20text-blue-600\x20leading-tight\x20uppercase\x20text-sm',_0x1f615a[_0x3e82c1(0x1e7)]=_0x3e82c1(0x20e)+_0x2bd753[_0x3e82c1(0x1c5)]+_0x3e82c1(0x159),_0x1f615a[_0x3e82c1(0x2af)]='text-sm\x20font-bold\x20text-gray-600\x20mt-1\x20text-sm',_0x127ae0['className']=_0x3e82c1(0x1cf),_0x848ba6[_0x3e82c1(0x261)]=_0x2bd753[_0x3e82c1(0x1c5)],_0x848ba6[_0x3e82c1(0x293)]=_0x2bd753[_0x3e82c1(0x1c5)],_0x3013d5['disabled']=![]);}function _0x54a8(){const _0x2b8e5e=['closeRandomizeModalButtonX','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','trim','grTotalEligible','crsg','--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--','bg-gray-100','searchEmployeeIdInput','groupViewManagerFilter',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22removeLuckyWinner(\x27','<span\x20class=\x22px-1\x20text-gray-400\x22>...</span>','teamStatsRegistered','bottom','sort-emp-id','\x27,\x20\x27','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><button\x20onclick=\x22toggleGiftStatus(\x27','<br/><span\x20class=\x22text-sm\x20text-orange-600\x20text-xs\x22>üéÅ\x20',']\x20‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\x20(‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á)','sort-emp-status','gift-management-content','gvOverallStatsRegistered','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á',':00','\x20uppercase\x20text-sm\x22>','</td><td\x20class=\x22px-4\x20py-4\x20text-center\x22><span\x20onclick=\x22removeLuckyWinner(\x27','downloadCsvButton','37776882qhkiFJ','grGiftBox','grGiftDisplayQty','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','editGiftRemainingQty','winnerBU','#10B981','OFF','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-700\x20text-center\x20text-sm\x22>','regEmpBranch',')\x22>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','targetCount','invite','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>','closeConfirmButton','member','bg-gray-200\x20text-gray-600','text-base\x20font-black\x20text-gray-400\x20leading-tight\x20uppercase\x20text-sm','</td><td\x20class=\x22px-4\x20py-0\x20uppercase\x20font-bold\x20text-xm\x20text-left\x20text-sm\x22>','confirmInput','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><input\x20type=\x22number\x22\x20value=\x22','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20font-bold\x20text-left\x20text-sm\x22>','<button\x20class=\x22pagination-btn\x20','bar','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20','employeeId','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?\x20(‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)','latestRegistrationsTableBody','confirmInputContainer','innerHTML','bar2','modalDrawnCount','updateGiftOrder','name','bg-gray-100\x20text-gray-500','registrationDonutChart','B19','bg-gray-100\x20text-gray-400','groupViewStatsRegistered','totalQty','gvOverallStatsTotal','‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô','addGiftBtn','4229140ellIvx','getElementById','Check_Manager','B23','timelineTotalInvite','find','groupViewModalTitle','A14','Check_Place','<div\x20class=\x22p-10\x20text-center\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--</div>','Employee_List_Report.csv','text-base\x20font-black\x20text-red-400\x20leading-tight\x20uppercase\x20text-sm','RandomTime','B16','bg-green-500\x20text-white','timelineTotalExtra','B11','\ufeff‡∏•‡∏≥‡∏î‡∏±‡∏ö,‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,Member,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','unregistered','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-white\x20border\x20border-gray-100\x20rounded-2xl\x20overflow-hidden\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-gray-50\x20px-6\x20py-4\x20border-b\x20flex\x20justify-between\x20items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-black\x20text-indigo-700\x20uppercase\x22>üéÅ\x20‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-center\x20text-gray-400\x20text-sm\x20text-sm\x22>','\x27)\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toMillis','editEmployeeModal','status','manualRegisterModal','</option>','\x27)\x22\x20class=\x22','searchRegEmployeeIdInput','add','team-list-content','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center\x20transition-all\x20duration-300','\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)','209NsQaSB','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x22>','register-content','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','openGiftPickerBtn','editEmpTeam','FullName_th','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-left\x22>','employeeListTableBody','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-black\x20uppercase\x20text-xs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','randomizeModal','hidden','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß','‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','value','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Branch_eng','bg-blue-600\x20text-white','<tr><td\x20colspan=\x227\x22\x20class=\x22p-10\x20text-center\x20text-sm\x20text-sm\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</td></tr>','breakdownCenterTotal','localeCompare','Remaining','A13','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20font-black\x20text-gray-900\x20mt-0.5\x20text-sm\x22>','dispatchEvent','B22','ttb-register','winnerEmployeeId','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20cursor-pointer\x20font-bold\x20text-lg\x20ml-3\x20text-sm\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','registered','winnerTeam','B24','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','ind','grStartDrawBtn','registrationTimelineChart','long','selectedTeamTableBody','appendChild','closeEditModalButton','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xs\x20uppercase\x20shadow-sm\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','remove','regEmpManager','dashboard-content','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20onclick=\x22openGroupDetail(\x27','click','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-blue-600\x20font-bold\x20text-sm\x22>','A11','floor','goal','<div\x20onclick=\x22pickGift(\x27','gvOverallStatsContainer','teamSelect','order','numeric','randomizeError',')\x22>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#BFDBFE','AwardedGift','‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:\x20','teamBarChart2','saveEditGiftBtn','max','\x20class=\x22px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-black\x20transition-all\x20shadow-sm\x20','changeEmpPage','A18','empStatsTotal','pickGift','editEmp','AwardedGiftId','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x20text-center\x20text-sm\x22>','75%','giftNameInput','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','teamGridB','top','1328343DAeRwS','group-view-content','text-blue-600','dashboardListCount','empPaginationContainer','regEmpId','‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-blue-600\x20font-bold\x20uppercase\x20text-center\x22>','A23','#fff','editGiftName','B13','toString','text/csv;charset=utf-8;','className','manager','join','9206AhAfDX','definedTeamNamesInput','B12','‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß','options','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','confirmTitle','resize','giftPickerModal','\x22,\x22','branch','ReceivedTime','\x27)\x22\x20class=\x22flex\x20items-center\x20justify-between\x20p-4\x20border\x20rounded-xl\x20hover:bg-blue-50\x20cursor-pointer\x20transition-all\x20','registrationBreakdownChart','createObjectURL','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','datasets','searchEmployeeError','createElement','asc','grRemainingEligible','\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á,‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\x0a','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x20text-[10px]\x20font-normal\x20text-xs\x20text-sm\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27','‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','data','crsg_gift','text-blue-800','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20transition-colors\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-bold\x20text-gray-400\x20text-xs\x22>','href','grDrawCount','\x27)\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','active','dashboardListModal','padStart','ceil','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-center\x20text-orange-600\x20text-sm\x20text-sm\x22>','Invite','2-digit','DateLogin','confirmModalInner','\x27)\x22\x20class=\x22bg-red-50\x20text-white\x20px-3\x20py-1\x20rounded\x20cursor-pointer\x20text-sm\x20font-bold\x22>‡∏•‡∏ö</span></td></tr>','Select','\x27)\x22\x20class=\x22px-3\x20py-0\x20bg-red-100\x20text-red-600\x20rounded-lg\x20text-xs\x20font-black\x20hover:bg-red-600\x20hover:text-white\x20transition-all\x20uppercase\x22>‡∏•‡∏ö</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','editGiftTotalQty','map','startsWith','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô','‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß','disabled','random','update','card-total','B14','dashboardListTableBody','\x27)\x22\x20class=\x22px-4\x20py-1\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x20border\x20','total','error','teamGridA','card-extras','sort','editEmpName','8CpKMxO','split','\x22,\x22‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô\x22\x0a','onclick=\x22markAsReceived(\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22editEmp(\x27','docs','searchEmployeeButton','empStatsPercent','length','loader','bar1','groupViewStatsTotal','resetTeamButton','remainingCount','bg-yellow-50','#F59E0B','forEach','addEventListener','grBoxLeft','regManualError','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','</td><td\x20class=\x22px-4\x20py-4\x20text-xm\x20font-bold\x20text-gray-500\x20uppercase\x20text-left\x20text-sm\x22>','div','extras','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î','sort-emp-gift','slice','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22px-4\x20py-1\x20','dashboardListModalTitle','‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-600\x20text-sm\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-mono\x20font-bold\x20text-blue-700\x20text-center\x22>','from','contains','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö','confirmModal','bg-orange-100','\x20‡∏ä‡∏¥‡πâ‡∏ô','\x27)\x22\x20class=\x22text-red-600\x20hover:text-red-700\x20cursor-pointer\x20font-black\x20text-xs\x22>‡∏•‡∏ö</span></td></tr>','toLocaleString','grTotalWinners','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22removeLuckyWinner(\x27','labels','closeGiftPickerBtn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22','classList',')\x22>','1:1070273157855:web:5c8120e1df27e233d8676a','regEmpInviteStatus','giftPickerList','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-mono\x20font-black\x20text-blue-700\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x20text-sm\x20text-sm\x22>','includes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20bg-blue-50\x20p-2.5\x20rounded-xl\x20border\x20border-blue-100\x20winner-row-animate\x20shadow-sm\x20mb-1.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-blue-600\x20text-white\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center\x20rounded-full\x20text-[9px]\x20font-bold\x22>','breakdown','donutPercentage','updateTeamNamesBtn','sort-emp-manager','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-gray-400\x20font-bold\x20text-xs\x22>','confirmActionButton','</button>','desc','<option\x20value=\x22\x22>--\x20‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','<option\x20value=\x22','‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all\x20text-sm','bold','winnersByGiftContainer','closeWinnerModalButton','confirmText','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-black\x20text-gray-800\x20uppercase\x20text-left\x22>','giftListTableBody','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text-base\x20text-gray-800','editEmpId','empStatsRegistered','B10','timeline','‡∏™‡∏≤‡∏Ç‡∏≤:\x20','group','regEmpName','winnerDetailModal','sort-emp-name','10332099PWHOlB','removeLuckyWinner','</td><td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-xm\x20text-left\x20text-sm\x22>','toggleGiftStatus','A20','teamStatsContainer','B15','querySelector','managerFilterSelect','\x20onclick=\x22changeEmpPage(','\x20px-3\x20py-1\x20rounded\x20text-[10px]\x20font-normal\x20uppercase\x20cursor-pointer\x20transition-all\x20text-sm\x20text-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x22>','A24','winners-list-content','bg-blue-100\x20border-blue-500\x20shadow-md','bg-gray-300','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-indigo-600\x20text-white\x20px-3\x20py-1\x20rounded-full\x20text-xs\x20font-bold\x20uppercase\x22>','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-2\x20py-0.5\x20rounded\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','text-sm\x20font-bold\x20text-gray-300\x20mt-1\x20text-sm','bg-green-400\x20text-white\x20border-green-600','\ufeff‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡∏°,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20mr-2\x20text-sm\x22>Edit</span>|\x20<span\x20onclick=\x22deleteGift(\x27','8PMaXUy','ttb-register.firebasestorage.app','\x20px-4\x20py-1\x20rounded\x20text-[10px]\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','digit','A21','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20text-sm\x22>Delete</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','currentDateTime','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-center\x22>','bg-white\x20border-gray-100','empStatsUnregistered','teamBarChart1','6iIwddJ','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','searchRegEmployeeError','--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--','th-TH','modalParticipantsCount','\x20font-bold\x20text-sm\x22>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','keys','startRandomizeButton','teamStatsTotal','line','round','gift','B20','regEmpSeat','commit','Winners_Report.csv','\x20aspect-square\x20rounded-full\x20border\x20border-gray-200\x20flex\x20flex-col\x20items-center\x20justify-center\x20cursor-pointer\x20hover:shadow-lg\x20hover:scale-105\x20transition-all\x20active:scale-95\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-[12px]\x20font-bold\x20text-blue-700\x20leading-none\x20text-xs\x20font-bold\x22>','‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','sort-emp-member','indGiftDisplayName','bg-red-100\x20text-red-700\x20hover:bg-red-200','ttb-register.firebaseapp.com','<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-400\x20font-bold\x22>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö\x20[','grGiftDisplayName','winnerName','giftQtyInput','remainingQty','editEmpManager','‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:\x20','<tr><td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>','sort-emp-branch','1700385kHQvuX','editGift','fill','empStatsContainer','grBoxRight','flex\x20items-center\x20justify-between\x20bg-blue-50\x20border-2\x20border-blue-300\x20rounded-xl\x20p-3\x20transition-all','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','replace','doughnut','saveManualRegButton','‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','bg-red-600\x20text-white\x20hover:bg-red-700','group-random-content','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x22>','change','groupViewModal','searchRegEmployeeButton','</td><td\x20class=\x22px-4\x20py-4\x20uppercase\x20font-bold\x20text-xm\x20text-left\x20text-sm\x20text-sm\x22>','loading-gif','<tr><td\x20class=\x22px-4\x20py-4\x20font-mono\x20font-black\x20text-blue-700\x20text-center\x20text-sm\x22>','#3B82F6','openGroupGiftPickerBtn','A17','editGiftModal','getHours','download','3896697xGdtuX','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200','filter','textContent','off','A19'];_0x54a8=function(){return _0x2b8e5e;};return _0x54a8();}async function startGroupRandomDraw(){const _0x5754a6=_0x2e49bf,_0x12405c=parseInt(document[_0x5754a6(0x233)](_0x5754a6(0x2d2))[_0x5754a6(0x261)])||0x0,_0x20dde1=allEmployeesData['filter'](_0x19dc31=>_0x19dc31[_0x5754a6(0x2db)]&&_0x19dc31['invite']===_0x5754a6(0x213)&&!_0x19dc31[_0x5754a6(0x23e)]);if(!selectedGroupGiftId)return;const _0x422654=allGiftsData[_0x5754a6(0x237)](_0xa2e76d=>_0xa2e76d['id']===selectedGroupGiftId);if(_0x12405c<=0x0||_0x20dde1['length']<_0x12405c||_0x422654['remainingQty']<_0x12405c)return;const _0x5e46e5=document[_0x5754a6(0x233)](_0x5754a6(0x276));_0x5e46e5['disabled']=!![];const _0x29c986=document[_0x5754a6(0x233)](_0x5754a6(0x145)),_0x3381de=document['getElementById'](_0x5754a6(0x1ce));_0x29c986['innerHTML']='',_0x3381de[_0x5754a6(0x224)]='';const _0xdb0d92=[..._0x20dde1][_0x5754a6(0x131)](()=>0.5-Math[_0x5754a6(0x127)]())[_0x5754a6(0x14d)](0x0,_0x12405c);await updateDoc(doc(db,_0x5754a6(0x2ce),selectedGroupGiftId),{'remainingQty':_0x422654[_0x5754a6(0x1c5)]-_0x12405c});const _0x2a3665=Math[_0x5754a6(0x2d7)](_0x12405c/0x2),_0x1ac90f=_0xdb0d92['slice'](0x0,_0x2a3665),_0x122ebf=_0xdb0d92[_0x5754a6(0x14d)](_0x2a3665),_0x2fdb52=_0x46a130=>{const _0x47d31c=_0x5754a6,_0x57ec10=document[_0x47d31c(0x2c6)](_0x47d31c(0x149));_0x57ec10['id']=_0x47d31c(0x13c),_0x57ec10['className']=_0x47d31c(0x1dc),_0x46a130[_0x47d31c(0x27a)](_0x57ec10);},_0x1ac225=_0x367f35=>{const _0x565bd3=_0x5754a6,_0x3bae29=_0x367f35[_0x565bd3(0x18e)]('#loader');if(_0x3bae29)_0x3bae29['remove']();};for(let _0x1c0db9=0x0;_0x1c0db9<_0x1ac90f[_0x5754a6(0x13b)];_0x1c0db9++){_0x2fdb52(_0x29c986),await new Promise(_0x7e97a4=>setTimeout(_0x7e97a4,0x3e8)),_0x1ac225(_0x29c986);const _0x47eab8=_0x1ac90f[_0x1c0db9];_0x29c986['innerHTML']+=createWinnerItemHTML(_0x1c0db9+0x1,_0x47eab8),await updateWinnerInDB(_0x47eab8,_0x422654[_0x5754a6(0x228)],selectedGroupGiftId);}for(let _0x1fbfa5=0x0;_0x1fbfa5<_0x122ebf[_0x5754a6(0x13b)];_0x1fbfa5++){_0x2fdb52(_0x3381de),await new Promise(_0x26eaaa=>setTimeout(_0x26eaaa,0x3e8)),_0x1ac225(_0x3381de);const _0xa671ec=_0x122ebf[_0x1fbfa5];_0x3381de['innerHTML']+=createWinnerItemHTML(_0x2a3665+_0x1fbfa5+0x1,_0xa671ec),await updateWinnerInDB(_0xa671ec,_0x422654[_0x5754a6(0x228)],selectedGroupGiftId);}_0x5e46e5['disabled']=![],confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}});}function createWinnerItemHTML(_0x13a336,_0x2048ad){const _0x449b28=_0x2e49bf;return _0x449b28(0x169)+_0x13a336+_0x449b28(0x17a)+_0x2048ad['FullName_th']+'\x20('+_0x2048ad[_0x449b28(0x220)]+_0x449b28(0x1f3)+_0x2048ad['id']+_0x449b28(0x26f);}async function updateWinnerInDB(_0x713bd,_0x267368,_0x5e5744){await updateDoc(doc(db,'crsg',_0x713bd['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x267368,'AwardedGiftId':_0x5e5744});}async function runIndividualLuckyDraw(){const _0x57126b=_0x2e49bf,_0x94036c=document[_0x57126b(0x233)](_0x57126b(0x28c));_0x94036c[_0x57126b(0x1e7)]='';const _0x31d6f5=allEmployeesData[_0x57126b(0x1e6)](_0x5b9255=>_0x5b9255[_0x57126b(0x2db)]&&_0x5b9255[_0x57126b(0x213)]===_0x57126b(0x213)&&!_0x5b9255[_0x57126b(0x23e)]);if(!selectedIndGiftId){_0x94036c[_0x57126b(0x1e7)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô';return;}if(!_0x31d6f5[_0x57126b(0x13b)]){_0x94036c['textContent']=_0x57126b(0x230);return;}const _0x51f447=allGiftsData[_0x57126b(0x237)](_0x2d0668=>_0x2d0668['id']===selectedIndGiftId);if(!_0x51f447||_0x51f447[_0x57126b(0x1c5)]<=0x0){_0x94036c[_0x57126b(0x1e7)]=_0x57126b(0x2b5);return;}const _0x1743be=document[_0x57126b(0x233)](_0x57126b(0x1b1));_0x1743be[_0x57126b(0x126)]=!![];const _0x5a9b8c=[0x1,0x2,0x3,0x4,0x5][_0x57126b(0x2e1)](_0x1c9408=>document[_0x57126b(0x233)](_0x57126b(0x1a1)+_0x1c9408));let _0x5d2b22=0x0;drawInterval=setInterval(()=>{const _0x31468a=_0x57126b;_0x5a9b8c[_0x31468a(0x143)](_0x2e225d=>_0x2e225d[_0x31468a(0x1e7)]=Math['floor'](Math[_0x31468a(0x127)]()*0xa));if(++_0x5d2b22>0x28){clearInterval(drawInterval);const _0x45dc1b=_0x31d6f5[Math[_0x31468a(0x285)](Math[_0x31468a(0x127)]()*_0x31d6f5[_0x31468a(0x13b)])],_0x2e7381=String(_0x45dc1b[_0x31468a(0x220)])['slice'](-0x5)[_0x31468a(0x2d6)](0x5,'0');_0x5a9b8c['forEach']((_0x30285e,_0x38f929)=>_0x30285e[_0x31468a(0x1e7)]=_0x2e7381[_0x38f929]),setTimeout(async()=>{const _0x4fd286=_0x31468a;await updateDoc(doc(db,_0x4fd286(0x2ce),selectedIndGiftId),{'remainingQty':_0x51f447[_0x4fd286(0x1c5)]-0x1}),await updateDoc(doc(db,'crsg',_0x45dc1b['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x51f447[_0x4fd286(0x228)],'AwardedGiftId':selectedIndGiftId}),document[_0x4fd286(0x233)](_0x4fd286(0x1c3))['textContent']=_0x45dc1b['FullName_th']+'\x20('+_0x45dc1b[_0x4fd286(0x220)]+')',document[_0x4fd286(0x233)]('winnerGiftText')['textContent']=_0x4fd286(0x2c3)+_0x51f447[_0x4fd286(0x228)],document[_0x4fd286(0x233)](_0x4fd286(0x26e))[_0x4fd286(0x1e7)]=_0x4fd286(0x1c7)+_0x45dc1b['employeeId'],document[_0x4fd286(0x233)](_0x4fd286(0x20b))[_0x4fd286(0x1e7)]=_0x4fd286(0x182)+(_0x45dc1b[_0x4fd286(0x263)]||'-'),document[_0x4fd286(0x233)](_0x4fd286(0x271))[_0x4fd286(0x1e7)]=_0x4fd286(0x290)+(_0x45dc1b[_0x4fd286(0x234)]||'-'),document['getElementById'](_0x4fd286(0x185))[_0x4fd286(0x161)][_0x4fd286(0x27d)](_0x4fd286(0x25e)),confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}}),_0x1743be['disabled']=![],updateLuckyDrawStats();},0x1f4);}},0x32);}window[_0x2e49bf(0x188)]=async _0x57c10d=>{const _0x84101f=_0x2e49bf,_0xf969ee=allEmployeesData[_0x84101f(0x237)](_0x37bc9a=>_0x37bc9a['id']===_0x57c10d);if(!_0xf969ee)return;if(_0xf969ee['AwardedGiftId']){const _0x6804cf=allGiftsData[_0x84101f(0x237)](_0xeb0984=>_0xeb0984['id']===_0xf969ee[_0x84101f(0x29a)]);if(_0x6804cf)await updateDoc(doc(db,'crsg_gift',_0x6804cf['id']),{'remainingQty':_0x6804cf[_0x84101f(0x1c5)]+0x1});}await updateDoc(doc(db,_0x84101f(0x1ee),_0x57c10d),{'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null}),document[_0x84101f(0x233)](_0x84101f(0x185))['classList']['add'](_0x84101f(0x25e));};function updateLuckyDrawStats(){const _0x29678d=_0x2e49bf,_0x513025=allEmployeesData[_0x29678d(0x1e6)](_0xa4737=>_0xa4737[_0x29678d(0x2db)]&&_0xa4737[_0x29678d(0x213)]===_0x29678d(0x213)),_0x886006=_0x513025[_0x29678d(0x1e6)](_0x43f224=>_0x43f224[_0x29678d(0x23e)])['sort']((_0x5d0f83,_0x5ec2f3)=>(_0x5ec2f3['RandomTime']?.[_0x29678d(0x248)]()||0x0)-(_0x5d0f83[_0x29678d(0x23e)]?.[_0x29678d(0x248)]()||0x0));document[_0x29678d(0x233)](_0x29678d(0x1ae))[_0x29678d(0x1e7)]=_0x513025[_0x29678d(0x1e6)](_0x2f6d97=>!_0x2f6d97[_0x29678d(0x23e)])[_0x29678d(0x13b)],document[_0x29678d(0x233)](_0x29678d(0x226))[_0x29678d(0x1e7)]=_0x886006[_0x29678d(0x13b)],document[_0x29678d(0x233)]('drawnWinnersTableBody')[_0x29678d(0x224)]=_0x886006[_0x29678d(0x2e1)](_0x12e66b=>_0x29678d(0x1dd)+_0x12e66b[_0x29678d(0x220)]+_0x29678d(0x1db)+_0x12e66b[_0x29678d(0x259)]+(_0x12e66b[_0x29678d(0x28f)]?_0x29678d(0x1fa)+_0x12e66b[_0x29678d(0x28f)]+'</span>':'')+_0x29678d(0x148)+(_0x12e66b[_0x29678d(0x263)]||'-')+_0x29678d(0x204)+_0x12e66b['id']+_0x29678d(0x2dd))[_0x29678d(0x2b1)]('');}function updateTeamTab(){const _0x245c81=_0x2e49bf,_0x59c957=document[_0x245c81(0x233)](_0x245c81(0x289)),_0x12e429=_0x59c957[_0x245c81(0x261)];_0x59c957[_0x245c81(0x224)]='<option\x20value=\x22\x22>--\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°\x20--</option>'+teamNames[_0x245c81(0x2e1)](_0x3b4345=>_0x245c81(0x173)+_0x3b4345+'\x22>'+_0x3b4345+_0x245c81(0x24c))[_0x245c81(0x2b1)](''),_0x59c957[_0x245c81(0x261)]=teamNames[_0x245c81(0x168)](_0x12e429)?_0x12e429:'';if(_0x59c957[_0x245c81(0x261)]){const _0x3a12f4=allEmployeesData['filter'](_0x2e0a8b=>_0x2e0a8b[_0x245c81(0x23a)]===_0x59c957[_0x245c81(0x261)]);document[_0x245c81(0x233)](_0x245c81(0x1b2))[_0x245c81(0x1e7)]=_0x3a12f4['length'],document[_0x245c81(0x233)](_0x245c81(0x1f5))[_0x245c81(0x1e7)]=_0x3a12f4[_0x245c81(0x1e6)](_0x14a3aa=>_0x14a3aa[_0x245c81(0x2db)])['length'],document[_0x245c81(0x233)](_0x245c81(0x18c))[_0x245c81(0x161)][_0x245c81(0x27d)](_0x245c81(0x25e)),document['getElementById'](_0x245c81(0x279))[_0x245c81(0x224)]=_0x3a12f4[_0x245c81(0x2e1)]((_0x3f2af9,_0x2172f6)=>_0x245c81(0x1d0)+(_0x3f2af9[_0x245c81(0x2db)]?_0x245c81(0x141):'')+_0x245c81(0x254)+(_0x2172f6+0x1)+_0x245c81(0x1ff)+_0x3f2af9[_0x245c81(0x220)]+_0x245c81(0x1d7)+_0x3f2af9[_0x245c81(0x259)]+_0x245c81(0x192)+(_0x3f2af9[_0x245c81(0x263)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>'+(_0x3f2af9['Check_Manager']||'-')+_0x245c81(0x25c)+(_0x3f2af9[_0x245c81(0x2db)]?_0x245c81(0x256):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27'+_0x3f2af9['id']+_0x245c81(0x27c))[_0x245c81(0x2b1)]('');}else document[_0x245c81(0x233)](_0x245c81(0x18c))[_0x245c81(0x161)][_0x245c81(0x24f)](_0x245c81(0x25e));}function updateGridTab(){const _0xe79035=_0x2e49bf,_0x175ffb=document[_0xe79035(0x233)]('groupViewManagerFilter')[_0xe79035(0x261)],_0x504269=[...new Set(allEmployeesData[_0xe79035(0x2e1)](_0x269f0c=>_0x269f0c[_0xe79035(0x234)])['filter'](Boolean))][_0xe79035(0x131)](),_0x34ea7a=document[_0xe79035(0x233)](_0xe79035(0x1f2));_0x34ea7a[_0xe79035(0x2b6)][_0xe79035(0x13b)]!==_0x504269[_0xe79035(0x13b)]+0x1&&(_0x34ea7a[_0xe79035(0x224)]=_0xe79035(0x172)+_0x504269[_0xe79035(0x2e1)](_0x2f03df=>_0xe79035(0x173)+_0x2f03df+'\x22>'+_0x2f03df+_0xe79035(0x24c))[_0xe79035(0x2b1)](''));_0x34ea7a[_0xe79035(0x261)]=_0x175ffb;const _0x53b550=_0x175ffb?allEmployeesData[_0xe79035(0x1e6)](_0x593341=>_0x593341['Check_Manager']===_0x175ffb):allEmployeesData,_0x390273=_0x53b550['filter'](_0x489c71=>_0x489c71[_0xe79035(0x213)]===_0xe79035(0x213));document[_0xe79035(0x233)](_0xe79035(0x22f))[_0xe79035(0x1e7)]=_0x390273['length'],document[_0xe79035(0x233)](_0xe79035(0x1fe))[_0xe79035(0x1e7)]=_0x390273[_0xe79035(0x1e6)](_0x581681=>_0x581681[_0xe79035(0x2db)])[_0xe79035(0x13b)],document[_0xe79035(0x233)](_0xe79035(0x288))[_0xe79035(0x161)][_0xe79035(0x27d)](_0xe79035(0x25e));const _0x2476bd={};teamNames[_0xe79035(0x143)](_0x15317f=>_0x2476bd[_0x15317f]={'r':0x0,'t':0x0}),_0x53b550[_0xe79035(0x1e6)](_0x567053=>_0x567053[_0xe79035(0x23a)])[_0xe79035(0x143)](_0x38b72a=>{const _0x393552=_0xe79035;if(_0x2476bd[_0x38b72a[_0x393552(0x23a)]]){_0x2476bd[_0x38b72a[_0x393552(0x23a)]]['t']++;if(_0x38b72a['DateLogin'])_0x2476bd[_0x38b72a[_0x393552(0x23a)]]['r']++;}});const _0x222ee4=document[_0xe79035(0x233)](_0xe79035(0x12f)),_0x5b43d0=document['getElementById'](_0xe79035(0x29f));_0x222ee4['innerHTML']='',_0x5b43d0[_0xe79035(0x224)]='',teamNames['forEach'](_0x2e32a3=>{const _0x268903=_0xe79035,_0x1386e8=_0x2476bd[_0x2e32a3];let _0x3c617d='bg-gray-100';if(_0x1386e8['t']>0x0){if(_0x1386e8['r']===_0x1386e8['t'])_0x3c617d='bg-green-100';else{if(_0x1386e8['r']>0x0)_0x3c617d=_0x268903(0x158);}}const _0x82c367=_0x268903(0x281)+_0x2e32a3+_0x268903(0x24d)+_0x3c617d+_0x268903(0x1ba)+_0x2e32a3+_0x268903(0x26a)+_0x1386e8['r']+'/'+_0x1386e8['t']+_0x268903(0x1eb);if(_0x2e32a3[_0x268903(0x2e2)]('A'))_0x222ee4[_0x268903(0x224)]+=_0x82c367;else{if(_0x2e32a3[_0x268903(0x2e2)]('B'))_0x5b43d0[_0x268903(0x224)]+=_0x82c367;}});}function updateEmployeeList(){const _0x6c53f8=_0x2e49bf,_0x3e8636=document[_0x6c53f8(0x233)](_0x6c53f8(0x18f))['value'],_0x24ae35=[...new Set(allEmployeesData[_0x6c53f8(0x2e1)](_0x40ca00=>_0x40ca00[_0x6c53f8(0x234)])['filter'](Boolean))]['sort'](),_0x3534b1=document['getElementById'](_0x6c53f8(0x18f));_0x3534b1[_0x6c53f8(0x2b6)][_0x6c53f8(0x13b)]!==_0x24ae35[_0x6c53f8(0x13b)]+0x1&&(_0x3534b1[_0x6c53f8(0x224)]='<option\x20value=\x22\x22>--\x20‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>'+_0x24ae35['map'](_0x3e7972=>_0x6c53f8(0x173)+_0x3e7972+'\x22>'+_0x3e7972+_0x6c53f8(0x24c))[_0x6c53f8(0x2b1)](''));_0x3534b1[_0x6c53f8(0x261)]=_0x3e8636;let _0x39d59b=allEmployeesData['filter'](_0x3b95d3=>_0x3b95d3[_0x6c53f8(0x23a)]&&_0x3b95d3[_0x6c53f8(0x23a)][_0x6c53f8(0x1ec)]()!==''||_0x3b95d3[_0x6c53f8(0x2db)]);if(_0x3e8636)_0x39d59b=_0x39d59b[_0x6c53f8(0x1e6)](_0x1124c7=>_0x1124c7[_0x6c53f8(0x234)]===_0x3e8636);_0x39d59b[_0x6c53f8(0x131)]((_0x345c16,_0x10f9a7)=>{const _0x1707aa=_0x6c53f8;let _0x1579b1,_0x479327;switch(empSortField){case'status':_0x1579b1=_0x345c16[_0x1707aa(0x2db)]?0x1:0x0,_0x479327=_0x10f9a7[_0x1707aa(0x2db)]?0x1:0x0;break;case _0x1707aa(0x228):return empSortDir===_0x1707aa(0x2c7)?_0x345c16[_0x1707aa(0x259)][_0x1707aa(0x267)](_0x10f9a7[_0x1707aa(0x259)],'th'):_0x10f9a7[_0x1707aa(0x259)][_0x1707aa(0x267)](_0x345c16['FullName_th'],'th');case _0x1707aa(0x2be):_0x1579b1=_0x345c16[_0x1707aa(0x263)]||'',_0x479327=_0x10f9a7[_0x1707aa(0x263)]||'';break;case _0x1707aa(0x2b0):_0x1579b1=_0x345c16[_0x1707aa(0x234)]||'',_0x479327=_0x10f9a7['Check_Manager']||'';break;case _0x1707aa(0x216):_0x1579b1=_0x345c16[_0x1707aa(0x213)]||'',_0x479327=_0x10f9a7[_0x1707aa(0x213)]||'';break;case'gift':_0x1579b1=_0x345c16[_0x1707aa(0x28f)]?0x1:0x0,_0x479327=_0x10f9a7[_0x1707aa(0x28f)]?0x1:0x0;break;default:_0x1579b1=_0x345c16[_0x1707aa(0x220)],_0x479327=_0x10f9a7[_0x1707aa(0x220)];}if(_0x1579b1<_0x479327)return empSortDir===_0x1707aa(0x2c7)?-0x1:0x1;if(_0x1579b1>_0x479327)return empSortDir==='asc'?0x1:-0x1;return 0x0;});const _0x21131b=_0x39d59b[_0x6c53f8(0x13b)],_0x572466=_0x39d59b[_0x6c53f8(0x1e6)](_0x41027e=>_0x41027e[_0x6c53f8(0x2db)])[_0x6c53f8(0x13b)],_0x300d39=_0x21131b-_0x572466,_0x5616d4=_0x21131b>0x0?Math['round'](_0x572466/_0x21131b*0x64):0x0;document[_0x6c53f8(0x233)](_0x6c53f8(0x297))['textContent']=_0x21131b,document['getElementById'](_0x6c53f8(0x17f))[_0x6c53f8(0x1e7)]=_0x572466,document[_0x6c53f8(0x233)]('empStatsUnregistered')[_0x6c53f8(0x1e7)]=_0x300d39,document[_0x6c53f8(0x233)]('empStatsPercent')['textContent']=_0x5616d4+'%',document[_0x6c53f8(0x233)](_0x6c53f8(0x1cd))[_0x6c53f8(0x161)][_0x6c53f8(0x27d)]('hidden');const _0x3c0867=Math[_0x6c53f8(0x2d7)](_0x21131b/empPageSize);if(empCurrentPage>_0x3c0867&&_0x3c0867>0x0)empCurrentPage=_0x3c0867;const _0xb519f7=_0x39d59b[_0x6c53f8(0x14d)]((empCurrentPage-0x1)*empPageSize,empCurrentPage*empPageSize);document[_0x6c53f8(0x233)](_0x6c53f8(0x25b))['innerHTML']=_0xb519f7[_0x6c53f8(0x2e1)]((_0x3ed03f,_0x13adf7)=>{const _0x6752ed=_0x6c53f8,_0x4538e7=_0x3ed03f[_0x6752ed(0x2db)]?!![]:![];return _0x6752ed(0x147)+(_0x4538e7?_0x6752ed(0x141):'')+'\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-400\x20text-center\x20text-xs\x22>'+((empCurrentPage-0x1)*empPageSize+(_0x13adf7+0x1))+_0x6752ed(0x29b)+_0x3ed03f[_0x6752ed(0x220)]+_0x6752ed(0x167)+_0x3ed03f['FullName_th']+_0x6752ed(0x152)+(_0x3ed03f[_0x6752ed(0x263)]||'-')+_0x6752ed(0x152)+(_0x3ed03f[_0x6752ed(0x234)]||'-')+_0x6752ed(0x246)+(_0x3ed03f[_0x6752ed(0x213)]||'-')+_0x6752ed(0x2d8)+(_0x3ed03f[_0x6752ed(0x28f)]?_0x6752ed(0x2b9):'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x20text-sm\x20text-sm\x22>'+(_0x3ed03f[_0x6752ed(0x23a)]||'-')+_0x6752ed(0x1aa)+(_0x4538e7?_0x6752ed(0x2ca):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27'+_0x3ed03f['id']+_0x6752ed(0x1f8)+_0x3ed03f['FullName_th']+_0x6752ed(0x2d3)+(_0x4538e7?'':'disabled')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22'+(_0x4538e7?_0x6752ed(0x1be):'bg-gray-100\x20text-gray-400')+_0x6752ed(0x191);})['join'](''),renderEmpPagination(_0x3c0867);}function renderEmpPagination(_0x237316){const _0x392799=_0x2e49bf,_0x2fc9f8=document[_0x392799(0x233)](_0x392799(0x2a5));if(_0x237316<=0x1){_0x2fc9f8[_0x392799(0x224)]='';return;}let _0x583bff=_0x392799(0x151)+(empCurrentPage===0x1?'disabled':'')+_0x392799(0x190)+(empCurrentPage-0x1)+_0x392799(0x211);for(let _0x2e2000=0x1;_0x2e2000<=_0x237316;_0x2e2000++){if(_0x2e2000===0x1||_0x2e2000===_0x237316||_0x2e2000>=empCurrentPage-0x2&&_0x2e2000<=empCurrentPage+0x2)_0x583bff+=_0x392799(0x21d)+(_0x2e2000===empCurrentPage?_0x392799(0x2d4):'')+'\x22\x20onclick=\x22changeEmpPage('+_0x2e2000+_0x392799(0x162)+_0x2e2000+_0x392799(0x170);else(_0x2e2000===empCurrentPage-0x3||_0x2e2000===empCurrentPage+0x3)&&(_0x583bff+=_0x392799(0x1f4));}_0x583bff+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20'+(empCurrentPage===_0x237316?_0x392799(0x126):'')+_0x392799(0x190)+(empCurrentPage+0x1)+_0x392799(0x28d),_0x2fc9f8['innerHTML']=_0x583bff;}window[_0x2e49bf(0x295)]=_0x1b637e=>{empCurrentPage=_0x1b637e,updateEmployeeList();},window['cancelReg']=(_0x3ce5de,_0x22ee7a)=>{const _0x15f493=_0x2e49bf,_0x526afa=allEmployeesData[_0x15f493(0x237)](_0x37d75f=>_0x37d75f['id']===_0x3ce5de);if(!_0x526afa)return;const _0x2a1039=document['getElementById']('confirmModalInner');_0x2a1039[_0x15f493(0x2af)]=_0x15f493(0x280),currentConfirmAction=async()=>{const _0x555f2e=_0x15f493;try{const _0x443f15={'DateLogin':null,'MobileId':'','AwardedGift':'','AwardedGiftId':null,'RandomTime':null,'ReceivedTime':null};if(_0x526afa[_0x555f2e(0x29a)]){const _0x41dcfa=allGiftsData['find'](_0x2d02bc=>_0x2d02bc['id']===_0x526afa[_0x555f2e(0x29a)]);_0x41dcfa&&await updateDoc(doc(db,_0x555f2e(0x2ce),_0x41dcfa['id']),{'remainingQty':(_0x41dcfa[_0x555f2e(0x1c5)]||0x0)+0x1});}await updateDoc(doc(db,_0x555f2e(0x1ee),_0x3ce5de),_0x443f15),document[_0x555f2e(0x233)](_0x555f2e(0x157))[_0x555f2e(0x161)][_0x555f2e(0x24f)](_0x555f2e(0x25e));if(!document[_0x555f2e(0x233)](_0x555f2e(0x2d5))['classList'][_0x555f2e(0x155)](_0x555f2e(0x25e))){const _0x1d5aa9=document[_0x555f2e(0x233)](_0x555f2e(0x14f))[_0x555f2e(0x1e7)];let _0x4aa1f9=_0x555f2e(0x12d);if(_0x1d5aa9[_0x555f2e(0x168)](_0x555f2e(0x2e5)))_0x4aa1f9=_0x555f2e(0x270);else{if(_0x1d5aa9[_0x555f2e(0x168)]('‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô'))_0x4aa1f9=_0x555f2e(0x244);else{if(_0x1d5aa9[_0x555f2e(0x168)]('‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô'))_0x4aa1f9='extras';}}}}catch(_0x11a026){console['error'](_0x11a026);}},document[_0x15f493(0x233)](_0x15f493(0x2ba))[_0x15f493(0x1e7)]=_0x15f493(0x274),document['getElementById'](_0x15f493(0x179))[_0x15f493(0x1e7)]='‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ç‡∏≠‡∏á\x20['+_0x22ee7a+_0x15f493(0x1fb),document[_0x15f493(0x233)](_0x15f493(0x223))[_0x15f493(0x161)][_0x15f493(0x24f)]('hidden'),document[_0x15f493(0x233)](_0x15f493(0x157))[_0x15f493(0x161)][_0x15f493(0x27d)](_0x15f493(0x25e));},window['openGroupDetail']=_0x3e6a36=>{const _0x2fd745=_0x2e49bf,_0x10da36=allEmployeesData['filter'](_0x54190d=>_0x54190d[_0x2fd745(0x23a)]===_0x3e6a36);document[_0x2fd745(0x233)](_0x2fd745(0x238))[_0x2fd745(0x1e7)]=_0x2fd745(0x150)+_0x3e6a36,document[_0x2fd745(0x233)](_0x2fd745(0x13e))[_0x2fd745(0x1e7)]=_0x10da36[_0x2fd745(0x13b)],document[_0x2fd745(0x233)](_0x2fd745(0x22d))['textContent']=_0x10da36['filter'](_0x2937a9=>_0x2937a9[_0x2fd745(0x2db)])[_0x2fd745(0x13b)],document[_0x2fd745(0x233)]('groupViewTableBody')[_0x2fd745(0x224)]=_0x10da36[_0x2fd745(0x2e1)]((_0x5c03c1,_0x2c18c7)=>{const _0x219250=_0x2fd745;return'<tr\x20class=\x22'+(_0x5c03c1[_0x219250(0x2db)]?'bg-yellow-50':'')+'\x20hover:bg-gray-50\x20text-center\x20text-sm\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-gray-400\x20text-xs\x22>'+(_0x2c18c7+0x1)+_0x219250(0x20f)+_0x5c03c1['employeeId']+_0x219250(0x21c)+_0x5c03c1[_0x219250(0x259)]+_0x219250(0x214)+(_0x5c03c1[_0x219250(0x263)]||'-')+_0x219250(0x214)+(_0x5c03c1[_0x219250(0x234)]||'-')+_0x219250(0x262)+(_0x5c03c1['DateLogin']?_0x219250(0x199):'-')+_0x219250(0x137)+_0x5c03c1['id']+'\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-bold\x20uppercase\x20cursor-pointer\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';})[_0x2fd745(0x2b1)]('')||_0x2fd745(0x265),document[_0x2fd745(0x233)](_0x2fd745(0x1d9))[_0x2fd745(0x161)][_0x2fd745(0x27d)]('hidden');},window[_0x2e49bf(0x299)]=_0x30815b=>{const _0x259caf=_0x2e49bf,_0xa44567=allEmployeesData[_0x259caf(0x237)](_0x109972=>_0x109972['id']===_0x30815b);if(!_0xa44567)return;currentEditingDocId=_0x30815b,document[_0x259caf(0x233)](_0x259caf(0x17e))['textContent']=_0xa44567['employeeId'],document['getElementById'](_0x259caf(0x132))[_0x259caf(0x1e7)]=_0xa44567[_0x259caf(0x259)],document[_0x259caf(0x233)](_0x259caf(0x1c6))[_0x259caf(0x261)]=_0xa44567['Check_Manager']||'',document[_0x259caf(0x233)](_0x259caf(0x258))[_0x259caf(0x261)]=_0xa44567[_0x259caf(0x23a)]||'',document[_0x259caf(0x233)]('editEmployeeModal')[_0x259caf(0x161)][_0x259caf(0x27d)](_0x259caf(0x25e));};function searchForRegistration(){const _0x4ba224=_0x2e49bf,_0x594131=document[_0x4ba224(0x233)](_0x4ba224(0x24e))[_0x4ba224(0x261)][_0x4ba224(0x1ec)](),_0x1e9c1a=document[_0x4ba224(0x233)](_0x4ba224(0x1ab));_0x1e9c1a[_0x4ba224(0x1e7)]='';if(!_0x594131){_0x1e9c1a[_0x4ba224(0x1e7)]=_0x4ba224(0x2b8);return;}const _0x3c5141=allEmployeesData['find'](_0x2a25f8=>_0x2a25f8[_0x4ba224(0x220)]===_0x594131);_0x3c5141?(currentEditingDocId=_0x3c5141['id'],document[_0x4ba224(0x233)](_0x4ba224(0x2a6))['textContent']=_0x3c5141[_0x4ba224(0x220)],document[_0x4ba224(0x233)](_0x4ba224(0x184))['textContent']=_0x3c5141[_0x4ba224(0x259)],document[_0x4ba224(0x233)](_0x4ba224(0x210))['textContent']=_0x3c5141['Branch_eng']||'-',document[_0x4ba224(0x233)](_0x4ba224(0x27e))[_0x4ba224(0x1e7)]=_0x3c5141[_0x4ba224(0x234)]||'-',document[_0x4ba224(0x233)](_0x4ba224(0x1b7))['value']=_0x3c5141[_0x4ba224(0x23a)]||'',document[_0x4ba224(0x233)]('regEmpInviteStatus')[_0x4ba224(0x261)]=_0x3c5141[_0x4ba224(0x213)]||'',document[_0x4ba224(0x233)](_0x4ba224(0x24b))[_0x4ba224(0x161)][_0x4ba224(0x27d)](_0x4ba224(0x25e)),document['getElementById'](_0x4ba224(0x146))[_0x4ba224(0x1e7)]=''):_0x1e9c1a[_0x4ba224(0x1e7)]='‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';}async function saveManualRegistration(){const _0x21da0a=_0x2e49bf,_0x44a2b2=document[_0x21da0a(0x233)](_0x21da0a(0x1b7))[_0x21da0a(0x261)][_0x21da0a(0x1ec)](),_0x460311=document['getElementById'](_0x21da0a(0x164))[_0x21da0a(0x261)],_0x2538ae=document[_0x21da0a(0x233)](_0x21da0a(0x146));try{await updateDoc(doc(db,_0x21da0a(0x1ee),currentEditingDocId),{'Check_Place':_0x44a2b2,'invite':_0x460311,'DateLogin':serverTimestamp()}),document[_0x21da0a(0x233)](_0x21da0a(0x24b))[_0x21da0a(0x161)][_0x21da0a(0x24f)](_0x21da0a(0x25e)),document[_0x21da0a(0x233)](_0x21da0a(0x24e))[_0x21da0a(0x261)]='';}catch(_0x3c2206){console[_0x21da0a(0x12e)](_0x3c2206),_0x2538ae['textContent']=_0x21da0a(0x2b7);}}function handleEmpSort(_0x5e93f5){const _0x3f9d6a=_0x2e49bf;empSortField===_0x5e93f5?empSortDir=empSortDir===_0x3f9d6a(0x2c7)?_0x3f9d6a(0x171):_0x3f9d6a(0x2c7):(empSortField=_0x5e93f5,empSortDir=_0x3f9d6a(0x2c7)),empCurrentPage=0x1,updateEmployeeList();}function setupListeners(){const _0x59b91f=_0x2e49bf;document[_0x59b91f(0x233)]('randomizeButton')['addEventListener'](_0x59b91f(0x282),()=>{const _0x14087a=_0x59b91f;updateLuckyDrawStats(),document[_0x14087a(0x233)](_0x14087a(0x25d))[_0x14087a(0x161)][_0x14087a(0x27d)](_0x14087a(0x25e));}),document[_0x59b91f(0x233)](_0x59b91f(0x1ea))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document['getElementById'](_0x59b91f(0x25d))[_0x59b91f(0x161)][_0x59b91f(0x24f)]('hidden')),document[_0x59b91f(0x233)](_0x59b91f(0x1b1))[_0x59b91f(0x144)](_0x59b91f(0x282),runIndividualLuckyDraw),document[_0x59b91f(0x233)](_0x59b91f(0x276))['addEventListener'](_0x59b91f(0x282),startGroupRandomDraw),document[_0x59b91f(0x233)]('closeGroupViewModalButton')[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document[_0x59b91f(0x233)](_0x59b91f(0x1d9))[_0x59b91f(0x161)][_0x59b91f(0x24f)]('hidden')),document[_0x59b91f(0x233)](_0x59b91f(0x178))['addEventListener'](_0x59b91f(0x282),()=>document['getElementById'](_0x59b91f(0x185))[_0x59b91f(0x161)][_0x59b91f(0x24f)](_0x59b91f(0x25e))),document[_0x59b91f(0x233)](_0x59b91f(0x27b))[_0x59b91f(0x144)]('click',()=>document[_0x59b91f(0x233)](_0x59b91f(0x249))[_0x59b91f(0x161)][_0x59b91f(0x24f)](_0x59b91f(0x25e))),document['getElementById'](_0x59b91f(0x215))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document['getElementById']('confirmModal')[_0x59b91f(0x161)][_0x59b91f(0x24f)](_0x59b91f(0x25e))),document[_0x59b91f(0x233)](_0x59b91f(0x129))['addEventListener'](_0x59b91f(0x282),()=>openDashboardList(_0x59b91f(0x12d))),document[_0x59b91f(0x233)]('card-registered')[_0x59b91f(0x144)]('click',()=>openDashboardList(_0x59b91f(0x270))),document[_0x59b91f(0x233)]('card-unregistered')[_0x59b91f(0x144)]('click',()=>openDashboardList(_0x59b91f(0x244))),document[_0x59b91f(0x233)](_0x59b91f(0x130))[_0x59b91f(0x144)]('click',()=>openDashboardList('extras')),document[_0x59b91f(0x233)]('closeDashboardListModalButton')[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document['getElementById']('dashboardListModal')['classList'][_0x59b91f(0x24f)](_0x59b91f(0x25e))),document['getElementById'](_0x59b91f(0x1f7))['addEventListener'](_0x59b91f(0x282),()=>handleEmpSort('id')),document[_0x59b91f(0x233)](_0x59b91f(0x186))['addEventListener'](_0x59b91f(0x282),()=>handleEmpSort(_0x59b91f(0x228))),document['getElementById'](_0x59b91f(0x1c9))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>handleEmpSort(_0x59b91f(0x2be))),document[_0x59b91f(0x233)](_0x59b91f(0x16d))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>handleEmpSort('manager')),document[_0x59b91f(0x233)](_0x59b91f(0x1bc))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>handleEmpSort('member')),document[_0x59b91f(0x233)](_0x59b91f(0x14c))['addEventListener']('click',()=>handleEmpSort(_0x59b91f(0x1b5))),document[_0x59b91f(0x233)](_0x59b91f(0x1fc))[_0x59b91f(0x144)]('click',()=>handleEmpSort(_0x59b91f(0x24a))),document[_0x59b91f(0x233)](_0x59b91f(0x1da))[_0x59b91f(0x144)](_0x59b91f(0x282),searchForRegistration),document[_0x59b91f(0x233)]('closeManualRegModalButton')[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document[_0x59b91f(0x233)](_0x59b91f(0x24b))['classList'][_0x59b91f(0x24f)](_0x59b91f(0x25e))),document[_0x59b91f(0x233)](_0x59b91f(0x1d3))[_0x59b91f(0x144)](_0x59b91f(0x282),saveManualRegistration),document['getElementById'](_0x59b91f(0x16f))[_0x59b91f(0x144)]('click',async()=>{if(currentConfirmAction)await currentConfirmAction();}),document[_0x59b91f(0x233)](_0x59b91f(0x231))['addEventListener'](_0x59b91f(0x282),addGift),document[_0x59b91f(0x233)](_0x59b91f(0x257))[_0x59b91f(0x144)]('click',()=>{const _0x1afb08=_0x59b91f;giftPickerContext=_0x1afb08(0x275),renderGiftPicker(),document[_0x1afb08(0x233)]('giftPickerModal')[_0x1afb08(0x161)]['remove']('hidden');}),document[_0x59b91f(0x233)](_0x59b91f(0x1df))['addEventListener'](_0x59b91f(0x282),()=>{const _0x3beabe=_0x59b91f;giftPickerContext=_0x3beabe(0x183),renderGiftPicker(),document[_0x3beabe(0x233)](_0x3beabe(0x2bc))['classList'][_0x3beabe(0x27d)]('hidden');}),document['getElementById'](_0x59b91f(0x15f))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document[_0x59b91f(0x233)](_0x59b91f(0x2bc))[_0x59b91f(0x161)][_0x59b91f(0x24f)](_0x59b91f(0x25e))),document[_0x59b91f(0x233)]('closeEditGiftModalBtn')[_0x59b91f(0x144)](_0x59b91f(0x282),()=>document[_0x59b91f(0x233)](_0x59b91f(0x1e1))[_0x59b91f(0x161)][_0x59b91f(0x24f)]('hidden')),document['getElementById'](_0x59b91f(0x292))['addEventListener'](_0x59b91f(0x282),async()=>{const _0x5969a0=_0x59b91f,_0x4de8e8=document[_0x5969a0(0x233)](_0x5969a0(0x2ab))[_0x5969a0(0x261)]['trim'](),_0x570791=parseInt(document[_0x5969a0(0x233)](_0x5969a0(0x2e0))[_0x5969a0(0x261)]),_0x169444=parseInt(document['getElementById'](_0x5969a0(0x20a))['value']);if(!_0x4de8e8||isNaN(_0x570791)||isNaN(_0x169444))return;await updateDoc(doc(db,'crsg_gift',currentEditingGiftId),{'name':_0x4de8e8,'totalQty':_0x570791,'remainingQty':_0x169444}),document[_0x5969a0(0x233)](_0x5969a0(0x1e1))['classList'][_0x5969a0(0x24f)](_0x5969a0(0x25e));}),document[_0x59b91f(0x233)]('saveEditModalButton')[_0x59b91f(0x144)](_0x59b91f(0x282),async()=>{const _0x3a0509=_0x59b91f;await updateDoc(doc(db,_0x3a0509(0x1ee),currentEditingDocId),{'Check_Manager':document[_0x3a0509(0x233)](_0x3a0509(0x1c6))['value'],'Check_Place':document['getElementById'](_0x3a0509(0x258))[_0x3a0509(0x261)]}),document[_0x3a0509(0x233)](_0x3a0509(0x249))[_0x3a0509(0x161)][_0x3a0509(0x24f)](_0x3a0509(0x25e));}),document['getElementById'](_0x59b91f(0x139))[_0x59b91f(0x144)]('click',()=>{const _0x31ceb4=_0x59b91f,_0x24106c=document[_0x31ceb4(0x233)](_0x31ceb4(0x2c5));_0x24106c['textContent']='';const _0x26de8a=document[_0x31ceb4(0x233)](_0x31ceb4(0x1f1))[_0x31ceb4(0x261)][_0x31ceb4(0x1ec)]();if(!_0x26de8a){_0x24106c[_0x31ceb4(0x1e7)]=_0x31ceb4(0x2b8);return;}const _0x4d1a89=allEmployeesData[_0x31ceb4(0x237)](_0x1f44c7=>_0x1f44c7[_0x31ceb4(0x220)]===_0x26de8a);_0x4d1a89?(editEmp(_0x4d1a89['id']),document[_0x31ceb4(0x233)]('searchEmployeeIdInput')['value']=''):_0x24106c[_0x31ceb4(0x1e7)]=_0x31ceb4(0x209);}),document[_0x59b91f(0x233)]('teamSelect')[_0x59b91f(0x144)](_0x59b91f(0x1d8),updateTeamTab),document[_0x59b91f(0x233)](_0x59b91f(0x1f2))[_0x59b91f(0x144)]('change',updateGridTab),document['getElementById']('managerFilterSelect')[_0x59b91f(0x144)](_0x59b91f(0x1d8),()=>{empCurrentPage=0x1,updateEmployeeList();}),document['getElementById'](_0x59b91f(0x16c))['addEventListener'](_0x59b91f(0x282),()=>{const _0x13b8a9=_0x59b91f,_0xe90fec=document['getElementById'](_0x13b8a9(0x2b3))[_0x13b8a9(0x261)][_0x13b8a9(0x1ec)]();if(!_0xe90fec)return;teamNames=_0xe90fec[_0x13b8a9(0x134)](',')[_0x13b8a9(0x2e1)](_0x4ec0cf=>_0x4ec0cf[_0x13b8a9(0x1ec)]())[_0x13b8a9(0x1e6)](Boolean),refreshUI();}),document[_0x59b91f(0x233)](_0x59b91f(0x205))[_0x59b91f(0x144)](_0x59b91f(0x282),()=>{const _0x46cb3c=_0x59b91f;let _0x342042=_0x46cb3c(0x19c);allEmployeesData[_0x46cb3c(0x1e6)](_0x164953=>_0x164953['DateLogin'])['forEach'](_0x22c122=>{const _0x3e37d6=_0x46cb3c;_0x342042+='\x22'+_0x22c122[_0x3e37d6(0x220)]+_0x3e37d6(0x2bd)+_0x22c122[_0x3e37d6(0x259)]+_0x3e37d6(0x2bd)+(_0x22c122[_0x3e37d6(0x263)]||'')+_0x3e37d6(0x2bd)+(_0x22c122['Check_Manager']||'')+_0x3e37d6(0x2bd)+(_0x22c122['Check_Place']||'')+_0x3e37d6(0x135);});const _0x3352dc=new Blob([_0x342042],{'type':_0x46cb3c(0x2ae)}),_0x51b9ee=document['createElement']('a');_0x51b9ee[_0x46cb3c(0x2d1)]=URL[_0x46cb3c(0x2c2)](_0x3352dc),_0x51b9ee[_0x46cb3c(0x1e3)]='Registration_Report.csv',_0x51b9ee['click']();}),document['getElementById']('downloadEmployeeCsvButton')[_0x59b91f(0x144)](_0x59b91f(0x282),()=>{const _0x4a4927=_0x59b91f,_0x2aa3de=document[_0x4a4927(0x233)](_0x4a4927(0x18f))['value'];let _0x47ca3a=allEmployeesData[_0x4a4927(0x1e6)](_0x2812bd=>_0x2812bd['Check_Place']&&_0x2812bd[_0x4a4927(0x23a)][_0x4a4927(0x1ec)]()!==''||_0x2812bd[_0x4a4927(0x2db)]);if(_0x2aa3de)_0x47ca3a=_0x47ca3a[_0x4a4927(0x1e6)](_0x2617f4=>_0x2617f4[_0x4a4927(0x234)]===_0x2aa3de);let _0x3c8739=_0x4a4927(0x243);_0x47ca3a[_0x4a4927(0x143)]((_0x51c562,_0x20fead)=>{const _0x4b2307=_0x4a4927,_0x43d87d=_0x51c562[_0x4b2307(0x2db)]?_0x4b2307(0x2cc):'-',_0x50c6f5=_0x51c562['invite']||'-',_0x3d9ea8=_0x51c562[_0x4b2307(0x28f)]?_0x4b2307(0x2b9):'-';_0x3c8739+='\x22'+(_0x20fead+0x1)+'\x22,\x22'+_0x51c562[_0x4b2307(0x220)]+'\x22,\x22'+_0x51c562[_0x4b2307(0x259)]+'\x22,\x22'+(_0x51c562[_0x4b2307(0x263)]||'-')+_0x4b2307(0x2bd)+(_0x51c562['Check_Manager']||'-')+_0x4b2307(0x2bd)+_0x50c6f5+_0x4b2307(0x2bd)+_0x3d9ea8+_0x4b2307(0x2bd)+(_0x51c562[_0x4b2307(0x23a)]||'-')+_0x4b2307(0x2bd)+_0x43d87d+'\x22\x0a';});const _0x18bc46=new Blob([_0x3c8739],{'type':'text/csv;charset=utf-8;'}),_0x4bc660=document[_0x4a4927(0x2c6)]('a');_0x4bc660['href']=URL[_0x4a4927(0x2c2)](_0x18bc46),_0x4bc660[_0x4a4927(0x1e3)]=_0x4a4927(0x23c),_0x4bc660[_0x4a4927(0x282)]();}),document[_0x59b91f(0x233)]('downloadWinnersCsvButton')[_0x59b91f(0x144)](_0x59b91f(0x282),()=>{const _0x2fec6d=_0x59b91f,_0x4e9651=allEmployeesData[_0x2fec6d(0x1e6)](_0x45a74c=>_0x45a74c[_0x2fec6d(0x23e)])[_0x2fec6d(0x131)]((_0xcbd40f,_0x5bea27)=>(_0x5bea27[_0x2fec6d(0x23e)]?.['toMillis']()||0x0)-(_0xcbd40f[_0x2fec6d(0x23e)]?.[_0x2fec6d(0x248)]()||0x0));let _0x345be0=_0x2fec6d(0x2c9);_0x4e9651[_0x2fec6d(0x143)](_0x3dd6a3=>{const _0x363cf2=_0x2fec6d,_0x1ef7fd=_0x3dd6a3['RandomTime']?.['toMillis']()?new Date(_0x3dd6a3[_0x363cf2(0x23e)][_0x363cf2(0x248)]())[_0x363cf2(0x15b)]('th-TH'):'-',_0x267983=_0x3dd6a3[_0x363cf2(0x2bf)]?_0x363cf2(0x2a7):_0x363cf2(0x156);_0x345be0+='\x22'+_0x3dd6a3['employeeId']+'\x22,\x22'+_0x3dd6a3[_0x363cf2(0x259)]+'\x22,\x22'+(_0x3dd6a3[_0x363cf2(0x28f)]||'')+'\x22,\x22'+(_0x3dd6a3['Branch_eng']||'')+_0x363cf2(0x2bd)+(_0x3dd6a3[_0x363cf2(0x234)]||'')+_0x363cf2(0x2bd)+(_0x3dd6a3['Check_Place']||'')+'\x22,\x22'+_0x267983+_0x363cf2(0x2bd)+_0x1ef7fd+'\x22\x0a';});const _0x329c9a=new Blob([_0x345be0],{'type':_0x2fec6d(0x2ae)}),_0x40c6ec=document[_0x2fec6d(0x2c6)]('a');_0x40c6ec[_0x2fec6d(0x2d1)]=URL[_0x2fec6d(0x2c2)](_0x329c9a),_0x40c6ec[_0x2fec6d(0x1e3)]=_0x2fec6d(0x1b9),_0x40c6ec[_0x2fec6d(0x282)]();}),document[_0x59b91f(0x233)](_0x59b91f(0x13f))[_0x59b91f(0x144)]('click',()=>{const _0x286e82=_0x59b91f,_0x455b36=document['getElementById']('confirmModalInner'),_0x381ba3=document[_0x286e82(0x233)](_0x286e82(0x223)),_0x421f76=document[_0x286e82(0x233)](_0x286e82(0x21a));_0x381ba3[_0x286e82(0x161)][_0x286e82(0x27d)](_0x286e82(0x25e)),_0x421f76['value']='',currentConfirmAction=async()=>{const _0x1445fe=_0x286e82;if(_0x421f76[_0x1445fe(0x261)][_0x1445fe(0x1ec)]()['toUpperCase']()!=='RESET')return;const _0x41b27b=writeBatch(db);allEmployeesData['forEach'](_0x17d2b5=>{const _0x298446=_0x1445fe;_0x41b27b[_0x298446(0x128)](doc(db,_0x298446(0x1ee),_0x17d2b5['id']),{'DateLogin':null,'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null,'MobileId':''});}),allGiftsData[_0x1445fe(0x143)](_0x1511fc=>{const _0x34db37=_0x1445fe;_0x41b27b[_0x34db37(0x128)](doc(db,'crsg_gift',_0x1511fc['id']),{'remainingQty':_0x1511fc['totalQty']||0x1});}),await _0x41b27b[_0x1445fe(0x1b8)](),document['getElementById'](_0x1445fe(0x157))[_0x1445fe(0x161)][_0x1445fe(0x24f)](_0x1445fe(0x25e));},document[_0x286e82(0x233)]('confirmTitle')[_0x286e82(0x1e7)]='‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö',document['getElementById']('confirmText')[_0x286e82(0x1e7)]=_0x286e82(0x221),document['getElementById']('confirmModal')[_0x286e82(0x161)]['remove'](_0x286e82(0x25e));});}function updateGroupRandomUI(){const _0x5a32f3=_0x2e49bf,_0x4d515d=allEmployeesData[_0x5a32f3(0x1e6)](_0x1a9347=>_0x1a9347[_0x5a32f3(0x2db)]&&_0x1a9347[_0x5a32f3(0x213)]==='invite'),_0x3ee253=_0x4d515d[_0x5a32f3(0x1e6)](_0x26d7a5=>_0x26d7a5[_0x5a32f3(0x23e)])[_0x5a32f3(0x131)]((_0x540187,_0x5c2071)=>(_0x5c2071[_0x5a32f3(0x23e)]?.[_0x5a32f3(0x248)]()||0x0)-(_0x540187[_0x5a32f3(0x23e)]?.[_0x5a32f3(0x248)]()||0x0)),_0x52e6e9=_0x4d515d['filter'](_0x34c86e=>!_0x34c86e[_0x5a32f3(0x23e)]);if(document['getElementById'](_0x5a32f3(0x1ed)))document[_0x5a32f3(0x233)](_0x5a32f3(0x1ed))['textContent']=_0x4d515d[_0x5a32f3(0x13b)];if(document[_0x5a32f3(0x233)](_0x5a32f3(0x2c8)))document['getElementById']('grRemainingEligible')[_0x5a32f3(0x1e7)]=_0x52e6e9[_0x5a32f3(0x13b)];if(document[_0x5a32f3(0x233)](_0x5a32f3(0x15c)))document['getElementById'](_0x5a32f3(0x15c))[_0x5a32f3(0x1e7)]=_0x3ee253['length'];}
    </script>
</body>

</html>
