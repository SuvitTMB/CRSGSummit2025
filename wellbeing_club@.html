<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE Retail Club</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff;
            letter-spacing: normal !important;
            font-size: 1.125rem;
        }
        * {
            font-family: 'Sarabun', sans-serif !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            /* ‡∏õ‡∏£‡∏±‡∏ö font dropdown ‡πÅ‡∏•‡∏∞ input ‡∏•‡∏á 1 ‡∏Ç‡∏±‡πâ‡∏ô */
            font-size: 1rem;
        }
        thead.table-header-gray {
             background-color: #e5e7eb;
        }
        table thead th {
            font-weight: bold !important;
            font-size: 1rem !important;
            /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î font-align center */
            text-align: center !important;
        }
        table tbody tr {
            height: 30px !important;
        }
        .winner-row-animate {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        button:disabled {
            background-color: #d1d5db !important;
            cursor: not-allowed !important;
            box-shadow: none !important;
            transform: none !important;
        }
        .loading-gif {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0); }
            100% { transform: rotate(360deg); }
        }
        .sortable-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .sortable-header:hover {
            background-color: #d1d5db;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[95%] max-w-7xl p-0 bg-white rounded-lg">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6 pt-6 px-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold" style="color: #0056ff;">Recog Night White Elegance</h1>
            </div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-400 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="mb-6 border-b border-gray-200 px-8">
            <nav class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Tabs">
                <button id="tab-dashboard" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-700 bg-gray-300 border-blue-600">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°
                </button>
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>
                <button id="tab-gift-management" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
                <button id="tab-register" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    QR Code
                </button>
                <button id="tab-group-random" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-winners-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
            </nav>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="px-8 pb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                <div class="lg:w-2/5">
                     <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center h-full">
                         <p class="text-gray-600 text-base mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                         <div class="relative w-64 h-64">
                             <canvas id="registrationBreakdownChart"></canvas>
                             <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                 <span id="breakdownCenterTotal" class="text-2xl font-bold text-gray-900">0</span>
                                 <span class="text-base text-gray-500 font-bold">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                             </div>
                         </div>
                     </div>
                </div>
                <div class="lg:w-3/5">
                    <div class="flex gap-6 h-full">
                         <div class="w-2/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-base mb-4 font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Invite</p>
                            <div class="relative w-64 h-64">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                    <span class="text-base text-gray-500 font-bold">%‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                </div>
                            </div>
                        </div>
                         <div class="w-1/3 flex flex-col justify-between space-y-2">
                            <div class="h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-blue-700 text-sm font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Invite)</p>
                                <p id="targetCount" class="text-2xl font-bold text-blue-800 mt-1">0</p>
                            </div>
                            <div class="h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-green-700 text-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Invite)</p>
                                <p id="participantsCountBox" class="text-2xl font-bold text-green-800 mt-1">0</p>
                            </div>
                            <div class="h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-red-700 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</p>
                                <p id="remainingCount" class="text-2xl font-bold text-red-800 mt-1">0</p>
                            </div>
                            <div class="h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-yellow-700 text-sm">‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô (Non-Invite)</p>
                                <p id="attendeesCount" class="text-2xl font-bold text-yellow-800 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-xl font-semibold text-gray-800 font-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                     <button id="randomizeButton" class="px-6 py-3 text-base font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow active:scale-95 transition-all font-bold">
                         ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (A1 - A24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart1"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (B1 - B24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart2"></canvas></div>
                    </div>
                </div>
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-200 text-sm">
                            <tr><td colspan="6" class="p-6 text-center text-gray-500 font-bold text-sm">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-8 text-center">
                <button id="downloadCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all">
                    üì• Download CSV Report
                </button>
            </div>
        </div>

        <!-- Team List Content -->
        <div id="team-list-content" class="hidden pb-8 px-0">
            <div class="bg-white overflow-hidden">
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center bg-gray-50">
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm">
                        <p class="text-base text-blue-700 font-bold">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm font-bold">
                        <p class="text-base text-green-700">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ó‡∏µ‡∏°</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border shadow-sm font-bold flex flex-col"> 
                        <p class="text-sm text-gray-400 font-bold mb-1 uppercase tracking-tight">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</p>
                        <textarea id="definedTeamNamesInput" class="!text-xs h-16 resize-none bg-blue-50 border-blue-100 font-mono" placeholder="A,B,C..."></textarea>
                        <button id="updateTeamNamesBtn" class="mt-1 text-[10px] bg-blue-600 text-white py-1 rounded uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</button>
                    </div>
                </div>
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-8 py-3 text-base font-bold text-white bg-red-600 rounded-md hover:bg-red-700 shadow transition-all">Reset System Data</button>
                </div>
                 <div class="p-6">
                     <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                         <div>
                             <h3 class="text-xl font-bold border-l-4 border-blue-600 pl-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h3>
                             <div id="teamStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                                 <span class="px-3 py-1 rounded-md bg-gray-100 text-gray-700 text-sm font-bold border">Total: <span id="teamStatsTotal">0</span></span>
                                 <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">Reg: <span id="teamStatsRegistered">0</span></span>
                             </div>
                         </div>
                         <div class="flex items-center">
                             <label for="teamSelect" class="text-base font-bold text-gray-600 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                                 <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏° --</option>
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-xl shadow-sm">
                        <table class="min-w-full text-lg">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-4 text-center font-bold">#</th>
                                    <th class="px-4 py-4 text-left font-bold">Employee ID</th>
                                    <th class="px-4 py-4 text-left font-bold">Full Name</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                    <th class="px-4 py-4 text-left font-bold">Status</th>
                                    <th class="px-4 py-4 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- Group View Content -->
        <div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                <!-- Search Boxes Container -->
                <div class="flex flex-col md:flex-row gap-6 mb-6">
                    <!-- Box 1: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-gray-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchEmployeeIdInput" class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 5-6 ‡∏´‡∏•‡∏±‡∏Å">
                            </div>
                            <button id="searchEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow transition-all active:scale-95">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        <p id="searchEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>

                    <!-- Box 2: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-green-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-green-800 mb-3 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchRegEmployeeIdInput" class="block text-sm font-bold text-green-600 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchRegEmployeeIdInput" class="mt-1 block w-full rounded-md border-green-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">
                            </div>
                            <button id="searchRegEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95 uppercase">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                        </div>
                        <p id="searchRegEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>
                </div>

                <div class="px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (Grid)</h2>
                        <div id="gvOverallStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                             <span class="px-3 py-1 rounded-md bg-gray-100 text-sm font-bold border">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Invite): <span id="gvOverallStatsTotal">0</span></span>
                             <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß: <span id="gvOverallStatsRegistered">0</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="groupViewManagerFilter" class="text-base font-bold text-gray-600 mr-2">Manager:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                    </div>
                </div>
                <div id="teamBoxesContainer" class="p-6 grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3"></div>
             </div>
        </div>
        
        <!-- Employee List Content -->
        <div id="employee-list-content" class="hidden pb-8 px-0">
             <div class="bg-white overflow-hidden">
                <div class="px-8 py-6 border-b flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <div id="empStatsContainer" class="hidden flex flex-wrap gap-2 mt-3">
                            <span class="px-4 py-1.5 rounded-xl bg-gray-100 text-gray-700 text-sm font-black border shadow-sm">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="empStatsTotal">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-green-50 text-green-700 text-sm font-black border border-green-200 shadow-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="empStatsRegistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á: <span id="empStatsUnregistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-sm font-black border border-blue-200 shadow-sm">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô: <span id="empStatsPercent">0%</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="managerFilterSelect" class="text-base font-bold text-gray-600 mr-2">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</label>
                         <select id="managerFilterSelect" class="rounded-xl border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                     </div>
                </div>
                <div class="overflow-x-auto p-8">
                    <table class="min-w-full text-sm shadow-sm border rounded-2xl overflow-hidden">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold">#</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-id">‡∏£‡∏´‡∏±‡∏™ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-branch">‡∏™‡∏≤‡∏Ç‡∏≤ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-manager">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-member">Member ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-gift">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                    </table>
                </div>
                <!-- ‡∏õ‡∏∏‡πà‡∏° Download CSV ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                <div class="pb-8 text-center">
                    <button id="downloadEmployeeCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all uppercase">
                        üì• Download Employee CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Gift Management Content -->
        <div id="gift-management-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-blue-600 pl-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
                <div class="bg-gray-50 p-6 rounded-2xl border mb-8 max-w-[1000px] shadow-inner">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-grow" style="max-width: 600px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
                            <input type="text" id="giftNameInput" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                        </div>
                        <div style="width: 90px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="giftQtyInput" class="!text-sm text-center" value="1" min="1">
                        </div>
                        <div class="flex items-end">
                            <button id="addGiftBtn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all active:scale-95 shadow-lg !text-xs">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto border rounded-xl shadow-sm">
                    <table class="min-w-full text-base">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold w-24">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="giftListTableBody" class="divide-y divide-gray-100 bg-white">
                            <tr><td colspan="6" class="p-6 text-center text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Winners List Content -->
        <div id="winners-list-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-green-600 pl-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                <div id="winnersByGiftContainer" class="space-y-12">
                    <div class="p-10 text-center text-gray-400 font-bold italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
                <div class="mt-12 text-center">
                    <button id="downloadWinnersCsvButton" class="px-8 py-3 text-base font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95">
                        üì• Download Winners CSV Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Register Content -->
        <div id="register-content" class="hidden pb-8 px-6 text-center">
             <div class="bg-white p-12 rounded-[3rem] shadow-xl border border-gray-100 flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-800 mb-10 font-black">QR Code</h2>
                <div class="p-6 bg-white border-8 border-blue-600 rounded-[3rem] shadow-2xl mb-4 hover:scale-105 transition-all">
                    <img src="./images/QRcode-CRSG.png" alt="QR Code" class="w-80 h-80" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=REGISTER'">
                </div>
             </div>
        </div>

        <!-- Group Random Content -->
        <div id="group-random-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                
                <div class="flex flex-col md:flex-row gap-4 mb-6 items-stretch">
                    <div class="md:w-[30%] grid grid-cols-1 gap-2">
                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 shadow-sm text-center">
                            <p class="text-sm text-blue-700 uppercase font-black">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Invite)</p>
                            <p id="grTotalEligible" class="text-xl font-black text-blue-900">0</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 shadow-sm text-center">
                            <p class="text-sm text-orange-700 uppercase font-black">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°</p>
                            <p id="grRemainingEligible" class="text-xl font-black text-orange-900">0</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100 shadow-sm text-center">
                            <p class="text-sm text-green-700 uppercase font-black">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="grTotalWinners" class="text-xl font-black text-green-900">0</p>
                        </div>
                    </div>

                    <div class="md:w-[70%] flex flex-col gap-3">
                        <div class="bg-gray-50 px-4 py-3 rounded-xl border shadow-sm w-full">
                            <label class="block text-sm font-bold text-gray-400 mb-1 uppercase tracking-wider text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
                            <div id="grGiftBox" class="flex items-center justify-between bg-white border-2 border-dashed border-gray-200 rounded-xl p-3 transition-all">
                                <div class="flex flex-col text-left">
                                    <p id="grGiftDisplayName" class="text-base font-black text-gray-400 leading-tight uppercase">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                                    <p id="grGiftDisplayQty" class="text-sm font-bold text-gray-300 mt-1">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                                </div>
                                <button id="openGroupGiftPickerBtn" class="px-4 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-xs font-black border border-blue-200 shadow-sm shrink-0 active:scale-95 transition-all">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                            </div>
                        </div>

                        <div class="flex items-stretch gap-3 w-full flex-grow min-h-[90px]">
                            <div class="w-[30%] bg-gray-50 p-3 rounded-xl border shadow-sm flex flex-col justify-center items-center text-center">
                                <label class="text-sm font-bold text-gray-500 uppercase mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</label>
                                <input type="number" id="grDrawCount" value="0" min="0" class="w-full text-center text-3xl font-black text-blue-600 bg-white border border-blue-100 rounded-lg focus:border-blue-500 focus:ring-0 py-1 shadow-inner">
                            </div>
                            <div class="w-[70%]">
                                <button id="grStartDrawBtn" class="w-full h-full text-xl font-black text-white bg-[#0056ff] rounded-xl hover:bg-blue-700 shadow-lg transition-all active:scale-95 disabled:bg-gray-400 uppercase tracking-widest flex items-center justify-center">
                                    üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border-t border-gray-100 pt-4">
                    <div class="p-4 border-r border-gray-100">
                        <h4 class="text-xl font-black text-blue-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</h4>
                        <div id="grBoxLeft" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                    <div class="p-4">
                        <h4 class="text-xl font-black text-indigo-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h4>
                        <div id="grBoxRight" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- LIGHTBOX: Manual Registration -->
    <div id="manualRegisterModal" class="hidden fixed inset-0 z-[140] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-lg border-t-8 border-green-600">
            <h3 class="text-xl font-bold mb-6 uppercase border-b pb-3 text-gray-800 text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            <div id="regEmpDetail" class="space-y-4 mb-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="regEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="regEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏™‡∏≤‡∏Ç‡∏≤ ‡πÅ‡∏•‡∏∞ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏≤‡∏Ç‡∏≤ (Branch)</label><p id="regEmpBranch" class="text-sm font-bold text-gray-700"></p></div>
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Manager)</label><p id="regEmpManager" class="text-sm font-bold text-gray-700"></p></div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                        <input type="text" id="regEmpSeat" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, A2">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Invite</label>
                        <select id="regEmpInviteStatus" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base">
                            <option value="">-- ‡∏ß‡πà‡∏≤‡∏á --</option>
                            <option value="invite">invite</option>
                        </select>
                    </div>
                </div>
                <p id="regManualError" class="text-red-600 text-sm font-black italic h-4"></p>
            </div>
            <div class="flex justify-end gap-3 font-bold">
                <button id="closeManualRegModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveManualRegButton" class="px-8 py-2 bg-green-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-green-700 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Group Detail -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="groupViewModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
                     <div id="groupViewStatsContainer" class="flex flex-wrap gap-2 mt-2">
                         <span class="px-3 py-1 rounded-full bg-gray-100 text-sm font-bold border uppercase">Total: <span id="groupViewStatsTotal">0</span></span>
                         <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-sm font-bold border border-green-200 uppercase">Reg: <span id="groupViewStatsRegistered">0</span></span>
                     </div>
                 </div>
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">ID</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- MODAL: Lucky Draw Individual -->
    <div id="randomizeModal" class="hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 w-[75%] h-[80vh] flex flex-col mx-4 border-t-8 border-blue-600 relative">
            <button id="closeRandomizeModalButtonX" class="absolute top-2 right-4 text-gray-400 hover:text-gray-600 text-5xl font-light transition-all z-10">&times;</button>
            <h3 class="text-xl font-bold text-center text-gray-900 mb-6 uppercase">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
            <div class="max-w-lg mx-auto mb-8 w-full">
                <label class="block text-sm font-bold text-gray-400 mb-2 text-center">‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏∏‡πà‡∏°</label>
                <div id="indGiftBox" class="flex items-center justify-between bg-blue-50 border-2 border-dashed border-blue-200 rounded-2xl p-3 transition-colors">
                    <div class="flex flex-col text-left">
                        <p id="indGiftDisplayName" class="text-lg font-black text-blue-400 leading-tight">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                        <p id="indGiftDisplayQty" class="text-sm text-black-400 mt-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    </div>
                    <button id="openGiftPickerBtn" class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-blue-700 uppercase">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p><p id="modalParticipantsCount" class="text-2xl font-bold">0</p></div>
                <div class="bg-green-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-green-700 uppercase">‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß</p><p id="modalDrawnCount" class="text-2xl font-bold">0</p></div>
            </div>
            <div class="flex justify-center space-x-2 mb-6 shrink-0">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
            </div>
            <div class="mb-6 flex flex-col items-center shrink-0">
                <button id="startRandomizeButton" class="w-[40%] px-6 py-4 text-base text-white bg-blue-600 rounded-lg font-bold hover:bg-blue-700 shadow-xl active:scale-95 disabled:bg-gray-400 uppercase" disabled>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</button>
                <p id="randomizeError" class="text-red-600 text-base mt-3 font-bold uppercase"></p>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-xl bg-gray-50 font-bold">
                <table class="min-w-full text-base">
                    <thead class="bg-gray-200 sticky top-0 uppercase text-gray-700">
                        <tr><th class="px-4 py-4 text-left">‡∏£‡∏´‡∏±‡∏™</th><th class="px-4 py-4 text-left">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</th><th class="px-4 py-4 text-left">‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th><th class="px-4 py-4 text-center">Action</th></tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL: Gift Picker -->
    <div id="giftPickerModal" class="hidden fixed inset-0 z-[100] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-[70%] modal-enter flex flex-col border-t-8 border-orange-500">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="giftPickerTitle" class="text-xl font-black text-gray-800 uppercase">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
                <button id="closeGiftPickerBtn" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto max-h-[60vh] space-y-2" id="giftPickerList"></div>
        </div>
    </div>

    <!-- POPUP WINNER Detail -->
    <div id="winnerDetailModal" class="hidden fixed inset-0 z-[200] bg-gray-900 bg-opacity-95 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-xl w-full text-center border-t-8 border-blue-600 transform scale-110">
            <h3 class="text-xl font-black text-blue-600 mb-4 uppercase">üéä WINNER üéä</h3>
            <div class="text-6xl mb-6">üèÜ</div>
            <p id="winnerName" class="text-2xl font-black text-gray-900 my-4 leading-tight uppercase"></p>
            <p id="winnerGiftText" class="text-xl font-bold text-orange-600 mb-6"></p>
            <div class="bg-blue-50 p-6 rounded-[2rem] mb-10 border border-blue-100 shadow-inner text-center">
                <p id="winnerEmployeeId" class="text-xl font-black text-blue-800 font-mono"></p>
                <p id="winnerBU" class="text-lg font-bold text-gray-600 mt-2 uppercase"></p>
                <p id="winnerTeam" class="text-base font-medium text-gray-400 mt-2 uppercase"></p>
            </div>
            <div class="flex flex-col gap-4">
                <button id="cancelWinnerButton" class="text-base font-bold text-red-400 hover:text-red-600 hover:underline transition-all uppercase">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Cancel)</button>
                <button id="closeWinnerModalButton" class="px-12 py-3 text-base font-black bg-blue-600 text-white rounded-[1.5rem] hover:bg-blue-700 shadow-2xl active:scale-95 transition-all">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Profile -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-[120] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="editEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="editEmpName" class="font-black text-gray-900 text-lg"></p></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Manager / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="editEmpManager" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Team / ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label><input type="text" id="editEmpTeam" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <p id="editError" class="text-red-600 text-sm font-black italic mt-2"></p>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditModalButton" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Gift -->
    <div id="editGiftModal" class="hidden fixed inset-0 z-[150] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
            <div class="space-y-6">
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label><input type="text" id="editGiftName" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ 50 ‡∏ô‡∏¥‡πâ‡∏ß"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                        <input type="number" id="editGiftTotalQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="1">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                        <input type="number" id="editGiftRemainingQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="0">
                    </div>
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditGiftModalBtn" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditGiftBtn" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmation Center -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[300] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div id="confirmModalInner" class="bg-white rounded-2xl p-10 max-w-lg w-full shadow-2xl text-center transition-all duration-300">
            <h3 id="confirmTitle" class="text-xl font-black mb-4 uppercase text-red-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?</h3>
            <p id="confirmText" class="text-gray-600 font-bold mb-6 leading-relaxed italic text-base"></p>
            
            <div id="confirmInputContainer" class="hidden mb-10">
                <p class="text-sm text-gray-500 mb-2">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <span class="font-bold text-red-600 uppercase">Reset</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <input type="text" id="confirmInput" class="text-center border-2 border-red-200 rounded-lg p-2 w-full focus:border-red-500 outline-none text-sm font-bold uppercase" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            </div>

            <div class="flex justify-center gap-4">
                <button id="closeConfirmButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm font-bold hover:bg-gray-200 uppercase">‡πÑ‡∏°‡πà</button>
                <button id="confirmActionButton" class="px-8 py-2 bg-red-600 text-white rounded-xl text-sm font-black shadow-lg hover:bg-red-700 uppercase">‡πÉ‡∏ä‡πà</button>
            </div>
        </div>
    </div>

    <!-- Script Section -->
    <script type="module">
const _0x54afb4=_0x2521;(function(_0x479237,_0x752343){const _0x271523=_0x2521,_0x5cf420=_0x479237();while(!![]){try{const _0x27084f=parseInt(_0x271523(0x98))/0x1*(-parseInt(_0x271523(0x153))/0x2)+-parseInt(_0x271523(0x10a))/0x3*(parseInt(_0x271523(0x129))/0x4)+-parseInt(_0x271523(0xe6))/0x5*(-parseInt(_0x271523(0x172))/0x6)+-parseInt(_0x271523(0x13f))/0x7*(parseInt(_0x271523(0x125))/0x8)+parseInt(_0x271523(0x177))/0x9+-parseInt(_0x271523(0xdf))/0xa*(parseInt(_0x271523(0x1eb))/0xb)+parseInt(_0x271523(0x93))/0xc;if(_0x27084f===_0x752343)break;else _0x5cf420['push'](_0x5cf420['shift']());}catch(_0x1a3cb8){_0x5cf420['push'](_0x5cf420['shift']());}}}(_0x3902,0xd1dff));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,collection,onSnapshot,doc,updateDoc,setDoc,addDoc,deleteDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':'AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','authDomain':'ttb-register.firebaseapp.com','projectId':_0x54afb4(0x8d),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0x54afb4(0x1c8),'appId':_0x54afb4(0x14e)};function _0x2521(_0xff63e0,_0x3fecbe){_0xff63e0=_0xff63e0-0x73;const _0x39029e=_0x3902();let _0x252171=_0x39029e[_0xff63e0];return _0x252171;}let db,auth,allEmployeesData=[],allGiftsData=[],selectedIndGiftId=null,selectedGroupGiftId=null,giftPickerContext='ind',teamNames=['A1','A2','A3','A4','A5','A6','A7','A8','A9','A10','A11',_0x54afb4(0x168),'A13','A14',_0x54afb4(0x14d),'A16',_0x54afb4(0x1be),_0x54afb4(0x142),'A19','A20','A21',_0x54afb4(0x178),_0x54afb4(0x1ca),'A24','B1','B2','B3','B4','B5','B6','B7','B8','B9','B10',_0x54afb4(0xbc),_0x54afb4(0x1bc),_0x54afb4(0x1e6),_0x54afb4(0x1c2),_0x54afb4(0x19a),_0x54afb4(0x13d),_0x54afb4(0xd7),_0x54afb4(0xae),'B19',_0x54afb4(0x12a),_0x54afb4(0x197),_0x54afb4(0x139),_0x54afb4(0xd8),_0x54afb4(0x7b)],charts={},currentConfirmAction=null,currentEditingDocId=null,currentEditingGiftId=null,drawInterval=null,empSortField='status',empSortDir=_0x54afb4(0xe2);((async()=>{const _0x54a462=_0x54afb4;try{const _0xf307d4=initializeApp(firebaseConfig);db=getFirestore(_0xf307d4),auth=getAuth(_0xf307d4),await signInAnonymously(auth),initCharts(),setupTabs(),setupListeners(),startListening(),startListeningGifts(),document['getElementById'](_0x54a462(0x1bb))[_0x54a462(0xf4)]=teamNames['join'](','),setInterval(()=>{const _0x5363cf=_0x54a462,_0x61f870=new Date();document['getElementById'](_0x5363cf(0xe0))[_0x5363cf(0xfd)]=_0x61f870[_0x5363cf(0xdd)](_0x5363cf(0x124),{'year':_0x5363cf(0x143),'month':_0x5363cf(0xc0),'day':_0x5363cf(0x143),'hour':_0x5363cf(0x123),'minute':_0x5363cf(0x123),'second':'2-digit'});},0x3e8);}catch(_0x121503){console[_0x54a462(0x140)](_0x121503);}})());function setupTabs(){const _0x3d2830=_0x54afb4,_0xdf99ed={'tab-dashboard':_0x3d2830(0x104),'tab-team-list':_0x3d2830(0x18b),'tab-group-view':_0x3d2830(0x1e2),'tab-employee-list':_0x3d2830(0x1a3),'tab-gift-management':'gift-management-content','tab-register':_0x3d2830(0x17b),'tab-group-random':_0x3d2830(0x1de),'tab-winners-list':_0x3d2830(0x85)};Object[_0x3d2830(0x1a5)](_0xdf99ed)[_0x3d2830(0x148)](_0x234abf=>{const _0x3f918f=_0x3d2830,_0x152d1a=document['getElementById'](_0x234abf);if(!_0x152d1a)return;_0x152d1a[_0x3f918f(0xcd)](_0x3f918f(0x78),function(){const _0x3a8430=_0x3f918f;Object['keys'](_0xdf99ed)[_0x3a8430(0x148)](_0x409305=>{const _0x35221b=_0x3a8430,_0x5afd4a=document[_0x35221b(0x14f)](_0x409305),_0x244feb=document[_0x35221b(0x14f)](_0xdf99ed[_0x409305]);if(_0x5afd4a)_0x5afd4a[_0x35221b(0x137)][_0x35221b(0x188)](_0x35221b(0x1c5),_0x35221b(0x187));if(_0x244feb)_0x244feb[_0x35221b(0x137)][_0x35221b(0xb4)](_0x35221b(0x174));}),this[_0x3a8430(0x137)][_0x3a8430(0x188)](_0x3a8430(0x187),_0x3a8430(0x1c5)),document[_0x3a8430(0x14f)](_0xdf99ed[_0x234abf])?.[_0x3a8430(0x137)]['remove']('hidden'),window[_0x3a8430(0x138)](new Event(_0x3a8430(0xf3)));});});}function initCharts(){const _0xac77a9=_0x54afb4,_0x35206c={'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]},'datalabels':{'color':_0xac77a9(0x17e),'font':{'weight':_0xac77a9(0xf0),'size':0xc},'formatter':_0x3e2f7a=>_0x3e2f7a>0x0?_0x3e2f7a:''}}};charts[_0xac77a9(0xe4)]=new Chart(document[_0xac77a9(0x14f)](_0xac77a9(0xb3)),{'type':_0xac77a9(0x12e),'data':{'labels':[_0xac77a9(0xb0),_0xac77a9(0x185)],'datasets':[{'data':[0x0,0x0],'backgroundColor':['#3B82F6',_0xac77a9(0x108)]}]},'options':{..._0x35206c,'cutout':_0xac77a9(0x176)},'plugins':[ChartDataLabels]}),charts[_0xac77a9(0x127)]=new Chart(document[_0xac77a9(0x14f)]('registrationDonutChart'),{'type':_0xac77a9(0x12e),'data':{'labels':[_0xac77a9(0xd4),_0xac77a9(0x1ce)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0xac77a9(0x19b),_0xac77a9(0x159)]}]},'options':{..._0x35206c,'cutout':_0xac77a9(0x176)},'plugins':[ChartDataLabels]});const _0x110e99={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'stacked':!![]},'y':{'stacked':!![]}},'plugins':{'legend':{'display':!![],'position':_0xac77a9(0x1b9),'labels':{'font':{'size':0xc}}},'datalabels':{'color':_0xac77a9(0x17e)}}};charts[_0xac77a9(0x164)]=new Chart(document[_0xac77a9(0x14f)](_0xac77a9(0xc1)),{'type':_0xac77a9(0x1ba),'data':{'labels':[],'datasets':[{'label':'‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','data':[],'backgroundColor':_0xac77a9(0x14b)},{'label':_0xac77a9(0x1e1),'data':[],'backgroundColor':'#BFDBFE'}]},'options':_0x110e99,'plugins':[ChartDataLabels]}),charts[_0xac77a9(0xca)]=new Chart(document[_0xac77a9(0x14f)](_0xac77a9(0x16f)),{'type':_0xac77a9(0x1ba),'data':{'labels':[],'datasets':[{'label':'‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','data':[],'backgroundColor':_0xac77a9(0x14b)},{'label':_0xac77a9(0x1e1),'data':[],'backgroundColor':_0xac77a9(0x11f)}]},'options':_0x110e99,'plugins':[ChartDataLabels]});}function startListening(){const _0x1ff541=_0x54afb4;onSnapshot(collection(db,_0x1ff541(0xd0)),_0xc54d86=>{const _0x24d30f=_0x1ff541;allEmployeesData=_0xc54d86[_0x24d30f(0xb5)][_0x24d30f(0x115)](_0x4da183=>({'id':_0x4da183['id'],..._0x4da183[_0x24d30f(0x8e)]()})),refreshUI();},_0x285bec=>console[_0x1ff541(0x140)](_0x285bec));}function startListeningGifts(){const _0x25f506=_0x54afb4;onSnapshot(collection(db,_0x25f506(0x179)),_0x48931d=>{const _0x3406c8=_0x25f506,_0x479c93=_0x48931d['docs']['map'](_0x4e1bf3=>({'id':_0x4e1bf3['id'],..._0x4e1bf3[_0x3406c8(0x8e)]()}));allGiftsData=_0x479c93[_0x3406c8(0x13a)]((_0x29410e,_0x104604)=>(_0x29410e['order']||0x0)-(_0x104604[_0x3406c8(0xa0)]||0x0)),renderGiftTable(),refreshIndGiftState(),refreshGroupGiftState(),updateWinnersList();},_0x285e9a=>console['error'](_0x285e9a));}function refreshUI(){const _0x59fb9e=_0x54afb4,_0x409fbf=allEmployeesData['filter'](_0x16db76=>_0x16db76['DateLogin']),_0x3cfcef=allEmployeesData['filter'](_0x1ab7b2=>_0x1ab7b2[_0x59fb9e(0x175)]&&_0x1ab7b2[_0x59fb9e(0x7f)]===_0x59fb9e(0x7f)),_0x2dab18=allEmployeesData['filter'](_0x424a84=>_0x424a84[_0x59fb9e(0x175)]&&_0x424a84[_0x59fb9e(0x7f)]!==_0x59fb9e(0x7f)),_0x5115b1=allEmployeesData['filter'](_0x15fa18=>_0x15fa18[_0x59fb9e(0x7f)]===_0x59fb9e(0x7f));document[_0x59fb9e(0x14f)]('managerEmployeeCount')[_0x59fb9e(0xfd)]=allEmployeesData[_0x59fb9e(0xe9)](_0x55c711=>_0x55c711[_0x59fb9e(0x18e)])[_0x59fb9e(0x191)],document[_0x59fb9e(0x14f)](_0x59fb9e(0x83))['textContent']=allEmployeesData[_0x59fb9e(0xe9)](_0x20227c=>_0x20227c['Check_Place'])[_0x59fb9e(0x191)];const _0x32c961=allEmployeesData[_0x59fb9e(0x191)],_0x260c38=_0x409fbf[_0x59fb9e(0x191)],_0x1f3297=_0x32c961-_0x260c38,_0x351070=_0x32c961>0x0?Math[_0x59fb9e(0x1c4)](_0x260c38/_0x32c961*0x64):0x0;document[_0x59fb9e(0x14f)](_0x59fb9e(0x1d5))&&(document[_0x59fb9e(0x14f)](_0x59fb9e(0xee))['textContent']=_0x32c961,document['getElementById'](_0x59fb9e(0xe1))['textContent']=_0x260c38,document[_0x59fb9e(0x14f)](_0x59fb9e(0x1d0))[_0x59fb9e(0xfd)]=_0x1f3297,document[_0x59fb9e(0x14f)](_0x59fb9e(0x165))[_0x59fb9e(0xfd)]=_0x351070+'%',document[_0x59fb9e(0x14f)](_0x59fb9e(0x1d5))[_0x59fb9e(0x137)][_0x59fb9e(0x1a2)]('hidden'));document[_0x59fb9e(0x14f)](_0x59fb9e(0x11e))['textContent']=_0x5115b1[_0x59fb9e(0x191)],document[_0x59fb9e(0x14f)](_0x59fb9e(0x1db))[_0x59fb9e(0xfd)]=_0x3cfcef[_0x59fb9e(0x191)],document[_0x59fb9e(0x14f)]('attendeesCount')[_0x59fb9e(0xfd)]=_0x2dab18['length'],document['getElementById'](_0x59fb9e(0x16c))[_0x59fb9e(0xfd)]=Math[_0x59fb9e(0xbd)](0x0,_0x5115b1[_0x59fb9e(0x191)]-_0x3cfcef[_0x59fb9e(0x191)]),document[_0x59fb9e(0x14f)](_0x59fb9e(0x14c))[_0x59fb9e(0xfd)]=_0x409fbf[_0x59fb9e(0x191)],document['getElementById']('donutPercentage')['textContent']=_0x5115b1['length']?Math['round'](_0x3cfcef['length']/_0x5115b1[_0x59fb9e(0x191)]*0x64)+'%':'0%';charts[_0x59fb9e(0xe4)]&&(charts['breakdown'][_0x59fb9e(0x8e)][_0x59fb9e(0x1cb)][0x0][_0x59fb9e(0x8e)]=[_0x3cfcef[_0x59fb9e(0x191)],_0x2dab18[_0x59fb9e(0x191)]],charts['breakdown'][_0x59fb9e(0x157)]());charts['goal']&&(charts['goal'][_0x59fb9e(0x8e)][_0x59fb9e(0x1cb)][0x0][_0x59fb9e(0x8e)]=[_0x3cfcef[_0x59fb9e(0x191)],Math[_0x59fb9e(0xbd)](0x0,_0x5115b1[_0x59fb9e(0x191)]-_0x3cfcef[_0x59fb9e(0x191)])],charts['goal'][_0x59fb9e(0x157)]());const _0x6fef24={};teamNames['forEach'](_0x386ec1=>_0x6fef24[_0x386ec1]={'r':0x0,'t':0x0}),allEmployeesData['forEach'](_0x34f53a=>{const _0x2f02fb=_0x59fb9e;if(_0x34f53a[_0x2f02fb(0x130)]&&_0x6fef24[_0x34f53a[_0x2f02fb(0x130)]]){_0x6fef24[_0x34f53a[_0x2f02fb(0x130)]]['t']++;if(_0x34f53a['DateLogin'])_0x6fef24[_0x34f53a[_0x2f02fb(0x130)]]['r']++;}});const _0x452322=Math['ceil'](teamNames[_0x59fb9e(0x191)]/0x2);charts[_0x59fb9e(0x164)]&&(charts[_0x59fb9e(0x164)]['data']['labels']=teamNames[_0x59fb9e(0xa7)](0x0,_0x452322),charts[_0x59fb9e(0x164)][_0x59fb9e(0x8e)]['datasets'][0x0][_0x59fb9e(0x8e)]=teamNames[_0x59fb9e(0xa7)](0x0,_0x452322)['map'](_0x497e4c=>_0x6fef24[_0x497e4c]['r']),charts[_0x59fb9e(0x164)][_0x59fb9e(0x8e)][_0x59fb9e(0x1cb)][0x1][_0x59fb9e(0x8e)]=teamNames[_0x59fb9e(0xa7)](0x0,_0x452322)[_0x59fb9e(0x115)](_0x111eff=>_0x6fef24[_0x111eff]['t']-_0x6fef24[_0x111eff]['r']),charts[_0x59fb9e(0x164)]['update']());charts[_0x59fb9e(0xca)]&&(charts[_0x59fb9e(0xca)][_0x59fb9e(0x8e)][_0x59fb9e(0x192)]=teamNames[_0x59fb9e(0xa7)](_0x452322),charts['bar2'][_0x59fb9e(0x8e)][_0x59fb9e(0x1cb)][0x0][_0x59fb9e(0x8e)]=teamNames[_0x59fb9e(0xa7)](_0x452322)[_0x59fb9e(0x115)](_0x4e8e6b=>_0x6fef24[_0x4e8e6b]['r']),charts[_0x59fb9e(0xca)][_0x59fb9e(0x8e)]['datasets'][0x1]['data']=teamNames[_0x59fb9e(0xa7)](_0x452322)['map'](_0x3b4691=>_0x6fef24[_0x3b4691]['t']-_0x6fef24[_0x3b4691]['r']),charts[_0x59fb9e(0xca)][_0x59fb9e(0x157)]());const _0x1d648=[..._0x409fbf]['sort']((_0xc30bc1,_0x570d65)=>(_0x570d65['DateLogin']?.[_0x59fb9e(0x163)]()||0x0)-(_0xc30bc1[_0x59fb9e(0x175)]?.[_0x59fb9e(0x163)]()||0x0))[_0x59fb9e(0xa7)](0x0,0x1e);document[_0x59fb9e(0x14f)]('latestRegistrationsTableBody')[_0x59fb9e(0xdc)]=_0x1d648[_0x59fb9e(0x115)](_0x17687f=>_0x59fb9e(0x7e)+_0x17687f[_0x59fb9e(0x9c)]+'</td><td\x20class=\x22px-4\x20py-0\x20uppercase\x20font-bold\x20text-xm\x20text-left\x22>'+_0x17687f[_0x59fb9e(0x180)]+_0x59fb9e(0x1e9)+(_0x17687f[_0x59fb9e(0x16d)]||'-')+_0x59fb9e(0x1e9)+(_0x17687f[_0x59fb9e(0x18e)]||'-')+'</td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20class=\x22px-3\x20py-0\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span></td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22cancelReg(\x27'+_0x17687f['id']+_0x59fb9e(0xfa)+_0x17687f[_0x59fb9e(0x180)]+'\x27)\x22\x20class=\x22text-red-600\x20hover:text-red-700\x20cursor-pointer\x20font-black\x20text-xs\x22>‡∏•‡∏ö</span></td></tr>')['join'](''),updateTeamTab(),updateGridTab(),updateEmployeeList(),updateGroupRandomUI(),updateLuckyDrawStats(),updateWinnersList();}function updateWinnersList(){const _0x2c4d22=_0x54afb4,_0x4837a9=document[_0x2c4d22(0x14f)](_0x2c4d22(0xeb));if(!_0x4837a9)return;const _0x5eeb00=allEmployeesData[_0x2c4d22(0xe9)](_0x306045=>_0x306045[_0x2c4d22(0xcc)]);if(_0x5eeb00[_0x2c4d22(0x191)]===0x0){_0x4837a9[_0x2c4d22(0xdc)]=_0x2c4d22(0x1b2);return;}_0x4837a9[_0x2c4d22(0xdc)]=allGiftsData[_0x2c4d22(0x115)](_0x5738d0=>{const _0x235896=_0x2c4d22,_0x2d6569=_0x5eeb00['filter'](_0x503fea=>_0x503fea[_0x235896(0x1e8)]===_0x5738d0['id']||_0x503fea[_0x235896(0x17f)]===_0x5738d0[_0x235896(0x1d4)]&&!_0x503fea[_0x235896(0x1e8)]);if(_0x2d6569['length']===0x0)return'';return _0x2d6569[_0x235896(0x13a)]((_0x30f555,_0x54db6d)=>(_0x54db6d[_0x235896(0xcc)]?.[_0x235896(0x163)]()||0x0)-(_0x30f555[_0x235896(0xcc)]?.[_0x235896(0x163)]()||0x0)),_0x235896(0x181)+_0x5738d0[_0x235896(0x1d4)]+_0x235896(0x10e)+_0x2d6569[_0x235896(0x191)]+_0x235896(0x152)+_0x2d6569[_0x235896(0x115)]((_0x262a06,_0x23c53e)=>{const _0x86fa0e=_0x235896,_0x381d2b=_0x262a06[_0x86fa0e(0x1cf)]?!![]:![],_0x203ead=_0x381d2b?_0x86fa0e(0x189):_0x86fa0e(0xda),_0x5d9793=_0x381d2b?_0x86fa0e(0x1cd):'bg-red-500\x20text-white\x20cursor-pointer\x20hover:bg-red-600',_0x369559=_0x381d2b?'':_0x86fa0e(0xc9)+_0x262a06['id']+_0x86fa0e(0x1ea);return _0x86fa0e(0xec)+(_0x23c53e+0x1)+_0x86fa0e(0xea)+_0x262a06[_0x86fa0e(0x9c)]+_0x86fa0e(0x145)+_0x262a06[_0x86fa0e(0x180)]+_0x86fa0e(0x1da)+(_0x262a06[_0x86fa0e(0x16d)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-xm\x20text-left\x22>'+(_0x262a06[_0x86fa0e(0x18e)]||'-')+_0x86fa0e(0x9f)+(_0x262a06[_0x86fa0e(0x130)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20'+_0x369559+_0x86fa0e(0x90)+_0x5d9793+'\x22>'+_0x203ead+_0x86fa0e(0x103)+_0x262a06['id']+_0x86fa0e(0xc8);})[_0x235896(0x195)]('')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';})[_0x2c4d22(0x195)]('');}window['markAsReceived']=async _0x2af20b=>{const _0x15263a=_0x54afb4;try{await updateDoc(doc(db,_0x15263a(0xd0),_0x2af20b),{'ReceivedTime':serverTimestamp()});}catch(_0x2c0b97){console[_0x15263a(0x140)](_0x2c0b97);}};async function addGift(){const _0x3d1558=_0x54afb4,_0x349732=document[_0x3d1558(0x14f)](_0x3d1558(0x1ac))['value']['trim'](),_0x231994=parseInt(document[_0x3d1558(0x14f)](_0x3d1558(0x88))[_0x3d1558(0xf4)]);if(!_0x349732||isNaN(_0x231994))return;const _0x41d6e5=allGiftsData[_0x3d1558(0xab)]((_0x5e4393,_0xb51c62)=>Math[_0x3d1558(0xbd)](_0x5e4393,_0xb51c62['order']||0x0),0x0);await addDoc(collection(db,_0x3d1558(0x179)),{'name':_0x349732,'totalQty':_0x231994,'remainingQty':_0x231994,'status':'on','order':_0x41d6e5+0x1,'createdAt':serverTimestamp()}),document['getElementById'](_0x3d1558(0x1ac))[_0x3d1558(0xf4)]='',document[_0x3d1558(0x14f)](_0x3d1558(0x88))[_0x3d1558(0xf4)]='1';}function renderGiftTable(){const _0x4ce98e=_0x54afb4,_0x45fffa=document['getElementById'](_0x4ce98e(0x1d3));if(allGiftsData[_0x4ce98e(0x191)]===0x0){_0x45fffa[_0x4ce98e(0xdc)]='<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-400\x20font-bold\x22>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>';return;}_0x45fffa['innerHTML']=allGiftsData[_0x4ce98e(0x115)]((_0x5b46ba,_0x52329a)=>_0x4ce98e(0x96)+(_0x5b46ba[_0x4ce98e(0xa0)]||_0x52329a+0x1)+_0x4ce98e(0x1c1)+_0x5b46ba['id']+_0x4ce98e(0x198)+_0x5b46ba['name']+_0x4ce98e(0x18f)+_0x5b46ba[_0x4ce98e(0x154)]+_0x4ce98e(0xf5)+_0x5b46ba[_0x4ce98e(0x1a4)]+_0x4ce98e(0x15b)+_0x5b46ba['id']+'\x27,\x20\x27'+_0x5b46ba[_0x4ce98e(0xb6)]+_0x4ce98e(0x183)+(_0x5b46ba[_0x4ce98e(0xb6)]==='on'?'bg-green-400\x20text-white\x20border-green-600':'bg-gray-200\x20text-gray-600')+'\x22>'+(_0x5b46ba[_0x4ce98e(0xb6)]==='on'?'ON':_0x4ce98e(0x10d))+_0x4ce98e(0xa6)+_0x5b46ba['id']+_0x4ce98e(0x1a7)+_0x5b46ba['id']+_0x4ce98e(0xfa)+_0x5b46ba[_0x4ce98e(0x1d4)]+_0x4ce98e(0x8f))['join']('');}window[_0x54afb4(0xd2)]=async(_0x4579a7,_0x37d8d3)=>{const _0x113a63=_0x54afb4,_0x413f12=parseInt(_0x37d8d3);if(!isNaN(_0x413f12))await updateDoc(doc(db,_0x113a63(0x179),_0x4579a7),{'order':_0x413f12});},window[_0x54afb4(0x184)]=async(_0x481575,_0x37affc)=>{await updateDoc(doc(db,'crsg_gift',_0x481575),{'status':_0x37affc==='on'?'off':'on'});},window[_0x54afb4(0x1b8)]=_0x1d55e9=>{const _0x216dbd=_0x54afb4,_0x2ed507=allGiftsData[_0x216dbd(0x84)](_0x235052=>_0x235052['id']===_0x1d55e9);if(!_0x2ed507)return;currentEditingGiftId=_0x1d55e9,document[_0x216dbd(0x14f)](_0x216dbd(0xf9))[_0x216dbd(0xf4)]=_0x2ed507[_0x216dbd(0x1d4)],document['getElementById'](_0x216dbd(0x167))[_0x216dbd(0xf4)]=_0x2ed507[_0x216dbd(0x154)],document[_0x216dbd(0x14f)](_0x216dbd(0x193))[_0x216dbd(0xf4)]=_0x2ed507[_0x216dbd(0x1a4)],document[_0x216dbd(0x14f)](_0x216dbd(0x119))[_0x216dbd(0x137)][_0x216dbd(0x1a2)](_0x216dbd(0x174));},window[_0x54afb4(0x112)]=(_0x4940d5,_0x5e32bd)=>{const _0x5e5b51=_0x54afb4,_0x4fad17=document[_0x5e5b51(0x14f)](_0x5e5b51(0x11a));_0x4fad17[_0x5e5b51(0x113)]=_0x5e5b51(0x97),currentConfirmAction=async()=>{const _0x3542f3=_0x5e5b51;await deleteDoc(doc(db,_0x3542f3(0x179),_0x4940d5)),document['getElementById'](_0x3542f3(0x150))[_0x3542f3(0x137)]['add'](_0x3542f3(0x174));},document[_0x5e5b51(0x14f)]('confirmTitle')[_0x5e5b51(0xfd)]=_0x5e5b51(0xef),document[_0x5e5b51(0x14f)](_0x5e5b51(0x1ae))[_0x5e5b51(0xfd)]=_0x5e5b51(0x1e0)+_0x5e32bd+_0x5e5b51(0x1ab),document['getElementById']('confirmInputContainer')['classList'][_0x5e5b51(0xb4)](_0x5e5b51(0x174)),document['getElementById'](_0x5e5b51(0x150))['classList'][_0x5e5b51(0x1a2)](_0x5e5b51(0x174));};function renderGiftPicker(){const _0x51e264=_0x54afb4,_0x2c078d=document[_0x51e264(0x14f)](_0x51e264(0x147)),_0x3f218c=allGiftsData[_0x51e264(0xe9)](_0x5f297b=>_0x5f297b['status']==='on'&&_0x5f297b[_0x51e264(0x1a4)]>0x0);document['getElementById']('giftPickerTitle')[_0x51e264(0xfd)]=giftPickerContext===_0x51e264(0xc7)?_0x51e264(0x1c3):_0x51e264(0x111);if(!_0x3f218c[_0x51e264(0x191)]){_0x2c078d[_0x51e264(0xdc)]=_0x51e264(0xa4);return;}const _0x1f0870=giftPickerContext===_0x51e264(0xc7)?selectedIndGiftId:selectedGroupGiftId;_0x2c078d[_0x51e264(0xdc)]=_0x3f218c[_0x51e264(0x115)](_0x146752=>{const _0x53d772=_0x51e264,_0x3c96d3=_0x146752['id']===_0x1f0870;return'<div\x20onclick=\x22pickGift(\x27'+_0x146752['id']+_0x53d772(0x1af)+(_0x3c96d3?_0x53d772(0x7d):_0x53d772(0x194))+_0x53d772(0xa2)+(_0x3c96d3?_0x53d772(0x9b):_0x53d772(0x144))+'\x20uppercase\x22>'+_0x146752[_0x53d772(0x1d4)]+_0x53d772(0x156)+(_0x3c96d3?_0x53d772(0x114):_0x53d772(0x1a6))+_0x53d772(0xfe)+_0x146752[_0x53d772(0x1a4)]+_0x53d772(0x1bd)+(_0x3c96d3?_0x53d772(0xa8):'bg-gray-100\x20text-gray-500')+_0x53d772(0x1ad)+(_0x3c96d3?_0x53d772(0x18d):_0x53d772(0x8c))+_0x53d772(0xfc);})['join']('');}window['pickGift']=_0x21241d=>{const _0x582283=_0x54afb4;giftPickerContext===_0x582283(0xc7)?(selectedIndGiftId=_0x21241d,refreshIndGiftState()):(selectedGroupGiftId=_0x21241d,document[_0x582283(0x14f)](_0x582283(0x109))[_0x582283(0xdc)]='',document[_0x582283(0x14f)]('grBoxRight')['innerHTML']='',refreshGroupGiftState()),document[_0x582283(0x14f)]('giftPickerModal')[_0x582283(0x137)]['add'](_0x582283(0x174));};function _0x3902(){const _0x2fa37c=['closeGroupViewModalButton','winnerTeam','editEmpManager','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20onclick=\x22openGroupDetail(\x27','click','<option\x20value=\x22','closeWinnerModalButton','B24','text-sm\x20font-bold\x20text-gray-600\x20mt-1','bg-blue-100\x20border-blue-500\x20shadow-md','<tr><td\x20class=\x22px-4\x20py-0\x20text-center\x22>','invite','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20text-center\x20text-orange-600\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center','teamMemberCountElem','find','winners-list-content','openGiftPickerBtn','asc','giftQtyInput','searchRegEmployeeError','\x20p-2\x20rounded-[8px]\x20border\x20text-center\x20shadow-sm\x20cursor-pointer\x20hover:shadow-md\x20transition-all\x20active:scale-95\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-[10px]\x20font-black\x20text-blue-700\x20uppercase\x22>','editEmp','Select','ttb-register','data','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x22>Delete</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20class=\x22px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-black\x20transition-all\x20shadow-sm\x20','sort-emp-manager','\x22,\x22‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô\x22\x0a','8910624aXDSBT','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22editEmp(\x27','regEmpId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><input\x20type=\x22number\x22\x20value=\x22','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center\x20transition-all\x20duration-300','1VpvUQA','split','manager','text-blue-800','employeeId','\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)','manualRegisterModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-blue-600\x20font-bold\x20uppercase\x20text-xm\x20text-left\x22>','order','loading-gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-black\x20','closeEditModalButton','<p\x20class=\x22text-center\x20py-10\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠\x20--</p>','member','</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><span\x20onclick=\x22editGift(\x27','slice','bg-blue-600\x20text-white','confirmActionButton','digit','reduce','download','teamBoxesContainer','B18','giftPickerModal','Invite','regEmpManager','drawnWinnersTableBody','registrationBreakdownChart','add','docs','status','closeEditGiftModalBtn','‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô\x20(‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô\x20invite)','options','createObjectURL','saveEditGiftBtn','B11','max','confirmTitle','padStart','long','teamBarChart1','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20cursor-pointer\x20font-bold\x20text-lg\x20ml-3\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','randomizeButton','<option\x20value=\x22\x22>--\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°\x20--</option>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','closeGiftPickerBtn','ind','\x27)\x22\x20class=\x22px-3\x20py-0\x20bg-red-100\x20text-red-600\x20rounded-lg\x20text-xs\x20font-black\x20hover:bg-red-600\x20hover:text-white\x20transition-all\x20uppercase\x22>‡∏•‡∏ö</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','onclick=\x22markAsReceived(\x27','bar2','openGroupGiftPickerBtn','RandomTime','addEventListener','toUpperCase','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å','crsg','grGiftBox','updateGiftOrder','text-base\x20font-black\x20text-blue-600\x20leading-tight\x20uppercase','Registered','‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö','cancelReg','B17','B23','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö','saveEditModalButton','innerHTML','toLocaleString','regManualError','484630LKnERb','currentDateTime','empStatsRegistered','desc','editEmployeeModal','breakdown','Employee_List_Report.csv','224940KMErWM','confirmInputContainer','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-gray-600\x20text-left\x22>','filter','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-mono\x20font-black\x20text-blue-700\x20text-sm\x22>','winnersByGiftContainer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20transition-colors\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-bold\x20text-gray-400\x20text-xs\x22>','closeRandomizeModalButtonX','empStatsTotal','‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','bold','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20bg-blue-50\x20p-2.5\x20rounded-xl\x20border\x20border-blue-100\x20winner-row-animate\x20shadow-sm\x20mb-1.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-blue-600\x20text-white\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center\x20rounded-full\x20text-[9px]\x20font-bold\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-blue-800\x22>','resize','value','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-blue-600\x20font-bold\x22>','<tr\x20class=\x22','randomizeModal','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200','editGiftName','\x27,\x20\x27','updateTeamNamesBtn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','textContent','\x20font-bold\x22>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','includes','--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--','text-sm\x20font-bold\x20text-gray-300\x20mt-1','employeeListTableBody','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22removeLuckyWinner(\x27','dashboard-content','randomizeError','sort-emp-status','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-700\x20text-xm\x20text-center\x22>','#F59E0B','grBoxLeft','488169exZKSO','\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-bold\x20uppercase\x20cursor-pointer\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20uppercase\x20font-bold\x20text-left\x22>','OFF','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-indigo-600\x20text-white\x20px-3\x20py-1\x20rounded-full\x20text-xs\x20font-bold\x20uppercase\x22>','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20text-left\x20text-gray-600\x22>','‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','deleteGift','className','text-blue-600','map','closeConfirmButton','selectedTeamTableBody','‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß','editGiftModal','confirmModalInner','‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á\x20[','teamSelect','closeManualRegModalButton','targetCount','#BFDBFE','‡∏™‡∏≤‡∏Ç‡∏≤:\x20','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-2\x20py-0.5\x20rounded\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','regEmpSeat','2-digit','th-TH','224RSBONO','addGiftBtn','goal','winnerDetailModal','12XNFBvO','B20','teamStatsContainer','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x22>','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','doughnut','trim','Check_Place','‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','RESET','disabled','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','bg-orange-100','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô','classList','dispatchEvent','B22','sort','startRandomizeButton','</span>','B16','\x22,\x22','132559PscXIe','error','bg-yellow-50','A18','numeric','text-base\x20text-gray-800','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20uppercase\x20text-xm\x20text-left\x22>','groupViewTableBody','giftPickerList','forEach','</td><td\x20class=\x22px-4\x20py-4\x20text-xm\x20font-bold\x20text-gray-500\x20uppercase\x20text-left\x22>','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xs\x20uppercase\x20shadow-sm\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','#3B82F6','breakdownCenterTotal','A15','1:1070273157855:web:5c8120e1df27e233d8676a','getElementById','confirmModal','div','\x20‡∏ó‡πà‡∏≤‡∏ô</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22overflow-x-auto\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22min-w-full\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-header-gray\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏£‡∏´‡∏±‡∏™</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏≤‡∏Ç‡∏≤</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20class=\x22divide-y\x20divide-gray-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','316978lWkrmn','totalQty','confirmInput','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22','update','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#E5E7EB','bg-green-100','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><button\x20onclick=\x22toggleGiftStatus(\x27','Winners_Report.csv','text/csv;charset=utf-8;','gift','grGiftDisplayName','regEmpInviteStatus','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-xm\x20uppercase\x20font-normal\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text-base\x20font-black\x20text-gray-400\x20leading-tight\x20uppercase','toMillis','bar1','empStatsPercent','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-sm\x20font-normal\x20text-gray-400\x22>','editGiftTotalQty','A12','groupViewModalTitle','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:\x20','remainingCount','Branch_eng',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22removeLuckyWinner(\x27','teamBarChart2','sort-emp-name','searchRegEmployeeButton','138oZaYHS','groupViewManagerFilter','hidden','DateLogin','75%','6695055NiDQhy','A22','crsg_gift','\ufeff‡∏•‡∏≥‡∏î‡∏±‡∏ö,‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,Member,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','register-content','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-xm\x20text-blue-500\x20uppercase\x22>','indGiftDisplayName','#fff','AwardedGift','FullName_th','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-white\x20border\x20border-gray-100\x20rounded-2xl\x20overflow-hidden\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-gray-50\x20px-6\x20py-4\x20border-b\x20flex\x20justify-between\x20items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-black\x20text-indigo-700\x20uppercase\x22>üéÅ\x20‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','resetTeamButton','\x27)\x22\x20class=\x22px-4\x20py-1\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x20border\x20','toggleGiftStatus','Non-Invite','searchEmployeeError','bg-gray-100','replace','‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20text-xs\x20uppercase\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','team-list-content','regEmpName','Selected','Check_Manager','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22>','\x27)\x22\x20class=\x22','length','labels','editGiftRemainingQty','bg-white\x20border-gray-100','join','editEmpId','B21','\x27,\x20this.value)\x22\x20class=\x22w-16\x20p-1\x20text-center\x20border\x20rounded\x20font-bold\x20text-blue-600\x22\x20min=\x221\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20font-normal\x22>','grBoxRight','B15','#10B981','<tr><td\x20class=\x22px-4\x20py-4\x20font-mono\x20font-black\x20text-blue-700\x20text-center\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-xm\x20uppercase\x20text-gray-400\x20text-left\x22>','</option>','<option\x20value=\x22\x22>--\x20‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','grDrawCount','grTotalWinners','remove','employee-list-content','remainingQty','keys','text-gray-500','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20mr-2\x22>Edit</span>|\x20<span\x20onclick=\x22deleteGift(\x27','sort-emp-id','createElement','href',']\x20?','giftNameInput','\x20rounded-lg\x20text-sm\x20font-black\x20uppercase\x22>','confirmText','\x27)\x22\x20class=\x22flex\x20items-center\x20justify-between\x20p-4\x20border\x20rounded-xl\x20hover:bg-blue-50\x20cursor-pointer\x20transition-all\x20','searchRegEmployeeIdInput','loader','<div\x20class=\x22p-10\x20text-center\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--</div>','gvOverallStatsContainer','groupViewModal','indGiftDisplayQty','\x20hover:bg-gray-50\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-gray-400\x20text-xs\x22>','group','editGift','bottom','bar','definedTeamNamesInput','B12','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22px-4\x20py-1\x20','A17','winnerGiftText','commit','\x22\x20onchange=\x22updateGiftOrder(\x27','B14','‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','round','bg-gray-300','#loader','random','1070273157855','editEmpTeam','A23','datasets','groupViewStatsTotal','bg-green-500\x20text-white','Remaining','ReceivedTime','empStatsUnregistered','winnerName','sort-emp-member','giftListTableBody','name','empStatsContainer','grStartDrawBtn','\x20‡∏ä‡∏¥‡πâ‡∏ô','</td><td\x20class=\x22px-4\x20py-4\x20text-center\x22><span\x20onclick=\x22removeLuckyWinner(\x27','branch','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-xm\x20text-left\x22>','participantsCountBox','gvOverallStatsRegistered','<option\x20value=\x22\x22>--\x20‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','group-random-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö\x20[','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á','group-view-content','change','‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','teamStatsTotal','B13','Registration_Report.csv','AwardedGiftId','</td><td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-xm\x20text-left\x22>','\x27)\x22','110mkNGba','grRemainingEligible','\x27)\x22\x20class=\x22bg-red-100\x20text-red-700\x20px-3\x20py-1\x20rounded\x20text-[10px]\x20font-normal\x20uppercase\x20cursor-pointer\x20hover:bg-red-200\x20transition-all\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'];_0x3902=function(){return _0x2fa37c;};return _0x3902();}function refreshIndGiftState(){const _0x4280fe=_0x54afb4,_0xf19230=document[_0x4280fe(0x14f)](_0x4280fe(0x17d)),_0x2a508c=document[_0x4280fe(0x14f)](_0x4280fe(0x1b5)),_0x1304d7=document[_0x4280fe(0x14f)](_0x4280fe(0x13b));if(!selectedIndGiftId){_0xf19230['textContent']='--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--',_0x2a508c[_0x4280fe(0xfd)]=_0x4280fe(0x10f),_0x1304d7[_0x4280fe(0x133)]=!![];return;}const _0x10266f=allGiftsData[_0x4280fe(0x84)](_0x2f0964=>_0x2f0964['id']===selectedIndGiftId);!_0x10266f||_0x10266f['remainingQty']<=0x0?(_0xf19230[_0x4280fe(0xfd)]=_0x10266f?_0x10266f[_0x4280fe(0x1d4)]+'\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)':_0x4280fe(0x100),_0x2a508c[_0x4280fe(0xfd)]='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200',_0x1304d7[_0x4280fe(0x133)]=!![]):(_0xf19230['textContent']=_0x10266f['name'],_0x2a508c[_0x4280fe(0xfd)]=_0x4280fe(0x16a)+_0x10266f['remainingQty']+'\x20‡∏ä‡∏¥‡πâ‡∏ô',_0x1304d7['disabled']=![]);}function refreshGroupGiftState(){const _0x3019fc=_0x54afb4,_0x597bb8=document['getElementById'](_0x3019fc(0x15f)),_0x40cbc6=document[_0x3019fc(0x14f)]('grGiftDisplayQty'),_0x36a4b0=document['getElementById'](_0x3019fc(0xd1)),_0x51a85f=document[_0x3019fc(0x14f)](_0x3019fc(0x1d6)),_0x5a5184=document[_0x3019fc(0x14f)](_0x3019fc(0x1a0));if(!selectedGroupGiftId){_0x597bb8[_0x3019fc(0xfd)]='--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--',_0x597bb8[_0x3019fc(0x113)]=_0x3019fc(0x162),_0x40cbc6[_0x3019fc(0xfd)]=_0x3019fc(0x10f),_0x40cbc6[_0x3019fc(0x113)]=_0x3019fc(0x101),_0x36a4b0[_0x3019fc(0x113)]='flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all',_0x5a5184['value']=0x0,_0x51a85f[_0x3019fc(0x133)]=!![];return;}const _0x1a87c4=allGiftsData[_0x3019fc(0x84)](_0x20bb98=>_0x20bb98['id']===selectedGroupGiftId);!_0x1a87c4||_0x1a87c4[_0x3019fc(0x1a4)]<=0x0?(_0x597bb8[_0x3019fc(0xfd)]=_0x1a87c4?_0x1a87c4[_0x3019fc(0x1d4)]+_0x3019fc(0x9d):_0x3019fc(0x100),_0x597bb8[_0x3019fc(0x113)]='text-base\x20font-black\x20text-red-400\x20leading-tight\x20uppercase',_0x40cbc6['textContent']=_0x3019fc(0xf8),_0x36a4b0['className']=_0x3019fc(0xd9),_0x5a5184['value']=0x0,_0x51a85f[_0x3019fc(0x133)]=!![]):(_0x597bb8[_0x3019fc(0xfd)]=_0x1a87c4[_0x3019fc(0x1d4)],_0x597bb8[_0x3019fc(0x113)]=_0x3019fc(0xd3),_0x40cbc6[_0x3019fc(0xfd)]='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20'+_0x1a87c4[_0x3019fc(0x1a4)]+_0x3019fc(0x1d7),_0x40cbc6[_0x3019fc(0x113)]=_0x3019fc(0x7c),_0x36a4b0[_0x3019fc(0x113)]='flex\x20items-center\x20justify-between\x20bg-blue-50\x20border-2\x20border-blue-300\x20rounded-xl\x20p-3\x20transition-all',_0x5a5184[_0x3019fc(0xf4)]=_0x1a87c4[_0x3019fc(0x1a4)],_0x5a5184[_0x3019fc(0xbd)]=_0x1a87c4[_0x3019fc(0x1a4)],_0x51a85f[_0x3019fc(0x133)]=![]);}async function startGroupRandomDraw(){const _0x1b8084=_0x54afb4,_0x4873a9=parseInt(document[_0x1b8084(0x14f)]('grDrawCount')[_0x1b8084(0xf4)])||0x0,_0x4faa33=allEmployeesData[_0x1b8084(0xe9)](_0x415de8=>_0x415de8[_0x1b8084(0x175)]&&_0x415de8[_0x1b8084(0x7f)]===_0x1b8084(0x7f)&&!_0x415de8[_0x1b8084(0xcc)]);if(!selectedGroupGiftId)return;const _0x12a3a6=allGiftsData[_0x1b8084(0x84)](_0x24d80d=>_0x24d80d['id']===selectedGroupGiftId);if(_0x4873a9<=0x0||_0x4faa33['length']<_0x4873a9||_0x12a3a6[_0x1b8084(0x1a4)]<_0x4873a9)return;const _0x537e0e=document[_0x1b8084(0x14f)](_0x1b8084(0x1d6));_0x537e0e['disabled']=!![];const _0x3bdab6=document[_0x1b8084(0x14f)](_0x1b8084(0x109)),_0x595159=document['getElementById'](_0x1b8084(0x199));_0x3bdab6[_0x1b8084(0xdc)]='',_0x595159[_0x1b8084(0xdc)]='';const _0x2725c3=[..._0x4faa33][_0x1b8084(0x13a)](()=>0.5-Math['random']())[_0x1b8084(0xa7)](0x0,_0x4873a9);await updateDoc(doc(db,_0x1b8084(0x179),selectedGroupGiftId),{'remainingQty':_0x12a3a6[_0x1b8084(0x1a4)]-_0x4873a9});const _0x4c8d17=Math['ceil'](_0x4873a9/0x2),_0x5eefab=_0x2725c3[_0x1b8084(0xa7)](0x0,_0x4c8d17),_0x494ac8=_0x2725c3[_0x1b8084(0xa7)](_0x4c8d17),_0x23bc64=_0x49618c=>{const _0x8cfd89=_0x1b8084,_0x351b42=document['createElement'](_0x8cfd89(0x151));_0x351b42['id']=_0x8cfd89(0x1b1),_0x351b42[_0x8cfd89(0x113)]=_0x8cfd89(0xa1),_0x49618c['appendChild'](_0x351b42);},_0x575820=_0x42ed3a=>{const _0x49cf2f=_0x1b8084,_0x348309=_0x42ed3a['querySelector'](_0x49cf2f(0x1c6));if(_0x348309)_0x348309[_0x49cf2f(0x1a2)]();};for(let _0x5e6071=0x0;_0x5e6071<_0x5eefab['length'];_0x5e6071++){_0x23bc64(_0x3bdab6),await new Promise(_0x97a866=>setTimeout(_0x97a866,0x3e8)),_0x575820(_0x3bdab6);const _0x2c7305=_0x5eefab[_0x5e6071];_0x3bdab6['innerHTML']+=createWinnerItemHTML(_0x5e6071+0x1,_0x2c7305),await updateWinnerInDB(_0x2c7305,_0x12a3a6[_0x1b8084(0x1d4)],selectedGroupGiftId);}for(let _0xe7bff=0x0;_0xe7bff<_0x494ac8['length'];_0xe7bff++){_0x23bc64(_0x595159),await new Promise(_0x516062=>setTimeout(_0x516062,0x3e8)),_0x575820(_0x595159);const _0x110f26=_0x494ac8[_0xe7bff];_0x595159[_0x1b8084(0xdc)]+=createWinnerItemHTML(_0x4c8d17+_0xe7bff+0x1,_0x110f26),await updateWinnerInDB(_0x110f26,_0x12a3a6[_0x1b8084(0x1d4)],selectedGroupGiftId);}_0x537e0e[_0x1b8084(0x133)]=![],confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}});}function createWinnerItemHTML(_0x455ae2,_0x48a394){const _0x3e2084=_0x54afb4;return _0x3e2084(0xf1)+_0x455ae2+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-black\x20text-gray-800\x20uppercase\x20text-left\x22>'+_0x48a394[_0x3e2084(0x180)]+'\x20('+_0x48a394['employeeId']+_0x3e2084(0x16e)+_0x48a394['id']+_0x3e2084(0xc2);}async function updateWinnerInDB(_0x39f27c,_0x497a3e,_0x331578){const _0xe207c3=_0x54afb4;await updateDoc(doc(db,_0xe207c3(0xd0),_0x39f27c['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x497a3e,'AwardedGiftId':_0x331578});}async function runIndividualLuckyDraw(){const _0x39c68c=_0x54afb4,_0x433d62=document[_0x39c68c(0x14f)](_0x39c68c(0x105));_0x433d62[_0x39c68c(0xfd)]='';const _0x4b0cc2=allEmployeesData[_0x39c68c(0xe9)](_0x5f2a62=>_0x5f2a62['DateLogin']&&_0x5f2a62[_0x39c68c(0x7f)]===_0x39c68c(0x7f)&&!_0x5f2a62[_0x39c68c(0xcc)]);if(!selectedIndGiftId){_0x433d62[_0x39c68c(0xfd)]=_0x39c68c(0x136);return;}if(!_0x4b0cc2[_0x39c68c(0x191)]){_0x433d62['textContent']=_0x39c68c(0xb8);return;}const _0xfe72b5=allGiftsData[_0x39c68c(0x84)](_0x1f1d99=>_0x1f1d99['id']===selectedIndGiftId);if(!_0xfe72b5||_0xfe72b5[_0x39c68c(0x1a4)]<=0x0){_0x433d62['textContent']=_0x39c68c(0x118);return;}const _0x5bfc02=document['getElementById'](_0x39c68c(0x13b));_0x5bfc02[_0x39c68c(0x133)]=!![];const _0x5b1d8e=[0x1,0x2,0x3,0x4,0x5]['map'](_0x448c62=>document['getElementById'](_0x39c68c(0xaa)+_0x448c62));let _0x2a6e9b=0x0;drawInterval=setInterval(()=>{const _0x573d11=_0x39c68c;_0x5b1d8e['forEach'](_0x279bf3=>_0x279bf3[_0x573d11(0xfd)]=Math['floor'](Math['random']()*0xa));if(++_0x2a6e9b>0x28){clearInterval(drawInterval);const _0x1b1d88=_0x4b0cc2[Math['floor'](Math[_0x573d11(0x1c7)]()*_0x4b0cc2[_0x573d11(0x191)])],_0x242088=String(_0x1b1d88['employeeId'])[_0x573d11(0xa7)](-0x5)[_0x573d11(0xbf)](0x5,'0');_0x5b1d8e[_0x573d11(0x148)]((_0x2c49f4,_0x59f2f3)=>_0x2c49f4[_0x573d11(0xfd)]=_0x242088[_0x59f2f3]),setTimeout(async()=>{const _0x383502=_0x573d11;await updateDoc(doc(db,_0x383502(0x179),selectedIndGiftId),{'remainingQty':_0xfe72b5['remainingQty']-0x1}),await updateDoc(doc(db,'crsg',_0x1b1d88['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0xfe72b5[_0x383502(0x1d4)],'AwardedGiftId':selectedIndGiftId}),document[_0x383502(0x14f)](_0x383502(0x1d1))[_0x383502(0xfd)]=_0x1b1d88[_0x383502(0x180)]+'\x20('+_0x1b1d88[_0x383502(0x9c)]+')',document[_0x383502(0x14f)](_0x383502(0x1bf))[_0x383502(0xfd)]='‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20'+_0xfe72b5[_0x383502(0x1d4)],document['getElementById']('winnerEmployeeId')['textContent']=_0x383502(0x16b)+_0x1b1d88[_0x383502(0x9c)],document['getElementById']('winnerBU')[_0x383502(0xfd)]=_0x383502(0x120)+(_0x1b1d88['Branch_eng']||'-'),document[_0x383502(0x14f)](_0x383502(0x75))[_0x383502(0xfd)]='‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:\x20'+(_0x1b1d88['Check_Manager']||'-'),document['getElementById'](_0x383502(0x128))[_0x383502(0x137)][_0x383502(0x1a2)]('hidden'),confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}}),_0x5bfc02[_0x383502(0x133)]=![],updateLuckyDrawStats();},0x1f4);}},0x32);}window['removeLuckyWinner']=async _0x1635a3=>{const _0xdf13ce=_0x54afb4,_0x5a83fb=allEmployeesData[_0xdf13ce(0x84)](_0x4ef2ca=>_0x4ef2ca['id']===_0x1635a3);if(!_0x5a83fb)return;if(_0x5a83fb[_0xdf13ce(0x1e8)]){const _0x473688=allGiftsData[_0xdf13ce(0x84)](_0x1ac2de=>_0x1ac2de['id']===_0x5a83fb[_0xdf13ce(0x1e8)]);if(_0x473688)await updateDoc(doc(db,_0xdf13ce(0x179),_0x473688['id']),{'remainingQty':_0x473688[_0xdf13ce(0x1a4)]+0x1});}await updateDoc(doc(db,_0xdf13ce(0xd0),_0x1635a3),{'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null}),document[_0xdf13ce(0x14f)](_0xdf13ce(0x128))[_0xdf13ce(0x137)]['add'](_0xdf13ce(0x174));};function updateLuckyDrawStats(){const _0x357a88=_0x54afb4,_0x31a9e6=allEmployeesData[_0x357a88(0xe9)](_0x5e6d8c=>_0x5e6d8c[_0x357a88(0x175)]&&_0x5e6d8c[_0x357a88(0x7f)]===_0x357a88(0x7f)),_0x101303=_0x31a9e6['filter'](_0x938a46=>_0x938a46[_0x357a88(0xcc)])[_0x357a88(0x13a)]((_0x2a9097,_0x106e2f)=>(_0x106e2f[_0x357a88(0xcc)]?.['toMillis']()||0x0)-(_0x2a9097['RandomTime']?.[_0x357a88(0x163)]()||0x0));document[_0x357a88(0x14f)]('modalParticipantsCount')[_0x357a88(0xfd)]=_0x31a9e6[_0x357a88(0xe9)](_0x3dca59=>!_0x3dca59[_0x357a88(0xcc)])[_0x357a88(0x191)],document[_0x357a88(0x14f)]('modalDrawnCount')['textContent']=_0x101303[_0x357a88(0x191)],document[_0x357a88(0x14f)](_0x357a88(0xb2))[_0x357a88(0xdc)]=_0x101303[_0x357a88(0x115)](_0x362738=>_0x357a88(0x19c)+_0x362738[_0x357a88(0x9c)]+'</td><td\x20class=\x22px-4\x20py-4\x20uppercase\x20font-bold\x20text-xm\x20text-left\x22>'+_0x362738['FullName_th']+(_0x362738[_0x357a88(0x17f)]?'<br/><span\x20class=\x22text-sm\x20text-orange-600\x22>üéÅ\x20'+_0x362738[_0x357a88(0x17f)]+_0x357a88(0x13c):'')+_0x357a88(0x149)+(_0x362738['Branch_eng']||'-')+_0x357a88(0x1d8)+_0x362738['id']+'\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-1\x20rounded\x20cursor-pointer\x20text-sm\x20font-bold\x22>‡∏•‡∏ö</span></td></tr>')[_0x357a88(0x195)]('');}function updateTeamTab(){const _0x5343e6=_0x54afb4,_0x4cc1f7=document['getElementById']('teamSelect'),_0x482b28=_0x4cc1f7[_0x5343e6(0xf4)];_0x4cc1f7[_0x5343e6(0xdc)]=_0x5343e6(0xc4)+teamNames[_0x5343e6(0x115)](_0x2accc1=>'<option\x20value=\x22'+_0x2accc1+'\x22>'+_0x2accc1+_0x5343e6(0x19e))[_0x5343e6(0x195)](''),_0x4cc1f7[_0x5343e6(0xf4)]=teamNames[_0x5343e6(0xff)](_0x482b28)?_0x482b28:'';if(_0x4cc1f7[_0x5343e6(0xf4)]){const _0x232b75=allEmployeesData['filter'](_0xb79e0a=>_0xb79e0a[_0x5343e6(0x130)]===_0x4cc1f7[_0x5343e6(0xf4)]);document[_0x5343e6(0x14f)](_0x5343e6(0x1e5))[_0x5343e6(0xfd)]=_0x232b75['length'],document[_0x5343e6(0x14f)]('teamStatsRegistered')[_0x5343e6(0xfd)]=_0x232b75[_0x5343e6(0xe9)](_0x3a042c=>_0x3a042c[_0x5343e6(0x175)])[_0x5343e6(0x191)],document[_0x5343e6(0x14f)](_0x5343e6(0x12b))[_0x5343e6(0x137)][_0x5343e6(0x1a2)](_0x5343e6(0x174)),document[_0x5343e6(0x14f)](_0x5343e6(0x117))[_0x5343e6(0xdc)]=_0x232b75[_0x5343e6(0x115)]((_0x46a38b,_0x43ad57)=>_0x5343e6(0x1df)+(_0x46a38b[_0x5343e6(0x175)]?_0x5343e6(0x141):'')+_0x5343e6(0x12c)+(_0x43ad57+0x1)+_0x5343e6(0xf2)+_0x46a38b['employeeId']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20uppercase\x20text-left\x22>'+_0x46a38b['FullName_th']+_0x5343e6(0xe8)+(_0x46a38b[_0x5343e6(0x16d)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-gray-600\x20text-left\x22>'+(_0x46a38b[_0x5343e6(0x18e)]||'-')+_0x5343e6(0x18a)+(_0x46a38b['DateLogin']?'<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>':'-')+_0x5343e6(0x81)+_0x46a38b['id']+_0x5343e6(0x14a))['join']('');}else document['getElementById'](_0x5343e6(0x12b))['classList'][_0x5343e6(0xb4)]('hidden');}function updateGridTab(){const _0x3d6d58=_0x54afb4,_0x535ebe=document[_0x3d6d58(0x14f)](_0x3d6d58(0x173))[_0x3d6d58(0xf4)],_0x192cc2=[...new Set(allEmployeesData[_0x3d6d58(0x115)](_0x3f1803=>_0x3f1803['Check_Manager'])[_0x3d6d58(0xe9)](Boolean))][_0x3d6d58(0x13a)](),_0x32eab4=document[_0x3d6d58(0x14f)](_0x3d6d58(0x173));_0x32eab4[_0x3d6d58(0xb9)][_0x3d6d58(0x191)]!==_0x192cc2[_0x3d6d58(0x191)]+0x1&&(_0x32eab4[_0x3d6d58(0xdc)]=_0x3d6d58(0x1dd)+_0x192cc2['map'](_0x5696ce=>_0x3d6d58(0x79)+_0x5696ce+'\x22>'+_0x5696ce+'</option>')[_0x3d6d58(0x195)](''));_0x32eab4[_0x3d6d58(0xf4)]=_0x535ebe;const _0x449efa=_0x535ebe?allEmployeesData[_0x3d6d58(0xe9)](_0x534d62=>_0x534d62[_0x3d6d58(0x18e)]===_0x535ebe):allEmployeesData,_0x123df5=_0x449efa['filter'](_0x34b7c2=>_0x34b7c2['invite']==='invite');document[_0x3d6d58(0x14f)]('gvOverallStatsTotal')[_0x3d6d58(0xfd)]=_0x123df5[_0x3d6d58(0x191)],document[_0x3d6d58(0x14f)](_0x3d6d58(0x1dc))[_0x3d6d58(0xfd)]=_0x123df5[_0x3d6d58(0xe9)](_0x507ef1=>_0x507ef1[_0x3d6d58(0x175)])[_0x3d6d58(0x191)],document[_0x3d6d58(0x14f)](_0x3d6d58(0x1b3))[_0x3d6d58(0x137)]['remove'](_0x3d6d58(0x174));const _0x36ef5a={};teamNames[_0x3d6d58(0x148)](_0x23eb4b=>_0x36ef5a[_0x23eb4b]={'r':0x0,'t':0x0}),_0x449efa[_0x3d6d58(0xe9)](_0x4f01d5=>_0x4f01d5['Check_Place'])[_0x3d6d58(0x148)](_0x37c8f9=>{const _0x311e51=_0x3d6d58;if(_0x36ef5a[_0x37c8f9['Check_Place']]){_0x36ef5a[_0x37c8f9[_0x311e51(0x130)]]['t']++;if(_0x37c8f9[_0x311e51(0x175)])_0x36ef5a[_0x37c8f9['Check_Place']]['r']++;}}),document['getElementById'](_0x3d6d58(0xad))[_0x3d6d58(0xdc)]=teamNames[_0x3d6d58(0x115)](_0x14510f=>{const _0x26ae57=_0x3d6d58,_0x27e30e=_0x36ef5a[_0x14510f];let _0x5a3ea8='bg-gray-100';if(_0x27e30e['t']>0x0){if(_0x27e30e['r']===_0x27e30e['t'])_0x5a3ea8=_0x26ae57(0x15a);else{if(_0x27e30e['r']>0x0)_0x5a3ea8=_0x26ae57(0x135);}}return _0x26ae57(0x77)+_0x14510f+_0x26ae57(0x190)+_0x5a3ea8+_0x26ae57(0x8a)+_0x14510f+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20font-black\x20text-gray-900\x20mt-0.5\x22>'+_0x27e30e['r']+'/'+_0x27e30e['t']+_0x26ae57(0xc5);})[_0x3d6d58(0x195)]('');}function updateEmployeeList(){const _0xcf412e=_0x54afb4,_0x23b428=document['getElementById']('managerFilterSelect')[_0xcf412e(0xf4)],_0x506d66=[...new Set(allEmployeesData[_0xcf412e(0x115)](_0x52cfb0=>_0x52cfb0['Check_Manager'])[_0xcf412e(0xe9)](Boolean))][_0xcf412e(0x13a)](),_0xe13c49=document[_0xcf412e(0x14f)]('managerFilterSelect');_0xe13c49[_0xcf412e(0xb9)][_0xcf412e(0x191)]!==_0x506d66[_0xcf412e(0x191)]+0x1&&(_0xe13c49[_0xcf412e(0xdc)]=_0xcf412e(0x19f)+_0x506d66[_0xcf412e(0x115)](_0x5c22ed=>_0xcf412e(0x79)+_0x5c22ed+'\x22>'+_0x5c22ed+'</option>')[_0xcf412e(0x195)](''));_0xe13c49[_0xcf412e(0xf4)]=_0x23b428;let _0x4f1703=_0x23b428?allEmployeesData[_0xcf412e(0xe9)](_0x4649d0=>_0x4649d0[_0xcf412e(0x18e)]===_0x23b428):allEmployeesData;_0x4f1703[_0xcf412e(0x13a)]((_0x1e852e,_0x22d512)=>{const _0x1d085b=_0xcf412e;let _0x4d3943,_0x270030;switch(empSortField){case _0x1d085b(0xb6):_0x4d3943=_0x1e852e[_0x1d085b(0x175)]?0x1:0x0,_0x270030=_0x22d512[_0x1d085b(0x175)]?0x1:0x0;break;case _0x1d085b(0x1d4):return empSortDir===_0x1d085b(0x87)?_0x1e852e[_0x1d085b(0x180)]['localeCompare'](_0x22d512[_0x1d085b(0x180)],'th'):_0x22d512['FullName_th']['localeCompare'](_0x1e852e[_0x1d085b(0x180)],'th');case'branch':_0x4d3943=_0x1e852e[_0x1d085b(0x16d)]||'',_0x270030=_0x22d512['Branch_eng']||'';break;case _0x1d085b(0x9a):_0x4d3943=_0x1e852e[_0x1d085b(0x18e)]||'',_0x270030=_0x22d512['Check_Manager']||'';break;case _0x1d085b(0xa5):_0x4d3943=_0x1e852e['invite']||'',_0x270030=_0x22d512[_0x1d085b(0x7f)]||'';break;case _0x1d085b(0x15e):_0x4d3943=_0x1e852e[_0x1d085b(0x17f)]?0x1:0x0,_0x270030=_0x22d512[_0x1d085b(0x17f)]?0x1:0x0;break;default:_0x4d3943=_0x1e852e[_0x1d085b(0x9c)],_0x270030=_0x22d512[_0x1d085b(0x9c)];}if(_0x4d3943<_0x270030)return empSortDir===_0x1d085b(0x87)?-0x1:0x1;if(_0x4d3943>_0x270030)return empSortDir===_0x1d085b(0x87)?0x1:-0x1;return 0x0;}),document['getElementById'](_0xcf412e(0x102))['innerHTML']=_0x4f1703[_0xcf412e(0x115)]((_0x18d041,_0x2eb3e0)=>'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22'+(_0x18d041[_0xcf412e(0x175)]?'bg-yellow-50':'')+_0xcf412e(0x166)+(_0x2eb3e0+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-blue-800\x22>'+_0x18d041[_0xcf412e(0x9c)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20uppercase\x20text-left\x22>'+_0x18d041[_0xcf412e(0x180)]+_0xcf412e(0x110)+(_0x18d041[_0xcf412e(0x16d)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20text-left\x20text-gray-600\x22>'+(_0x18d041['Check_Manager']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20text-center\x20text-gray-400\x22>'+(_0x18d041[_0xcf412e(0x7f)]||'-')+_0xcf412e(0x80)+(_0x18d041[_0xcf412e(0x17f)]?_0xcf412e(0x12d):'-')+_0xcf412e(0x17c)+(_0x18d041['Check_Place']||'-')+_0xcf412e(0x158)+(_0x18d041['DateLogin']?_0xcf412e(0x134):'-')+_0xcf412e(0x94)+_0x18d041['id']+_0xcf412e(0x73))[_0xcf412e(0x195)]('');}window[_0x54afb4(0xd6)]=(_0x40dc55,_0x3a869a)=>{const _0x2e20f6=_0x54afb4,_0x5ceee8=document[_0x2e20f6(0x14f)](_0x2e20f6(0x11a));_0x5ceee8[_0x2e20f6(0x113)]=_0x2e20f6(0x82),currentConfirmAction=async()=>{const _0x2542cd=_0x2e20f6;await updateDoc(doc(db,'crsg',_0x40dc55),{'DateLogin':null}),document['getElementById'](_0x2542cd(0x150))['classList'][_0x2542cd(0xb4)](_0x2542cd(0x174));},document['getElementById'](_0x2e20f6(0xbe))[_0x2e20f6(0xfd)]=_0x2e20f6(0x1e4),document[_0x2e20f6(0x14f)](_0x2e20f6(0x1ae))['textContent']=_0x2e20f6(0x11b)+_0x3a869a+_0x2e20f6(0x1ab),document[_0x2e20f6(0x14f)](_0x2e20f6(0xe7))['classList'][_0x2e20f6(0xb4)](_0x2e20f6(0x174)),document[_0x2e20f6(0x14f)](_0x2e20f6(0x150))[_0x2e20f6(0x137)][_0x2e20f6(0x1a2)](_0x2e20f6(0x174));},window['openGroupDetail']=_0xa6d040=>{const _0x13351a=_0x54afb4,_0x1f92c1=allEmployeesData[_0x13351a(0xe9)](_0x2f7da1=>_0x2f7da1[_0x13351a(0x130)]===_0xa6d040);document[_0x13351a(0x14f)](_0x13351a(0x169))[_0x13351a(0xfd)]='‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°\x20'+_0xa6d040,document['getElementById'](_0x13351a(0x1cc))[_0x13351a(0xfd)]=_0x1f92c1[_0x13351a(0x191)],document[_0x13351a(0x14f)]('groupViewStatsRegistered')[_0x13351a(0xfd)]=_0x1f92c1[_0x13351a(0xe9)](_0x58d083=>_0x58d083['DateLogin'])['length'],document[_0x13351a(0x14f)](_0x13351a(0x146))['innerHTML']=_0x1f92c1['map']((_0x46c008,_0x5c074f)=>{const _0x53f54f=_0x13351a;return _0x53f54f(0xf6)+(_0x46c008[_0x53f54f(0x175)]?_0x53f54f(0x141):'')+_0x53f54f(0x1b6)+(_0x5c074f+0x1)+_0x53f54f(0x107)+_0x46c008[_0x53f54f(0x9c)]+_0x53f54f(0x10c)+_0x46c008[_0x53f54f(0x180)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-xm\x20uppercase\x20text-gray-400\x20text-left\x22>'+(_0x46c008[_0x53f54f(0x16d)]||'-')+_0x53f54f(0x19d)+(_0x46c008[_0x53f54f(0x18e)]||'-')+_0x53f54f(0x161)+(_0x46c008[_0x53f54f(0x175)]?_0x53f54f(0x121):'-')+_0x53f54f(0x94)+_0x46c008['id']+_0x53f54f(0x10b);})[_0x13351a(0x195)]('')||'<tr><td\x20colspan=\x227\x22\x20class=\x22p-10\x20text-center\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</td></tr>',document[_0x13351a(0x14f)](_0x13351a(0x1b4))[_0x13351a(0x137)][_0x13351a(0x1a2)](_0x13351a(0x174));},window[_0x54afb4(0x8b)]=_0xf736a5=>{const _0x3ed36b=_0x54afb4,_0xfd136b=allEmployeesData[_0x3ed36b(0x84)](_0x55339f=>_0x55339f['id']===_0xf736a5);if(!_0xfd136b)return;currentEditingDocId=_0xf736a5,document[_0x3ed36b(0x14f)](_0x3ed36b(0x196))[_0x3ed36b(0xfd)]=_0xfd136b[_0x3ed36b(0x9c)],document['getElementById']('editEmpName')[_0x3ed36b(0xfd)]=_0xfd136b[_0x3ed36b(0x180)],document[_0x3ed36b(0x14f)](_0x3ed36b(0x76))[_0x3ed36b(0xf4)]=_0xfd136b[_0x3ed36b(0x18e)]||'',document['getElementById'](_0x3ed36b(0x1c9))[_0x3ed36b(0xf4)]=_0xfd136b[_0x3ed36b(0x130)]||'',document[_0x3ed36b(0x14f)](_0x3ed36b(0xe3))['classList'][_0x3ed36b(0x1a2)]('hidden');};function searchForRegistration(){const _0x2226d3=_0x54afb4,_0x17f7aa=document[_0x2226d3(0x14f)](_0x2226d3(0x1b0))[_0x2226d3(0xf4)][_0x2226d3(0x12f)](),_0x501764=document[_0x2226d3(0x14f)](_0x2226d3(0x89));_0x501764['textContent']='';if(!_0x17f7aa){_0x501764[_0x2226d3(0xfd)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';return;}const _0x3803b3=allEmployeesData['find'](_0x38d861=>_0x38d861[_0x2226d3(0x9c)]===_0x17f7aa);_0x3803b3?(currentEditingDocId=_0x3803b3['id'],document[_0x2226d3(0x14f)](_0x2226d3(0x95))[_0x2226d3(0xfd)]=_0x3803b3[_0x2226d3(0x9c)],document['getElementById'](_0x2226d3(0x18c))['textContent']=_0x3803b3[_0x2226d3(0x180)],document['getElementById']('regEmpBranch')[_0x2226d3(0xfd)]=_0x3803b3[_0x2226d3(0x16d)]||'-',document[_0x2226d3(0x14f)](_0x2226d3(0xb1))['textContent']=_0x3803b3['Check_Manager']||'-',document[_0x2226d3(0x14f)]('regEmpSeat')[_0x2226d3(0xf4)]=_0x3803b3[_0x2226d3(0x130)]||'',document[_0x2226d3(0x14f)](_0x2226d3(0x160))[_0x2226d3(0xf4)]=_0x3803b3[_0x2226d3(0x7f)]||'',document['getElementById'](_0x2226d3(0x9e))[_0x2226d3(0x137)][_0x2226d3(0x1a2)](_0x2226d3(0x174)),document[_0x2226d3(0x14f)](_0x2226d3(0xde))[_0x2226d3(0xfd)]=''):_0x501764[_0x2226d3(0xfd)]='‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';}async function saveManualRegistration(){const _0x19f08e=_0x54afb4,_0x3ade17=document[_0x19f08e(0x14f)](_0x19f08e(0x122))[_0x19f08e(0xf4)][_0x19f08e(0x12f)](),_0x1e4d06=document[_0x19f08e(0x14f)](_0x19f08e(0x160))[_0x19f08e(0xf4)],_0x11863c=document['getElementById'](_0x19f08e(0xde));try{await updateDoc(doc(db,_0x19f08e(0xd0),currentEditingDocId),{'Check_Place':_0x3ade17,'invite':_0x1e4d06,'DateLogin':serverTimestamp()}),document[_0x19f08e(0x14f)](_0x19f08e(0x9e))['classList'][_0x19f08e(0xb4)](_0x19f08e(0x174)),document['getElementById'](_0x19f08e(0x1b0))[_0x19f08e(0xf4)]='';}catch(_0x3f3723){console['error'](_0x3f3723),_0x11863c[_0x19f08e(0xfd)]=_0x19f08e(0xcf);}}function handleEmpSort(_0x48d4e9){const _0x226b8e=_0x54afb4;empSortField===_0x48d4e9?empSortDir=empSortDir===_0x226b8e(0x87)?_0x226b8e(0xe2):_0x226b8e(0x87):(empSortField=_0x48d4e9,empSortDir=_0x226b8e(0x87)),updateEmployeeList();}function setupListeners(){const _0x4e87ee=_0x54afb4;document[_0x4e87ee(0x14f)](_0x4e87ee(0xc3))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>{const _0x2f58a0=_0x4e87ee;updateLuckyDrawStats(),document[_0x2f58a0(0x14f)](_0x2f58a0(0xf7))['classList'][_0x2f58a0(0x1a2)](_0x2f58a0(0x174));}),document['getElementById'](_0x4e87ee(0xed))['addEventListener'](_0x4e87ee(0x78),()=>document['getElementById']('randomizeModal')[_0x4e87ee(0x137)][_0x4e87ee(0xb4)]('hidden')),document[_0x4e87ee(0x14f)](_0x4e87ee(0x13b))[_0x4e87ee(0xcd)]('click',runIndividualLuckyDraw),document['getElementById'](_0x4e87ee(0x1d6))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),startGroupRandomDraw),document[_0x4e87ee(0x14f)](_0x4e87ee(0x74))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>document[_0x4e87ee(0x14f)](_0x4e87ee(0x1b4))[_0x4e87ee(0x137)][_0x4e87ee(0xb4)](_0x4e87ee(0x174))),document['getElementById'](_0x4e87ee(0x7a))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>document[_0x4e87ee(0x14f)](_0x4e87ee(0x128))[_0x4e87ee(0x137)][_0x4e87ee(0xb4)]('hidden')),document['getElementById'](_0x4e87ee(0xa3))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>document[_0x4e87ee(0x14f)](_0x4e87ee(0xe3))[_0x4e87ee(0x137)][_0x4e87ee(0xb4)]('hidden')),document['getElementById'](_0x4e87ee(0x116))['addEventListener'](_0x4e87ee(0x78),()=>document['getElementById']('confirmModal')[_0x4e87ee(0x137)][_0x4e87ee(0xb4)](_0x4e87ee(0x174))),document[_0x4e87ee(0x14f)](_0x4e87ee(0x1a8))['addEventListener'](_0x4e87ee(0x78),()=>handleEmpSort('id')),document[_0x4e87ee(0x14f)](_0x4e87ee(0x170))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>handleEmpSort('name')),document[_0x4e87ee(0x14f)]('sort-emp-branch')[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>handleEmpSort(_0x4e87ee(0x1d9))),document['getElementById'](_0x4e87ee(0x91))[_0x4e87ee(0xcd)]('click',()=>handleEmpSort(_0x4e87ee(0x9a))),document[_0x4e87ee(0x14f)](_0x4e87ee(0x1d2))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>handleEmpSort('member')),document[_0x4e87ee(0x14f)]('sort-emp-gift')[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>handleEmpSort('gift')),document[_0x4e87ee(0x14f)](_0x4e87ee(0x106))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>handleEmpSort(_0x4e87ee(0xb6))),document[_0x4e87ee(0x14f)](_0x4e87ee(0x171))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),searchForRegistration),document['getElementById'](_0x4e87ee(0x11d))[_0x4e87ee(0xcd)]('click',()=>document[_0x4e87ee(0x14f)]('manualRegisterModal')['classList'][_0x4e87ee(0xb4)]('hidden')),document['getElementById']('saveManualRegButton')['addEventListener'](_0x4e87ee(0x78),saveManualRegistration),document['getElementById'](_0x4e87ee(0xa9))['addEventListener'](_0x4e87ee(0x78),async()=>{if(currentConfirmAction)await currentConfirmAction();}),document['getElementById'](_0x4e87ee(0x126))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),addGift),document[_0x4e87ee(0x14f)](_0x4e87ee(0x86))['addEventListener'](_0x4e87ee(0x78),()=>{const _0x40df7c=_0x4e87ee;giftPickerContext='ind',renderGiftPicker(),document[_0x40df7c(0x14f)](_0x40df7c(0xaf))['classList'][_0x40df7c(0x1a2)]('hidden');}),document['getElementById'](_0x4e87ee(0xcb))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>{const _0x48ecd0=_0x4e87ee;giftPickerContext=_0x48ecd0(0x1b7),renderGiftPicker(),document['getElementById'](_0x48ecd0(0xaf))[_0x48ecd0(0x137)][_0x48ecd0(0x1a2)](_0x48ecd0(0x174));}),document[_0x4e87ee(0x14f)](_0x4e87ee(0xc6))[_0x4e87ee(0xcd)]('click',()=>document[_0x4e87ee(0x14f)](_0x4e87ee(0xaf))['classList']['add']('hidden')),document['getElementById'](_0x4e87ee(0xb7))['addEventListener'](_0x4e87ee(0x78),()=>document[_0x4e87ee(0x14f)]('editGiftModal')[_0x4e87ee(0x137)][_0x4e87ee(0xb4)](_0x4e87ee(0x174))),document['getElementById'](_0x4e87ee(0xbb))['addEventListener']('click',async()=>{const _0x438665=_0x4e87ee,_0x246e77=document[_0x438665(0x14f)]('editGiftName')[_0x438665(0xf4)]['trim'](),_0x27aa82=parseInt(document[_0x438665(0x14f)](_0x438665(0x167))[_0x438665(0xf4)]),_0x25ae9e=parseInt(document[_0x438665(0x14f)](_0x438665(0x193))[_0x438665(0xf4)]);if(!_0x246e77||isNaN(_0x27aa82)||isNaN(_0x25ae9e))return;await updateDoc(doc(db,_0x438665(0x179),currentEditingGiftId),{'name':_0x246e77,'totalQty':_0x27aa82,'remainingQty':_0x25ae9e}),document['getElementById'](_0x438665(0x119))[_0x438665(0x137)]['add'](_0x438665(0x174));}),document[_0x4e87ee(0x14f)](_0x4e87ee(0xdb))['addEventListener'](_0x4e87ee(0x78),async()=>{const _0x258ce2=_0x4e87ee;await updateDoc(doc(db,_0x258ce2(0xd0),currentEditingDocId),{'Check_Manager':document[_0x258ce2(0x14f)](_0x258ce2(0x76))[_0x258ce2(0xf4)],'Check_Place':document[_0x258ce2(0x14f)](_0x258ce2(0x1c9))[_0x258ce2(0xf4)]}),document[_0x258ce2(0x14f)](_0x258ce2(0xe3))[_0x258ce2(0x137)][_0x258ce2(0xb4)]('hidden');}),document[_0x4e87ee(0x14f)]('searchEmployeeButton')['addEventListener'](_0x4e87ee(0x78),()=>{const _0x374bad=_0x4e87ee,_0x8d13ea=document['getElementById']('searchEmployeeIdInput')['value'][_0x374bad(0x12f)](),_0x16bd70=allEmployeesData['find'](_0x19d984=>_0x19d984['employeeId']===_0x8d13ea);if(_0x16bd70)editEmp(_0x16bd70['id']);else document[_0x374bad(0x14f)](_0x374bad(0x186))[_0x374bad(0xfd)]='‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';}),document[_0x4e87ee(0x14f)](_0x4e87ee(0x11c))['addEventListener'](_0x4e87ee(0x1e3),updateTeamTab),document['getElementById'](_0x4e87ee(0x173))['addEventListener']('change',updateGridTab),document[_0x4e87ee(0x14f)]('managerFilterSelect')[_0x4e87ee(0xcd)](_0x4e87ee(0x1e3),updateEmployeeList),document['getElementById'](_0x4e87ee(0xfb))[_0x4e87ee(0xcd)]('click',()=>{const _0x23c8bd=_0x4e87ee,_0x1a814d=document['getElementById'](_0x23c8bd(0x1bb))[_0x23c8bd(0xf4)][_0x23c8bd(0x12f)]();if(!_0x1a814d)return;teamNames=_0x1a814d[_0x23c8bd(0x99)](',')['map'](_0x31ccc5=>_0x31ccc5[_0x23c8bd(0x12f)]())[_0x23c8bd(0xe9)](Boolean),refreshUI();}),document['getElementById']('downloadCsvButton')['addEventListener'](_0x4e87ee(0x78),()=>{const _0xe146f1=_0x4e87ee;let _0x24a017='\ufeff‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡∏°,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a';allEmployeesData[_0xe146f1(0xe9)](_0x2096e7=>_0x2096e7[_0xe146f1(0x175)])[_0xe146f1(0x148)](_0x16991d=>{const _0x5a526a=_0xe146f1;_0x24a017+='\x22'+_0x16991d['employeeId']+_0x5a526a(0x13e)+_0x16991d[_0x5a526a(0x180)]+_0x5a526a(0x13e)+(_0x16991d['Branch_eng']||'')+_0x5a526a(0x13e)+(_0x16991d[_0x5a526a(0x18e)]||'')+_0x5a526a(0x13e)+(_0x16991d[_0x5a526a(0x130)]||'')+_0x5a526a(0x92);});const _0x3d5cb2=new Blob([_0x24a017],{'type':'text/csv;charset=utf-8;'}),_0x3084fc=document[_0xe146f1(0x1a9)]('a');_0x3084fc['href']=URL[_0xe146f1(0xba)](_0x3d5cb2),_0x3084fc[_0xe146f1(0xac)]=_0xe146f1(0x1e7),_0x3084fc[_0xe146f1(0x78)]();}),document['getElementById']('downloadEmployeeCsvButton')[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>{const _0x1a1344=_0x4e87ee,_0xf4c512=document[_0x1a1344(0x14f)]('managerFilterSelect')['value'];let _0x54e72a=_0xf4c512?allEmployeesData['filter'](_0x2c8f34=>_0x2c8f34['Check_Manager']===_0xf4c512):allEmployeesData,_0x4fb12e=_0x1a1344(0x17a);_0x54e72a[_0x1a1344(0x148)]((_0x29acef,_0x5eafcb)=>{const _0x168f94=_0x1a1344,_0x6bceec=_0x29acef[_0x168f94(0x175)]?_0x168f94(0x131):'-',_0x419660=_0x29acef[_0x168f94(0x7f)]||'-',_0x1c523c=_0x29acef[_0x168f94(0x17f)]?_0x168f94(0x12d):'-';_0x4fb12e+='\x22'+(_0x5eafcb+0x1)+'\x22,\x22'+_0x29acef['employeeId']+_0x168f94(0x13e)+_0x29acef['FullName_th']+'\x22,\x22'+(_0x29acef[_0x168f94(0x16d)]||'-')+'\x22,\x22'+(_0x29acef[_0x168f94(0x18e)]||'-')+_0x168f94(0x13e)+_0x419660+_0x168f94(0x13e)+_0x1c523c+'\x22,\x22'+(_0x29acef[_0x168f94(0x130)]||'-')+'\x22,\x22'+_0x6bceec+'\x22\x0a';});const _0x23ba49=new Blob([_0x4fb12e],{'type':_0x1a1344(0x15d)}),_0x4a8276=document[_0x1a1344(0x1a9)]('a');_0x4a8276[_0x1a1344(0x1aa)]=URL[_0x1a1344(0xba)](_0x23ba49),_0x4a8276[_0x1a1344(0xac)]=_0x1a1344(0xe5),_0x4a8276['click']();}),document[_0x4e87ee(0x14f)]('downloadWinnersCsvButton')[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>{const _0x485f07=_0x4e87ee,_0x559d68=allEmployeesData[_0x485f07(0xe9)](_0x143a36=>_0x143a36[_0x485f07(0xcc)])['sort']((_0xe57f8,_0x1e983f)=>(_0x1e983f[_0x485f07(0xcc)]?.[_0x485f07(0x163)]()||0x0)-(_0xe57f8['RandomTime']?.[_0x485f07(0x163)]()||0x0));let _0x4bd577='\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á,‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\x0a';_0x559d68['forEach'](_0x4f6393=>{const _0x307c2f=_0x485f07,_0x55fe94=_0x4f6393[_0x307c2f(0xcc)]?.[_0x307c2f(0x163)]()?new Date(_0x4f6393['RandomTime'][_0x307c2f(0x163)]())['toLocaleString']('th-TH'):'-',_0x222219=_0x4f6393[_0x307c2f(0x1cf)]?'‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß':_0x307c2f(0xda);_0x4bd577+='\x22'+_0x4f6393[_0x307c2f(0x9c)]+'\x22,\x22'+_0x4f6393['FullName_th']+_0x307c2f(0x13e)+(_0x4f6393[_0x307c2f(0x17f)]||'')+_0x307c2f(0x13e)+(_0x4f6393[_0x307c2f(0x16d)]||'')+_0x307c2f(0x13e)+(_0x4f6393[_0x307c2f(0x18e)]||'')+_0x307c2f(0x13e)+(_0x4f6393[_0x307c2f(0x130)]||'')+'\x22,\x22receivedStr}\x22,\x22'+_0x55fe94+'\x22\x0a';});const _0x25ee21=new Blob([_0x4bd577],{'type':_0x485f07(0x15d)}),_0x55d1ca=document[_0x485f07(0x1a9)]('a');_0x55d1ca[_0x485f07(0x1aa)]=URL[_0x485f07(0xba)](_0x25ee21),_0x55d1ca[_0x485f07(0xac)]=_0x485f07(0x15c),_0x55d1ca['click']();}),document[_0x4e87ee(0x14f)](_0x4e87ee(0x182))[_0x4e87ee(0xcd)](_0x4e87ee(0x78),()=>{const _0x58b351=_0x4e87ee,_0xcb3ba5=document[_0x58b351(0x14f)](_0x58b351(0x11a)),_0x54be36=document['getElementById'](_0x58b351(0xe7)),_0xf0410=document[_0x58b351(0x14f)](_0x58b351(0x155));_0x54be36[_0x58b351(0x137)][_0x58b351(0x1a2)]('hidden'),_0xf0410['value']='',currentConfirmAction=async()=>{const _0x7f0fc0=_0x58b351;if(_0xf0410[_0x7f0fc0(0xf4)][_0x7f0fc0(0x12f)]()[_0x7f0fc0(0xce)]()!==_0x7f0fc0(0x132))return;const _0x548bdb=writeBatch(db);allEmployeesData['forEach'](_0xd86ac7=>{const _0x4efdb0=_0x7f0fc0;_0x548bdb['update'](doc(db,_0x4efdb0(0xd0),_0xd86ac7['id']),{'DateLogin':null,'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null});}),await _0x548bdb[_0x7f0fc0(0x1c0)](),document[_0x7f0fc0(0x14f)]('confirmModal')['classList']['add'](_0x7f0fc0(0x174));},document['getElementById'](_0x58b351(0xbe))['textContent']=_0x58b351(0xd5),document['getElementById']('confirmText')['textContent']='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?',document['getElementById'](_0x58b351(0x150))['classList']['remove'](_0x58b351(0x174));});}function updateGroupRandomUI(){const _0x2aa690=_0x54afb4,_0x5f290e=allEmployeesData[_0x2aa690(0xe9)](_0x59581b=>_0x59581b[_0x2aa690(0x175)]&&_0x59581b[_0x2aa690(0x7f)]===_0x2aa690(0x7f)),_0x2f0d31=_0x5f290e[_0x2aa690(0xe9)](_0x598a33=>_0x598a33['RandomTime'])['sort']((_0x3cb1f3,_0x535aa8)=>(_0x535aa8[_0x2aa690(0xcc)]?.[_0x2aa690(0x163)]()||0x0)-(_0x3cb1f3[_0x2aa690(0xcc)]?.[_0x2aa690(0x163)]()||0x0)),_0x3dbaa7=_0x5f290e[_0x2aa690(0xe9)](_0x262a2e=>!_0x262a2e[_0x2aa690(0xcc)]);if(document[_0x2aa690(0x14f)]('grTotalEligible'))document[_0x2aa690(0x14f)]('grTotalEligible')[_0x2aa690(0xfd)]=_0x5f290e[_0x2aa690(0x191)];if(document[_0x2aa690(0x14f)](_0x2aa690(0x1ec)))document[_0x2aa690(0x14f)](_0x2aa690(0x1ec))[_0x2aa690(0xfd)]=_0x3dbaa7[_0x2aa690(0x191)];if(document[_0x2aa690(0x14f)](_0x2aa690(0x1a1)))document[_0x2aa690(0x14f)]('grTotalWinners')['textContent']=_0x2f0d31[_0x2aa690(0x191)];}
    </script>
</body>

</html>
