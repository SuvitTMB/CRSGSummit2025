<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE Retail Club</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff;
            letter-spacing: normal !important;
            font-size: 1.125rem;
        }
        * {
            font-family: 'Sarabun', sans-serif !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            /* ‡∏õ‡∏£‡∏±‡∏ö font dropdown ‡πÅ‡∏•‡∏∞ input ‡∏•‡∏á 1 ‡∏Ç‡∏±‡πâ‡∏ô */
            font-size: 1rem;
        }
        thead.table-header-gray {
             background-color: #e5e7eb;
        }
        table thead th {
            font-weight: bold !important;
            font-size: 1rem !important;
            /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î font-align center */
            text-align: center !important;
        }
        table tbody tr {
            height: 30px !important;
        }
        .winner-row-animate {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        button:disabled {
            background-color: #d1d5db !important;
            cursor: not-allowed !important;
            box-shadow: none !important;
            transform: none !important;
        }
        .loading-gif {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0); }
            100% { transform: rotate(360deg); }
        }
        .sortable-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .sortable-header:hover {
            background-color: #d1d5db;
        }
        .dashboard-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        /* Pagination Styles */
        .pagination-btn {
            padding: 0.25rem 0.75rem;
            border: 1px solid #d1d5db;
            background-color: #fff;
            color: #374151;
            font-size: 0.875rem;
            border-radius: 0.375rem;
            transition: all 0.2s;
        }
        .pagination-btn:hover:not(:disabled) {
            background-color: #f3f4f6;
        }
        .pagination-btn.active {
            background-color: #0056ff;
            color: #fff;
            border-color: #0056ff;
        }
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[95%] max-w-7xl p-0 bg-white rounded-lg">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6 pt-6 px-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold" style="color: #0056ff;">Recog Night White Elegance</h1>
            </div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-400 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="mb-6 border-b border-gray-200 px-8">
            <nav class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Tabs">
                <button id="tab-dashboard" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-700 bg-gray-300 border-blue-600">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°
                </button>
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>
                <button id="tab-gift-management" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
                <button id="tab-register" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    QR Code
                </button>
                <button id="tab-group-random" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-winners-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
            </nav>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="px-8 pb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                <div class="lg:w-2/5">
                     <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center h-full">
                         <p class="text-gray-600 text-base mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                         <div class="relative w-64 h-64">
                             <canvas id="registrationBreakdownChart"></canvas>
                             <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                 <span id="breakdownCenterTotal" class="text-2xl font-bold text-gray-900">0</span>
                                 <span class="text-base text-gray-500 font-bold">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                             </div>
                         </div>
                     </div>
                </div>
                <div class="lg:w-3/5">
                    <div class="flex gap-6 h-full">
                         <div class="w-2/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-base mb-4 font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
                            <div class="relative w-64 h-64">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                    <span class="text-base text-gray-500 font-bold">%‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                </div>
                            </div>
                        </div>
                         <div class="w-1/3 flex flex-col justify-between space-y-2">
                            <div id="card-total" class="dashboard-card h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-blue-700 text-sm font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                                <p id="targetCount" class="text-2xl font-bold text-blue-800 mt-1">0</p>
                            </div>
                            <div id="card-registered" class="dashboard-card h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-green-700 text-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
                                <p id="participantsCountBox" class="text-2xl font-bold text-green-800 mt-1">0</p>
                            </div>
                            <div id="card-unregistered" class="dashboard-card h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-red-700 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</p>
                                <p id="remainingCount" class="text-2xl font-bold text-red-800 mt-1">0</p>
                            </div>
                            <div id="card-extras" class="dashboard-card h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-yellow-700 text-sm">‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="attendeesCount" class="text-2xl font-bold text-yellow-800 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Timeline Row Updated with Side Stats -->
            <div class="mb-8 w-full">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <!-- Chart Area (Left) -->
                        <div class="flex-grow h-72 w-full md:w-3/4">
                            <canvas id="registrationTimelineChart"></canvas>
                        </div>
                        
                        <!-- Summary Stats (Right) -->
                        <div class="w-full md:w-1/4 flex flex-col gap-4">
                            <div class="bg-blue-50 border-l-4 border-blue-600 p-4 rounded-r-lg">
                                <p class="text-blue-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</p>
                                <p id="timelineTotalInvite" class="text-2xl font-black text-blue-900 mt-1">0</p>
                                <p class="text-[10px] text-blue-400 font-bold uppercase tracking-widest">(‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg">
                                <p class="text-orange-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="timelineTotalExtra" class="text-2xl font-black text-orange-900 mt-1">0</p>
                                <p class="text-[10px] text-orange-400 font-bold uppercase tracking-widest">(‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-xl font-semibold text-gray-800 font-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                     <button id="randomizeButton" class="px-6 py-3 text-base font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow active:scale-95 transition-all font-bold">
                         ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (A1 - A24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart1"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (B1 - B24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart2"></canvas></div>
                    </div>
                </div>
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-100 text-sm">
                            <tr><td colspan="6" class="p-6 text-center text-gray-500 font-bold text-sm">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-8 text-center">
                <button id="downloadCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all">
                    üì• Download CSV Report
                </button>
            </div>
        </div>

        <!-- Team List Content -->
        <div id="team-list-content" class="hidden pb-8 px-0">
            <div class="bg-white overflow-hidden">
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center bg-gray-50">
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm">
                        <p class="text-base text-blue-700 font-bold">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm font-bold">
                        <p class="text-base text-green-700">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ó‡∏µ‡∏°</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border shadow-sm font-bold flex flex-col"> 
                        <p class="text-sm text-gray-400 font-bold mb-1 uppercase tracking-tight">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</p>
                        <textarea id="definedTeamNamesInput" class="!text-xs h-16 resize-none bg-blue-50 border-blue-100 font-mono" placeholder="A,B,C..."></textarea>
                        <button id="updateTeamNamesBtn" class="mt-1 text-[10px] bg-blue-600 text-white py-1 rounded uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</button>
                    </div>
                </div>
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-8 py-3 text-base font-bold text-white bg-red-600 rounded-md hover:bg-red-700 shadow transition-all">Reset System Data</button>
                </div>
                 <div class="p-6">
                     <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                         <div>
                             <h3 class="text-xl font-bold border-l-4 border-blue-600 pl-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h3>
                             <div id="teamStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                                 <span class="px-3 py-1 rounded-md bg-gray-100 text-gray-700 text-sm font-bold border">Total: <span id="teamStatsTotal">0</span></span>
                                 <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">Reg: <span id="teamStatsRegistered">0</span></span>
                             </div>
                         </div>
                         <div class="flex items-center">
                             <label for="teamSelect" class="text-base font-bold text-gray-600 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                                 <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏° --</option>
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-xl shadow-sm">
                        <table class="min-w-full text-lg">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-4 text-center font-bold">#</th>
                                    <th class="px-4 py-4 text-left font-bold">Employee ID</th>
                                    <th class="px-4 py-4 text-left font-bold">Full Name</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                    <th class="px-4 py-4 text-left font-bold">Status</th>
                                    <th class="px-4 py-4 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- Group View Content -->
        <div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                <!-- Search Boxes Container -->
                <div class="flex flex-col md:flex-row gap-6 mb-6">
                    <!-- Box 1: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-gray-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchEmployeeIdInput" class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 5-6 ‡∏´‡∏•‡∏±‡∏Å">
                            </div>
                            <button id="searchEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow transition-all active:scale-95">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        <p id="searchEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>

                    <!-- Box 2: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-green-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-green-800 mb-3 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchRegEmployeeIdInput" class="block text-sm font-bold text-green-600 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchRegEmployeeIdInput" class="mt-1 block w-full rounded-md border-green-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">
                            </div>
                            <button id="searchRegEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95 uppercase">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                        </div>
                        <p id="searchRegEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>
                </div>

                <div class="px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (Grid)</h2>
                        <div id="gvOverallStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                             <span class="px-3 py-1 rounded-md bg-gray-100 text-sm font-bold border">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="gvOverallStatsTotal">0</span></span>
                             <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß: <span id="gvOverallStatsRegistered">0</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="groupViewManagerFilter" class="text-base font-bold text-gray-600 mr-2">Manager:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                    </div>
                </div>

                <!-- New Layout: Recog Night Header + Seat Grid -->
                <div class="w-full flex justify-center mb-6 px-6">
                    <div class="w-[60%] bg-[#0056ff] text-white text-center py-3 rounded-xl font-bold shadow-md">
                        ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á Recog Night White Elegance
                    </div>
                </div>

                <div class="px-6 flex w-full items-stretch gap-0">
                    <!-- ‡πÇ‡∏ã‡∏ô A (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridA" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á (4%) -->
                    <div class="w-[4%] flex justify-center py-2">
                        <!-- Border 2% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á 4% ‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
                        <div class="w-1 bg-gray-200 rounded-full h-full opacity-50" id="gridDivider"></div>
                    </div>

                    <!-- ‡πÇ‡∏ã‡∏ô B (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridB" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                </div>
                
                <div class="p-10"></div> <!-- Spacer -->
             </div>
        </div>
        
        <!-- Employee List Content -->
        <div id="employee-list-content" class="hidden pb-8 px-0">
             <div class="bg-white overflow-hidden">
                <div class="px-8 py-6 border-b flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <div id="empStatsContainer" class="hidden flex flex-wrap gap-2 mt-3">
                            <span class="px-4 py-1.5 rounded-xl bg-gray-100 text-gray-700 text-sm font-black border shadow-sm">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="empStatsTotal">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-green-50 text-green-700 text-sm font-black border border-green-200 shadow-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="empStatsRegistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á: <span id="empStatsUnregistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-sm font-black border border-blue-200 shadow-sm">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô: <span id="empStatsPercent">0%</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="managerFilterSelect" class="text-base font-bold text-gray-600 mr-2">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</label>
                         <select id="managerFilterSelect" class="rounded-xl border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                     </div>
                </div>
                <div class="overflow-x-auto p-8">
                    <table class="min-w-full text-sm shadow-sm border rounded-2xl overflow-hidden">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold">#</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-id">‡∏£‡∏´‡∏±‡∏™ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-branch">‡∏™‡∏≤‡∏Ç‡∏≤ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-manager">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-member">Member ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-gift">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                    </table>
                </div>

                <!-- Pagination Container -->
                <div id="empPaginationContainer" class="flex justify-center items-center gap-2 py-6 border-t border-gray-100"></div>

                <!-- ‡∏õ‡∏∏‡πà‡∏° Download CSV ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                <div class="pb-8 text-center">
                    <button id="downloadEmployeeCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all uppercase">
                        üì• Download Employee CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Gift Management Content -->
        <div id="gift-management-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-blue-600 pl-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
                <div class="bg-gray-50 p-6 rounded-2xl border mb-8 max-w-[1000px] shadow-inner">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-grow" style="max-width: 600px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
                            <input type="text" id="giftNameInput" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                        </div>
                        <div style="width: 90px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="giftQtyInput" class="!text-sm text-center" value="1" min="1">
                        </div>
                        <div class="flex items-end">
                            <button id="addGiftBtn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all active:scale-95 shadow-lg !text-xs">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto border rounded-xl shadow-sm">
                    <table class="min-w-full text-base">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold w-24">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="giftListTableBody" class="divide-y divide-gray-100 bg-white">
                            <tr><td colspan="6" class="p-6 text-center text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Winners List Content -->
        <div id="winners-list-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-green-600 pl-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                <div id="winnersByGiftContainer" class="space-y-12">
                    <div class="p-10 text-center text-gray-400 font-bold italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
                <div class="mt-12 text-center">
                    <button id="downloadWinnersCsvButton" class="px-8 py-3 text-base font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95">
                        üì• Download Winners CSV Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Register Content -->
        <div id="register-content" class="hidden pb-8 px-6 text-center">
             <div class="bg-white p-12 rounded-[3rem] shadow-xl border border-gray-100 flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-800 mb-10 font-black">QR Code</h2>
                <div class="p-6 bg-white border-8 border-blue-600 rounded-[3rem] shadow-2xl mb-4 hover:scale-105 transition-all">
                    <img src="./images/QRcode-CRSG.png" alt="QR Code" class="w-80 h-80" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=REGISTER'">
                </div>
             </div>
        </div>

        <!-- Group Random Content -->
        <div id="group-random-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                
                <div class="flex flex-col md:flex-row gap-4 mb-6 items-stretch">
                    <div class="md:w-[30%] grid grid-cols-1 gap-2">
                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 shadow-sm text-center">
                            <p class="text-sm text-blue-700 uppercase font-black">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p id="grTotalEligible" class="text-xl font-black text-blue-900">0</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 shadow-sm text-center">
                            <p class="text-sm text-orange-700 uppercase font-black">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°</p>
                            <p id="grRemainingEligible" class="text-xl font-black text-orange-900">0</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100 shadow-sm text-center">
                            <p class="text-sm text-green-700 uppercase font-black">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="grTotalWinners" class="text-xl font-black text-green-900">0</p>
                        </div>
                    </div>

                    <div class="md:w-[70%] flex flex-col gap-3">
                        <div class="bg-gray-50 px-4 py-3 rounded-xl border shadow-sm w-full">
                            <label class="block text-sm font-bold text-gray-400 mb-1 uppercase tracking-wider text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
                            <div id="grGiftBox" class="flex items-center justify-between bg-white border-2 border-dashed border-gray-200 rounded-xl p-3 transition-all">
                                <div class="flex flex-col text-left">
                                    <p id="grGiftDisplayName" class="text-base font-black text-gray-400 leading-tight uppercase">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                                    <p id="grGiftDisplayQty" class="text-sm font-bold text-gray-300 mt-1">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                                </div>
                                <button id="openGroupGiftPickerBtn" class="px-4 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-xs font-black border border-blue-200 shadow-sm shrink-0 active:scale-95 transition-all">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                            </div>
                        </div>

                        <div class="flex items-stretch gap-3 w-full flex-grow min-h-[90px]">
                            <div class="w-[30%] bg-gray-50 p-3 rounded-xl border shadow-sm flex flex-col justify-center items-center text-center">
                                <label class="text-sm font-bold text-gray-500 uppercase mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</label>
                                <input type="number" id="grDrawCount" value="0" min="0" class="w-full text-center text-3xl font-black text-blue-600 bg-white border border-blue-100 rounded-lg focus:border-blue-500 focus:ring-0 py-1 shadow-inner">
                            </div>
                            <div class="w-[70%]">
                                <button id="grStartDrawBtn" class="w-full h-full text-xl font-black text-white bg-[#0056ff] rounded-xl hover:bg-blue-700 shadow-lg transition-all active:scale-95 disabled:bg-gray-400 uppercase tracking-widest flex items-center justify-center">
                                    üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border-t border-gray-100 pt-4">
                    <div class="p-4 border-r border-gray-100">
                        <h4 class="text-xl font-black text-blue-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</h4>
                        <div id="grBoxLeft" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                    <div class="p-4">
                        <h4 class="text-xl font-black text-indigo-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h4>
                        <div id="grBoxRight" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- LIGHTBOX: Manual Registration -->
    <div id="manualRegisterModal" class="hidden fixed inset-0 z-[140] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-lg border-t-8 border-green-600">
            <h3 class="text-xl font-bold mb-6 uppercase border-b pb-3 text-gray-800 text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            <div id="regEmpDetail" class="space-y-4 mb-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="regEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="regEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏™‡∏≤‡∏Ç‡∏≤ ‡πÅ‡∏•‡∏∞ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏≤‡∏Ç‡∏≤ (Branch)</label><p id="regEmpBranch" class="text-sm font-bold text-gray-700"></p></div>
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Manager)</label><p id="regEmpManager" class="text-sm font-bold text-gray-700"></p></div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                        <input type="text" id="regEmpSeat" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, A2">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="regEmpInviteStatus" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base">
                            <option value="">-- ‡∏ß‡πà‡∏≤‡∏á --</option>
                            <option value="invite">invite</option>
                        </select>
                    </div>
                </div>
                <p id="regManualError" class="text-red-600 text-sm font-black italic h-4"></p>
            </div>
            <div class="flex justify-end gap-3 font-bold">
                <button id="closeManualRegModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveManualRegButton" class="px-8 py-2 bg-green-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-green-700 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Group Detail -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="groupViewModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
                     <div id="groupViewStatsContainer" class="flex flex-wrap gap-2 mt-2">
                         <span class="px-3 py-1 rounded-full bg-gray-100 text-sm font-bold border uppercase">Total: <span id="groupViewStatsTotal">0</span></span>
                         <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-sm font-bold border border-green-200 uppercase">Reg: <span id="groupViewStatsRegistered">0</span></span>
                     </div>
                 </div>
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">ID</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Dashboard List Detail -->
    <div id="dashboardListModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="dashboardListModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                     <p class="text-sm text-gray-400 font-bold mt-1 uppercase tracking-tight">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="dashboardListCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                 </div>
                 <button id="closeDashboardListModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
                            <th class="px-4 py-4 text-center font-bold">‡∏£‡∏´‡∏±‡∏™</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-center font-bold">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                            <th class="px-4 py-4 text-center font-bold">‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                        </tr>
                    </thead>
                    <tbody id="dashboardListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- MODAL: Lucky Draw Individual -->
    <div id="randomizeModal" class="hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 w-[75%] h-[80vh] flex flex-col mx-4 border-t-8 border-blue-600 relative">
            <button id="closeRandomizeModalButtonX" class="absolute top-2 right-4 text-gray-400 hover:text-gray-600 text-5xl font-light transition-all z-10">&times;</button>
            <h3 class="text-xl font-bold text-center text-gray-900 mb-6 uppercase">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
            <div class="max-w-lg mx-auto mb-8 w-full">
                <label class="block text-sm font-bold text-gray-400 mb-2 text-center">‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏∏‡πà‡∏°</label>
                <div id="indGiftBox" class="flex items-center justify-between bg-blue-50 border-2 border-dashed border-blue-200 rounded-2xl p-3 transition-colors">
                    <div class="flex flex-col text-left">
                        <p id="indGiftDisplayName" class="text-lg font-black text-blue-400 leading-tight">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                        <p id="indGiftDisplayQty" class="text-sm text-black-400 mt-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    </div>
                    <button id="openGiftPickerBtn" class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-blue-700 uppercase">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p><p id="modalParticipantsCount" class="text-2xl font-bold">0</p></div>
                <div class="bg-green-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-green-700 uppercase">‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß</p><p id="modalDrawnCount" class="text-2xl font-bold">0</p></div>
            </div>
            <div class="flex justify-center space-x-2 mb-6 shrink-0">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
            </div>
            <div class="mb-6 flex flex-col items-center shrink-0">
                <button id="startRandomizeButton" class="w-[40%] px-6 py-4 text-base text-white bg-blue-600 rounded-lg font-bold hover:bg-blue-700 shadow-xl active:scale-95 disabled:bg-gray-400 uppercase" disabled>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</button>
                <p id="randomizeError" class="text-red-600 text-base mt-3 font-bold uppercase"></p>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-xl bg-gray-50 font-bold">
                <table class="min-w-full text-base">
                    <thead class="bg-gray-200 sticky top-0 uppercase text-gray-700">
                        <tr><th class="px-4 py-4 text-left">‡∏£‡∏´‡∏±‡∏™</th><th class="px-4 py-4 text-left">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</th><th class="px-4 py-4 text-left">‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th><th class="px-4 py-4 text-center">Action</th></tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL: Gift Picker -->
    <div id="giftPickerModal" class="hidden fixed inset-0 z-[100] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-[70%] modal-enter flex flex-col border-t-8 border-orange-500">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="giftPickerTitle" class="text-xl font-black text-gray-800 uppercase">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
                <button id="closeGiftPickerBtn" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto max-h-[60vh] space-y-2" id="giftPickerList"></div>
        </div>
    </div>

    <!-- POPUP WINNER Detail -->
    <div id="winnerDetailModal" class="hidden fixed inset-0 z-[200] bg-gray-900 bg-opacity-95 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-xl w-full text-center border-t-8 border-blue-600 transform scale-110">
            <h3 class="text-xl font-black text-blue-600 mb-4 uppercase">üéä WINNER üéä</h3>
            <div class="text-6xl mb-6">üèÜ</div>
            <p id="winnerName" class="text-2xl font-black text-gray-900 my-4 leading-tight uppercase"></p>
            <p id="winnerGiftText" class="text-xl font-bold text-orange-600 mb-6"></p>
            <div class="bg-blue-50 p-6 rounded-[2rem] mb-10 border border-blue-100 shadow-inner text-center">
                <p id="winnerEmployeeId" class="text-xl font-black text-blue-800 font-mono"></p>
                <p id="winnerBU" class="text-lg font-bold text-gray-600 mt-2 uppercase"></p>
                <p id="winnerTeam" class="text-base font-medium text-gray-400 mt-2 uppercase"></p>
            </div>
            <div class="flex flex-col gap-4">
                <button id="cancelWinnerButton" class="text-base font-bold text-red-400 hover:text-red-600 hover:underline transition-all uppercase">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Cancel)</button>
                <button id="closeWinnerModalButton" class="px-12 py-3 text-base font-black bg-blue-600 text-white rounded-[1.5rem] hover:bg-blue-700 shadow-2xl active:scale-95 transition-all">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Profile -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-[120] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="editEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="editEmpName" class="font-black text-gray-900 text-lg"></p></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Manager / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="editEmpManager" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Team / ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label><input type="text" id="editEmpTeam" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <p id="editError" class="text-red-600 text-sm font-black italic mt-2"></p>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditModalButton" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Gift -->
    <div id="editGiftModal" class="hidden fixed inset-0 z-[150] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
            <div class="space-y-6">
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label><input type="text" id="editGiftName" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ 50 ‡∏ô‡∏¥‡πâ‡∏ß"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                        <input type="number" id="editGiftTotalQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="1">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                        <input type="number" id="editGiftRemainingQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="0">
                    </div>
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditGiftModalBtn" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditGiftBtn" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmation Center -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[300] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div id="confirmModalInner" class="bg-white rounded-2xl p-10 max-w-lg w-full shadow-2xl text-center transition-all duration-300">
            <h3 id="confirmTitle" class="text-xl font-black mb-4 uppercase text-red-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?</h3>
            <p id="confirmText" class="text-gray-600 font-bold mb-6 leading-relaxed italic text-base"></p>
            
            <div id="confirmInputContainer" class="hidden mb-10">
                <p class="text-sm text-gray-500 mb-2">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <span class="font-bold text-red-600 uppercase">Reset</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <input type="text" id="confirmInput" class="text-center border-2 border-red-200 rounded-lg p-2 w-full focus:border-red-500 outline-none text-sm font-bold uppercase" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            </div>

            <div class="flex justify-center gap-4">
                <button id="closeConfirmButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm font-bold hover:bg-gray-200 uppercase">‡πÑ‡∏°‡πà</button>
                <button id="confirmActionButton" class="px-8 py-2 bg-red-600 text-white rounded-xl text-sm font-black shadow-lg hover:bg-red-700 uppercase">‡πÉ‡∏ä‡πà</button>
            </div>
        </div>
    </div>

    <!-- Script Section -->
    <script type="module">
function _0x3862(){const _0x16d4b6=['closeEditModalButton','gvOverallStatsRegistered','</td><td\x20class=\x22px-4\x20py-4\x20uppercase\x20font-bold\x20text-xm\x20text-left\x20text-sm\x20text-sm\x22>','sort-emp-branch','editGift','bg-blue-100\x20border-blue-500\x20shadow-md','<tr><td\x20colspan=\x227\x22\x20class=\x22p-10\x20text-center\x20text-gray-400\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>','bg-red-500\x20text-white\x20cursor-pointer\x20hover:bg-red-600','crsg','groupViewManagerFilter','modalParticipantsCount','B14','bg-gray-300','createObjectURL','appendChild','branch','Check_Place','‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß','loader','#3B82F6','<div\x20onclick=\x22pickGift(\x27','ttb-register','A17','dispatchEvent','unregistered','long','confirmModal','startsWith','A12','\x20class=\x22px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-black\x20transition-all\x20shadow-sm\x20','‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','timelineTotalInvite','remove','member','classList','modalDrawnCount','A19','confirmInputContainer','bottom','bg-orange-100','\x27)\x22','‡∏™‡∏≤‡∏Ç‡∏≤:\x20','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','closeManualRegModalButton','editEmpId','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20font-bold\x20text-left\x20text-sm\x22>','searchEmployeeError','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22removeLuckyWinner(\x27','updateGiftOrder','\x22\x20onchange=\x22updateGiftOrder(\x27','digit','text-base\x20font-black\x20text-blue-600\x20leading-tight\x20uppercase\x20text-sm','numeric','grStartDrawBtn','</option>','‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á\x20[','goal','reduce','#F59E0B','definedTeamNamesInput','breakdownCenterTotal','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å','searchRegEmployeeButton','timeline','</button>','OFF','labels','grGiftDisplayQty','\x20‡∏ó‡πà‡∏≤‡∏ô</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22overflow-x-auto\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22min-w-full\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-header-gray\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏£‡∏´‡∏±‡∏™</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏≤‡∏Ç‡∏≤</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20class=\x22divide-y\x20divide-gray-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','max','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-mono\x20font-black\x20text-blue-700\x22>','\x20onclick=\x22changeEmpPage(','status','data','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-600\x20text-sm\x20text-sm\x22>','startRandomizeButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-left\x20uppercase\x22>','A18','B24','B10','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x20text-sm\x20text-sm\x22>','employeeId','sort-emp-member','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><button\x20onclick=\x22toggleGiftStatus(\x27','manager','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö','RandomTime','loading-gif','indGiftDisplayName','A24','grTotalWinners','ceil','off','14311832uJjTCM','<tr\x20class=\x22','bar2','dashboardListTableBody','\x20hover:bg-gray-50\x20text-center\x20text-sm\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-gray-400\x20text-xs\x22>','B15','winnerDetailModal','Check_Manager','text-gray-500','saveEditModalButton','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö','total','</td><td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-xm\x20text-left\x20text-sm\x22>','openGroupDetail','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>','filter','managerFilterSelect','\x27)\x22\x20class=\x22px-3\x20py-0\x20bg-red-100\x20text-red-600\x20rounded-lg\x20text-xs\x20font-black\x20hover:bg-red-600\x20hover:text-white\x20transition-all\x20uppercase\x22>‡∏•‡∏ö</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','grGiftBox','teamStatsContainer','sort-emp-status','6EYOSka','grBoxRight','register-content','closeEditGiftModalBtn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x20text-center\x20text-sm\x22>','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','B13','<option\x20value=\x22\x22>--\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°\x20--</option>','gvOverallStatsTotal','find','bg-gray-100','docs','downloadWinnersCsvButton','A21','regManualError','innerHTML','forEach','dashboard-content','</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><span\x20onclick=\x22editGift(\x27','winnersByGiftContainer','value','card-registered','1052860HpysIx','#fff','121725xVQohD','\x27)\x22\x20class=\x22text-red-600\x20hover:text-red-700\x20cursor-pointer\x20font-black\x20text-xs\x22>‡∏•‡∏ö</span></td></tr>',')\x22>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-black\x20','\x27,\x20\x27','B12','resize','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20mr-2\x20text-sm\x22>Edit</span>|\x20<span\x20onclick=\x22deleteGift(\x27','</span>','A14','selectedTeamTableBody','Winners_Report.csv','editEmpManager','\x22,\x22‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô\x22\x0a','editGiftName','<option\x20value=\x22','closeWinnerModalButton','editEmpName','href','‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-mono\x20font-bold\x20text-blue-700\x20text-center\x22>','#loader','change','Non-Invite','groupViewStatsRegistered','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x22>','doughnut','invite','\x22\x20onclick=\x22changeEmpPage(','donutPercentage','hidden','drawnWinnersTableBody','deleteGift','searchEmployeeIdInput',')\x22>','removeLuckyWinner','DateLogin','Registration_Report.csv','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all\x20text-sm','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><input\x20type=\x22number\x22\x20value=\x22','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','groupViewTableBody','saveManualRegButton','toggleGiftStatus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','card-total','2-digit','trim','group-random-content','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20uppercase\x20text-left\x22>','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-400\x20text-center\x20text-xs\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20font-black\x20text-gray-900\x20mt-0.5\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>','name','bg-gray-200\x20text-gray-600','‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','asc','B20','updateTeamNamesBtn','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center\x20transition-all\x20duration-300','getElementById','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center','teamGridB','currentDateTime','Invite','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','\ufeff‡∏•‡∏≥‡∏î‡∏±‡∏ö,‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,Member,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-blue-600\x20font-bold\x20uppercase\x20text-center\x22>','changeEmpPage','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','editGiftRemainingQty','datasets','regEmpBranch','searchEmployeeButton','--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-black\x20uppercase\x20text-xs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','bg-blue-600\x20text-white','addEventListener','Branch_eng','\x27)\x22\x20class=\x22bg-red-100\x20text-red-700\x20px-3\x20py-1\x20rounded\x20text-[10px]\x20font-normal\x20uppercase\x20cursor-pointer\x20hover:bg-red-200\x20transition-all\x20text-sm\x20text-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toString','grGiftDisplayName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22editEmp(\x27','line','<div\x20class=\x22p-10\x20text-center\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--</div>','editGiftModal','A15','slice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','markAsReceived','</td><td\x20class=\x22px-4\x20py-4\x20text-xm\x20font-bold\x20text-gray-500\x20uppercase\x20text-left\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x20text-sm\x20text-sm\x22>','#BFDBFE','latestRegistrationsTableBody','registrationBreakdownChart','card-extras','FullName_th','closeGiftPickerBtn','bg-yellow-50','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','4iTgJvP','confirmTitle','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-700\x20text-center\x20text-sm\x22>','bg-white\x20border-gray-100','totalQty','empStatsUnregistered','‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','addGiftBtn','registrationDonutChart','update','confirmModalInner','length','bar1','text/csv;charset=utf-8;','bg-green-100','AwardedGiftId','add','winnerEmployeeId','‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö','B21','giftPickerTitle','download','pickGift','round','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x20text-[10px]\x20font-normal\x20text-xs\x20text-sm\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x22>','join','openDashboardList','active','closeConfirmButton','flex\x20items-center\x20justify-between\x20bg-blue-50\x20border-2\x20border-blue-300\x20rounded-xl\x20p-3\x20transition-all','#E5E7EB','text-blue-800','team-list-content','75%','includes','\x27)\x22\x20class=\x22flex\x20items-center\x20justify-between\x20p-4\x20border\x20rounded-xl\x20hover:bg-blue-50\x20cursor-pointer\x20transition-all\x20','A10','crsg_gift','sort','‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:\x20','desc','1070273157855','regEmpInviteStatus','A16','‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','card-unregistered','random','giftPickerModal','bg-green-400\x20text-white\x20border-green-600','Select','<option\x20value=\x22\x22>--\x20‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','extras','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all','\x27)\x22\x20class=\x22bg-red-50\x20text-white\x20px-3\x20py-1\x20rounded\x20cursor-pointer\x20text-sm\x20font-bold\x22>‡∏•‡∏ö</span></td></tr>','confirmText','keys','searchRegEmployeeIdInput','createElement','fill','B23','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>','group-view-content','B19','managerEmployeeCount','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27','1:1070273157855:web:5c8120e1df27e233d8676a','text-base\x20text-gray-800','closeGroupViewModalButton','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß','grRemainingEligible','AwardedGift','from','A13','#10B981','breakdown','\x27)\x22\x20class=\x22px-4\x20py-1\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x20border\x20','400736JLkcbF','randomizeModal','grTotalEligible','disabled','randomizeError','teamGridA','<br/><span\x20class=\x22text-sm\x20text-orange-600\x20text-xs\x22>üéÅ\x20','toLocaleString','querySelector','\x20uppercase\x20text-sm\x22>','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','remainingQty','empStatsContainer','‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:\x20','regEmpSeat','ind','groupViewModal','padStart','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á','sort-emp-manager','randomizeButton','downloadCsvButton','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20','<option\x20value=\x22\x22>--\x20‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','A23','giftPickerList','error','order','registered','\x22,\x22','bar','teamSelect','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x22>','commit','\ufeff‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡∏°,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢','\x20‡∏ä‡∏¥‡πâ‡∏ô','winnerBU','editEmp','3207920egMTLb','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20','bg-gray-100\x20text-gray-500','groupViewStatsTotal','top','div','editGiftTotalQty','editEmpTeam','1010bnokrq','B16','localeCompare','empStatsRegistered','cancelReg','12283901eCPmUv','sort-emp-gift','winnerGiftText','click','--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--','editEmployeeModal','2654466UDlZgv','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-2\x20py-0.5\x20rounded\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','teamMemberCountElem','saveEditGiftBtn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22px-4\x20py-1\x20','sort-emp-name','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô','sort-emp-id','targetCount','</td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20class=\x22px-3\x20py-0\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span></td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22cancelReg(\x27','textContent','map','winnerTeam','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-indigo-600\x20text-white\x20px-3\x20py-1\x20rounded-full\x20text-xs\x20font-bold\x20uppercase\x22>','empStatsPercent','gift','toMillis','dashboardListModal','manualRegisterModal','className','teamStatsRegistered','Remaining','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20onclick=\x22openGroupDetail(\x27','<button\x20class=\x22pagination-btn\x20','winnerName','empStatsTotal','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','split','options','text-sm\x20font-bold\x20text-gray-600\x20mt-1\x20text-sm','teamStatsTotal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-left\x22>','attendeesCount','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-sm\x22>','giftListTableBody','RESET','th-TH','<tr><td\x20class=\x22px-4\x20py-4\x20font-mono\x20font-black\x20text-blue-700\x20text-center\x20text-sm\x22>','ReceivedTime'];_0x3862=function(){return _0x16d4b6;};return _0x3862();}const _0x4a069b=_0x29e5;(function(_0x267f88,_0x1c1179){const _0x369a4d=_0x29e5,_0x326af2=_0x267f88();while(!![]){try{const _0x23fd1f=-parseInt(_0x369a4d(0x1eb))/0x1+parseInt(_0x369a4d(0x213))/0x2+parseInt(_0x369a4d(0x226))/0x3+parseInt(_0x369a4d(0x19d))/0x4*(parseInt(_0x369a4d(0x2d7))/0x5)+parseInt(_0x369a4d(0x2c1))/0x6*(parseInt(_0x369a4d(0x220))/0x7)+-parseInt(_0x369a4d(0x2ac))/0x8+parseInt(_0x369a4d(0x2d9))/0x9*(-parseInt(_0x369a4d(0x21b))/0xa);if(_0x23fd1f===_0x1c1179)break;else _0x326af2['push'](_0x326af2['shift']());}catch(_0x305b23){_0x326af2['push'](_0x326af2['shift']());}}}(_0x3862,0xdb599));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,collection,onSnapshot,doc,updateDoc,setDoc,addDoc,deleteDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x4a069b(0x241),'authDomain':'ttb-register.firebaseapp.com','projectId':_0x4a069b(0x263),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0x4a069b(0x1c8),'appId':_0x4a069b(0x1e0)};let db,auth,allEmployeesData=[],allGiftsData=[],selectedIndGiftId=null,selectedGroupGiftId=null,giftPickerContext=_0x4a069b(0x1fb),teamNames=['A1','A2','A3','A4','A5','A6','A7','A8','A9',_0x4a069b(0x1c3),'A11',_0x4a069b(0x26a),_0x4a069b(0x1e7),_0x4a069b(0x2e2),_0x4a069b(0x331),_0x4a069b(0x1ca),_0x4a069b(0x264),_0x4a069b(0x29c),_0x4a069b(0x272),'A20',_0x4a069b(0x2ce),'A22',_0x4a069b(0x204),_0x4a069b(0x2a8),'B1','B2','B3','B4','B5','B6','B7','B8','B9',_0x4a069b(0x29e),'B11',_0x4a069b(0x2de),_0x4a069b(0x2c7),_0x4a069b(0x259),_0x4a069b(0x2b1),_0x4a069b(0x21c),'B17','B18',_0x4a069b(0x1dd),_0x4a069b(0x312),_0x4a069b(0x1b0),'B22',_0x4a069b(0x1da),_0x4a069b(0x29d)],charts={},currentConfirmAction=null,currentEditingDocId=null,currentEditingGiftId=null,drawInterval=null,empSortField=_0x4a069b(0x297),empSortDir='desc',empCurrentPage=0x1;const empPageSize=0x64;((async()=>{const _0x4e8fd8=_0x4a069b;try{const _0x4365fb=initializeApp(firebaseConfig);db=getFirestore(_0x4365fb),auth=getAuth(_0x4365fb),await signInAnonymously(auth),initCharts(),setupTabs(),setupListeners(),startListening(),startListeningGifts(),document[_0x4e8fd8(0x316)](_0x4e8fd8(0x289))[_0x4e8fd8(0x2d5)]=teamNames['join'](','),setInterval(()=>{const _0x32ae50=_0x4e8fd8,_0x569d7a=new Date();document['getElementById'](_0x32ae50(0x319))[_0x32ae50(0x230)]=_0x569d7a[_0x32ae50(0x1f2)](_0x32ae50(0x24b),{'year':_0x32ae50(0x282),'month':_0x32ae50(0x267),'day':_0x32ae50(0x282),'hour':_0x32ae50(0x307),'minute':_0x32ae50(0x307),'second':_0x32ae50(0x307)});},0x3e8);}catch(_0x4165f0){console['error'](_0x4165f0);}})());function setupTabs(){const _0x2f5e30=_0x4a069b,_0xb7abea={'tab-dashboard':_0x2f5e30(0x2d2),'tab-team-list':_0x2f5e30(0x1bf),'tab-group-view':_0x2f5e30(0x1dc),'tab-employee-list':'employee-list-content','tab-gift-management':'gift-management-content','tab-register':_0x2f5e30(0x2c3),'tab-group-random':_0x2f5e30(0x309),'tab-winners-list':'winners-list-content'};Object[_0x2f5e30(0x1d6)](_0xb7abea)[_0x2f5e30(0x2d1)](_0x2b335f=>{const _0x35a2d6=_0x2f5e30,_0x5bd097=document[_0x35a2d6(0x316)](_0x2b335f);if(!_0x5bd097)return;_0x5bd097[_0x35a2d6(0x328)](_0x35a2d6(0x223),function(){const _0x2a28c9=_0x35a2d6;Object[_0x2a28c9(0x1d6)](_0xb7abea)[_0x2a28c9(0x2d1)](_0x4f5ace=>{const _0x5685f0=_0x2a28c9,_0x5485a4=document[_0x5685f0(0x316)](_0x4f5ace),_0x140732=document[_0x5685f0(0x316)](_0xb7abea[_0x4f5ace]);if(_0x5485a4)_0x5485a4[_0x5685f0(0x270)]['replace']('bg-gray-300',_0x5685f0(0x2cb));if(_0x140732)_0x140732[_0x5685f0(0x270)][_0x5685f0(0x1ad)]('hidden');}),this[_0x2a28c9(0x270)]['replace'](_0x2a28c9(0x2cb),_0x2a28c9(0x25a)),document['getElementById'](_0xb7abea[_0x2b335f])?.[_0x2a28c9(0x270)]['remove'](_0x2a28c9(0x2f7)),window[_0x2a28c9(0x265)](new Event(_0x2a28c9(0x2df)));});});}function initCharts(){const _0x1eb080=_0x4a069b,_0x37a0ec={'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]},'datalabels':{'color':_0x1eb080(0x2d8),'font':{'weight':'bold','size':0xc},'formatter':_0x352b4f=>_0x352b4f>0x0?_0x352b4f:''}}};charts[_0x1eb080(0x1e9)]=new Chart(document['getElementById'](_0x1eb080(0x197)),{'type':_0x1eb080(0x2f3),'data':{'labels':[_0x1eb080(0x31a),_0x1eb080(0x2f0)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x1eb080(0x261),_0x1eb080(0x288)]}]},'options':{..._0x37a0ec,'cutout':_0x1eb080(0x1c0)},'plugins':[ChartDataLabels]}),charts[_0x1eb080(0x286)]=new Chart(document[_0x1eb080(0x316)](_0x1eb080(0x1a5)),{'type':'doughnut','data':{'labels':['Registered',_0x1eb080(0x23b)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x1eb080(0x1e8),_0x1eb080(0x1bd)]}]},'options':{..._0x37a0ec,'cutout':'75%'},'plugins':[ChartDataLabels]});const _0xaa480a={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'stacked':!![]},'y':{'stacked':!![]}},'plugins':{'legend':{'display':!![],'position':_0x1eb080(0x274),'labels':{'font':{'size':0xc}}},'datalabels':{'color':_0x1eb080(0x2d8)}}};charts[_0x1eb080(0x1a9)]=new Chart(document[_0x1eb080(0x316)]('teamBarChart1'),{'type':_0x1eb080(0x20a),'data':{'labels':[],'datasets':[{'label':'‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','data':[],'backgroundColor':_0x1eb080(0x261)},{'label':_0x1eb080(0x1fe),'data':[],'backgroundColor':_0x1eb080(0x337)}]},'options':_0xaa480a,'plugins':[ChartDataLabels]}),charts['bar2']=new Chart(document[_0x1eb080(0x316)]('teamBarChart2'),{'type':_0x1eb080(0x20a),'data':{'labels':[],'datasets':[{'label':_0x1eb080(0x1cb),'data':[],'backgroundColor':_0x1eb080(0x261)},{'label':'‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á','data':[],'backgroundColor':_0x1eb080(0x337)}]},'options':_0xaa480a,'plugins':[ChartDataLabels]}),charts[_0x1eb080(0x28d)]=new Chart(document[_0x1eb080(0x316)]('registrationTimelineChart'),{'type':_0x1eb080(0x32e),'data':{'labels':Array[_0x1eb080(0x1e6)]({'length':0x18},(_0x36a0de,_0x35a45b)=>_0x35a45b[_0x1eb080(0x32b)]()[_0x1eb080(0x1fd)](0x2,'0')+':00'),'datasets':[{'label':_0x1eb080(0x20f),'data':Array(0x18)[_0x1eb080(0x1d9)](0x0),'borderColor':_0x1eb080(0x261),'backgroundColor':_0x1eb080(0x261),'tension':0.1},{'label':'‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô','data':Array(0x18)[_0x1eb080(0x1d9)](0x0),'borderColor':_0x1eb080(0x288),'backgroundColor':_0x1eb080(0x288),'tension':0.1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':!![],'position':_0x1eb080(0x217)},'datalabels':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function startListening(){const _0x3c9819=_0x4a069b;onSnapshot(collection(db,_0x3c9819(0x256)),_0x32c8ad=>{const _0x4f1eb9=_0x3c9819;allEmployeesData=_0x32c8ad[_0x4f1eb9(0x2cc)]['map'](_0x5621c6=>({'id':_0x5621c6['id'],..._0x5621c6['data']()})),refreshUI();},_0x2d4887=>console['error'](_0x2d4887));}function startListeningGifts(){const _0x2677ef=_0x4a069b;onSnapshot(collection(db,_0x2677ef(0x1c4)),_0x1eca3e=>{const _0x234702=_0x2677ef,_0x11b09c=_0x1eca3e[_0x234702(0x2cc)][_0x234702(0x231)](_0x2e5c2c=>({'id':_0x2e5c2c['id'],..._0x2e5c2c[_0x234702(0x298)]()}));allGiftsData=_0x11b09c['sort']((_0x2cf8a9,_0x287c0f)=>(_0x2cf8a9[_0x234702(0x207)]||0x0)-(_0x287c0f[_0x234702(0x207)]||0x0)),renderGiftTable(),refreshIndGiftState(),refreshGroupGiftState(),updateWinnersList();},_0x21f73a=>console['error'](_0x21f73a));}function refreshUI(){const _0x37fbb0=_0x4a069b,_0x28b436=allEmployeesData[_0x37fbb0(0x2bb)](_0x3386e6=>_0x3386e6[_0x37fbb0(0x2fd)]),_0x443068=allEmployeesData['filter'](_0x596d99=>_0x596d99[_0x37fbb0(0x2fd)]&&_0x596d99[_0x37fbb0(0x2f4)]===_0x37fbb0(0x2f4)),_0x1e39d5=allEmployeesData[_0x37fbb0(0x2bb)](_0x4fa231=>_0x4fa231['DateLogin']&&_0x4fa231['invite']!=='invite'),_0x5ca09f=allEmployeesData[_0x37fbb0(0x2bb)](_0x486e73=>_0x486e73[_0x37fbb0(0x2f4)]===_0x37fbb0(0x2f4));document[_0x37fbb0(0x316)](_0x37fbb0(0x1de))[_0x37fbb0(0x230)]=allEmployeesData[_0x37fbb0(0x2bb)](_0x3496ee=>_0x3496ee['Check_Manager'])['length'],document[_0x37fbb0(0x316)](_0x37fbb0(0x228))[_0x37fbb0(0x230)]=allEmployeesData[_0x37fbb0(0x2bb)](_0x426ad9=>_0x426ad9[_0x37fbb0(0x25e)])[_0x37fbb0(0x1a8)];const _0x1abfe4=allEmployeesData['filter'](_0xcb8ba4=>_0xcb8ba4[_0x37fbb0(0x25e)]&&_0xcb8ba4[_0x37fbb0(0x25e)][_0x37fbb0(0x308)]()!==''),_0x2e5018=_0x1abfe4[_0x37fbb0(0x1a8)],_0x46585b=_0x1abfe4[_0x37fbb0(0x2bb)](_0xd7b9b2=>_0xd7b9b2[_0x37fbb0(0x2fd)])[_0x37fbb0(0x1a8)],_0x1e3460=_0x2e5018-_0x46585b,_0x5bf2de=_0x2e5018>0x0?Math[_0x37fbb0(0x1b4)](_0x46585b/_0x2e5018*0x64):0x0;document[_0x37fbb0(0x316)](_0x37fbb0(0x1f7))&&(document[_0x37fbb0(0x316)]('empStatsTotal')[_0x37fbb0(0x230)]=_0x2e5018,document[_0x37fbb0(0x316)](_0x37fbb0(0x21e))[_0x37fbb0(0x230)]=_0x46585b,document['getElementById']('empStatsUnregistered')[_0x37fbb0(0x230)]=_0x1e3460,document[_0x37fbb0(0x316)](_0x37fbb0(0x234))[_0x37fbb0(0x230)]=_0x5bf2de+'%',document[_0x37fbb0(0x316)](_0x37fbb0(0x1f7))[_0x37fbb0(0x270)][_0x37fbb0(0x26e)](_0x37fbb0(0x2f7)));document['getElementById'](_0x37fbb0(0x22e))['textContent']=_0x5ca09f[_0x37fbb0(0x1a8)],document[_0x37fbb0(0x316)]('participantsCountBox')[_0x37fbb0(0x230)]=_0x443068['length'],document['getElementById'](_0x37fbb0(0x247))['textContent']=_0x1e39d5[_0x37fbb0(0x1a8)],document['getElementById']('remainingCount')[_0x37fbb0(0x230)]=Math[_0x37fbb0(0x293)](0x0,_0x5ca09f['length']-_0x443068[_0x37fbb0(0x1a8)]),document[_0x37fbb0(0x316)](_0x37fbb0(0x28a))['textContent']=_0x28b436[_0x37fbb0(0x1a8)],document['getElementById'](_0x37fbb0(0x2f6))['textContent']=_0x5ca09f[_0x37fbb0(0x1a8)]?Math['round'](_0x443068[_0x37fbb0(0x1a8)]/_0x5ca09f['length']*0x64)+'%':'0%';charts[_0x37fbb0(0x1e9)]&&(charts[_0x37fbb0(0x1e9)][_0x37fbb0(0x298)]['datasets'][0x0][_0x37fbb0(0x298)]=[_0x443068[_0x37fbb0(0x1a8)],_0x1e39d5[_0x37fbb0(0x1a8)]],charts['breakdown']['update']());charts[_0x37fbb0(0x286)]&&(charts[_0x37fbb0(0x286)][_0x37fbb0(0x298)][_0x37fbb0(0x321)][0x0][_0x37fbb0(0x298)]=[_0x443068[_0x37fbb0(0x1a8)],Math[_0x37fbb0(0x293)](0x0,_0x5ca09f['length']-_0x443068[_0x37fbb0(0x1a8)])],charts[_0x37fbb0(0x286)]['update']());if(charts[_0x37fbb0(0x28d)]){const _0x5ab23c=Array(0x18)['fill'](0x0),_0x3731dc=Array(0x18)[_0x37fbb0(0x1d9)](0x0);let _0x32a4eb=0x0,_0x5051df=0x0;_0x28b436[_0x37fbb0(0x2d1)](_0x12c392=>{const _0xc174d3=_0x37fbb0;if(_0x12c392[_0xc174d3(0x2fd)]){const _0x88ebe=new Date(_0x12c392[_0xc174d3(0x2fd)][_0xc174d3(0x236)]()),_0x657a31=_0x88ebe['getHours']();_0x12c392['invite']===_0xc174d3(0x2f4)?(_0x5ab23c[_0x657a31]++,_0x32a4eb++):(_0x3731dc[_0x657a31]++,_0x5051df++);}}),charts[_0x37fbb0(0x28d)][_0x37fbb0(0x298)][_0x37fbb0(0x321)][0x0][_0x37fbb0(0x298)]=_0x5ab23c,charts[_0x37fbb0(0x28d)][_0x37fbb0(0x298)][_0x37fbb0(0x321)][0x1]['data']=_0x3731dc,charts[_0x37fbb0(0x28d)][_0x37fbb0(0x1a6)](),document[_0x37fbb0(0x316)](_0x37fbb0(0x26d))[_0x37fbb0(0x230)]=_0x32a4eb,document[_0x37fbb0(0x316)]('timelineTotalExtra')['textContent']=_0x5051df;}const _0x6320d9={};teamNames[_0x37fbb0(0x2d1)](_0x36596a=>_0x6320d9[_0x36596a]={'r':0x0,'t':0x0}),allEmployeesData['forEach'](_0x49b33d=>{const _0x25e039=_0x37fbb0;if(_0x49b33d[_0x25e039(0x25e)]&&_0x6320d9[_0x49b33d[_0x25e039(0x25e)]]){_0x6320d9[_0x49b33d[_0x25e039(0x25e)]]['t']++;if(_0x49b33d[_0x25e039(0x2fd)])_0x6320d9[_0x49b33d[_0x25e039(0x25e)]]['r']++;}});const _0x144dff=Math[_0x37fbb0(0x2aa)](teamNames['length']/0x2);charts['bar1']&&(charts[_0x37fbb0(0x1a9)][_0x37fbb0(0x298)]['labels']=teamNames[_0x37fbb0(0x332)](0x0,_0x144dff),charts[_0x37fbb0(0x1a9)][_0x37fbb0(0x298)][_0x37fbb0(0x321)][0x0]['data']=teamNames[_0x37fbb0(0x332)](0x0,_0x144dff)[_0x37fbb0(0x231)](_0xaf2b8c=>_0x6320d9[_0xaf2b8c]['r']),charts[_0x37fbb0(0x1a9)][_0x37fbb0(0x298)]['datasets'][0x1]['data']=teamNames[_0x37fbb0(0x332)](0x0,_0x144dff)[_0x37fbb0(0x231)](_0x334da7=>_0x6320d9[_0x334da7]['t']-_0x6320d9[_0x334da7]['r']),charts['bar1'][_0x37fbb0(0x1a6)]());charts[_0x37fbb0(0x2ae)]&&(charts[_0x37fbb0(0x2ae)][_0x37fbb0(0x298)][_0x37fbb0(0x290)]=teamNames['slice'](_0x144dff),charts[_0x37fbb0(0x2ae)]['data'][_0x37fbb0(0x321)][0x0]['data']=teamNames['slice'](_0x144dff)[_0x37fbb0(0x231)](_0x20dfc8=>_0x6320d9[_0x20dfc8]['r']),charts[_0x37fbb0(0x2ae)][_0x37fbb0(0x298)][_0x37fbb0(0x321)][0x1][_0x37fbb0(0x298)]=teamNames[_0x37fbb0(0x332)](_0x144dff)['map'](_0x1dd0e5=>_0x6320d9[_0x1dd0e5]['t']-_0x6320d9[_0x1dd0e5]['r']),charts[_0x37fbb0(0x2ae)][_0x37fbb0(0x1a6)]());const _0x2ca8f6=[..._0x28b436][_0x37fbb0(0x1c5)]((_0x101087,_0x921ab6)=>(_0x921ab6[_0x37fbb0(0x2fd)]?.[_0x37fbb0(0x236)]()||0x0)-(_0x101087[_0x37fbb0(0x2fd)]?.[_0x37fbb0(0x236)]()||0x0))[_0x37fbb0(0x332)](0x0,0x1e);document[_0x37fbb0(0x316)](_0x37fbb0(0x196))['innerHTML']=_0x2ca8f6['map'](_0xa45fc1=>'<tr><td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>'+_0xa45fc1['employeeId']+'</td><td\x20class=\x22px-4\x20py-0\x20uppercase\x20font-bold\x20text-xm\x20text-left\x20text-sm\x22>'+_0xa45fc1['FullName_th']+_0x37fbb0(0x2b8)+(_0xa45fc1[_0x37fbb0(0x329)]||'-')+_0x37fbb0(0x2b8)+(_0xa45fc1[_0x37fbb0(0x2b3)]||'-')+_0x37fbb0(0x22f)+_0xa45fc1['id']+'\x27,\x20\x27'+_0xa45fc1[_0x37fbb0(0x199)]+_0x37fbb0(0x2da))[_0x37fbb0(0x1b8)](''),updateTeamTab(),updateGridTab(),updateEmployeeList(),updateGroupRandomUI(),updateLuckyDrawStats(),updateWinnersList();}function updateWinnersList(){const _0x377c4f=_0x4a069b,_0x407ef0=document[_0x377c4f(0x316)](_0x377c4f(0x2d4));if(!_0x407ef0)return;const _0x2c8b88=allEmployeesData[_0x377c4f(0x2bb)](_0x20c481=>_0x20c481[_0x377c4f(0x2a5)]);if(_0x2c8b88[_0x377c4f(0x1a8)]===0x0){_0x407ef0['innerHTML']=_0x377c4f(0x32f);return;}_0x407ef0['innerHTML']=allGiftsData[_0x377c4f(0x231)](_0x1687b3=>{const _0x4f9f27=_0x377c4f,_0x24adcf=_0x2c8b88[_0x4f9f27(0x2bb)](_0x193060=>_0x193060[_0x4f9f27(0x1ac)]===_0x1687b3['id']||_0x193060[_0x4f9f27(0x1e5)]===_0x1687b3[_0x4f9f27(0x30e)]&&!_0x193060[_0x4f9f27(0x1ac)]);if(_0x24adcf[_0x4f9f27(0x1a8)]===0x0)return'';return _0x24adcf[_0x4f9f27(0x1c5)]((_0x36c1ca,_0x58d69e)=>(_0x58d69e[_0x4f9f27(0x2a5)]?.[_0x4f9f27(0x236)]()||0x0)-(_0x36c1ca[_0x4f9f27(0x2a5)]?.[_0x4f9f27(0x236)]()||0x0)),'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-white\x20border\x20border-gray-100\x20rounded-2xl\x20overflow-hidden\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-gray-50\x20px-6\x20py-4\x20border-b\x20flex\x20justify-between\x20items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-black\x20text-indigo-700\x20uppercase\x22>üéÅ\x20‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20'+_0x1687b3[_0x4f9f27(0x30e)]+_0x4f9f27(0x233)+_0x24adcf['length']+_0x4f9f27(0x292)+_0x24adcf[_0x4f9f27(0x231)]((_0x2be33d,_0x1cb5a2)=>{const _0x595c07=_0x4f9f27,_0x5193b0=_0x2be33d[_0x595c07(0x24d)]?!![]:![],_0x29578a=_0x5193b0?'‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß':_0x595c07(0x2b6),_0x15771c=_0x5193b0?'bg-green-500\x20text-white':_0x595c07(0x255),_0xee3ded=_0x5193b0?'':'onclick=\x22markAsReceived(\x27'+_0x2be33d['id']+_0x595c07(0x276);return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20transition-colors\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-bold\x20text-gray-400\x20text-xs\x22>'+(_0x1cb5a2+0x1)+_0x595c07(0x295)+_0x2be33d['employeeId']+_0x595c07(0x30a)+_0x2be33d[_0x595c07(0x199)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-left\x22>'+(_0x2be33d[_0x595c07(0x329)]||'-')+_0x595c07(0x246)+(_0x2be33d[_0x595c07(0x2b3)]||'-')+_0x595c07(0x31d)+(_0x2be33d[_0x595c07(0x25e)]||'-')+_0x595c07(0x214)+_0xee3ded+_0x595c07(0x26b)+_0x15771c+'\x22>'+_0x29578a+_0x595c07(0x27d)+_0x2be33d['id']+_0x595c07(0x2bd);})[_0x4f9f27(0x1b8)]('')+_0x4f9f27(0x305);})[_0x377c4f(0x1b8)]('');}window[_0x4a069b(0x334)]=async _0x2e4887=>{const _0x17a6a5=_0x4a069b;try{await updateDoc(doc(db,_0x17a6a5(0x256),_0x2e4887),{'ReceivedTime':serverTimestamp()});}catch(_0x15c799){console[_0x17a6a5(0x206)](_0x15c799);}},window[_0x4a069b(0x1b9)]=_0x9c77a3=>{const _0x5f266e=_0x4a069b;let _0x3b50da='',_0x5d03ec=[];if(_0x9c77a3===_0x5f266e(0x2b7))_0x3b50da='‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',_0x5d03ec=allEmployeesData[_0x5f266e(0x2bb)](_0xdc9f4b=>_0xdc9f4b[_0x5f266e(0x2f4)]===_0x5f266e(0x2f4));else{if(_0x9c77a3==='registered')_0x3b50da=_0x5f266e(0x1e3),_0x5d03ec=allEmployeesData[_0x5f266e(0x2bb)](_0x50c012=>_0x50c012[_0x5f266e(0x2fd)]&&_0x50c012['invite']===_0x5f266e(0x2f4));else{if(_0x9c77a3===_0x5f266e(0x266))_0x3b50da='‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô',_0x5d03ec=allEmployeesData['filter'](_0x152327=>!_0x152327[_0x5f266e(0x2fd)]&&_0x152327[_0x5f266e(0x2f4)]===_0x5f266e(0x2f4));else _0x9c77a3===_0x5f266e(0x1d2)&&(_0x3b50da='‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô',_0x5d03ec=allEmployeesData[_0x5f266e(0x2bb)](_0x3dd429=>_0x3dd429[_0x5f266e(0x2fd)]&&_0x3dd429[_0x5f266e(0x2f4)]!=='invite'));}}document[_0x5f266e(0x316)]('dashboardListModalTitle')[_0x5f266e(0x230)]=_0x3b50da,document[_0x5f266e(0x316)]('dashboardListCount')['textContent']=_0x5d03ec['length'];const _0x19f1e4=document[_0x5f266e(0x316)](_0x5f266e(0x2af));_0x19f1e4[_0x5f266e(0x2d0)]=_0x5d03ec[_0x5f266e(0x231)]((_0x358996,_0x3154de)=>{const _0x53fbea=_0x5f266e,_0x55afdb=_0x358996['DateLogin']?new Date(_0x358996[_0x53fbea(0x2fd)]['toMillis']())[_0x53fbea(0x1f2)](_0x53fbea(0x24b),{'hour':_0x53fbea(0x307),'minute':_0x53fbea(0x307)}):'-';return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-gray-400\x20font-bold\x20text-xs\x22>'+(_0x3154de+0x1)+_0x53fbea(0x2ed)+_0x358996[_0x53fbea(0x2a0)]+_0x53fbea(0x29b)+_0x358996[_0x53fbea(0x199)]+_0x53fbea(0x1db)+(_0x358996[_0x53fbea(0x329)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>'+(_0x358996['Check_Manager']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x22>'+(_0x358996[_0x53fbea(0x25e)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20text-gray-500\x20text-center\x22>'+_0x55afdb+_0x53fbea(0x314);})[_0x5f266e(0x1b8)]('')||_0x5f266e(0x254),document[_0x5f266e(0x316)](_0x5f266e(0x237))[_0x5f266e(0x270)][_0x5f266e(0x26e)]('hidden');};async function addGift(){const _0x2ada71=_0x4a069b,_0x815ba3=document[_0x2ada71(0x316)]('giftNameInput')[_0x2ada71(0x2d5)][_0x2ada71(0x308)](),_0x2d1c40=parseInt(document['getElementById']('giftQtyInput')['value']);if(!_0x815ba3||isNaN(_0x2d1c40))return;const _0xfa97c5=allGiftsData[_0x2ada71(0x287)]((_0x20c066,_0x1df732)=>Math[_0x2ada71(0x293)](_0x20c066,_0x1df732[_0x2ada71(0x207)]||0x0),0x0);await addDoc(collection(db,_0x2ada71(0x1c4)),{'name':_0x815ba3,'totalQty':_0x2d1c40,'remainingQty':_0x2d1c40,'status':'on','order':_0xfa97c5+0x1,'createdAt':serverTimestamp()}),document[_0x2ada71(0x316)]('giftNameInput')[_0x2ada71(0x2d5)]='',document[_0x2ada71(0x316)]('giftQtyInput')['value']='1';}function renderGiftTable(){const _0x13b553=_0x4a069b,_0x534187=document[_0x13b553(0x316)](_0x13b553(0x249));if(allGiftsData['length']===0x0){_0x534187[_0x13b553(0x2d0)]='<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-400\x20font-bold\x22>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>';return;}_0x534187[_0x13b553(0x2d0)]=allGiftsData[_0x13b553(0x231)]((_0x55496c,_0x5d3131)=>_0x13b553(0x300)+(_0x55496c[_0x13b553(0x207)]||_0x5d3131+0x1)+_0x13b553(0x27f)+_0x55496c['id']+'\x27,\x20this.value)\x22\x20class=\x22w-16\x20p-1\x20text-center\x20border\x20rounded\x20font-bold\x20text-blue-600\x22\x20min=\x221\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20font-normal\x22>'+_0x55496c[_0x13b553(0x30e)]+_0x13b553(0x248)+_0x55496c[_0x13b553(0x1a1)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-blue-600\x20font-bold\x20text-sm\x22>'+_0x55496c[_0x13b553(0x1f6)]+_0x13b553(0x2a2)+_0x55496c['id']+_0x13b553(0x2dd)+_0x55496c[_0x13b553(0x297)]+_0x13b553(0x1ea)+(_0x55496c['status']==='on'?_0x13b553(0x1cf):_0x13b553(0x30f))+'\x22>'+(_0x55496c[_0x13b553(0x297)]==='on'?'ON':_0x13b553(0x28f))+_0x13b553(0x2d3)+_0x55496c['id']+_0x13b553(0x2e0)+_0x55496c['id']+_0x13b553(0x2dd)+_0x55496c[_0x13b553(0x30e)]+'\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20text-sm\x22>Delete</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20')[_0x13b553(0x1b8)]('');}window[_0x4a069b(0x27e)]=async(_0x379941,_0x118183)=>{const _0x5a8933=_0x4a069b,_0x519aa5=parseInt(_0x118183);if(!isNaN(_0x519aa5))await updateDoc(doc(db,_0x5a8933(0x1c4),_0x379941),{'order':_0x519aa5});},window[_0x4a069b(0x304)]=async(_0x205973,_0x2f9bec)=>{const _0x5612b3=_0x4a069b;await updateDoc(doc(db,_0x5612b3(0x1c4),_0x205973),{'status':_0x2f9bec==='on'?_0x5612b3(0x2ab):'on'});},window[_0x4a069b(0x252)]=_0x44a4bb=>{const _0x22f148=_0x4a069b,_0xcfb4aa=allGiftsData['find'](_0x42b47f=>_0x42b47f['id']===_0x44a4bb);if(!_0xcfb4aa)return;currentEditingGiftId=_0x44a4bb,document[_0x22f148(0x316)](_0x22f148(0x2e7))[_0x22f148(0x2d5)]=_0xcfb4aa[_0x22f148(0x30e)],document['getElementById']('editGiftTotalQty')[_0x22f148(0x2d5)]=_0xcfb4aa[_0x22f148(0x1a1)],document[_0x22f148(0x316)]('editGiftRemainingQty')[_0x22f148(0x2d5)]=_0xcfb4aa['remainingQty'],document[_0x22f148(0x316)](_0x22f148(0x330))[_0x22f148(0x270)]['remove'](_0x22f148(0x2f7));},window[_0x4a069b(0x2f9)]=(_0x1e34e2,_0x22b721)=>{const _0x4131b4=_0x4a069b,_0x4d2c18=document['getElementById'](_0x4131b4(0x1a7));_0x4d2c18[_0x4131b4(0x239)]=_0x4131b4(0x315),currentConfirmAction=async()=>{const _0x6b88c3=_0x4131b4;await deleteDoc(doc(db,_0x6b88c3(0x1c4),_0x1e34e2)),document['getElementById'](_0x6b88c3(0x268))[_0x6b88c3(0x270)][_0x6b88c3(0x1ad)](_0x6b88c3(0x2f7));},document[_0x4131b4(0x316)](_0x4131b4(0x19e))[_0x4131b4(0x230)]=_0x4131b4(0x1f8),document['getElementById']('confirmText')['textContent']='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö\x20['+_0x22b721+']\x20?',document[_0x4131b4(0x316)](_0x4131b4(0x273))[_0x4131b4(0x270)][_0x4131b4(0x1ad)](_0x4131b4(0x2f7)),document[_0x4131b4(0x316)](_0x4131b4(0x268))[_0x4131b4(0x270)]['remove'](_0x4131b4(0x2f7));};function renderGiftPicker(){const _0x80a0f=_0x4a069b,_0x2b6ff2=document[_0x80a0f(0x316)](_0x80a0f(0x205)),_0x1277c4=allGiftsData['filter'](_0xe2975a=>_0xe2975a['status']==='on'&&_0xe2975a[_0x80a0f(0x1f6)]>0x0);document['getElementById'](_0x80a0f(0x1b1))['textContent']=giftPickerContext===_0x80a0f(0x1fb)?_0x80a0f(0x310):_0x80a0f(0x1a3);if(!_0x1277c4['length']){_0x2b6ff2['innerHTML']='<p\x20class=\x22text-center\x20py-10\x20text-gray-400\x20font-bold\x20italic\x20text-sm\x22>--\x20‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠\x20--</p>';return;}const _0x6e34e1=giftPickerContext===_0x80a0f(0x1fb)?selectedIndGiftId:selectedGroupGiftId;_0x2b6ff2[_0x80a0f(0x2d0)]=_0x1277c4[_0x80a0f(0x231)](_0x1eae7d=>{const _0x13f5ab=_0x80a0f,_0x3d54b0=_0x1eae7d['id']===_0x6e34e1;return _0x13f5ab(0x262)+_0x1eae7d['id']+_0x13f5ab(0x1c2)+(_0x3d54b0?_0x13f5ab(0x253):_0x13f5ab(0x1a0))+_0x13f5ab(0x2dc)+(_0x3d54b0?_0x13f5ab(0x1be):_0x13f5ab(0x1e1))+_0x13f5ab(0x1f4)+_0x1eae7d[_0x13f5ab(0x30e)]+_0x13f5ab(0x240)+(_0x3d54b0?'text-blue-600':_0x13f5ab(0x2b4))+'\x20font-bold\x20text-sm\x22>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20'+_0x1eae7d[_0x13f5ab(0x1f6)]+_0x13f5ab(0x22a)+(_0x3d54b0?_0x13f5ab(0x327):_0x13f5ab(0x215))+'\x20rounded-lg\x20text-sm\x20font-black\x20uppercase\x22>'+(_0x3d54b0?'Selected':_0x13f5ab(0x1d0))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';})['join']('');}window[_0x4a069b(0x1b3)]=_0x17ce23=>{const _0x45d871=_0x4a069b;giftPickerContext===_0x45d871(0x1fb)?(selectedIndGiftId=_0x17ce23,refreshIndGiftState()):(selectedGroupGiftId=_0x17ce23,document[_0x45d871(0x316)]('teamGridA')['innerHTML']='',document[_0x45d871(0x316)]('teamGridB')[_0x45d871(0x2d0)]='',refreshGroupGiftState()),document[_0x45d871(0x316)]('giftPickerModal')['classList'][_0x45d871(0x1ad)](_0x45d871(0x2f7));};function refreshIndGiftState(){const _0x2ed00d=_0x4a069b,_0x768422=document[_0x2ed00d(0x316)](_0x2ed00d(0x2a7)),_0x401062=document[_0x2ed00d(0x316)]('indGiftDisplayQty'),_0x3c5f32=document[_0x2ed00d(0x316)]('startRandomizeButton');if(!selectedIndGiftId){_0x768422[_0x2ed00d(0x230)]=_0x2ed00d(0x224),_0x401062[_0x2ed00d(0x230)]=_0x2ed00d(0x22c),_0x3c5f32[_0x2ed00d(0x1ee)]=!![];return;}const _0x4b5ef6=allGiftsData[_0x2ed00d(0x2ca)](_0x29d309=>_0x29d309['id']===selectedIndGiftId);!_0x4b5ef6||_0x4b5ef6['remainingQty']<=0x0?(_0x768422[_0x2ed00d(0x230)]=_0x4b5ef6?_0x4b5ef6[_0x2ed00d(0x30e)]+'\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)':_0x2ed00d(0x324),_0x401062['textContent']='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200',_0x3c5f32[_0x2ed00d(0x1ee)]=!![]):(_0x768422[_0x2ed00d(0x230)]=_0x4b5ef6[_0x2ed00d(0x30e)],_0x401062[_0x2ed00d(0x230)]=_0x2ed00d(0x301)+_0x4b5ef6['remainingQty']+_0x2ed00d(0x210),_0x3c5f32['disabled']=![]);}function refreshGroupGiftState(){const _0xf9de77=_0x4a069b,_0xe8696e=document['getElementById'](_0xf9de77(0x32c)),_0x388ff2=document[_0xf9de77(0x316)](_0xf9de77(0x291)),_0x464609=document[_0xf9de77(0x316)](_0xf9de77(0x2be)),_0x43d354=document['getElementById'](_0xf9de77(0x283)),_0x4f4f81=document[_0xf9de77(0x316)]('grDrawCount');if(!selectedGroupGiftId){_0xe8696e[_0xf9de77(0x230)]=_0xf9de77(0x224),_0xe8696e[_0xf9de77(0x239)]='text-base\x20font-black\x20text-gray-400\x20leading-tight\x20uppercase\x20text-sm',_0x388ff2['textContent']=_0xf9de77(0x22c),_0x388ff2['className']='text-sm\x20font-bold\x20text-gray-300\x20mt-1\x20text-sm',_0x464609['className']=_0xf9de77(0x2ff),_0x4f4f81[_0xf9de77(0x2d5)]=0x0,_0x43d354[_0xf9de77(0x1ee)]=!![];return;}const _0x58b0eb=allGiftsData['find'](_0x2e8ef8=>_0x2e8ef8['id']===selectedGroupGiftId);!_0x58b0eb||_0x58b0eb[_0xf9de77(0x1f6)]<=0x0?(_0xe8696e[_0xf9de77(0x230)]=_0x58b0eb?_0x58b0eb[_0xf9de77(0x30e)]+'\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)':_0xf9de77(0x324),_0xe8696e[_0xf9de77(0x239)]='text-base\x20font-black\x20text-red-400\x20leading-tight\x20uppercase\x20text-sm',_0x388ff2[_0xf9de77(0x230)]=_0xf9de77(0x325),_0x464609['className']=_0xf9de77(0x1d3),_0x4f4f81['value']=0x0,_0x43d354[_0xf9de77(0x1ee)]=!![]):(_0xe8696e[_0xf9de77(0x230)]=_0x58b0eb['name'],_0xe8696e[_0xf9de77(0x239)]=_0xf9de77(0x281),_0x388ff2['textContent']=_0xf9de77(0x301)+_0x58b0eb[_0xf9de77(0x1f6)]+_0xf9de77(0x210),_0x388ff2[_0xf9de77(0x239)]=_0xf9de77(0x244),_0x464609['className']=_0xf9de77(0x1bc),_0x4f4f81[_0xf9de77(0x2d5)]=_0x58b0eb[_0xf9de77(0x1f6)],_0x4f4f81[_0xf9de77(0x293)]=_0x58b0eb[_0xf9de77(0x1f6)],_0x43d354['disabled']=![]);}async function startGroupRandomDraw(){const _0x5d9d4e=_0x4a069b,_0x3df7b6=parseInt(document['getElementById']('grDrawCount')['value'])||0x0,_0x33ec3e=allEmployeesData[_0x5d9d4e(0x2bb)](_0x2bc72e=>_0x2bc72e[_0x5d9d4e(0x2fd)]&&_0x2bc72e[_0x5d9d4e(0x2f4)]===_0x5d9d4e(0x2f4)&&!_0x2bc72e[_0x5d9d4e(0x2a5)]);if(!selectedGroupGiftId)return;const _0x3add06=allGiftsData['find'](_0x598003=>_0x598003['id']===selectedGroupGiftId);if(_0x3df7b6<=0x0||_0x33ec3e[_0x5d9d4e(0x1a8)]<_0x3df7b6||_0x3add06[_0x5d9d4e(0x1f6)]<_0x3df7b6)return;const _0x2cf9fa=document[_0x5d9d4e(0x316)](_0x5d9d4e(0x283));_0x2cf9fa[_0x5d9d4e(0x1ee)]=!![];const _0x8e72ee=document['getElementById']('grBoxLeft'),_0xfaa684=document[_0x5d9d4e(0x316)](_0x5d9d4e(0x2c2));_0x8e72ee[_0x5d9d4e(0x2d0)]='',_0xfaa684['innerHTML']='';const _0x383834=[..._0x33ec3e]['sort'](()=>0.5-Math[_0x5d9d4e(0x1cd)]())[_0x5d9d4e(0x332)](0x0,_0x3df7b6);await updateDoc(doc(db,_0x5d9d4e(0x1c4),selectedGroupGiftId),{'remainingQty':_0x3add06[_0x5d9d4e(0x1f6)]-_0x3df7b6});const _0x2ddc21=Math[_0x5d9d4e(0x2aa)](_0x3df7b6/0x2),_0x1ae9c1=_0x383834['slice'](0x0,_0x2ddc21),_0x59713b=_0x383834[_0x5d9d4e(0x332)](_0x2ddc21),_0x559735=_0xbacd98=>{const _0x2cc2e8=_0x5d9d4e,_0x266094=document[_0x2cc2e8(0x1d8)](_0x2cc2e8(0x218));_0x266094['id']=_0x2cc2e8(0x260),_0x266094[_0x2cc2e8(0x239)]=_0x2cc2e8(0x2a6),_0xbacd98[_0x2cc2e8(0x25c)](_0x266094);},_0x327fb6=_0x5042f1=>{const _0x1a4df0=_0x5d9d4e,_0x391583=_0x5042f1[_0x1a4df0(0x1f3)](_0x1a4df0(0x2ee));if(_0x391583)_0x391583[_0x1a4df0(0x26e)]();};for(let _0x42129f=0x0;_0x42129f<_0x1ae9c1[_0x5d9d4e(0x1a8)];_0x42129f++){_0x559735(_0x8e72ee),await new Promise(_0x3eae62=>setTimeout(_0x3eae62,0x3e8)),_0x327fb6(_0x8e72ee);const _0x1d5a77=_0x1ae9c1[_0x42129f];_0x8e72ee[_0x5d9d4e(0x2d0)]+=createWinnerItemHTML(_0x42129f+0x1,_0x1d5a77),await updateWinnerInDB(_0x1d5a77,_0x3add06[_0x5d9d4e(0x30e)],selectedGroupGiftId);}for(let _0x37a6ef=0x0;_0x37a6ef<_0x59713b[_0x5d9d4e(0x1a8)];_0x37a6ef++){_0x559735(_0xfaa684),await new Promise(_0x2118f0=>setTimeout(_0x2118f0,0x3e8)),_0x327fb6(_0xfaa684);const _0x521e48=_0x59713b[_0x37a6ef];_0xfaa684['innerHTML']+=createWinnerItemHTML(_0x2ddc21+_0x37a6ef+0x1,_0x521e48),await updateWinnerInDB(_0x521e48,_0x3add06[_0x5d9d4e(0x30e)],selectedGroupGiftId);}_0x2cf9fa['disabled']=![],confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}});}function createWinnerItemHTML(_0x36b28e,_0x4b7f46){const _0x34c1c1=_0x4a069b;return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20bg-blue-50\x20p-2.5\x20rounded-xl\x20border\x20border-blue-100\x20winner-row-animate\x20shadow-sm\x20mb-1.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-blue-600\x20text-white\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center\x20rounded-full\x20text-[9px]\x20font-bold\x22>'+_0x36b28e+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-black\x20text-gray-800\x20uppercase\x20text-left\x22>'+_0x4b7f46[_0x34c1c1(0x199)]+'\x20('+_0x4b7f46[_0x34c1c1(0x2a0)]+')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22removeLuckyWinner(\x27'+_0x4b7f46['id']+'\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20cursor-pointer\x20font-bold\x20text-lg\x20ml-3\x20text-sm\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}async function updateWinnerInDB(_0x34db6a,_0x3c1163,_0x52b305){const _0x4b4da7=_0x4a069b;await updateDoc(doc(db,_0x4b4da7(0x256),_0x34db6a['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x3c1163,'AwardedGiftId':_0x52b305});}async function runIndividualLuckyDraw(){const _0x1f6323=_0x4a069b,_0x5bf6c8=document[_0x1f6323(0x316)](_0x1f6323(0x1ef));_0x5bf6c8[_0x1f6323(0x230)]='';const _0x4effce=allEmployeesData[_0x1f6323(0x2bb)](_0x33a13b=>_0x33a13b['DateLogin']&&_0x33a13b[_0x1f6323(0x2f4)]===_0x1f6323(0x2f4)&&!_0x33a13b['RandomTime']);if(!selectedIndGiftId){_0x5bf6c8[_0x1f6323(0x230)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô';return;}if(!_0x4effce[_0x1f6323(0x1a8)]){_0x5bf6c8['textContent']='‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô';return;}const _0x3436e5=allGiftsData[_0x1f6323(0x2ca)](_0xff04f9=>_0xff04f9['id']===selectedIndGiftId);if(!_0x3436e5||_0x3436e5['remainingQty']<=0x0){_0x5bf6c8[_0x1f6323(0x230)]=_0x1f6323(0x2ec);return;}const _0x6de632=document['getElementById'](_0x1f6323(0x29a));_0x6de632['disabled']=!![];const _0x215e07=[0x1,0x2,0x3,0x4,0x5]['map'](_0x3774c3=>document[_0x1f6323(0x316)](_0x1f6323(0x280)+_0x3774c3));let _0x3804dc=0x0;drawInterval=setInterval(()=>{const _0xf8de00=_0x1f6323;digits[_0xf8de00(0x2d1)](_0x12fc45=>_0x12fc45[_0xf8de00(0x230)]=Math['floor'](Math[_0xf8de00(0x1cd)]()*0xa));if(++_0x3804dc>0x28){clearInterval(drawInterval);const _0x11a39f=_0x4effce[Math['floor'](Math['random']()*_0x4effce[_0xf8de00(0x1a8)])],_0x1d6d64=String(_0x11a39f[_0xf8de00(0x2a0)])['slice'](-0x5)['padStart'](0x5,'0');_0x215e07[_0xf8de00(0x2d1)]((_0xcaeed5,_0x11f5c9)=>_0xcaeed5[_0xf8de00(0x230)]=_0x1d6d64[_0x11f5c9]),setTimeout(async()=>{const _0x2f18da=_0xf8de00;await updateDoc(doc(db,_0x2f18da(0x1c4),selectedIndGiftId),{'remainingQty':_0x3436e5['remainingQty']-0x1}),await updateDoc(doc(db,_0x2f18da(0x256),_0x11a39f['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x3436e5['name'],'AwardedGiftId':selectedIndGiftId}),document[_0x2f18da(0x316)](_0x2f18da(0x23e))[_0x2f18da(0x230)]=_0x11a39f[_0x2f18da(0x199)]+'\x20('+_0x11a39f[_0x2f18da(0x2a0)]+')',document[_0x2f18da(0x316)](_0x2f18da(0x222))[_0x2f18da(0x230)]=_0x2f18da(0x278)+_0x3436e5['name'],document[_0x2f18da(0x316)](_0x2f18da(0x1ae))[_0x2f18da(0x230)]=_0x2f18da(0x1f9)+_0x11a39f[_0x2f18da(0x2a0)],document['getElementById'](_0x2f18da(0x211))[_0x2f18da(0x230)]=_0x2f18da(0x277)+(_0x11a39f['Branch_eng']||'-'),document[_0x2f18da(0x316)](_0x2f18da(0x232))['textContent']=_0x2f18da(0x1c6)+(_0x11a39f[_0x2f18da(0x2b3)]||'-'),document[_0x2f18da(0x316)](_0x2f18da(0x2b2))[_0x2f18da(0x270)][_0x2f18da(0x26e)](_0x2f18da(0x2f7)),confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}}),_0x6de632['disabled']=![],updateLuckyDrawStats();},0x1f4);}},0x32);}window[_0x4a069b(0x2fc)]=async _0x138ee2=>{const _0x35bd86=_0x4a069b,_0x591b0d=allEmployeesData[_0x35bd86(0x2ca)](_0x2b20e0=>_0x2b20e0['id']===_0x138ee2);if(!_0x591b0d)return;if(_0x591b0d[_0x35bd86(0x1ac)]){const _0x2b5366=allGiftsData[_0x35bd86(0x2ca)](_0x36cf61=>_0x36cf61['id']===_0x591b0d[_0x35bd86(0x1ac)]);if(_0x2b5366)await updateDoc(doc(db,_0x35bd86(0x1c4),_0x2b5366['id']),{'remainingQty':_0x2b5366[_0x35bd86(0x1f6)]+0x1});}await updateDoc(doc(db,_0x35bd86(0x256),_0x138ee2),{'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null}),document[_0x35bd86(0x316)](_0x35bd86(0x2b2))[_0x35bd86(0x270)][_0x35bd86(0x1ad)]('hidden');};function _0x29e5(_0x10b246,_0x1e1df7){_0x10b246=_0x10b246-0x196;const _0x3862be=_0x3862();let _0x29e587=_0x3862be[_0x10b246];return _0x29e587;}function updateLuckyDrawStats(){const _0x2a722f=_0x4a069b,_0x2bce88=allEmployeesData[_0x2a722f(0x2bb)](_0x2e48f4=>_0x2e48f4[_0x2a722f(0x2fd)]&&_0x2e48f4[_0x2a722f(0x2f4)]===_0x2a722f(0x2f4)),_0x294038=_0x2bce88[_0x2a722f(0x2bb)](_0x5a5f38=>_0x5a5f38[_0x2a722f(0x2a5)])[_0x2a722f(0x1c5)]((_0x52d2ea,_0x4c17ce)=>(_0x4c17ce['RandomTime']?.['toMillis']()||0x0)-(_0x52d2ea[_0x2a722f(0x2a5)]?.['toMillis']()||0x0));document['getElementById'](_0x2a722f(0x258))[_0x2a722f(0x230)]=_0x2bce88['filter'](_0x4a75fb=>!_0x4a75fb[_0x2a722f(0x2a5)])['length'],document[_0x2a722f(0x316)](_0x2a722f(0x271))[_0x2a722f(0x230)]=_0x294038[_0x2a722f(0x1a8)],document['getElementById'](_0x2a722f(0x2f8))[_0x2a722f(0x2d0)]=_0x294038[_0x2a722f(0x231)](_0x1c27e4=>_0x2a722f(0x24c)+_0x1c27e4[_0x2a722f(0x2a0)]+_0x2a722f(0x250)+_0x1c27e4[_0x2a722f(0x199)]+(_0x1c27e4[_0x2a722f(0x1e5)]?_0x2a722f(0x1f1)+_0x1c27e4['AwardedGift']+_0x2a722f(0x2e1):'')+_0x2a722f(0x335)+(_0x1c27e4[_0x2a722f(0x329)]||'-')+'</td><td\x20class=\x22px-4\x20py-4\x20text-center\x22><span\x20onclick=\x22removeLuckyWinner(\x27'+_0x1c27e4['id']+_0x2a722f(0x1d4))[_0x2a722f(0x1b8)]('');}function updateTeamTab(){const _0x17b6a7=_0x4a069b,_0x521baa=document[_0x17b6a7(0x316)](_0x17b6a7(0x20b)),_0x1d553c=_0x521baa['value'];_0x521baa['innerHTML']=_0x17b6a7(0x2c8)+teamNames[_0x17b6a7(0x231)](_0x453e9f=>_0x17b6a7(0x2e8)+_0x453e9f+'\x22>'+_0x453e9f+'</option>')['join'](''),_0x521baa['value']=teamNames[_0x17b6a7(0x1c1)](_0x1d553c)?_0x1d553c:'';if(_0x521baa['value']){const _0x2100e8=allEmployeesData[_0x17b6a7(0x2bb)](_0xe69965=>_0xe69965['Check_Place']===_0x521baa[_0x17b6a7(0x2d5)]);document['getElementById'](_0x17b6a7(0x245))[_0x17b6a7(0x230)]=_0x2100e8[_0x17b6a7(0x1a8)],document['getElementById'](_0x17b6a7(0x23a))[_0x17b6a7(0x230)]=_0x2100e8[_0x17b6a7(0x2bb)](_0x30215b=>_0x30215b['DateLogin'])[_0x17b6a7(0x1a8)],document[_0x17b6a7(0x316)](_0x17b6a7(0x2bf))[_0x17b6a7(0x270)][_0x17b6a7(0x26e)](_0x17b6a7(0x2f7)),document[_0x17b6a7(0x316)](_0x17b6a7(0x2e3))[_0x17b6a7(0x2d0)]=_0x2100e8['map']((_0x5acdcf,_0x217f7d)=>'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22'+(_0x5acdcf[_0x17b6a7(0x2fd)]?_0x17b6a7(0x19b):'')+_0x17b6a7(0x2f2)+(_0x217f7d+0x1)+_0x17b6a7(0x20c)+_0x5acdcf[_0x17b6a7(0x2a0)]+_0x17b6a7(0x1b7)+_0x5acdcf['FullName_th']+_0x17b6a7(0x2ba)+(_0x5acdcf[_0x17b6a7(0x329)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>'+(_0x5acdcf[_0x17b6a7(0x2b3)]||'-')+_0x17b6a7(0x326)+(_0x5acdcf[_0x17b6a7(0x2fd)]?_0x17b6a7(0x2c6):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27'+_0x5acdcf['id']+'\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xs\x20uppercase\x20shadow-sm\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>')[_0x17b6a7(0x1b8)]('');}else document[_0x17b6a7(0x316)](_0x17b6a7(0x2bf))[_0x17b6a7(0x270)][_0x17b6a7(0x1ad)](_0x17b6a7(0x2f7));}function updateGridTab(){const _0x252017=_0x4a069b,_0x5df523=document['getElementById'](_0x252017(0x257))[_0x252017(0x2d5)],_0x11f569=[...new Set(allEmployeesData[_0x252017(0x231)](_0x23f030=>_0x23f030[_0x252017(0x2b3)])[_0x252017(0x2bb)](Boolean))][_0x252017(0x1c5)](),_0x19913d=document[_0x252017(0x316)](_0x252017(0x257));_0x19913d['options']['length']!==_0x11f569[_0x252017(0x1a8)]+0x1&&(_0x19913d[_0x252017(0x2d0)]=_0x252017(0x203)+_0x11f569['map'](_0x305117=>_0x252017(0x2e8)+_0x305117+'\x22>'+_0x305117+_0x252017(0x284))['join'](''));_0x19913d[_0x252017(0x2d5)]=_0x5df523;const _0x30f9ff=_0x5df523?allEmployeesData[_0x252017(0x2bb)](_0x392fab=>_0x392fab[_0x252017(0x2b3)]===_0x5df523):allEmployeesData,_0x1d51d7=_0x30f9ff[_0x252017(0x2bb)](_0x2a2021=>_0x2a2021['invite']===_0x252017(0x2f4));document[_0x252017(0x316)](_0x252017(0x2c9))[_0x252017(0x230)]=_0x1d51d7[_0x252017(0x1a8)],document[_0x252017(0x316)](_0x252017(0x24f))[_0x252017(0x230)]=_0x1d51d7[_0x252017(0x2bb)](_0x5a963a=>_0x5a963a[_0x252017(0x2fd)])[_0x252017(0x1a8)],document[_0x252017(0x316)]('gvOverallStatsContainer')[_0x252017(0x270)][_0x252017(0x26e)]('hidden');const _0x15a795={};teamNames[_0x252017(0x2d1)](_0x4ea9fe=>_0x15a795[_0x4ea9fe]={'r':0x0,'t':0x0}),_0x30f9ff[_0x252017(0x2bb)](_0xd520d=>_0xd520d[_0x252017(0x25e)])['forEach'](_0xdc47e3=>{const _0x889b14=_0x252017;if(_0x15a795[_0xdc47e3[_0x889b14(0x25e)]]){_0x15a795[_0xdc47e3[_0x889b14(0x25e)]]['t']++;if(_0xdc47e3[_0x889b14(0x2fd)])_0x15a795[_0xdc47e3['Check_Place']]['r']++;}});const _0x53f1a1=document[_0x252017(0x316)](_0x252017(0x1f0)),_0x49126b=document['getElementById'](_0x252017(0x318));_0x53f1a1[_0x252017(0x2d0)]='',_0x49126b[_0x252017(0x2d0)]='',teamNames[_0x252017(0x2d1)](_0x43efa7=>{const _0x36812c=_0x252017,_0xeacd40=_0x15a795[_0x43efa7];let _0x1768d1='bg-gray-100';if(_0xeacd40['t']>0x0){if(_0xeacd40['r']===_0xeacd40['t'])_0x1768d1=_0x36812c(0x1ab);else{if(_0xeacd40['r']>0x0)_0x1768d1=_0x36812c(0x275);}}const _0x5e4c05=_0x36812c(0x23c)+_0x43efa7+'\x27)\x22\x20class=\x22'+_0x1768d1+'\x20aspect-square\x20rounded-full\x20border\x20border-gray-200\x20flex\x20flex-col\x20items-center\x20justify-center\x20cursor-pointer\x20hover:shadow-lg\x20hover:scale-105\x20transition-all\x20active:scale-95\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-[12px]\x20font-bold\x20text-blue-700\x20leading-none\x20text-xs\x20font-bold\x22>'+_0x43efa7+_0x36812c(0x30c)+_0xeacd40['r']+'/'+_0xeacd40['t']+_0x36812c(0x294);if(_0x43efa7[_0x36812c(0x269)]('A'))_0x53f1a1['innerHTML']+=_0x5e4c05;else{if(_0x43efa7[_0x36812c(0x269)]('B'))_0x49126b[_0x36812c(0x2d0)]+=_0x5e4c05;}});}function updateEmployeeList(){const _0x219561=_0x4a069b,_0x511060=document[_0x219561(0x316)]('managerFilterSelect')['value'],_0x1029a0=[...new Set(allEmployeesData[_0x219561(0x231)](_0x11e1e4=>_0x11e1e4['Check_Manager'])[_0x219561(0x2bb)](Boolean))][_0x219561(0x1c5)](),_0x203bb7=document[_0x219561(0x316)](_0x219561(0x2bc));_0x203bb7[_0x219561(0x243)][_0x219561(0x1a8)]!==_0x1029a0[_0x219561(0x1a8)]+0x1&&(_0x203bb7[_0x219561(0x2d0)]=_0x219561(0x1d1)+_0x1029a0[_0x219561(0x231)](_0x441d71=>_0x219561(0x2e8)+_0x441d71+'\x22>'+_0x441d71+_0x219561(0x284))[_0x219561(0x1b8)](''));_0x203bb7['value']=_0x511060;let _0x15d8dc=allEmployeesData[_0x219561(0x2bb)](_0x4d2906=>_0x4d2906['Check_Place']&&_0x4d2906[_0x219561(0x25e)]['trim']()!=='');if(_0x511060)_0x15d8dc=_0x15d8dc[_0x219561(0x2bb)](_0x5f3a7d=>_0x5f3a7d[_0x219561(0x2b3)]===_0x511060);_0x15d8dc['sort']((_0x2a9d0a,_0x40bcff)=>{const _0x473fae=_0x219561;let _0x282ce1,_0x535f2b;switch(empSortField){case _0x473fae(0x297):_0x282ce1=_0x2a9d0a['DateLogin']?0x1:0x0,_0x535f2b=_0x40bcff[_0x473fae(0x2fd)]?0x1:0x0;break;case _0x473fae(0x30e):return empSortDir==='asc'?_0x2a9d0a['FullName_th'][_0x473fae(0x21d)](_0x40bcff[_0x473fae(0x199)],'th'):_0x40bcff[_0x473fae(0x199)]['localeCompare'](_0x2a9d0a[_0x473fae(0x199)],'th');case _0x473fae(0x25d):_0x282ce1=_0x2a9d0a['Branch_eng']||'',_0x535f2b=_0x40bcff[_0x473fae(0x329)]||'';break;case'manager':_0x282ce1=_0x2a9d0a[_0x473fae(0x2b3)]||'',_0x535f2b=_0x40bcff[_0x473fae(0x2b3)]||'';break;case _0x473fae(0x26f):_0x282ce1=_0x2a9d0a[_0x473fae(0x2f4)]||'',_0x535f2b=_0x40bcff[_0x473fae(0x2f4)]||'';break;case _0x473fae(0x235):_0x282ce1=_0x2a9d0a[_0x473fae(0x1e5)]?0x1:0x0,_0x535f2b=_0x40bcff['AwardedGift']?0x1:0x0;break;default:_0x282ce1=_0x2a9d0a[_0x473fae(0x2a0)],_0x535f2b=_0x40bcff[_0x473fae(0x2a0)];}if(_0x282ce1<_0x535f2b)return empSortDir===_0x473fae(0x311)?-0x1:0x1;if(_0x282ce1>_0x535f2b)return empSortDir==='asc'?0x1:-0x1;return 0x0;});const _0x5d896e=_0x15d8dc[_0x219561(0x1a8)],_0x56b15b=_0x15d8dc[_0x219561(0x2bb)](_0x11c31c=>_0x11c31c[_0x219561(0x2fd)])['length'],_0x64b863=_0x5d896e-_0x56b15b,_0x448cb1=_0x5d896e>0x0?Math['round'](_0x56b15b/_0x5d896e*0x64):0x0;document[_0x219561(0x316)](_0x219561(0x23f))['textContent']=_0x5d896e,document['getElementById'](_0x219561(0x21e))[_0x219561(0x230)]=_0x56b15b,document[_0x219561(0x316)](_0x219561(0x1a2))[_0x219561(0x230)]=_0x64b863,document['getElementById'](_0x219561(0x234))[_0x219561(0x230)]=_0x448cb1+'%',document[_0x219561(0x316)](_0x219561(0x1f7))['classList']['remove'](_0x219561(0x2f7));const _0x300ed7=Math[_0x219561(0x2aa)](_0x5d896e/empPageSize);if(empCurrentPage>_0x300ed7&&_0x300ed7>0x0)empCurrentPage=_0x300ed7;const _0x28c12e=_0x15d8dc[_0x219561(0x332)]((empCurrentPage-0x1)*empPageSize,empCurrentPage*empPageSize);document[_0x219561(0x316)]('employeeListTableBody')[_0x219561(0x2d0)]=_0x28c12e[_0x219561(0x231)]((_0x20a1d4,_0x9b0820)=>_0x219561(0x333)+(_0x20a1d4[_0x219561(0x2fd)]?_0x219561(0x19b):'')+_0x219561(0x30b)+((empCurrentPage-0x1)*empPageSize+(_0x9b0820+0x1))+_0x219561(0x2c5)+_0x20a1d4[_0x219561(0x2a0)]+_0x219561(0x29f)+_0x20a1d4[_0x219561(0x199)]+_0x219561(0x299)+(_0x20a1d4['Branch_eng']||'-')+_0x219561(0x299)+(_0x20a1d4['Check_Manager']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-center\x20text-gray-400\x20text-sm\x20text-sm\x22>'+(_0x20a1d4[_0x219561(0x2f4)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-center\x20text-orange-600\x20text-sm\x20text-sm\x22>'+(_0x20a1d4[_0x219561(0x1e5)]?_0x219561(0x1f5):'-')+_0x219561(0x336)+(_0x20a1d4[_0x219561(0x25e)]||'-')+_0x219561(0x31f)+(_0x20a1d4['DateLogin']?_0x219561(0x1b5):'-')+_0x219561(0x1df)+_0x20a1d4['id']+'\x27,\x20\x27'+_0x20a1d4['FullName_th']+_0x219561(0x32a))[_0x219561(0x1b8)](''),renderEmpPagination(_0x300ed7);}function renderEmpPagination(_0x13538a){const _0xe26eb5=_0x4a069b,_0x326791=document['getElementById']('empPaginationContainer');if(_0x13538a<=0x1){_0x326791['innerHTML']='';return;}let _0x18ab91=_0xe26eb5(0x202)+(empCurrentPage===0x1?_0xe26eb5(0x1ee):'')+_0xe26eb5(0x296)+(empCurrentPage-0x1)+_0xe26eb5(0x2db);for(let _0x4789d7=0x1;_0x4789d7<=_0x13538a;_0x4789d7++){if(_0x4789d7===0x1||_0x4789d7===_0x13538a||_0x4789d7>=empCurrentPage-0x2&&_0x4789d7<=empCurrentPage+0x2)_0x18ab91+=_0xe26eb5(0x23d)+(_0x4789d7===empCurrentPage?_0xe26eb5(0x1ba):'')+_0xe26eb5(0x2f5)+_0x4789d7+_0xe26eb5(0x2fb)+_0x4789d7+_0xe26eb5(0x28e);else(_0x4789d7===empCurrentPage-0x3||_0x4789d7===empCurrentPage+0x3)&&(_0x18ab91+='<span\x20class=\x22px-1\x20text-gray-400\x22>...</span>');}_0x18ab91+=_0xe26eb5(0x202)+(empCurrentPage===_0x13538a?_0xe26eb5(0x1ee):'')+_0xe26eb5(0x296)+(empCurrentPage+0x1)+')\x22>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x326791[_0xe26eb5(0x2d0)]=_0x18ab91;}window[_0x4a069b(0x31e)]=_0x5de47a=>{empCurrentPage=_0x5de47a,updateEmployeeList();},window[_0x4a069b(0x21f)]=(_0x4b3b25,_0x217280)=>{const _0x36960d=_0x4a069b,_0x2579b5=document[_0x36960d(0x316)](_0x36960d(0x1a7));_0x2579b5[_0x36960d(0x239)]=_0x36960d(0x317),currentConfirmAction=async()=>{const _0xa91bbf=_0x36960d;try{await updateDoc(doc(db,_0xa91bbf(0x256),_0x4b3b25),{'DateLogin':null,'MobileId':''}),document[_0xa91bbf(0x316)](_0xa91bbf(0x268))[_0xa91bbf(0x270)][_0xa91bbf(0x1ad)]('hidden');}catch(_0x56847b){console['error'](_0x56847b);}},document[_0x36960d(0x316)]('confirmTitle')[_0x36960d(0x230)]='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',document['getElementById'](_0x36960d(0x1d5))[_0x36960d(0x230)]=_0x36960d(0x285)+_0x217280+']\x20‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',document[_0x36960d(0x316)](_0x36960d(0x273))['classList'][_0x36960d(0x1ad)](_0x36960d(0x2f7)),document['getElementById'](_0x36960d(0x268))['classList'][_0x36960d(0x26e)](_0x36960d(0x2f7));},window[_0x4a069b(0x2b9)]=_0xa531f8=>{const _0x5dc000=_0x4a069b,_0x237c05=allEmployeesData[_0x5dc000(0x2bb)](_0x4984d2=>_0x4984d2[_0x5dc000(0x25e)]===_0xa531f8);document['getElementById']('groupViewModalTitle')['textContent']='‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°\x20'+_0xa531f8,document[_0x5dc000(0x316)](_0x5dc000(0x216))[_0x5dc000(0x230)]=_0x237c05[_0x5dc000(0x1a8)],document['getElementById'](_0x5dc000(0x2f1))[_0x5dc000(0x230)]=_0x237c05[_0x5dc000(0x2bb)](_0x369326=>_0x369326[_0x5dc000(0x2fd)])[_0x5dc000(0x1a8)],document[_0x5dc000(0x316)](_0x5dc000(0x302))[_0x5dc000(0x2d0)]=_0x237c05[_0x5dc000(0x231)]((_0x3cdd1f,_0x3fdaaa)=>{const _0x242579=_0x5dc000;return _0x242579(0x2ad)+(_0x3cdd1f[_0x242579(0x2fd)]?_0x242579(0x19b):'')+_0x242579(0x2b0)+(_0x3fdaaa+0x1)+_0x242579(0x19f)+_0x3cdd1f[_0x242579(0x2a0)]+_0x242579(0x27b)+_0x3cdd1f[_0x242579(0x199)]+_0x242579(0x30d)+(_0x3cdd1f[_0x242579(0x329)]||'-')+_0x242579(0x30d)+(_0x3cdd1f[_0x242579(0x2b3)]||'-')+_0x242579(0x19c)+(_0x3cdd1f['DateLogin']?_0x242579(0x227):'-')+_0x242579(0x32d)+_0x3cdd1f['id']+'\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-bold\x20uppercase\x20cursor-pointer\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>';})[_0x5dc000(0x1b8)]('')||'<tr><td\x20colspan=\x227\x22\x20class=\x22p-10\x20text-center\x20text-sm\x20text-sm\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</td></tr>',document[_0x5dc000(0x316)](_0x5dc000(0x1fc))[_0x5dc000(0x270)][_0x5dc000(0x26e)](_0x5dc000(0x2f7));},window[_0x4a069b(0x212)]=_0x406f30=>{const _0x35a54d=_0x4a069b,_0x307ece=allEmployeesData[_0x35a54d(0x2ca)](_0x3ff49e=>_0x3ff49e['id']===_0x406f30);if(!_0x307ece)return;currentEditingDocId=_0x406f30,document['getElementById'](_0x35a54d(0x27a))[_0x35a54d(0x230)]=_0x307ece[_0x35a54d(0x2a0)],document[_0x35a54d(0x316)](_0x35a54d(0x2ea))[_0x35a54d(0x230)]=_0x307ece['FullName_th'],document[_0x35a54d(0x316)](_0x35a54d(0x2e5))[_0x35a54d(0x2d5)]=_0x307ece[_0x35a54d(0x2b3)]||'',document['getElementById'](_0x35a54d(0x21a))[_0x35a54d(0x2d5)]=_0x307ece[_0x35a54d(0x25e)]||'',document['getElementById'](_0x35a54d(0x225))[_0x35a54d(0x270)][_0x35a54d(0x26e)](_0x35a54d(0x2f7));};function searchForRegistration(){const _0x52cd93=_0x4a069b,_0x3e6dbe=document[_0x52cd93(0x316)](_0x52cd93(0x1d7))['value'][_0x52cd93(0x308)](),_0x319d9a=document[_0x52cd93(0x316)]('searchRegEmployeeError');_0x319d9a[_0x52cd93(0x230)]='';if(!_0x3e6dbe){_0x319d9a[_0x52cd93(0x230)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';return;}const _0xae07fa=allEmployeesData[_0x52cd93(0x2ca)](_0x4509a9=>_0x4509a9[_0x52cd93(0x2a0)]===_0x3e6dbe);_0xae07fa?(currentEditingDocId=_0xae07fa['id'],document[_0x52cd93(0x316)]('regEmpId')[_0x52cd93(0x230)]=_0xae07fa[_0x52cd93(0x2a0)],document[_0x52cd93(0x316)]('regEmpName')[_0x52cd93(0x230)]=_0xae07fa['FullName_th'],document[_0x52cd93(0x316)](_0x52cd93(0x322))[_0x52cd93(0x230)]=_0xae07fa[_0x52cd93(0x329)]||'-',document[_0x52cd93(0x316)]('regEmpManager')['textContent']=_0xae07fa['Check_Manager']||'-',document[_0x52cd93(0x316)](_0x52cd93(0x1fa))[_0x52cd93(0x2d5)]=_0xae07fa['Check_Place']||'',document[_0x52cd93(0x316)](_0x52cd93(0x1c9))['value']=_0xae07fa['invite']||'',document[_0x52cd93(0x316)](_0x52cd93(0x238))['classList'][_0x52cd93(0x26e)](_0x52cd93(0x2f7)),document[_0x52cd93(0x316)](_0x52cd93(0x2cf))[_0x52cd93(0x230)]=''):_0x319d9a[_0x52cd93(0x230)]=_0x52cd93(0x2a4);}async function saveManualRegistration(){const _0x286bfc=_0x4a069b,_0x3a50e1=document[_0x286bfc(0x316)](_0x286bfc(0x1fa))[_0x286bfc(0x2d5)]['trim'](),_0x2bf96b=document['getElementById'](_0x286bfc(0x1c9))['value'],_0x3e5702=document['getElementById']('regManualError');try{await updateDoc(doc(db,_0x286bfc(0x256),currentEditingDocId),{'Check_Place':_0x3a50e1,'invite':_0x2bf96b,'DateLogin':serverTimestamp()}),document[_0x286bfc(0x316)](_0x286bfc(0x238))[_0x286bfc(0x270)][_0x286bfc(0x1ad)](_0x286bfc(0x2f7)),document[_0x286bfc(0x316)](_0x286bfc(0x1d7))['value']='';}catch(_0x7c7afd){console[_0x286bfc(0x206)](_0x7c7afd),_0x3e5702[_0x286bfc(0x230)]=_0x286bfc(0x28b);}}function handleEmpSort(_0x2f2f38){const _0x1bcf91=_0x4a069b;empSortField===_0x2f2f38?empSortDir=empSortDir===_0x1bcf91(0x311)?_0x1bcf91(0x1c7):_0x1bcf91(0x311):(empSortField=_0x2f2f38,empSortDir='asc'),empCurrentPage=0x1,updateEmployeeList();}function setupListeners(){const _0x4e3149=_0x4a069b;document[_0x4e3149(0x316)](_0x4e3149(0x200))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>{const _0x46b0e3=_0x4e3149;updateLuckyDrawStats(),document[_0x46b0e3(0x316)]('randomizeModal')[_0x46b0e3(0x270)][_0x46b0e3(0x26e)](_0x46b0e3(0x2f7));}),document[_0x4e3149(0x316)]('closeRandomizeModalButtonX')[_0x4e3149(0x328)](_0x4e3149(0x223),()=>document[_0x4e3149(0x316)](_0x4e3149(0x1ec))['classList']['add'](_0x4e3149(0x2f7))),document['getElementById'](_0x4e3149(0x29a))[_0x4e3149(0x328)](_0x4e3149(0x223),runIndividualLuckyDraw),document['getElementById'](_0x4e3149(0x283))[_0x4e3149(0x328)](_0x4e3149(0x223),startGroupRandomDraw),document[_0x4e3149(0x316)](_0x4e3149(0x1e2))['addEventListener'](_0x4e3149(0x223),()=>document[_0x4e3149(0x316)](_0x4e3149(0x1fc))[_0x4e3149(0x270)][_0x4e3149(0x1ad)](_0x4e3149(0x2f7))),document[_0x4e3149(0x316)](_0x4e3149(0x2e9))[_0x4e3149(0x328)]('click',()=>document[_0x4e3149(0x316)](_0x4e3149(0x2b2))['classList'][_0x4e3149(0x1ad)](_0x4e3149(0x2f7))),document[_0x4e3149(0x316)](_0x4e3149(0x24e))[_0x4e3149(0x328)]('click',()=>document[_0x4e3149(0x316)](_0x4e3149(0x225))[_0x4e3149(0x270)]['add'](_0x4e3149(0x2f7))),document[_0x4e3149(0x316)](_0x4e3149(0x1bb))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>document[_0x4e3149(0x316)](_0x4e3149(0x268))[_0x4e3149(0x270)][_0x4e3149(0x1ad)](_0x4e3149(0x2f7))),document['getElementById'](_0x4e3149(0x306))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>openDashboardList(_0x4e3149(0x2b7))),document[_0x4e3149(0x316)](_0x4e3149(0x2d6))[_0x4e3149(0x328)]('click',()=>openDashboardList(_0x4e3149(0x208))),document[_0x4e3149(0x316)](_0x4e3149(0x1cc))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>openDashboardList(_0x4e3149(0x266))),document[_0x4e3149(0x316)](_0x4e3149(0x198))[_0x4e3149(0x328)]('click',()=>openDashboardList('extras')),document[_0x4e3149(0x316)]('closeDashboardListModalButton')[_0x4e3149(0x328)](_0x4e3149(0x223),()=>document['getElementById'](_0x4e3149(0x237))[_0x4e3149(0x270)][_0x4e3149(0x1ad)](_0x4e3149(0x2f7))),document[_0x4e3149(0x316)](_0x4e3149(0x22d))['addEventListener'](_0x4e3149(0x223),()=>handleEmpSort('id')),document[_0x4e3149(0x316)](_0x4e3149(0x22b))[_0x4e3149(0x328)]('click',()=>handleEmpSort(_0x4e3149(0x30e))),document[_0x4e3149(0x316)](_0x4e3149(0x251))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>handleEmpSort(_0x4e3149(0x25d))),document[_0x4e3149(0x316)](_0x4e3149(0x1ff))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>handleEmpSort(_0x4e3149(0x2a3))),document['getElementById'](_0x4e3149(0x2a1))['addEventListener'](_0x4e3149(0x223),()=>handleEmpSort(_0x4e3149(0x26f))),document[_0x4e3149(0x316)](_0x4e3149(0x221))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>handleEmpSort(_0x4e3149(0x235))),document[_0x4e3149(0x316)](_0x4e3149(0x2c0))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>handleEmpSort(_0x4e3149(0x297))),document[_0x4e3149(0x316)](_0x4e3149(0x28c))['addEventListener'](_0x4e3149(0x223),searchForRegistration),document[_0x4e3149(0x316)](_0x4e3149(0x279))[_0x4e3149(0x328)]('click',()=>document[_0x4e3149(0x316)](_0x4e3149(0x238))[_0x4e3149(0x270)][_0x4e3149(0x1ad)](_0x4e3149(0x2f7))),document[_0x4e3149(0x316)](_0x4e3149(0x303))[_0x4e3149(0x328)](_0x4e3149(0x223),saveManualRegistration),document[_0x4e3149(0x316)]('confirmActionButton')[_0x4e3149(0x328)](_0x4e3149(0x223),async()=>{if(currentConfirmAction)await currentConfirmAction();}),document[_0x4e3149(0x316)](_0x4e3149(0x1a4))['addEventListener'](_0x4e3149(0x223),addGift),document['getElementById']('openGiftPickerBtn')['addEventListener']('click',()=>{const _0x22fc8b=_0x4e3149;giftPickerContext=_0x22fc8b(0x1fb),renderGiftPicker(),document[_0x22fc8b(0x316)]('giftPickerModal')[_0x22fc8b(0x270)]['remove'](_0x22fc8b(0x2f7));}),document[_0x4e3149(0x316)]('openGroupGiftPickerBtn')[_0x4e3149(0x328)](_0x4e3149(0x223),()=>{const _0x4ac71c=_0x4e3149;giftPickerContext='group',renderGiftPicker(),document['getElementById'](_0x4ac71c(0x1ce))[_0x4ac71c(0x270)]['remove'](_0x4ac71c(0x2f7));}),document['getElementById'](_0x4e3149(0x19a))[_0x4e3149(0x328)](_0x4e3149(0x223),()=>document[_0x4e3149(0x316)](_0x4e3149(0x1ce))[_0x4e3149(0x270)]['add'](_0x4e3149(0x2f7))),document[_0x4e3149(0x316)](_0x4e3149(0x2c4))['addEventListener'](_0x4e3149(0x223),()=>document[_0x4e3149(0x316)](_0x4e3149(0x330))[_0x4e3149(0x270)]['add'](_0x4e3149(0x2f7))),document['getElementById'](_0x4e3149(0x229))[_0x4e3149(0x328)](_0x4e3149(0x223),async()=>{const _0x29a9ac=_0x4e3149,_0x2a7cde=document[_0x29a9ac(0x316)]('editGiftName')['value']['trim'](),_0x963158=parseInt(document[_0x29a9ac(0x316)](_0x29a9ac(0x219))[_0x29a9ac(0x2d5)]),_0x3ba32b=parseInt(document[_0x29a9ac(0x316)](_0x29a9ac(0x320))['value']);if(!_0x2a7cde||isNaN(_0x963158)||isNaN(_0x3ba32b))return;await updateDoc(doc(db,_0x29a9ac(0x1c4),currentEditingGiftId),{'name':_0x2a7cde,'totalQty':_0x963158,'remainingQty':_0x3ba32b}),document[_0x29a9ac(0x316)](_0x29a9ac(0x330))[_0x29a9ac(0x270)]['add'](_0x29a9ac(0x2f7));}),document['getElementById'](_0x4e3149(0x2b5))[_0x4e3149(0x328)](_0x4e3149(0x223),async()=>{const _0x3d2372=_0x4e3149;await updateDoc(doc(db,_0x3d2372(0x256),currentEditingDocId),{'Check_Manager':document[_0x3d2372(0x316)](_0x3d2372(0x2e5))[_0x3d2372(0x2d5)],'Check_Place':document['getElementById'](_0x3d2372(0x21a))[_0x3d2372(0x2d5)]}),document[_0x3d2372(0x316)](_0x3d2372(0x225))[_0x3d2372(0x270)][_0x3d2372(0x1ad)](_0x3d2372(0x2f7));}),document[_0x4e3149(0x316)](_0x4e3149(0x323))['addEventListener'](_0x4e3149(0x223),()=>{const _0x24a0ea=_0x4e3149,_0x16cc05=document['getElementById'](_0x24a0ea(0x2fa))['value'][_0x24a0ea(0x308)](),_0x3c8ab0=allEmployeesData[_0x24a0ea(0x2ca)](_0x560936=>_0x560936['employeeId']===_0x16cc05);if(_0x3c8ab0)editEmp(_0x3c8ab0['id']);else document[_0x24a0ea(0x316)](_0x24a0ea(0x27c))[_0x24a0ea(0x230)]=_0x24a0ea(0x31b);}),document[_0x4e3149(0x316)](_0x4e3149(0x20b))[_0x4e3149(0x328)](_0x4e3149(0x2ef),updateTeamTab),document['getElementById']('groupViewManagerFilter')['addEventListener']('change',updateGridTab),document[_0x4e3149(0x316)](_0x4e3149(0x2bc))['addEventListener']('change',()=>{empCurrentPage=0x1,updateEmployeeList();}),document[_0x4e3149(0x316)](_0x4e3149(0x313))['addEventListener'](_0x4e3149(0x223),()=>{const _0x3e1919=_0x4e3149,_0x209dc7=document[_0x3e1919(0x316)](_0x3e1919(0x289))[_0x3e1919(0x2d5)][_0x3e1919(0x308)]();if(!_0x209dc7)return;teamNames=_0x209dc7[_0x3e1919(0x242)](',')[_0x3e1919(0x231)](_0x4f91b0=>_0x4f91b0[_0x3e1919(0x308)]())[_0x3e1919(0x2bb)](Boolean),refreshUI();}),document['getElementById'](_0x4e3149(0x201))['addEventListener']('click',()=>{const _0x1a6d02=_0x4e3149;let _0x82991d=_0x1a6d02(0x20e);allEmployeesData[_0x1a6d02(0x2bb)](_0x3b0d18=>_0x3b0d18[_0x1a6d02(0x2fd)])[_0x1a6d02(0x2d1)](_0x442054=>{const _0x4828d3=_0x1a6d02;_0x82991d+='\x22'+_0x442054[_0x4828d3(0x2a0)]+_0x4828d3(0x209)+_0x442054[_0x4828d3(0x199)]+'\x22,\x22'+(_0x442054[_0x4828d3(0x329)]||'')+_0x4828d3(0x209)+(_0x442054['Check_Manager']||'')+_0x4828d3(0x209)+(_0x442054[_0x4828d3(0x25e)]||'')+_0x4828d3(0x2e6);});const _0x45ce09=new Blob([_0x82991d],{'type':_0x1a6d02(0x1aa)}),_0x2be97f=document[_0x1a6d02(0x1d8)]('a');_0x2be97f[_0x1a6d02(0x2eb)]=URL[_0x1a6d02(0x25b)](_0x45ce09),_0x2be97f[_0x1a6d02(0x1b2)]=_0x1a6d02(0x2fe),_0x2be97f[_0x1a6d02(0x223)]();}),document['getElementById']('downloadEmployeeCsvButton')[_0x4e3149(0x328)](_0x4e3149(0x223),()=>{const _0x376ad6=_0x4e3149,_0x544b73=document[_0x376ad6(0x316)]('managerFilterSelect')[_0x376ad6(0x2d5)];let _0x403801=allEmployeesData[_0x376ad6(0x2bb)](_0x335117=>_0x335117[_0x376ad6(0x25e)]&&_0x335117[_0x376ad6(0x25e)][_0x376ad6(0x308)]()!=='');if(_0x544b73)_0x403801=_0x403801[_0x376ad6(0x2bb)](_0x39a2e3=>_0x39a2e3[_0x376ad6(0x2b3)]===_0x544b73);let _0x355357=_0x376ad6(0x31c);_0x403801[_0x376ad6(0x2d1)]((_0x34516a,_0x4303b0)=>{const _0x4c1717=_0x376ad6,_0xfd766=_0x34516a[_0x4c1717(0x2fd)]?_0x4c1717(0x26c):'-',_0x1e1e3f=_0x34516a['invite']||'-',_0xcbe99a=_0x34516a[_0x4c1717(0x1e5)]?'‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•':'-';_0x355357+='\x22'+(_0x4303b0+0x1)+_0x4c1717(0x209)+_0x34516a['employeeId']+_0x4c1717(0x209)+_0x34516a[_0x4c1717(0x199)]+_0x4c1717(0x209)+(_0x34516a[_0x4c1717(0x329)]||'-')+_0x4c1717(0x209)+(_0x34516a[_0x4c1717(0x2b3)]||'-')+'\x22,\x22'+_0x1e1e3f+_0x4c1717(0x209)+_0xcbe99a+_0x4c1717(0x209)+(_0x34516a['Check_Place']||'-')+_0x4c1717(0x209)+_0xfd766+'\x22\x0a';});const _0x1076aa=new Blob([_0x355357],{'type':'text/csv;charset=utf-8;'}),_0x129537=document[_0x376ad6(0x1d8)]('a');_0x129537[_0x376ad6(0x2eb)]=URL[_0x376ad6(0x25b)](_0x1076aa),_0x129537[_0x376ad6(0x1b2)]='Employee_List_Report.csv',_0x129537[_0x376ad6(0x223)]();}),document[_0x4e3149(0x316)](_0x4e3149(0x2cd))[_0x4e3149(0x328)]('click',()=>{const _0x5e17b2=_0x4e3149,_0x5228f5=allEmployeesData[_0x5e17b2(0x2bb)](_0x22d1c7=>_0x22d1c7['RandomTime'])['sort']((_0x268edf,_0x1e2833)=>(_0x1e2833['RandomTime']?.[_0x5e17b2(0x236)]()||0x0)-(_0x268edf[_0x5e17b2(0x2a5)]?.[_0x5e17b2(0x236)]()||0x0));let _0x228ee4='\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á,‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\x0a';_0x5228f5['forEach'](_0x103b80=>{const _0x30bdf8=_0x5e17b2,_0x47e211=_0x103b80[_0x30bdf8(0x2a5)]?.[_0x30bdf8(0x236)]()?new Date(_0x103b80['RandomTime'][_0x30bdf8(0x236)]())[_0x30bdf8(0x1f2)]('th-TH'):'-',_0x3e8370=_0x103b80['ReceivedTime']?_0x30bdf8(0x25f):'‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö';_0x228ee4+='\x22'+_0x103b80['employeeId']+_0x30bdf8(0x209)+_0x103b80['FullName_th']+_0x30bdf8(0x209)+(_0x103b80[_0x30bdf8(0x1e5)]||'')+_0x30bdf8(0x209)+(_0x103b80['Branch_eng']||'')+_0x30bdf8(0x209)+(_0x103b80['Check_Manager']||'')+_0x30bdf8(0x209)+(_0x103b80[_0x30bdf8(0x25e)]||'')+_0x30bdf8(0x209)+_0x3e8370+_0x30bdf8(0x209)+_0x47e211+'\x22\x0a';});const _0x5e6525=new Blob([_0x228ee4],{'type':_0x5e17b2(0x1aa)}),_0x240a31=document[_0x5e17b2(0x1d8)]('a');_0x240a31['href']=URL['createObjectURL'](_0x5e6525),_0x240a31['download']=_0x5e17b2(0x2e4),_0x240a31[_0x5e17b2(0x223)]();}),document[_0x4e3149(0x316)]('resetTeamButton')['addEventListener']('click',()=>{const _0x4a1078=_0x4e3149,_0x15f6ed=document[_0x4a1078(0x316)](_0x4a1078(0x1a7)),_0x53c5ae=document[_0x4a1078(0x316)](_0x4a1078(0x273)),_0x5ac87f=document[_0x4a1078(0x316)]('confirmInput');_0x53c5ae[_0x4a1078(0x270)][_0x4a1078(0x26e)](_0x4a1078(0x2f7)),_0x5ac87f[_0x4a1078(0x2d5)]='',currentConfirmAction=async()=>{const _0x50bba5=_0x4a1078;if(_0x5ac87f[_0x50bba5(0x2d5)][_0x50bba5(0x308)]()['toUpperCase']()!==_0x50bba5(0x24a))return;const _0x17e385=writeBatch(db);allEmployeesData[_0x50bba5(0x2d1)](_0x3fb262=>{const _0x261289=_0x50bba5;_0x17e385[_0x261289(0x1a6)](doc(db,_0x261289(0x256),_0x3fb262['id']),{'DateLogin':null,'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null,'MobileId':''});}),await _0x17e385[_0x50bba5(0x20d)](),document[_0x50bba5(0x316)](_0x50bba5(0x268))['classList'][_0x50bba5(0x1ad)]('hidden');},document[_0x4a1078(0x316)]('confirmTitle')[_0x4a1078(0x230)]=_0x4a1078(0x1af),document[_0x4a1078(0x316)](_0x4a1078(0x1d5))[_0x4a1078(0x230)]=_0x4a1078(0x1b6),document[_0x4a1078(0x316)](_0x4a1078(0x268))[_0x4a1078(0x270)]['remove']('hidden');});}function updateGroupRandomUI(){const _0x5f3e4a=_0x4a069b,_0x5723db=allEmployeesData['filter'](_0xbebcf3=>_0xbebcf3[_0x5f3e4a(0x2fd)]&&_0xbebcf3[_0x5f3e4a(0x2f4)]===_0x5f3e4a(0x2f4)),_0x1f5114=_0x5723db[_0x5f3e4a(0x2bb)](_0x5948d3=>_0x5948d3[_0x5f3e4a(0x2a5)])[_0x5f3e4a(0x1c5)]((_0x56facf,_0xc3fd92)=>(_0xc3fd92[_0x5f3e4a(0x2a5)]?.[_0x5f3e4a(0x236)]()||0x0)-(_0x56facf[_0x5f3e4a(0x2a5)]?.['toMillis']()||0x0)),_0x124f81=_0x5723db[_0x5f3e4a(0x2bb)](_0x293874=>!_0x293874[_0x5f3e4a(0x2a5)]);if(document[_0x5f3e4a(0x316)](_0x5f3e4a(0x1ed)))document[_0x5f3e4a(0x316)](_0x5f3e4a(0x1ed))['textContent']=_0x5723db[_0x5f3e4a(0x1a8)];if(document[_0x5f3e4a(0x316)](_0x5f3e4a(0x1e4)))document['getElementById']('grRemainingEligible')[_0x5f3e4a(0x230)]=_0x124f81[_0x5f3e4a(0x1a8)];if(document[_0x5f3e4a(0x316)](_0x5f3e4a(0x2a9)))document['getElementById'](_0x5f3e4a(0x2a9))[_0x5f3e4a(0x230)]=_0x1f5114['length'];}
    </script>
</body>

</html>
