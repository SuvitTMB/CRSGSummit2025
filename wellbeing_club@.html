<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE Retail Club</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff;
            letter-spacing: normal !important;
            font-size: 1.125rem;
        }
        * {
            font-family: 'Sarabun', sans-serif !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            /* ‡∏õ‡∏£‡∏±‡∏ö font dropdown ‡πÅ‡∏•‡∏∞ input ‡∏•‡∏á 1 ‡∏Ç‡∏±‡πâ‡∏ô */
            font-size: 1rem;
        }
        thead.table-header-gray {
             background-color: #e5e7eb;
        }
        table thead th {
            font-weight: bold !important;
            font-size: 1rem !important;
            /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î font-align center */
            text-align: center !important;
        }
        table tbody tr {
            height: 30px !important;
        }
        .winner-row-animate {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        button:disabled {
            background-color: #d1d5db !important;
            cursor: not-allowed !allowed;
            box-shadow: none !important;
            transform: none !important;
        }
        .loading-gif {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0); }
            100% { transform: rotate(360deg); }
        }
        .sortable-header {
            cursor: pointer;
            user-select: none;
        }
        .sortable-header:hover {
            background-color: #d1d5db;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[95%] max-w-7xl p-0 bg-white rounded-lg">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6 pt-6 px-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold" style="color: #0056ff;">Recog Night White Elegance</h1>
            </div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-400 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="mb-6 border-b border-gray-200 px-8">
            <nav class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Tabs">
                <button id="tab-dashboard" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-700 bg-gray-300 border-blue-600">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°
                </button>
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>
                <button id="tab-gift-management" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
                <button id="tab-register" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    QR Code
                </button>
                <button id="tab-group-random" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-winners-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
            </nav>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="px-8 pb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                <div class="lg:w-2/5">
                     <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center h-full">
                         <p class="text-gray-600 text-base mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                         <div class="relative w-64 h-64">
                             <canvas id="registrationBreakdownChart"></canvas>
                             <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                 <span id="breakdownCenterTotal" class="text-2xl font-bold text-gray-900">0</span>
                                 <span class="text-base text-gray-500 font-bold">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                             </div>
                         </div>
                     </div>
                </div>
                <div class="lg:w-3/5">
                    <div class="flex gap-6 h-full">
                         <div class="w-2/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-base mb-4 font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Invite</p>
                            <div class="relative w-64 h-64">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                    <span class="text-base text-gray-500 font-bold">%‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                </div>
                            </div>
                        </div>
                         <div class="w-1/3 flex flex-col justify-between space-y-2">
                            <div class="h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-blue-700 text-sm font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Invite)</p>
                                <p id="targetCount" class="text-2xl font-bold text-blue-800 mt-1">0</p>
                            </div>
                            <div class="h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-green-700 text-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Invite)</p>
                                <p id="participantsCountBox" class="text-2xl font-bold text-green-800 mt-1">0</p>
                            </div>
                            <div class="h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-red-700 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</p>
                                <p id="remainingCount" class="text-2xl font-bold text-red-800 mt-1">0</p>
                            </div>
                            <div class="h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-yellow-700 text-sm">‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô (Non-Invite)</p>
                                <p id="attendeesCount" class="text-2xl font-bold text-yellow-800 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-xl font-semibold text-gray-800 font-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                     <button id="randomizeButton" class="px-6 py-3 text-base font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow active:scale-95 transition-all font-bold">
                         ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (A1 - A24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart1"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (B1 - B24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart2"></canvas></div>
                    </div>
                </div>
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-200 text-sm">
                            <tr><td colspan="6" class="p-6 text-center text-gray-500 font-bold text-sm">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-8 text-center">
                <button id="downloadCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all">
                    üì• Download CSV Report
                </button>
            </div>
        </div>

        <!-- Team List Content -->
        <div id="team-list-content" class="hidden pb-8 px-0">
            <div class="bg-white overflow-hidden">
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center bg-gray-50">
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm">
                        <p class="text-base text-blue-700 font-bold">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm font-bold">
                        <p class="text-base text-green-700">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ó‡∏µ‡∏°</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border shadow-sm font-bold flex flex-col"> 
                        <p class="text-sm text-gray-400 font-bold mb-1 uppercase tracking-tight">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</p>
                        <textarea id="definedTeamNamesInput" class="!text-xs h-16 resize-none bg-blue-50 border-blue-100 font-mono" placeholder="A,B,C..."></textarea>
                        <button id="updateTeamNamesBtn" class="mt-1 text-[10px] bg-blue-600 text-white py-1 rounded uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</button>
                    </div>
                </div>
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-8 py-3 text-base font-bold text-white bg-red-600 rounded-md hover:bg-red-700 shadow transition-all">Reset System Data</button>
                </div>
                 <div class="p-6">
                     <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                         <div>
                             <h3 class="text-xl font-bold border-l-4 border-blue-600 pl-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h3>
                             <div id="teamStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                                 <span class="px-3 py-1 rounded-md bg-gray-100 text-gray-700 text-sm font-bold border">Total: <span id="teamStatsTotal">0</span></span>
                                 <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">Reg: <span id="teamStatsRegistered">0</span></span>
                             </div>
                         </div>
                         <div class="flex items-center">
                             <label for="teamSelect" class="text-base font-bold text-gray-600 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                                 <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏° --</option>
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-xl shadow-sm">
                        <table class="min-w-full text-lg">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-4 text-center font-bold">#</th>
                                    <th class="px-4 py-4 text-left font-bold">Employee ID</th>
                                    <th class="px-4 py-4 text-left font-bold">Full Name</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                    <th class="px-4 py-4 text-left font-bold">Status</th>
                                    <th class="px-4 py-4 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- Group View Content -->
        <div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                <!-- Search Boxes Container -->
                <div class="flex flex-col md:flex-row gap-6 mb-6">
                    <!-- Box 1: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-gray-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchEmployeeIdInput" class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                                <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 5-6 ‡∏´‡∏•‡∏±‡∏Å">
                            </div>
                            <button id="searchEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow transition-all active:scale-95">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        <p id="searchEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>

                    <!-- Box 2: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-green-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-green-800 mb-3 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchRegEmployeeIdInput" class="block text-sm font-bold text-green-600 mb-1">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                                <input type="text" id="searchRegEmployeeIdInput" class="mt-1 block w-full rounded-md border-green-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">
                            </div>
                            <button id="searchRegEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95 uppercase">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                        </div>
                        <p id="searchRegEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>
                </div>

                <div class="px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (Grid)</h2>
                        <div id="gvOverallStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                             <span class="px-3 py-1 rounded-md bg-gray-100 text-sm font-bold border">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Invite): <span id="gvOverallStatsTotal">0</span></span>
                             <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß: <span id="gvOverallStatsRegistered">0</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="groupViewManagerFilter" class="text-base font-bold text-gray-600 mr-2">Manager:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                    </div>
                </div>
                <div id="teamBoxesContainer" class="p-6 grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3"></div>
             </div>
        </div>
        
        <!-- Employee List Content -->
        <div id="employee-list-content" class="hidden pb-8 px-0">
             <div class="bg-white overflow-hidden">
                <div class="px-8 py-6 border-b flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <div id="empStatsContainer" class="hidden flex flex-wrap gap-2 mt-3">
                            <span class="px-4 py-1.5 rounded-xl bg-gray-100 text-gray-700 text-sm font-black border shadow-sm">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="empStatsTotal">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-green-50 text-green-700 text-sm font-black border border-green-200 shadow-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="empStatsRegistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á: <span id="empStatsUnregistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-sm font-black border border-blue-200 shadow-sm">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô: <span id="empStatsPercent">0%</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="managerFilterSelect" class="text-base font-bold text-gray-600 mr-2">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</label>
                         <select id="managerFilterSelect" class="rounded-xl border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                     </div>
                </div>
                <div class="overflow-x-auto p-8">
                    <table class="min-w-full text-sm shadow-sm border rounded-2xl overflow-hidden">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold">#</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-id">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Gift Management Content -->
        <div id="gift-management-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-blue-600 pl-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
                <div class="bg-gray-50 p-6 rounded-2xl border mb-8 max-w-[1000px] shadow-inner">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-grow" style="max-width: 600px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
                            <input type="text" id="giftNameInput" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                        </div>
                        <div style="width: 90px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="giftQtyInput" class="!text-sm text-center" value="1" min="1">
                        </div>
                        <div class="flex items-end">
                            <button id="addGiftBtn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all active:scale-95 shadow-lg !text-xs">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto border rounded-xl shadow-sm">
                    <table class="min-w-full text-base">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold w-24">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="giftListTableBody" class="divide-y divide-gray-100 bg-white">
                            <tr><td colspan="6" class="p-6 text-center text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Winners List Content -->
        <div id="winners-list-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-green-600 pl-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                <div id="winnersByGiftContainer" class="space-y-12">
                    <div class="p-10 text-center text-gray-400 font-bold italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
                <div class="mt-12 text-center">
                    <button id="downloadWinnersCsvButton" class="px-8 py-3 text-base font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95">
                        üì• Download Winners CSV Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Register Content -->
        <div id="register-content" class="hidden pb-8 px-6 text-center">
             <div class="bg-white p-12 rounded-[3rem] shadow-xl border border-gray-100 flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-800 mb-10 font-black">QR Code</h2>
                <div class="p-6 bg-white border-8 border-blue-600 rounded-[3rem] shadow-2xl mb-4 hover:scale-105 transition-all">
                    <img src="./images/QRcode-CRSG.png" alt="QR Code" class="w-80 h-80" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=REGISTER'">
                </div>
             </div>
        </div>

        <!-- Group Random Content -->
        <div id="group-random-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                
                <div class="flex flex-col md:flex-row gap-4 mb-6 items-stretch">
                    <div class="md:w-[30%] grid grid-cols-1 gap-2">
                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 shadow-sm text-center">
                            <p class="text-sm text-blue-700 uppercase font-black">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Invite)</p>
                            <p id="grTotalEligible" class="text-xl font-black text-blue-900">0</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 shadow-sm text-center">
                            <p class="text-sm text-orange-700 uppercase font-black">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°</p>
                            <p id="grRemainingEligible" class="text-xl font-black text-orange-900">0</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100 shadow-sm text-center">
                            <p class="text-sm text-green-700 uppercase font-black">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="grTotalWinners" class="text-xl font-black text-green-900">0</p>
                        </div>
                    </div>

                    <div class="md:w-[70%] flex flex-col gap-3">
                        <div class="bg-gray-50 px-4 py-3 rounded-xl border shadow-sm w-full">
                            <label class="block text-sm font-bold text-gray-400 mb-1 uppercase tracking-wider text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
                            <div id="grGiftBox" class="flex items-center justify-between bg-white border-2 border-dashed border-gray-200 rounded-xl p-3 transition-all">
                                <div class="flex flex-col text-left">
                                    <p id="grGiftDisplayName" class="text-base font-black text-gray-400 leading-tight uppercase">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                                    <p id="grGiftDisplayQty" class="text-sm font-bold text-gray-300 mt-1">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                                </div>
                                <button id="openGroupGiftPickerBtn" class="px-4 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-xs font-black border border-blue-200 shadow-sm shrink-0 active:scale-95 transition-all">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                            </div>
                        </div>

                        <div class="flex items-stretch gap-3 w-full flex-grow min-h-[90px]">
                            <div class="w-[30%] bg-gray-50 p-3 rounded-xl border shadow-sm flex flex-col justify-center items-center text-center">
                                <label class="text-sm font-bold text-gray-500 uppercase mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</label>
                                <input type="number" id="grDrawCount" value="0" min="0" class="w-full text-center text-3xl font-black text-blue-600 bg-white border border-blue-100 rounded-lg focus:border-blue-500 focus:ring-0 py-1 shadow-inner">
                            </div>
                            <div class="w-[70%]">
                                <button id="grStartDrawBtn" class="w-full h-full text-xl font-black text-white bg-[#0056ff] rounded-xl hover:bg-blue-700 shadow-lg transition-all active:scale-95 disabled:bg-gray-400 uppercase tracking-widest flex items-center justify-center">
                                    üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border-t border-gray-100 pt-4">
                    <div class="p-4 border-r border-gray-100">
                        <h4 class="text-xl font-black text-blue-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</h4>
                        <div id="grBoxLeft" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                    <div class="p-4">
                        <h4 class="text-xl font-black text-indigo-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h4>
                        <div id="grBoxRight" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- LIGHTBOX: Manual Registration -->
    <div id="manualRegisterModal" class="hidden fixed inset-0 z-[140] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-lg border-t-8 border-green-600">
            <h3 class="text-xl font-bold mb-6 uppercase border-b pb-3 text-gray-800 text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            <div id="regEmpDetail" class="space-y-4 mb-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="regEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="regEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏™‡∏≤‡∏Ç‡∏≤ ‡πÅ‡∏•‡∏∞ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° -->
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏≤‡∏Ç‡∏≤ (Branch)</label><p id="regEmpBranch" class="text-sm font-bold text-gray-700"></p></div>
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Manager)</label><p id="regEmpManager" class="text-sm font-bold text-gray-700"></p></div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                        <input type="text" id="regEmpSeat" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, A2">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Invite</label>
                        <select id="regEmpInviteStatus" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base">
                            <option value="">-- ‡∏ß‡πà‡∏≤‡∏á --</option>
                            <option value="invite">invite</option>
                        </select>
                    </div>
                </div>
                <p id="regManualError" class="text-red-600 text-sm font-black italic h-4"></p>
            </div>
            <div class="flex justify-end gap-3 font-bold">
                <button id="closeManualRegModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveManualRegButton" class="px-8 py-2 bg-green-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-green-700 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Group Detail -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="groupViewModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
                     <div id="groupViewStatsContainer" class="flex flex-wrap gap-2 mt-2">
                         <span class="px-3 py-1 rounded-full bg-gray-100 text-sm font-bold border uppercase">Total: <span id="groupViewStatsTotal">0</span></span>
                         <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-sm font-bold border border-green-200 uppercase">Reg: <span id="groupViewStatsRegistered">0</span></span>
                     </div>
                 </div>
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">ID</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- MODAL: Lucky Draw Individual -->
    <div id="randomizeModal" class="hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 w-[75%] h-[80vh] flex flex-col mx-4 border-t-8 border-blue-600 relative">
            <button id="closeRandomizeModalButtonX" class="absolute top-2 right-4 text-gray-400 hover:text-gray-600 text-5xl font-light transition-all z-10">&times;</button>
            <h3 class="text-xl font-bold text-center text-gray-900 mb-6 uppercase">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
            <div class="max-w-lg mx-auto mb-8 w-full">
                <label class="block text-sm font-bold text-gray-400 mb-2 text-center">‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏∏‡πà‡∏°</label>
                <div id="indGiftBox" class="flex items-center justify-between bg-blue-50 border-2 border-dashed border-blue-200 rounded-2xl p-3 transition-colors">
                    <div class="flex flex-col text-left">
                        <p id="indGiftDisplayName" class="text-lg font-black text-blue-400 leading-tight">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                        <p id="indGiftDisplayQty" class="text-sm text-black-400 mt-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    </div>
                    <button id="openGiftPickerBtn" class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-blue-700 uppercase">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p><p id="modalParticipantsCount" class="text-2xl font-bold">0</p></div>
                <div class="bg-green-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-green-700 uppercase">‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß</p><p id="modalDrawnCount" class="text-2xl font-bold">0</p></div>
            </div>
            <div class="flex justify-center space-x-2 mb-6 shrink-0">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
            </div>
            <div class="mb-6 flex flex-col items-center shrink-0">
                <button id="startRandomizeButton" class="w-[40%] px-6 py-4 text-base text-white bg-blue-600 rounded-lg font-bold hover:bg-blue-700 shadow-xl active:scale-95 disabled:bg-gray-400 uppercase" disabled>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</button>
                <p id="randomizeError" class="text-red-600 text-base mt-3 font-bold uppercase"></p>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-xl bg-gray-50 font-bold">
                <table class="min-w-full text-base">
                    <thead class="bg-gray-200 sticky top-0 uppercase text-gray-700">
                        <tr><th class="px-4 py-4 text-left">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th><th class="px-4 py-4 text-left">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</th><th class="px-4 py-4 text-left">‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th><th class="px-4 py-4 text-center">Action</th></tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL: Gift Picker -->
    <div id="giftPickerModal" class="hidden fixed inset-0 z-[100] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-[70%] modal-enter flex flex-col border-t-8 border-orange-500">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="giftPickerTitle" class="text-xl font-black text-gray-800 uppercase">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
                <button id="closeGiftPickerBtn" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto max-h-[60vh] space-y-2" id="giftPickerList"></div>
        </div>
    </div>

    <!-- POPUP WINNER Detail -->
    <div id="winnerDetailModal" class="hidden fixed inset-0 z-[200] bg-gray-900 bg-opacity-95 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-xl w-full text-center border-t-8 border-blue-600 transform scale-110">
            <h3 class="text-xl font-black text-blue-600 mb-4 uppercase">üéä WINNER üéä</h3>
            <div class="text-6xl mb-6">üèÜ</div>
            <p id="winnerName" class="text-2xl font-black text-gray-900 my-4 leading-tight uppercase"></p>
            <p id="winnerGiftText" class="text-xl font-bold text-orange-600 mb-6"></p>
            <div class="bg-blue-50 p-6 rounded-[2rem] mb-10 border border-blue-100 shadow-inner text-center">
                <p id="winnerEmployeeId" class="text-xl font-black text-blue-800 font-mono"></p>
                <p id="winnerBU" class="text-lg font-bold text-gray-600 mt-2 uppercase"></p>
                <p id="winnerTeam" class="text-base font-medium text-gray-400 mt-2 uppercase"></p>
            </div>
            <div class="flex flex-col gap-4">
                <button id="cancelWinnerButton" class="text-base font-bold text-red-400 hover:text-red-600 hover:underline transition-all uppercase">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Cancel)</button>
                <button id="closeWinnerModalButton" class="px-12 py-3 text-base font-black bg-blue-600 text-white rounded-[1.5rem] hover:bg-blue-700 shadow-2xl active:scale-95 transition-all">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Profile -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-[120] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="editEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="editEmpName" class="font-black text-gray-900 text-lg"></p></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Manager / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="editEmpManager" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Team / ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label><input type="text" id="editEmpTeam" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <p id="editError" class="text-red-600 text-sm font-black italic mt-2"></p>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditModalButton" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Gift -->
    <div id="editGiftModal" class="hidden fixed inset-0 z-[150] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
            <div class="space-y-6">
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label><input type="text" id="editGiftName" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ 50 ‡∏ô‡∏¥‡πâ‡∏ß"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                        <input type="number" id="editGiftTotalQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="1">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                        <input type="number" id="editGiftRemainingQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="0">
                    </div>
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditGiftModalBtn" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditGiftBtn" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmation Center -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[300] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div id="confirmModalInner" class="bg-white rounded-2xl p-10 max-w-lg w-full shadow-2xl text-center transition-all duration-300">
            <h3 id="confirmTitle" class="text-xl font-black mb-4 uppercase text-red-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?</h3>
            <p id="confirmText" class="text-gray-600 font-bold mb-6 leading-relaxed italic text-base"></p>
            
            <div id="confirmInputContainer" class="hidden mb-10">
                <p class="text-sm text-gray-500 mb-2">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <span class="font-bold text-red-600 uppercase">Reset</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <input type="text" id="confirmInput" class="text-center border-2 border-red-200 rounded-lg p-2 w-full focus:border-red-500 outline-none text-sm font-bold uppercase" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            </div>

            <div class="flex justify-center gap-4">
                <button id="closeConfirmButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm font-bold hover:bg-gray-200 uppercase">‡πÑ‡∏°‡πà</button>
                <button id="confirmActionButton" class="px-8 py-2 bg-red-600 text-white rounded-xl text-sm font-black shadow-lg hover:bg-red-700 uppercase">‡πÉ‡∏ä‡πà</button>
            </div>
        </div>
    </div>

    <!-- Script Section -->
    <script type="module">
const _0x43909=_0x16b2;(function(_0x51900d,_0x289a13){const _0x219e0f=_0x16b2,_0x258555=_0x51900d();while(!![]){try{const _0x47a512=parseInt(_0x219e0f(0x158))/0x1*(parseInt(_0x219e0f(0x200))/0x2)+-parseInt(_0x219e0f(0x1c2))/0x3*(parseInt(_0x219e0f(0x21e))/0x4)+-parseInt(_0x219e0f(0x195))/0x5+-parseInt(_0x219e0f(0x215))/0x6+-parseInt(_0x219e0f(0x125))/0x7+-parseInt(_0x219e0f(0x1f4))/0x8+parseInt(_0x219e0f(0x16f))/0x9;if(_0x47a512===_0x289a13)break;else _0x258555['push'](_0x258555['shift']());}catch(_0x2df4a7){_0x258555['push'](_0x258555['shift']());}}}(_0x273f,0x9d7fb));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,collection,onSnapshot,doc,updateDoc,setDoc,addDoc,deleteDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x43909(0x155),'authDomain':'ttb-register.firebaseapp.com','projectId':'ttb-register','storageBucket':_0x43909(0xf1),'messagingSenderId':_0x43909(0x1a1),'appId':_0x43909(0x1af)};let db,auth,allEmployeesData=[],allGiftsData=[],selectedIndGiftId=null,selectedGroupGiftId=null,giftPickerContext=_0x43909(0x114),teamNames=['A1','A2','A3','A4','A5','A6','A7','A8','A9',_0x43909(0x1dc),_0x43909(0x175),'A12',_0x43909(0x137),'A14',_0x43909(0x222),_0x43909(0x228),_0x43909(0x1d3),_0x43909(0xd6),_0x43909(0x107),_0x43909(0x187),_0x43909(0x1bb),_0x43909(0x227),'A23',_0x43909(0x136),'B1','B2','B3','B4','B5','B6','B7','B8','B9',_0x43909(0x209),_0x43909(0x1da),'B12',_0x43909(0x1ef),_0x43909(0xb0),_0x43909(0xfe),_0x43909(0x193),_0x43909(0xc1),'B18',_0x43909(0x121),'B20',_0x43909(0x1f2),_0x43909(0x1e6),'B23','B24'],charts={},currentConfirmAction=null,currentEditingDocId=null,currentEditingGiftId=null,drawInterval=null,empSortField=_0x43909(0xaf),empSortDir=_0x43909(0x1e1);((async()=>{const _0x40a93d=_0x43909;try{const _0xa706ca=initializeApp(firebaseConfig);db=getFirestore(_0xa706ca),auth=getAuth(_0xa706ca),await signInAnonymously(auth),initCharts(),setupTabs(),setupListeners(),startListening(),startListeningGifts(),document['getElementById'](_0x40a93d(0x1b0))[_0x40a93d(0x20e)]=teamNames[_0x40a93d(0x166)](','),setInterval(()=>{const _0x494d01=_0x40a93d,_0x24c782=new Date();document[_0x494d01(0x1d8)](_0x494d01(0x163))[_0x494d01(0xe1)]=_0x24c782[_0x494d01(0x171)](_0x494d01(0x14a),{'year':_0x494d01(0x20d),'month':_0x494d01(0x177),'day':_0x494d01(0x20d),'hour':_0x494d01(0xac),'minute':'2-digit','second':_0x494d01(0xac)});},0x3e8);}catch(_0x9b6b29){console[_0x40a93d(0xf0)](_0x9b6b29);}})());function setupTabs(){const _0x701936=_0x43909,_0x4818ac={'tab-dashboard':_0x701936(0xf3),'tab-team-list':_0x701936(0x13d),'tab-group-view':_0x701936(0x1ae),'tab-employee-list':_0x701936(0x19e),'tab-gift-management':_0x701936(0x157),'tab-register':_0x701936(0x104),'tab-group-random':_0x701936(0x1a4),'tab-winners-list':'winners-list-content'};Object[_0x701936(0x196)](_0x4818ac)[_0x701936(0x10e)](_0x17c5d5=>{const _0x1ccdc7=_0x701936,_0x16c069=document[_0x1ccdc7(0x1d8)](_0x17c5d5);if(!_0x16c069)return;_0x16c069[_0x1ccdc7(0x20f)](_0x1ccdc7(0x148),function(){const _0x140efc=_0x1ccdc7;Object[_0x140efc(0x196)](_0x4818ac)[_0x140efc(0x10e)](_0x514ea7=>{const _0xa2327b=_0x140efc,_0x177ce8=document['getElementById'](_0x514ea7),_0x509f18=document[_0xa2327b(0x1d8)](_0x4818ac[_0x514ea7]);if(_0x177ce8)_0x177ce8[_0xa2327b(0x1a6)]['replace'](_0xa2327b(0x12d),_0xa2327b(0x13c));if(_0x509f18)_0x509f18[_0xa2327b(0x1a6)][_0xa2327b(0xea)](_0xa2327b(0xef));}),this['classList'][_0x140efc(0x20c)](_0x140efc(0x13c),_0x140efc(0x12d)),document[_0x140efc(0x1d8)](_0x4818ac[_0x17c5d5])?.[_0x140efc(0x1a6)]['remove'](_0x140efc(0xef)),window[_0x140efc(0xce)](new Event(_0x140efc(0x115)));});});}function _0x16b2(_0x1c4c78,_0x5c5fa8){_0x1c4c78=_0x1c4c78-0xac;const _0x273fb2=_0x273f();let _0x16b250=_0x273fb2[_0x1c4c78];return _0x16b250;}function initCharts(){const _0x4aec5a=_0x43909,_0x182176={'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]},'datalabels':{'color':'#fff','font':{'weight':_0x4aec5a(0x10a),'size':0xc},'formatter':_0x192398=>_0x192398>0x0?_0x192398:''}}};charts[_0x4aec5a(0xbd)]=new Chart(document['getElementById'](_0x4aec5a(0x1ec)),{'type':_0x4aec5a(0x133),'data':{'labels':[_0x4aec5a(0xd0),_0x4aec5a(0xdd)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x4aec5a(0x13a),_0x4aec5a(0xdc)]}]},'options':{..._0x182176,'cutout':_0x4aec5a(0x126)},'plugins':[ChartDataLabels]}),charts[_0x4aec5a(0x1b9)]=new Chart(document[_0x4aec5a(0x1d8)](_0x4aec5a(0x1b2)),{'type':_0x4aec5a(0x133),'data':{'labels':['Registered',_0x4aec5a(0x184)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x4aec5a(0x128),_0x4aec5a(0x13b)]}]},'options':{..._0x182176,'cutout':_0x4aec5a(0x126)},'plugins':[ChartDataLabels]});const _0x200aed={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'stacked':!![]},'y':{'stacked':!![]}},'plugins':{'legend':{'display':!![],'position':'bottom','labels':{'font':{'size':0xc}}},'datalabels':{'color':_0x4aec5a(0x14e)}}};charts['bar1']=new Chart(document[_0x4aec5a(0x1d8)]('teamBarChart1'),{'type':_0x4aec5a(0xc3),'data':{'labels':[],'datasets':[{'label':_0x4aec5a(0x18d),'data':[],'backgroundColor':'#3B82F6'},{'label':_0x4aec5a(0x140),'data':[],'backgroundColor':'#BFDBFE'}]},'options':_0x200aed,'plugins':[ChartDataLabels]}),charts[_0x4aec5a(0x190)]=new Chart(document[_0x4aec5a(0x1d8)]('teamBarChart2'),{'type':_0x4aec5a(0xc3),'data':{'labels':[],'datasets':[{'label':_0x4aec5a(0x18d),'data':[],'backgroundColor':'#3B82F6'},{'label':_0x4aec5a(0x140),'data':[],'backgroundColor':_0x4aec5a(0x12e)}]},'options':_0x200aed,'plugins':[ChartDataLabels]});}function startListening(){const _0x33d7ba=_0x43909;onSnapshot(collection(db,_0x33d7ba(0x144)),_0x51d8f7=>{const _0xaf5300=_0x33d7ba;allEmployeesData=_0x51d8f7[_0xaf5300(0xca)][_0xaf5300(0x1df)](_0xcae8cf=>({'id':_0xcae8cf['id'],..._0xcae8cf[_0xaf5300(0x1f6)]()})),refreshUI();},_0x87eeff=>console['error'](_0x87eeff));}function startListeningGifts(){const _0x3aab24=_0x43909;onSnapshot(collection(db,_0x3aab24(0x127)),_0x460ef7=>{const _0x4bcfbc=_0x3aab24,_0x224fd6=_0x460ef7[_0x4bcfbc(0xca)][_0x4bcfbc(0x1df)](_0x4f9688=>({'id':_0x4f9688['id'],..._0x4f9688['data']()}));allGiftsData=_0x224fd6[_0x4bcfbc(0x1d5)]((_0x890d47,_0x429033)=>(_0x890d47[_0x4bcfbc(0x189)]||0x0)-(_0x429033[_0x4bcfbc(0x189)]||0x0)),renderGiftTable(),refreshIndGiftState(),refreshGroupGiftState(),updateWinnersList();},_0x2133ee=>console[_0x3aab24(0xf0)](_0x2133ee));}function refreshUI(){const _0x393ff5=_0x43909,_0x82132d=allEmployeesData[_0x393ff5(0x1b8)](_0x1d9307=>_0x1d9307[_0x393ff5(0x168)]),_0x4960f3=allEmployeesData[_0x393ff5(0x1b8)](_0x758485=>_0x758485[_0x393ff5(0x168)]&&_0x758485[_0x393ff5(0x16c)]==='invite'),_0x2a7892=allEmployeesData[_0x393ff5(0x1b8)](_0x29d957=>_0x29d957[_0x393ff5(0x168)]&&_0x29d957['invite']!==_0x393ff5(0x16c)),_0x5dc343=allEmployeesData['filter'](_0x433670=>_0x433670[_0x393ff5(0x16c)]===_0x393ff5(0x16c));document[_0x393ff5(0x1d8)](_0x393ff5(0x1d6))[_0x393ff5(0xe1)]=allEmployeesData[_0x393ff5(0x1b8)](_0x586a28=>_0x586a28[_0x393ff5(0x105)])[_0x393ff5(0x19a)],document[_0x393ff5(0x1d8)](_0x393ff5(0xc9))[_0x393ff5(0xe1)]=allEmployeesData[_0x393ff5(0x1b8)](_0x5172b8=>_0x5172b8[_0x393ff5(0x220)])[_0x393ff5(0x19a)];const _0x1b884d=allEmployeesData[_0x393ff5(0x19a)],_0x5a636f=_0x82132d['length'],_0x521990=_0x1b884d-_0x5a636f,_0x59a06d=_0x1b884d>0x0?Math[_0x393ff5(0x15d)](_0x5a636f/_0x1b884d*0x64):0x0;document[_0x393ff5(0x1d8)](_0x393ff5(0xe2))&&(document[_0x393ff5(0x1d8)](_0x393ff5(0x17b))[_0x393ff5(0xe1)]=_0x1b884d,document['getElementById'](_0x393ff5(0x1fb))[_0x393ff5(0xe1)]=_0x5a636f,document['getElementById'](_0x393ff5(0x1c3))[_0x393ff5(0xe1)]=_0x521990,document['getElementById'](_0x393ff5(0x1ca))[_0x393ff5(0xe1)]=_0x59a06d+'%',document[_0x393ff5(0x1d8)](_0x393ff5(0xe2))['classList'][_0x393ff5(0x123)](_0x393ff5(0xef)));document['getElementById']('targetCount')[_0x393ff5(0xe1)]=_0x5dc343[_0x393ff5(0x19a)],document['getElementById'](_0x393ff5(0xe4))[_0x393ff5(0xe1)]=_0x4960f3[_0x393ff5(0x19a)],document['getElementById'](_0x393ff5(0x1a3))[_0x393ff5(0xe1)]=_0x2a7892['length'],document[_0x393ff5(0x1d8)]('remainingCount')[_0x393ff5(0xe1)]=Math[_0x393ff5(0x181)](0x0,_0x5dc343[_0x393ff5(0x19a)]-_0x4960f3[_0x393ff5(0x19a)]),document[_0x393ff5(0x1d8)](_0x393ff5(0x19b))[_0x393ff5(0xe1)]=_0x82132d[_0x393ff5(0x19a)],document[_0x393ff5(0x1d8)]('donutPercentage')[_0x393ff5(0xe1)]=_0x5dc343['length']?Math[_0x393ff5(0x15d)](_0x4960f3['length']/_0x5dc343[_0x393ff5(0x19a)]*0x64)+'%':'0%';charts[_0x393ff5(0xbd)]&&(charts[_0x393ff5(0xbd)][_0x393ff5(0x1f6)]['datasets'][0x0][_0x393ff5(0x1f6)]=[_0x4960f3['length'],_0x2a7892['length']],charts['breakdown']['update']());charts[_0x393ff5(0x1b9)]&&(charts[_0x393ff5(0x1b9)][_0x393ff5(0x1f6)][_0x393ff5(0x162)][0x0][_0x393ff5(0x1f6)]=[_0x4960f3[_0x393ff5(0x19a)],Math[_0x393ff5(0x181)](0x0,_0x5dc343[_0x393ff5(0x19a)]-_0x4960f3[_0x393ff5(0x19a)])],charts[_0x393ff5(0x1b9)]['update']());const _0x1dda59={};teamNames['forEach'](_0xee12f7=>_0x1dda59[_0xee12f7]={'r':0x0,'t':0x0}),allEmployeesData[_0x393ff5(0x10e)](_0x287437=>{const _0x505156=_0x393ff5;if(_0x287437['Check_Place']&&_0x1dda59[_0x287437['Check_Place']]){_0x1dda59[_0x287437[_0x505156(0x220)]]['t']++;if(_0x287437[_0x505156(0x168)])_0x1dda59[_0x287437['Check_Place']]['r']++;}});const _0x786200=Math[_0x393ff5(0xee)](teamNames[_0x393ff5(0x19a)]/0x2);charts[_0x393ff5(0x19d)]&&(charts[_0x393ff5(0x19d)][_0x393ff5(0x1f6)][_0x393ff5(0x109)]=teamNames['slice'](0x0,_0x786200),charts[_0x393ff5(0x19d)][_0x393ff5(0x1f6)]['datasets'][0x0][_0x393ff5(0x1f6)]=teamNames[_0x393ff5(0x1d2)](0x0,_0x786200)['map'](_0x2c36ae=>_0x1dda59[_0x2c36ae]['r']),charts[_0x393ff5(0x19d)][_0x393ff5(0x1f6)][_0x393ff5(0x162)][0x1][_0x393ff5(0x1f6)]=teamNames[_0x393ff5(0x1d2)](0x0,_0x786200)['map'](_0x5ad008=>_0x1dda59[_0x5ad008]['t']-_0x1dda59[_0x5ad008]['r']),charts[_0x393ff5(0x19d)][_0x393ff5(0xc7)]());charts[_0x393ff5(0x190)]&&(charts[_0x393ff5(0x190)][_0x393ff5(0x1f6)][_0x393ff5(0x109)]=teamNames[_0x393ff5(0x1d2)](_0x786200),charts['bar2'][_0x393ff5(0x1f6)][_0x393ff5(0x162)][0x0]['data']=teamNames[_0x393ff5(0x1d2)](_0x786200)[_0x393ff5(0x1df)](_0x49169e=>_0x1dda59[_0x49169e]['r']),charts['bar2']['data'][_0x393ff5(0x162)][0x1][_0x393ff5(0x1f6)]=teamNames[_0x393ff5(0x1d2)](_0x786200)[_0x393ff5(0x1df)](_0x55b7ad=>_0x1dda59[_0x55b7ad]['t']-_0x1dda59[_0x55b7ad]['r']),charts['bar2'][_0x393ff5(0xc7)]());const _0x43ef07=[..._0x82132d][_0x393ff5(0x1d5)]((_0x1bc4b4,_0x28f8aa)=>(_0x28f8aa['DateLogin']?.[_0x393ff5(0x1d9)]()||0x0)-(_0x1bc4b4[_0x393ff5(0x168)]?.[_0x393ff5(0x1d9)]()||0x0))['slice'](0x0,0x1e);document['getElementById'](_0x393ff5(0xf4))['innerHTML']=_0x43ef07['map'](_0xd570=>'<tr><td\x20class=\x22px-4\x20py-0\x20text-center\x22>'+_0xd570[_0x393ff5(0x120)]+_0x393ff5(0xfd)+_0xd570[_0x393ff5(0x176)]+'</td><td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-xm\x20text-left\x22>'+(_0xd570[_0x393ff5(0x119)]||'-')+_0x393ff5(0x226)+(_0xd570[_0x393ff5(0x105)]||'-')+_0x393ff5(0xb2)+_0xd570['id']+_0x393ff5(0x1ad)+_0xd570[_0x393ff5(0x176)]+_0x393ff5(0x1e8))[_0x393ff5(0x166)](''),updateTeamTab(),updateGridTab(),updateEmployeeList(),updateGroupRandomUI(),updateLuckyDrawStats(),updateWinnersList();}function updateWinnersList(){const _0x1934a0=_0x43909,_0x114169=document[_0x1934a0(0x1d8)](_0x1934a0(0x15a));if(!_0x114169)return;const _0x11e3ba=allEmployeesData[_0x1934a0(0x1b8)](_0x247178=>_0x247178['RandomTime']);if(_0x11e3ba[_0x1934a0(0x19a)]===0x0){_0x114169[_0x1934a0(0x156)]=_0x1934a0(0x1ab);return;}_0x114169[_0x1934a0(0x156)]=allGiftsData['map'](_0x9d0f58=>{const _0x16ad90=_0x1934a0,_0x51c096=_0x11e3ba[_0x16ad90(0x1b8)](_0x15f372=>_0x15f372[_0x16ad90(0x1e4)]===_0x9d0f58['id']||_0x15f372[_0x16ad90(0x1d0)]===_0x9d0f58['name']&&!_0x15f372['AwardedGiftId']);if(_0x51c096['length']===0x0)return'';return _0x51c096[_0x16ad90(0x1d5)]((_0x240bfd,_0x26043e)=>(_0x26043e[_0x16ad90(0x1bc)]?.[_0x16ad90(0x1d9)]()||0x0)-(_0x240bfd['RandomTime']?.[_0x16ad90(0x1d9)]()||0x0)),_0x16ad90(0xd5)+_0x9d0f58[_0x16ad90(0x153)]+_0x16ad90(0x185)+_0x51c096['length']+_0x16ad90(0x146)+_0x51c096['map']((_0x507328,_0x23b984)=>{const _0x425b7c=_0x16ad90,_0x41f0de=_0x507328[_0x425b7c(0x1e0)]?!![]:![],_0x283e06=_0x41f0de?_0x425b7c(0x20b):_0x425b7c(0xff),_0x38cc7a=_0x41f0de?_0x425b7c(0x204):_0x425b7c(0x10b),_0x5a929c=_0x41f0de?'':'onclick=\x22markAsReceived(\x27'+_0x507328['id']+_0x425b7c(0xf5);return _0x425b7c(0xba)+(_0x23b984+0x1)+_0x425b7c(0x199)+_0x507328[_0x425b7c(0x120)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20uppercase\x20text-xm\x20text-left\x22>'+_0x507328[_0x425b7c(0x176)]+_0x425b7c(0x1e2)+(_0x507328[_0x425b7c(0x119)]||'-')+_0x425b7c(0x1e2)+(_0x507328[_0x425b7c(0x105)]||'-')+_0x425b7c(0x18f)+(_0x507328['Check_Place']||'-')+_0x425b7c(0x11a)+_0x5a929c+'\x20class=\x22px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-black\x20transition-all\x20shadow-sm\x20'+_0x38cc7a+'\x22>'+_0x283e06+_0x425b7c(0x147)+_0x507328['id']+_0x425b7c(0xb5);})['join']('')+_0x16ad90(0x135);})[_0x1934a0(0x166)]('');}window[_0x43909(0xd8)]=async _0x3fc159=>{const _0x5ea612=_0x43909;try{await updateDoc(doc(db,_0x5ea612(0x144),_0x3fc159),{'ReceivedTime':serverTimestamp()});}catch(_0x1d9147){console['error'](_0x1d9147);}};async function addGift(){const _0x43cb94=_0x43909,_0x424b55=document[_0x43cb94(0x1d8)]('giftNameInput')[_0x43cb94(0x20e)][_0x43cb94(0x213)](),_0xc731ed=parseInt(document[_0x43cb94(0x1d8)]('giftQtyInput')[_0x43cb94(0x20e)]);if(!_0x424b55||isNaN(_0xc731ed))return;const _0x1f0f07=allGiftsData['reduce']((_0x5b1f49,_0x2ba2f6)=>Math[_0x43cb94(0x181)](_0x5b1f49,_0x2ba2f6['order']||0x0),0x0);await addDoc(collection(db,'crsg_gift'),{'name':_0x424b55,'totalQty':_0xc731ed,'remainingQty':_0xc731ed,'status':'on','order':_0x1f0f07+0x1,'createdAt':serverTimestamp()}),document[_0x43cb94(0x1d8)](_0x43cb94(0xb9))[_0x43cb94(0x20e)]='',document['getElementById'](_0x43cb94(0x1c7))[_0x43cb94(0x20e)]='1';}function renderGiftTable(){const _0x36b06c=_0x43909,_0x5d5605=document[_0x36b06c(0x1d8)](_0x36b06c(0xad));if(allGiftsData[_0x36b06c(0x19a)]===0x0){_0x5d5605[_0x36b06c(0x156)]=_0x36b06c(0x10c);return;}_0x5d5605[_0x36b06c(0x156)]=allGiftsData[_0x36b06c(0x1df)]((_0x4d7686,_0x317f29)=>_0x36b06c(0xe0)+(_0x4d7686['order']||_0x317f29+0x1)+'\x22\x20onchange=\x22updateGiftOrder(\x27'+_0x4d7686['id']+_0x36b06c(0x1c6)+_0x4d7686[_0x36b06c(0x153)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22>'+_0x4d7686[_0x36b06c(0x19f)]+_0x36b06c(0x143)+_0x4d7686['remainingQty']+_0x36b06c(0x1b7)+_0x4d7686['id']+_0x36b06c(0x1ad)+_0x4d7686[_0x36b06c(0xaf)]+_0x36b06c(0xcf)+(_0x4d7686[_0x36b06c(0xaf)]==='on'?'bg-green-400\x20text-white\x20border-green-600':'bg-gray-200\x20text-gray-600')+'\x22>'+(_0x4d7686[_0x36b06c(0xaf)]==='on'?'ON':_0x36b06c(0x1bd))+_0x36b06c(0x1ba)+_0x4d7686['id']+_0x36b06c(0xb4)+_0x4d7686['id']+'\x27,\x20\x27'+_0x4d7686[_0x36b06c(0x153)]+'\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x22>Delete</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20')[_0x36b06c(0x166)]('');}window['updateGiftOrder']=async(_0x5aa544,_0x161b3d)=>{const _0x2b4b89=_0x43909,_0x5bfce2=parseInt(_0x161b3d);if(!isNaN(_0x5bfce2))await updateDoc(doc(db,_0x2b4b89(0x127),_0x5aa544),{'order':_0x5bfce2});},window[_0x43909(0x130)]=async(_0x3b539a,_0x17b34f)=>{const _0x1606ae=_0x43909;await updateDoc(doc(db,_0x1606ae(0x127),_0x3b539a),{'status':_0x17b34f==='on'?_0x1606ae(0x1f3):'on'});},window['editGift']=_0x2e18d9=>{const _0x2fe081=_0x43909,_0x1949d3=allGiftsData[_0x2fe081(0x10f)](_0xb347ba=>_0xb347ba['id']===_0x2e18d9);if(!_0x1949d3)return;currentEditingGiftId=_0x2e18d9,document[_0x2fe081(0x1d8)]('editGiftName')[_0x2fe081(0x20e)]=_0x1949d3['name'],document[_0x2fe081(0x1d8)]('editGiftTotalQty')[_0x2fe081(0x20e)]=_0x1949d3[_0x2fe081(0x19f)],document['getElementById']('editGiftRemainingQty')[_0x2fe081(0x20e)]=_0x1949d3[_0x2fe081(0x216)],document[_0x2fe081(0x1d8)](_0x2fe081(0x198))[_0x2fe081(0x1a6)]['remove'](_0x2fe081(0xef));},window[_0x43909(0xdb)]=(_0xa45dd6,_0x10b86d)=>{const _0x595de6=_0x43909,_0x1e6cd8=document[_0x595de6(0x1d8)]('confirmModalInner');_0x1e6cd8[_0x595de6(0x150)]=_0x595de6(0xc6),currentConfirmAction=async()=>{const _0x55910d=_0x595de6;await deleteDoc(doc(db,_0x55910d(0x127),_0xa45dd6)),document[_0x55910d(0x1d8)](_0x55910d(0x15b))[_0x55910d(0x1a6)][_0x55910d(0xea)](_0x55910d(0xef));},document[_0x595de6(0x1d8)](_0x595de6(0x15e))[_0x595de6(0xe1)]=_0x595de6(0x173),document['getElementById'](_0x595de6(0x20a))[_0x595de6(0xe1)]=_0x595de6(0x207)+_0x10b86d+_0x595de6(0x1aa),document[_0x595de6(0x1d8)](_0x595de6(0x14d))[_0x595de6(0x1a6)][_0x595de6(0xea)]('hidden'),document[_0x595de6(0x1d8)](_0x595de6(0x15b))[_0x595de6(0x1a6)][_0x595de6(0x123)](_0x595de6(0xef));};function renderGiftPicker(){const _0x2008e8=_0x43909,_0x2386b7=document[_0x2008e8(0x1d8)](_0x2008e8(0xfb)),_0x534e39=allGiftsData[_0x2008e8(0x1b8)](_0x1a1231=>_0x1a1231['status']==='on'&&_0x1a1231[_0x2008e8(0x216)]>0x0);document[_0x2008e8(0x1d8)](_0x2008e8(0xe8))['textContent']=giftPickerContext===_0x2008e8(0x114)?_0x2008e8(0x172):_0x2008e8(0x138);if(!_0x534e39[_0x2008e8(0x19a)]){_0x2386b7[_0x2008e8(0x156)]=_0x2008e8(0xe3);return;}const _0x3622f7=giftPickerContext===_0x2008e8(0x114)?selectedIndGiftId:selectedGroupGiftId;_0x2386b7[_0x2008e8(0x156)]=_0x534e39['map'](_0x42c5cb=>{const _0xa945d=_0x2008e8,_0x5222d7=_0x42c5cb['id']===_0x3622f7;return _0xa945d(0xc0)+_0x42c5cb['id']+_0xa945d(0x223)+(_0x5222d7?_0xa945d(0x174):_0xa945d(0xb1))+_0xa945d(0x197)+(_0x5222d7?_0xa945d(0x18a):'text-base\x20text-gray-800')+_0xa945d(0xb6)+_0x42c5cb[_0xa945d(0x153)]+_0xa945d(0x15c)+(_0x5222d7?_0xa945d(0x132):_0xa945d(0x16a))+_0xa945d(0xfa)+_0x42c5cb[_0xa945d(0x216)]+_0xa945d(0x1f0)+(_0x5222d7?_0xa945d(0x1e3):_0xa945d(0x139))+_0xa945d(0x1b3)+(_0x5222d7?_0xa945d(0x102):_0xa945d(0x1d7))+_0xa945d(0x1c0);})['join']('');}window[_0x43909(0x154)]=_0x373cd1=>{const _0x1f33d8=_0x43909;giftPickerContext===_0x1f33d8(0x114)?(selectedIndGiftId=_0x373cd1,refreshIndGiftState()):(selectedGroupGiftId=_0x373cd1,document['getElementById']('grBoxLeft')['innerHTML']='',document[_0x1f33d8(0x1d8)](_0x1f33d8(0x208))['innerHTML']='',refreshGroupGiftState()),document[_0x1f33d8(0x1d8)](_0x1f33d8(0x1b6))['classList'][_0x1f33d8(0xea)](_0x1f33d8(0xef));};function refreshIndGiftState(){const _0x1b4b8a=_0x43909,_0x21be00=document[_0x1b4b8a(0x1d8)](_0x1b4b8a(0x191)),_0x4b42c7=document['getElementById'](_0x1b4b8a(0x11e)),_0x2c5e8b=document[_0x1b4b8a(0x1d8)](_0x1b4b8a(0x1b1));if(!selectedIndGiftId){_0x21be00['textContent']=_0x1b4b8a(0x1ce),_0x4b42c7[_0x1b4b8a(0xe1)]=_0x1b4b8a(0xda),_0x2c5e8b['disabled']=!![];return;}const _0x1c5bb1=allGiftsData['find'](_0xd39abd=>_0xd39abd['id']===selectedIndGiftId);!_0x1c5bb1||_0x1c5bb1[_0x1b4b8a(0x216)]<=0x0?(_0x21be00[_0x1b4b8a(0xe1)]=_0x1c5bb1?_0x1c5bb1['name']+_0x1b4b8a(0x13e):'--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--',_0x4b42c7[_0x1b4b8a(0xe1)]=_0x1b4b8a(0x117),_0x2c5e8b[_0x1b4b8a(0x1fc)]=!![]):(_0x21be00['textContent']=_0x1c5bb1['name'],_0x4b42c7[_0x1b4b8a(0xe1)]=_0x1b4b8a(0xe6)+_0x1c5bb1[_0x1b4b8a(0x216)]+_0x1b4b8a(0x219),_0x2c5e8b[_0x1b4b8a(0x1fc)]=![]);}function refreshGroupGiftState(){const _0x305203=_0x43909,_0x5ede80=document[_0x305203(0x1d8)](_0x305203(0x217)),_0x1fee60=document[_0x305203(0x1d8)](_0x305203(0x17f)),_0x59e8be=document[_0x305203(0x1d8)](_0x305203(0x194)),_0x1aa43d=document[_0x305203(0x1d8)](_0x305203(0x112)),_0xb8e02b=document[_0x305203(0x1d8)](_0x305203(0x1cf));if(!selectedGroupGiftId){_0x5ede80[_0x305203(0xe1)]=_0x305203(0x1ce),_0x5ede80[_0x305203(0x150)]=_0x305203(0x221),_0x1fee60[_0x305203(0xe1)]='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô',_0x1fee60[_0x305203(0x150)]=_0x305203(0x1f9),_0x59e8be[_0x305203(0x150)]=_0x305203(0xe7),_0xb8e02b[_0x305203(0x20e)]=0x0,_0x1aa43d[_0x305203(0x1fc)]=!![];return;}const _0x2c54d1=allGiftsData[_0x305203(0x10f)](_0x42aad9=>_0x42aad9['id']===selectedGroupGiftId);!_0x2c54d1||_0x2c54d1[_0x305203(0x216)]<=0x0?(_0x5ede80[_0x305203(0xe1)]=_0x2c54d1?_0x2c54d1[_0x305203(0x153)]+_0x305203(0x13e):_0x305203(0xd1),_0x5ede80[_0x305203(0x150)]=_0x305203(0x21c),_0x1fee60[_0x305203(0xe1)]=_0x305203(0x117),_0x59e8be[_0x305203(0x150)]=_0x305203(0xe7),_0xb8e02b[_0x305203(0x20e)]=0x0,_0x1aa43d[_0x305203(0x1fc)]=!![]):(_0x5ede80['textContent']=_0x2c54d1[_0x305203(0x153)],_0x5ede80[_0x305203(0x150)]=_0x305203(0x1cb),_0x1fee60['textContent']=_0x305203(0xe6)+_0x2c54d1[_0x305203(0x216)]+_0x305203(0x219),_0x1fee60[_0x305203(0x150)]='text-sm\x20font-bold\x20text-gray-600\x20mt-1',_0x59e8be[_0x305203(0x150)]='flex\x20items-center\x20justify-between\x20bg-blue-50\x20border-2\x20border-blue-300\x20rounded-xl\x20p-3\x20transition-all',_0xb8e02b[_0x305203(0x20e)]=_0x2c54d1[_0x305203(0x216)],_0xb8e02b[_0x305203(0x181)]=_0x2c54d1[_0x305203(0x216)],_0x1aa43d[_0x305203(0x1fc)]=![]);}function _0x273f(){const _0x371b50=['</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-sm\x20font-black\x20text-gray-800\x20uppercase\x20text-left\x22>','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200','\x22,\x22','Branch_eng','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20','searchRegEmployeeIdInput','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27','‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö','indGiftDisplayQty','<option\x20value=\x22\x22>--\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°\x20--</option>','employeeId','B19','</option>','remove','\x27)\x22\x20class=\x22bg-red-50\x20text-white\x20px-3\x20py-1\x20rounded\x20cursor-pointer\x20text-sm\x20font-bold\x22>‡∏•‡∏ö</span></td></tr>','2699459uMoBSp','75%','crsg_gift','#10B981','\x20hover:bg-gray-50\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-gray-400\x20text-xs\x22>','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?','closeGroupViewModalButton','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','bg-gray-300','#BFDBFE','RESET','toggleGiftStatus','winnerGiftText','text-blue-600','doughnut','teamBoxesContainer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','A24','A13','‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','bg-gray-100\x20text-gray-500','#3B82F6','#E5E7EB','bg-gray-100','team-list-content','\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)','\x27)\x22\x20class=\x22','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á','asc','regEmpSeat','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-blue-600\x20font-bold\x22>','crsg','</td><td\x20class=\x22px-4\x20py-4\x20uppercase\x20font-bold\x20text-xm\x20text-left\x22>','\x20‡∏ó‡πà‡∏≤‡∏ô</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22overflow-x-auto\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22min-w-full\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-header-gray\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏≤‡∏Ç‡∏≤</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20class=\x22divide-y\x20divide-gray-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22removeLuckyWinner(\x27','click','<option\x20value=\x22','th-TH','Winners_Report.csv','bg-yellow-50','confirmInputContainer','#fff','editEmp','className','<option\x20value=\x22\x22>--\x20‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','div','name','pickGift','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','innerHTML','gift-management-content','419ZGTnfk','editEmpName','winnersByGiftContainer','confirmModal','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22','round','confirmTitle','split','random','modalDrawnCount','datasets','currentDateTime','grRemainingEligible','saveEditModalButton','join','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xs\x20uppercase\x20shadow-sm\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','DateLogin','editEmpId','text-gray-500','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22editEmp(\x27','invite','‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°\x20','regEmpManager','24385401qUkvKA','updateTeamNamesBtn','toLocaleString','‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','bg-blue-100\x20border-blue-500\x20shadow-md','A11','FullName_th','long','group','winnerTeam','groupViewModalTitle','empStatsTotal','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xm\x20uppercase\x20transition-all\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','confirmModalInner','closeEditModalButton','grGiftDisplayQty','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å','max','selectedTeamTableBody','regEmpBranch','Remaining','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-indigo-600\x20text-white\x20px-3\x20py-1\x20rounded-full\x20text-xs\x20font-bold\x20uppercase\x22>','text/csv;charset=utf-8;','A20','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-2\x20py-0.5\x20rounded\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','order','text-blue-800','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','loading-gif','‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','editEmpManager','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-blue-600\x20font-bold\x20uppercase\x20text-xm\x20text-left\x22>','bar2','indGiftDisplayName','commit','B16','grGiftBox','485705fwPfuH','keys','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-black\x20','editGiftModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-mono\x20font-black\x20text-blue-700\x20text-sm\x22>','length','breakdownCenterTotal','closeRandomizeModalButtonX','bar1','employee-list-content','totalQty','downloadWinnersCsvButton','1070273157855','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','attendeesCount','group-random-content','‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á\x20[','classList','editGiftName','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','options',']\x20?','<div\x20class=\x22p-10\x20text-center\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--</div>','sort-emp-id','\x27,\x20\x27','group-view-content','1:1070273157855:web:5c8120e1df27e233d8676a','definedTeamNamesInput','startRandomizeButton','registrationDonutChart','\x20rounded-lg\x20text-sm\x20font-black\x20uppercase\x22>','groupViewStatsRegistered','groupViewModal','giftPickerModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><button\x20onclick=\x22toggleGiftStatus(\x27','filter','goal','</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><span\x20onclick=\x22editGift(\x27','A21','RandomTime','OFF','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20text-xs\x20uppercase\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Registration_Report.csv','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','toUpperCase','105EuOeXJ','empStatsUnregistered','grTotalWinners','change','\x27,\x20this.value)\x22\x20class=\x22w-16\x20p-1\x20text-center\x20border\x20rounded\x20font-bold\x20text-blue-600\x22\x20min=\x221\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20font-normal\x22>','giftQtyInput','floor','searchEmployeeButton','empStatsPercent','text-base\x20font-black\x20text-blue-600\x20leading-tight\x20uppercase','searchRegEmployeeError','<tr><td\x20colspan=\x227\x22\x20class=\x22p-10\x20text-center\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</td></tr>','--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--','grDrawCount','AwardedGift','bg-green-100','slice','A17','<br/><span\x20class=\x22text-sm\x20text-orange-600\x22>üéÅ\x20','sort','managerEmployeeCount','Select','getElementById','toMillis','B11','groupViewManagerFilter','A10','includes','editGiftRemainingQty','map','ReceivedTime','desc','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-xm\x20text-left\x22>','bg-blue-600\x20text-white','AwardedGiftId','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20uppercase\x20font-bold\x20text-left\x22>','B22','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-700\x20text-xm\x20text-center\x22>','\x27)\x22\x20class=\x22text-red-600\x20hover:text-red-700\x20cursor-pointer\x20font-black\x20text-xs\x22>‡∏•‡∏ö</span></td></tr>','\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-bold\x20uppercase\x20cursor-pointer\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','addGiftBtn','registrationBreakdownChart','modalParticipantsCount','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-gray-600\x20text-left\x22>','B13','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22px-4\x20py-1\x20','\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á,‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\x0a','B21','off','9394536CiXCLr','\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡∏°,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','data','bg-orange-100','createElement','text-sm\x20font-bold\x20text-gray-300\x20mt-1','closeEditGiftModalBtn','empStatsRegistered','disabled','groupViewStatsTotal','openGroupDetail','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-xm\x20uppercase\x20text-gray-400\x20text-left\x22>','6052JIaAfq','cancelReg','editEmpTeam','resetTeamButton','bg-green-500\x20text-white','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20uppercase\x20text-left\x22>','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö\x20[','grBoxRight','B10','confirmText','‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß','replace','numeric','value','addEventListener','confirmActionButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-xm\x20text-blue-500\x20uppercase\x22>','closeWinnerModalButton','trim','randomizeModal','7696308WJwgYU','remainingQty','grGiftDisplayName','winnerDetailModal','\x20‡∏ä‡∏¥‡πâ‡∏ô','teamStatsContainer','teamSelect','text-base\x20font-black\x20text-red-400\x20leading-tight\x20uppercase','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x22>','44852JSJUcw','regManualError','Check_Place','text-base\x20font-black\x20text-gray-400\x20leading-tight\x20uppercase','A15','\x27)\x22\x20class=\x22flex\x20items-center\x20justify-between\x20p-4\x20border\x20rounded-xl\x20hover:bg-blue-50\x20cursor-pointer\x20transition-all\x20','href','createObjectURL','</td><td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-xm\x20text-left\x22>','A22','A16','winnerEmployeeId','2-digit','giftListTableBody','querySelector','status','B14','bg-white\x20border-gray-100','</td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20class=\x22px-3\x20py-0\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span></td><td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22cancelReg(\x27','groupViewTableBody','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20mr-2\x22>Edit</span>|\x20<span\x20onclick=\x22deleteGift(\x27','\x27)\x22\x20class=\x22px-3\x20py-0\x20bg-red-100\x20text-red-600\x20rounded-lg\x20text-xs\x20font-black\x20hover:bg-red-600\x20hover:text-white\x20transition-all\x20uppercase\x22>‡∏•‡∏ö</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20uppercase\x22>','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20text-xm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','giftNameInput','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20transition-colors\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-bold\x20text-gray-400\x20text-xs\x22>',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22removeLuckyWinner(\x27','\x20p-2\x20rounded-[8px]\x20border\x20text-center\x20shadow-sm\x20cursor-pointer\x20hover:shadow-md\x20transition-all\x20active:scale-95\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-[10px]\x20font-black\x20text-blue-700\x20uppercase\x22>','breakdown','teamStatsTotal','winnerName','<div\x20onclick=\x22pickGift(\x27','B17','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20text-left\x20text-gray-600\x22>','bar','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-lg\x20font-black\x20text-gray-900\x20mt-0.5\x22>','gvOverallStatsContainer','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center\x20transition-all\x20duration-300','update','bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center','teamMemberCountElem','docs','</td><td\x20class=\x22px-4\x20py-4\x20text-center\x22><span\x20onclick=\x22removeLuckyWinner(\x27','closeManualRegModalButton','download','dispatchEvent','\x27)\x22\x20class=\x22px-4\x20py-1\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x20border\x20','Invite','--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--','appendChild','editEmployeeModal','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20cursor-pointer\x20font-bold\x20text-lg\x20ml-3\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-white\x20border\x20border-gray-100\x20rounded-2xl\x20overflow-hidden\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-gray-50\x20px-6\x20py-4\x20border-b\x20flex\x20justify-between\x20items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-black\x20text-indigo-700\x20uppercase\x22>üéÅ\x20‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','A18','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20onclick=\x22openGroupDetail(\x27','markAsReceived','grTotalEligible','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô','deleteGift','#F59E0B','Non-Invite','editGiftTotalQty','#loader','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><input\x20type=\x22number\x22\x20value=\x22','textContent','empStatsContainer','<p\x20class=\x22text-center\x20py-10\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠\x20--</p>','participantsCountBox','openGroupGiftPickerBtn','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all','giftPickerTitle','regEmpName','add','teamStatsRegistered','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-xm\x20uppercase\x20font-normal\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','digit','ceil','hidden','error','ttb-register.firebasestorage.app','employeeListTableBody','dashboard-content','latestRegistrationsTableBody','\x27)\x22','‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','searchEmployeeError','regEmpInviteStatus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20bg-blue-50\x20p-2.5\x20rounded-xl\x20border\x20border-blue-100\x20winner-row-animate\x20shadow-sm\x20mb-1.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-blue-600\x20text-white\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center\x20rounded-full\x20text-[9px]\x20font-bold\x22>','\x20font-bold\x22>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','giftPickerList','localeCompare','</td><td\x20class=\x22px-4\x20py-0\x20uppercase\x20font-bold\x20text-xm\x20text-left\x22>','B15','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö','downloadCsvButton','</span>','Selected','regEmpId','register-content','Check_Manager','sort-emp-status','A19','grBoxLeft','labels','bold','bg-red-500\x20text-white\x20cursor-pointer\x20hover:bg-red-600','<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-400\x20font-bold\x22>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>','manualRegisterModal','forEach','find','saveManualRegButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20uppercase\x20text-left\x22>','grStartDrawBtn','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-sm\x20font-normal\x20text-gray-400\x22>','ind','resize'];_0x273f=function(){return _0x371b50;};return _0x273f();}async function startGroupRandomDraw(){const _0x4fe8c6=_0x43909,_0x14feff=parseInt(document['getElementById'](_0x4fe8c6(0x1cf))['value'])||0x0,_0x52a6a6=allEmployeesData[_0x4fe8c6(0x1b8)](_0x1f9193=>_0x1f9193[_0x4fe8c6(0x168)]&&_0x1f9193['invite']===_0x4fe8c6(0x16c)&&!_0x1f9193['RandomTime']);if(!selectedGroupGiftId)return;const _0x4921cd=allGiftsData[_0x4fe8c6(0x10f)](_0x2f5b60=>_0x2f5b60['id']===selectedGroupGiftId);if(_0x14feff<=0x0||_0x52a6a6[_0x4fe8c6(0x19a)]<_0x14feff||_0x4921cd[_0x4fe8c6(0x216)]<_0x14feff)return;const _0x3dbba4=document['getElementById'](_0x4fe8c6(0x112));_0x3dbba4[_0x4fe8c6(0x1fc)]=!![];const _0x16dc38=document['getElementById'](_0x4fe8c6(0x108)),_0x6ce6e2=document[_0x4fe8c6(0x1d8)](_0x4fe8c6(0x208));_0x16dc38[_0x4fe8c6(0x156)]='',_0x6ce6e2['innerHTML']='';const _0x2eac55=[..._0x52a6a6][_0x4fe8c6(0x1d5)](()=>0.5-Math[_0x4fe8c6(0x160)]())[_0x4fe8c6(0x1d2)](0x0,_0x14feff);await updateDoc(doc(db,_0x4fe8c6(0x127),selectedGroupGiftId),{'remainingQty':_0x4921cd[_0x4fe8c6(0x216)]-_0x14feff});const _0x52bc41=Math[_0x4fe8c6(0xee)](_0x14feff/0x2),_0x1207c7=_0x2eac55['slice'](0x0,_0x52bc41),_0x5d6c2b=_0x2eac55[_0x4fe8c6(0x1d2)](_0x52bc41),_0x4398f6=_0x1cf65e=>{const _0x5542cb=_0x4fe8c6,_0x219879=document[_0x5542cb(0x1f8)](_0x5542cb(0x152));_0x219879['id']='loader',_0x219879[_0x5542cb(0x150)]=_0x5542cb(0x18c),_0x1cf65e[_0x5542cb(0xd2)](_0x219879);},_0x10911b=_0xe959c8=>{const _0x4b23fd=_0x4fe8c6,_0x391128=_0xe959c8[_0x4b23fd(0xae)](_0x4b23fd(0xdf));if(_0x391128)_0x391128[_0x4b23fd(0x123)]();};for(let _0x394721=0x0;_0x394721<_0x1207c7['length'];_0x394721++){_0x4398f6(_0x16dc38),await new Promise(_0x5ac93f=>setTimeout(_0x5ac93f,0x3e8)),_0x10911b(_0x16dc38);const _0x17303e=_0x1207c7[_0x394721];_0x16dc38[_0x4fe8c6(0x156)]+=createWinnerItemHTML(_0x394721+0x1,_0x17303e),await updateWinnerInDB(_0x17303e,_0x4921cd[_0x4fe8c6(0x153)],selectedGroupGiftId);}for(let _0x265805=0x0;_0x265805<_0x5d6c2b[_0x4fe8c6(0x19a)];_0x265805++){_0x4398f6(_0x6ce6e2),await new Promise(_0x11231a=>setTimeout(_0x11231a,0x3e8)),_0x10911b(_0x6ce6e2);const _0x496259=_0x5d6c2b[_0x265805];_0x6ce6e2[_0x4fe8c6(0x156)]+=createWinnerItemHTML(_0x52bc41+_0x265805+0x1,_0x496259),await updateWinnerInDB(_0x496259,_0x4921cd['name'],selectedGroupGiftId);}_0x3dbba4[_0x4fe8c6(0x1fc)]=![],confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}});}function createWinnerItemHTML(_0xce53e0,_0x4b6af6){const _0x3e3f97=_0x43909;return _0x3e3f97(0xf9)+_0xce53e0+_0x3e3f97(0x116)+_0x4b6af6[_0x3e3f97(0x176)]+'\x20('+_0x4b6af6['employeeId']+_0x3e3f97(0xbb)+_0x4b6af6['id']+_0x3e3f97(0xd4);}async function updateWinnerInDB(_0x488a7f,_0x146ec2,_0x1369a1){const _0x352c70=_0x43909;await updateDoc(doc(db,_0x352c70(0x144),_0x488a7f['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x146ec2,'AwardedGiftId':_0x1369a1});}async function runIndividualLuckyDraw(){const _0x2f510f=_0x43909,_0x342f58=allEmployeesData[_0x2f510f(0x1b8)](_0x127453=>_0x127453[_0x2f510f(0x168)]&&_0x127453['invite']===_0x2f510f(0x16c)&&!_0x127453[_0x2f510f(0x1bc)]);if(!_0x342f58[_0x2f510f(0x19a)]||!selectedIndGiftId)return;const _0x5e7604=allGiftsData[_0x2f510f(0x10f)](_0x4250f8=>_0x4250f8['id']===selectedIndGiftId);if(_0x5e7604['remainingQty']<=0x0)return;const _0x5767a6=document[_0x2f510f(0x1d8)]('startRandomizeButton');_0x5767a6[_0x2f510f(0x1fc)]=!![];const _0x39b559=[0x1,0x2,0x3,0x4,0x5][_0x2f510f(0x1df)](_0x97f984=>document['getElementById'](_0x2f510f(0xed)+_0x97f984));let _0xf0ed8b=0x0;drawInterval=setInterval(()=>{const _0x58c26e=_0x2f510f;digits[_0x58c26e(0x10e)](_0x203b6f=>_0x203b6f[_0x58c26e(0xe1)]=Math['floor'](Math[_0x58c26e(0x160)]()*0xa));if(++_0xf0ed8b>0x28){clearInterval(drawInterval);const _0x10d391=_0x342f58[Math[_0x58c26e(0x1c8)](Math[_0x58c26e(0x160)]()*_0x342f58['length'])],_0x8d151f=String(_0x10d391[_0x58c26e(0x120)])[_0x58c26e(0x1d2)](-0x5)['padStart'](0x5,'0');_0x39b559['forEach']((_0x2119af,_0x132560)=>_0x2119af[_0x58c26e(0xe1)]=_0x8d151f[_0x132560]),setTimeout(async()=>{const _0x246e20=_0x58c26e;await updateDoc(doc(db,_0x246e20(0x127),selectedIndGiftId),{'remainingQty':_0x5e7604[_0x246e20(0x216)]-0x1}),await updateDoc(doc(db,_0x246e20(0x144),_0x10d391['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x5e7604[_0x246e20(0x153)],'AwardedGiftId':selectedIndGiftId}),document[_0x246e20(0x1d8)](_0x246e20(0xbf))[_0x246e20(0xe1)]=_0x10d391[_0x246e20(0x176)]+'\x20('+_0x10d391[_0x246e20(0x120)]+')',document['getElementById'](_0x246e20(0x131))[_0x246e20(0xe1)]=_0x246e20(0x1a2)+_0x5e7604[_0x246e20(0x153)],document[_0x246e20(0x1d8)](_0x246e20(0x229))['textContent']='‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:\x20'+_0x10d391['employeeId'],document[_0x246e20(0x1d8)]('winnerBU')[_0x246e20(0xe1)]='‡∏™‡∏≤‡∏Ç‡∏≤:\x20'+(_0x10d391[_0x246e20(0x119)]||'-'),document[_0x246e20(0x1d8)](_0x246e20(0x179))['textContent']='‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:\x20'+(_0x10d391[_0x246e20(0x105)]||'-'),document[_0x246e20(0x1d8)](_0x246e20(0x218))[_0x246e20(0x1a6)][_0x246e20(0x123)](_0x246e20(0xef)),confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}}),_0x5767a6['disabled']=![];},0x1f4);}},0x32);}window['removeLuckyWinner']=async _0x8a1ac4=>{const _0x1c6c90=_0x43909,_0x4150c9=allEmployeesData[_0x1c6c90(0x10f)](_0x24fd5f=>_0x24fd5f['id']===_0x8a1ac4);if(!_0x4150c9)return;if(_0x4150c9[_0x1c6c90(0x1e4)]){const _0x1f57c1=allGiftsData[_0x1c6c90(0x10f)](_0x24ea48=>_0x24ea48['id']===_0x4150c9[_0x1c6c90(0x1e4)]);if(_0x1f57c1)await updateDoc(doc(db,_0x1c6c90(0x127),_0x1f57c1['id']),{'remainingQty':_0x1f57c1['remainingQty']+0x1});}await updateDoc(doc(db,_0x1c6c90(0x144),_0x8a1ac4),{'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null}),document[_0x1c6c90(0x1d8)](_0x1c6c90(0x218))['classList']['add'](_0x1c6c90(0xef));};function updateLuckyDrawStats(){const _0x4f1906=_0x43909,_0x2271e1=allEmployeesData[_0x4f1906(0x1b8)](_0x55d8cc=>_0x55d8cc[_0x4f1906(0x168)]&&_0x55d8cc['invite']===_0x4f1906(0x16c)),_0x5cdf78=_0x2271e1[_0x4f1906(0x1b8)](_0x36d40a=>_0x36d40a[_0x4f1906(0x1bc)])[_0x4f1906(0x1d5)]((_0x1c8003,_0x2a1247)=>(_0x2a1247[_0x4f1906(0x1bc)]?.[_0x4f1906(0x1d9)]()||0x0)-(_0x1c8003[_0x4f1906(0x1bc)]?.['toMillis']()||0x0));document[_0x4f1906(0x1d8)](_0x4f1906(0x1ed))[_0x4f1906(0xe1)]=_0x2271e1['filter'](_0x123d53=>!_0x123d53[_0x4f1906(0x1bc)])[_0x4f1906(0x19a)],document[_0x4f1906(0x1d8)](_0x4f1906(0x161))[_0x4f1906(0xe1)]=_0x5cdf78['length'],document[_0x4f1906(0x1d8)]('drawnWinnersTableBody')[_0x4f1906(0x156)]=_0x5cdf78[_0x4f1906(0x1df)](_0x5403a7=>'<tr><td\x20class=\x22px-4\x20py-4\x20font-mono\x20font-black\x20text-blue-700\x20text-center\x22>'+_0x5403a7['employeeId']+_0x4f1906(0x145)+_0x5403a7[_0x4f1906(0x176)]+(_0x5403a7[_0x4f1906(0x1d0)]?_0x4f1906(0x1d4)+_0x5403a7[_0x4f1906(0x1d0)]+_0x4f1906(0x101):'')+'</td><td\x20class=\x22px-4\x20py-4\x20text-xm\x20font-bold\x20text-gray-500\x20uppercase\x20text-left\x22>'+(_0x5403a7[_0x4f1906(0x119)]||'-')+_0x4f1906(0xcb)+_0x5403a7['id']+_0x4f1906(0x124))['join']('');}function updateTeamTab(){const _0x1067ff=_0x43909,_0x2d730c=document[_0x1067ff(0x1d8)]('teamSelect'),_0x5a7013=_0x2d730c[_0x1067ff(0x20e)];_0x2d730c[_0x1067ff(0x156)]=_0x1067ff(0x11f)+teamNames[_0x1067ff(0x1df)](_0x5f59a4=>_0x1067ff(0x149)+_0x5f59a4+'\x22>'+_0x5f59a4+_0x1067ff(0x122))[_0x1067ff(0x166)](''),_0x2d730c['value']=teamNames[_0x1067ff(0x1dd)](_0x5a7013)?_0x5a7013:'';if(_0x2d730c[_0x1067ff(0x20e)]){const _0x3847dc=allEmployeesData[_0x1067ff(0x1b8)](_0x398a51=>_0x398a51[_0x1067ff(0x220)]===_0x2d730c[_0x1067ff(0x20e)]);document['getElementById'](_0x1067ff(0xbe))[_0x1067ff(0xe1)]=_0x3847dc[_0x1067ff(0x19a)],document[_0x1067ff(0x1d8)](_0x1067ff(0xeb))[_0x1067ff(0xe1)]=_0x3847dc[_0x1067ff(0x1b8)](_0x954fa4=>_0x954fa4[_0x1067ff(0x168)])[_0x1067ff(0x19a)],document[_0x1067ff(0x1d8)](_0x1067ff(0x21a))[_0x1067ff(0x1a6)][_0x1067ff(0x123)](_0x1067ff(0xef)),document[_0x1067ff(0x1d8)](_0x1067ff(0x182))['innerHTML']=_0x3847dc[_0x1067ff(0x1df)]((_0x10ad92,_0x1fa6a2)=>_0x1067ff(0x12c)+(_0x10ad92[_0x1067ff(0x168)]?_0x1067ff(0x14c):'')+_0x1067ff(0x21d)+(_0x1fa6a2+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-blue-800\x22>'+_0x10ad92[_0x1067ff(0x120)]+_0x1067ff(0x111)+_0x10ad92['FullName_th']+_0x1067ff(0x1ee)+(_0x10ad92[_0x1067ff(0x119)]||'-')+_0x1067ff(0x1ee)+(_0x10ad92['Check_Manager']||'-')+_0x1067ff(0x1be)+(_0x10ad92['DateLogin']?_0x1067ff(0x205):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27'+_0x10ad92['id']+_0x1067ff(0x167))[_0x1067ff(0x166)]('');}else document[_0x1067ff(0x1d8)](_0x1067ff(0x21a))[_0x1067ff(0x1a6)][_0x1067ff(0xea)]('hidden');}function updateGridTab(){const _0x1c31ee=_0x43909,_0x82bdea=document[_0x1c31ee(0x1d8)](_0x1c31ee(0x1db))['value'],_0x33d805=[...new Set(allEmployeesData[_0x1c31ee(0x1df)](_0x48ed22=>_0x48ed22[_0x1c31ee(0x105)])[_0x1c31ee(0x1b8)](Boolean))][_0x1c31ee(0x1d5)](),_0x457029=document[_0x1c31ee(0x1d8)](_0x1c31ee(0x1db));_0x457029[_0x1c31ee(0x1a9)][_0x1c31ee(0x19a)]!==_0x33d805[_0x1c31ee(0x19a)]+0x1&&(_0x457029[_0x1c31ee(0x156)]='<option\x20value=\x22\x22>--\x20‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>'+_0x33d805['map'](_0x3c8388=>'<option\x20value=\x22'+_0x3c8388+'\x22>'+_0x3c8388+_0x1c31ee(0x122))['join'](''));_0x457029[_0x1c31ee(0x20e)]=_0x82bdea;const _0x5f5c62=_0x82bdea?allEmployeesData[_0x1c31ee(0x1b8)](_0x36b25d=>_0x36b25d[_0x1c31ee(0x105)]===_0x82bdea):allEmployeesData,_0xb1f6d7=_0x5f5c62[_0x1c31ee(0x1b8)](_0x5ce9ac=>_0x5ce9ac['invite']===_0x1c31ee(0x16c));document[_0x1c31ee(0x1d8)]('gvOverallStatsTotal')['textContent']=_0xb1f6d7[_0x1c31ee(0x19a)],document['getElementById']('gvOverallStatsRegistered')['textContent']=_0xb1f6d7[_0x1c31ee(0x1b8)](_0x5de0a0=>_0x5de0a0[_0x1c31ee(0x168)])[_0x1c31ee(0x19a)],document['getElementById'](_0x1c31ee(0xc5))[_0x1c31ee(0x1a6)][_0x1c31ee(0x123)]('hidden');const _0x2ce33a={};teamNames[_0x1c31ee(0x10e)](_0x26541d=>_0x2ce33a[_0x26541d]={'r':0x0,'t':0x0}),_0x5f5c62['filter'](_0x100410=>_0x100410[_0x1c31ee(0x220)])[_0x1c31ee(0x10e)](_0x26cac1=>{const _0x502215=_0x1c31ee;if(_0x2ce33a[_0x26cac1[_0x502215(0x220)]]){_0x2ce33a[_0x26cac1[_0x502215(0x220)]]['t']++;if(_0x26cac1[_0x502215(0x168)])_0x2ce33a[_0x26cac1[_0x502215(0x220)]]['r']++;}}),document[_0x1c31ee(0x1d8)](_0x1c31ee(0x134))[_0x1c31ee(0x156)]=teamNames[_0x1c31ee(0x1df)](_0x3bbebb=>{const _0x27afe2=_0x1c31ee,_0x155d94=_0x2ce33a[_0x3bbebb];let _0x305f06=_0x27afe2(0x13c);if(_0x155d94['t']>0x0){if(_0x155d94['r']===_0x155d94['t'])_0x305f06=_0x27afe2(0x1d1);else{if(_0x155d94['r']>0x0)_0x305f06=_0x27afe2(0x1f7);}}return _0x27afe2(0xd7)+_0x3bbebb+_0x27afe2(0x13f)+_0x305f06+_0x27afe2(0xbc)+_0x3bbebb+_0x27afe2(0xc4)+_0x155d94['r']+'/'+_0x155d94['t']+_0x27afe2(0x1a8);})[_0x1c31ee(0x166)]('');}function updateEmployeeList(){const _0x565178=_0x43909,_0x60c5b3=document[_0x565178(0x1d8)]('managerFilterSelect')['value'],_0x2574e3=[...new Set(allEmployeesData['map'](_0x1aa645=>_0x1aa645[_0x565178(0x105)])[_0x565178(0x1b8)](Boolean))][_0x565178(0x1d5)](),_0x42a6e4=document[_0x565178(0x1d8)]('managerFilterSelect');_0x42a6e4[_0x565178(0x1a9)][_0x565178(0x19a)]!==_0x2574e3[_0x565178(0x19a)]+0x1&&(_0x42a6e4[_0x565178(0x156)]=_0x565178(0x151)+_0x2574e3['map'](_0x385ead=>_0x565178(0x149)+_0x385ead+'\x22>'+_0x385ead+'</option>')['join'](''));_0x42a6e4[_0x565178(0x20e)]=_0x60c5b3;let _0x56a345=_0x60c5b3?allEmployeesData[_0x565178(0x1b8)](_0x5be69b=>_0x5be69b[_0x565178(0x105)]===_0x60c5b3):allEmployeesData;_0x56a345['sort']((_0xe5c8f5,_0x399b55)=>{const _0x3d3cbb=_0x565178;let _0x13186b,_0x13ad2d;if(empSortField===_0x3d3cbb(0xaf))_0x13186b=_0xe5c8f5[_0x3d3cbb(0x168)]?0x1:0x0,_0x13ad2d=_0x399b55['DateLogin']?0x1:0x0;else{if(empSortField===_0x3d3cbb(0x153))return empSortDir===_0x3d3cbb(0x141)?_0xe5c8f5[_0x3d3cbb(0x176)]['localeCompare'](_0x399b55['FullName_th'],'th'):_0x399b55[_0x3d3cbb(0x176)][_0x3d3cbb(0xfc)](_0xe5c8f5[_0x3d3cbb(0x176)],'th');else _0x13186b=_0xe5c8f5['employeeId'],_0x13ad2d=_0x399b55['employeeId'];}if(_0x13186b<_0x13ad2d)return empSortDir==='asc'?-0x1:0x1;if(_0x13186b>_0x13ad2d)return empSortDir===_0x3d3cbb(0x141)?0x1:-0x1;return 0x0;}),document[_0x565178(0x1d8)](_0x565178(0xf2))[_0x565178(0x156)]=_0x56a345['map']((_0x15cc96,_0x41729b)=>_0x565178(0x18b)+(_0x15cc96[_0x565178(0x168)]?'bg-yellow-50':'')+_0x565178(0x113)+(_0x41729b+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-sm\x20text-blue-800\x22>'+_0x15cc96[_0x565178(0x120)]+_0x565178(0x206)+_0x15cc96[_0x565178(0x176)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-xm\x20text-left\x20text-gray-600\x22>'+(_0x15cc96[_0x565178(0x119)]||'-')+_0x565178(0xc2)+(_0x15cc96['Check_Manager']||'-')+_0x565178(0x211)+(_0x15cc96[_0x565178(0x220)]||'-')+_0x565178(0xb8)+(_0x15cc96[_0x565178(0x168)]?'<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>':'-')+_0x565178(0x11c)+_0x15cc96['id']+_0x565178(0x17c))[_0x565178(0x166)]('');}window[_0x43909(0x201)]=(_0x2251d6,_0x36044a)=>{const _0x558fd0=_0x43909,_0x291a28=document[_0x558fd0(0x1d8)]('confirmModalInner');_0x291a28[_0x558fd0(0x150)]=_0x558fd0(0xc8),currentConfirmAction=async()=>{const _0x27cac7=_0x558fd0;await updateDoc(doc(db,'crsg',_0x2251d6),{'DateLogin':null}),document[_0x27cac7(0x1d8)](_0x27cac7(0x15b))['classList']['add'](_0x27cac7(0xef));},document[_0x558fd0(0x1d8)](_0x558fd0(0x15e))[_0x558fd0(0xe1)]=_0x558fd0(0xf6),document[_0x558fd0(0x1d8)](_0x558fd0(0x20a))[_0x558fd0(0xe1)]=_0x558fd0(0x1a5)+_0x36044a+_0x558fd0(0x1aa),document[_0x558fd0(0x1d8)]('confirmInputContainer')[_0x558fd0(0x1a6)][_0x558fd0(0xea)](_0x558fd0(0xef)),document['getElementById'](_0x558fd0(0x15b))[_0x558fd0(0x1a6)][_0x558fd0(0x123)](_0x558fd0(0xef));},window[_0x43909(0x1fe)]=_0x5bab04=>{const _0x921607=_0x43909,_0x45e984=allEmployeesData[_0x921607(0x1b8)](_0x23952c=>_0x23952c[_0x921607(0x220)]===_0x5bab04);document[_0x921607(0x1d8)](_0x921607(0x17a))[_0x921607(0xe1)]=_0x921607(0x16d)+_0x5bab04,document[_0x921607(0x1d8)](_0x921607(0x1fd))[_0x921607(0xe1)]=_0x45e984[_0x921607(0x19a)],document['getElementById'](_0x921607(0x1b4))[_0x921607(0xe1)]=_0x45e984[_0x921607(0x1b8)](_0xde2c50=>_0xde2c50[_0x921607(0x168)])[_0x921607(0x19a)],document[_0x921607(0x1d8)](_0x921607(0xb3))[_0x921607(0x156)]=_0x45e984['map']((_0x3b56ba,_0x119c78)=>{const _0x19fc3f=_0x921607;return'<tr\x20class=\x22'+(_0x3b56ba['DateLogin']?_0x19fc3f(0x14c):'')+_0x19fc3f(0x129)+(_0x119c78+0x1)+_0x19fc3f(0x1e7)+_0x3b56ba[_0x19fc3f(0x120)]+_0x19fc3f(0x1e5)+_0x3b56ba['FullName_th']+_0x19fc3f(0x1ff)+(_0x3b56ba['Branch_eng']||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-xm\x20uppercase\x20text-gray-400\x20text-left\x22>'+(_0x3b56ba[_0x19fc3f(0x105)]||'-')+_0x19fc3f(0xec)+(_0x3b56ba[_0x19fc3f(0x168)]?_0x19fc3f(0x188):'-')+_0x19fc3f(0x16b)+_0x3b56ba['id']+_0x19fc3f(0x1e9);})[_0x921607(0x166)]('')||_0x921607(0x1cd),document[_0x921607(0x1d8)]('groupViewModal')[_0x921607(0x1a6)][_0x921607(0x123)](_0x921607(0xef));},window[_0x43909(0x14f)]=_0x1ff90c=>{const _0x566f5c=_0x43909,_0x4f5047=allEmployeesData['find'](_0x460479=>_0x460479['id']===_0x1ff90c);if(!_0x4f5047)return;currentEditingDocId=_0x1ff90c,document[_0x566f5c(0x1d8)](_0x566f5c(0x169))[_0x566f5c(0xe1)]=_0x4f5047[_0x566f5c(0x120)],document[_0x566f5c(0x1d8)](_0x566f5c(0x159))[_0x566f5c(0xe1)]=_0x4f5047['FullName_th'],document[_0x566f5c(0x1d8)]('editEmpManager')['value']=_0x4f5047['Check_Manager']||'',document[_0x566f5c(0x1d8)](_0x566f5c(0x202))['value']=_0x4f5047[_0x566f5c(0x220)]||'',document[_0x566f5c(0x1d8)]('editEmployeeModal')['classList']['remove'](_0x566f5c(0xef));};function searchForRegistration(){const _0x1d9eaa=_0x43909,_0x4ded65=document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x11b))[_0x1d9eaa(0x20e)][_0x1d9eaa(0x213)](),_0x3fc35a=document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x1cc));_0x3fc35a[_0x1d9eaa(0xe1)]='';if(!_0x4ded65){_0x3fc35a[_0x1d9eaa(0xe1)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';return;}const _0x2f5d0e=allEmployeesData[_0x1d9eaa(0x10f)](_0x202faf=>_0x202faf[_0x1d9eaa(0x120)]===_0x4ded65);_0x2f5d0e?(currentEditingDocId=_0x2f5d0e['id'],document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x103))[_0x1d9eaa(0xe1)]=_0x2f5d0e[_0x1d9eaa(0x120)],document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0xe9))[_0x1d9eaa(0xe1)]=_0x2f5d0e[_0x1d9eaa(0x176)],document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x183))[_0x1d9eaa(0xe1)]=_0x2f5d0e[_0x1d9eaa(0x119)]||'-',document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x16e))['textContent']=_0x2f5d0e[_0x1d9eaa(0x105)]||'-',document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x142))[_0x1d9eaa(0x20e)]=_0x2f5d0e[_0x1d9eaa(0x220)]||'',document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0xf8))[_0x1d9eaa(0x20e)]=_0x2f5d0e[_0x1d9eaa(0x16c)]||'',document[_0x1d9eaa(0x1d8)]('manualRegisterModal')['classList'][_0x1d9eaa(0x123)]('hidden'),document[_0x1d9eaa(0x1d8)](_0x1d9eaa(0x21f))[_0x1d9eaa(0xe1)]=''):_0x3fc35a['textContent']=_0x1d9eaa(0xb7);}async function saveManualRegistration(){const _0x2e447c=_0x43909,_0x5907b0=document[_0x2e447c(0x1d8)](_0x2e447c(0x142))[_0x2e447c(0x20e)]['trim'](),_0x27f809=document[_0x2e447c(0x1d8)](_0x2e447c(0xf8))[_0x2e447c(0x20e)],_0x2a4c42=document['getElementById'](_0x2e447c(0x21f));try{await updateDoc(doc(db,'crsg',currentEditingDocId),{'Check_Place':_0x5907b0,'invite':_0x27f809,'DateLogin':serverTimestamp()}),document[_0x2e447c(0x1d8)](_0x2e447c(0x10d))[_0x2e447c(0x1a6)][_0x2e447c(0xea)](_0x2e447c(0xef)),document[_0x2e447c(0x1d8)](_0x2e447c(0x11b))[_0x2e447c(0x20e)]='';}catch(_0x2a47e0){console[_0x2e447c(0xf0)](_0x2a47e0),_0x2a4c42['textContent']=_0x2e447c(0x180);}}function handleEmpSort(_0x24ae00){const _0x3e227b=_0x43909;empSortField===_0x24ae00?empSortDir=empSortDir==='asc'?_0x3e227b(0x1e1):_0x3e227b(0x141):(empSortField=_0x24ae00,empSortDir=_0x3e227b(0x141)),updateEmployeeList();}function setupListeners(){const _0xd4a46a=_0x43909;document[_0xd4a46a(0x1d8)]('randomizeButton')['addEventListener'](_0xd4a46a(0x148),()=>{const _0x5b090a=_0xd4a46a;updateLuckyDrawStats(),document['getElementById']('randomizeModal')[_0x5b090a(0x1a6)][_0x5b090a(0x123)]('hidden');}),document['getElementById'](_0xd4a46a(0x19c))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>document[_0xd4a46a(0x1d8)](_0xd4a46a(0x214))[_0xd4a46a(0x1a6)][_0xd4a46a(0xea)](_0xd4a46a(0xef))),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1b1))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),runIndividualLuckyDraw),document[_0xd4a46a(0x1d8)]('grStartDrawBtn')['addEventListener']('click',startGroupRandomDraw),document['getElementById'](_0xd4a46a(0x12b))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1b5))['classList'][_0xd4a46a(0xea)](_0xd4a46a(0xef))),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x212))[_0xd4a46a(0x20f)]('click',()=>document[_0xd4a46a(0x1d8)](_0xd4a46a(0x218))[_0xd4a46a(0x1a6)][_0xd4a46a(0xea)]('hidden')),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x17e))[_0xd4a46a(0x20f)]('click',()=>document['getElementById']('editEmployeeModal')[_0xd4a46a(0x1a6)][_0xd4a46a(0xea)](_0xd4a46a(0xef))),document[_0xd4a46a(0x1d8)]('closeConfirmButton')['addEventListener'](_0xd4a46a(0x148),()=>document[_0xd4a46a(0x1d8)]('confirmModal')['classList'][_0xd4a46a(0xea)](_0xd4a46a(0xef))),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1ac))[_0xd4a46a(0x20f)]('click',()=>handleEmpSort('id')),document[_0xd4a46a(0x1d8)]('sort-emp-name')[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>handleEmpSort(_0xd4a46a(0x153))),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x106))[_0xd4a46a(0x20f)]('click',()=>handleEmpSort(_0xd4a46a(0xaf))),document['getElementById']('searchRegEmployeeButton')[_0xd4a46a(0x20f)](_0xd4a46a(0x148),searchForRegistration),document[_0xd4a46a(0x1d8)](_0xd4a46a(0xcc))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>document[_0xd4a46a(0x1d8)]('manualRegisterModal')[_0xd4a46a(0x1a6)][_0xd4a46a(0xea)]('hidden')),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x110))[_0xd4a46a(0x20f)]('click',saveManualRegistration),document['getElementById'](_0xd4a46a(0x210))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),async()=>{if(currentConfirmAction)await currentConfirmAction();}),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1eb))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),addGift),document['getElementById']('openGiftPickerBtn')[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>{const _0xa10636=_0xd4a46a;giftPickerContext=_0xa10636(0x114),renderGiftPicker(),document[_0xa10636(0x1d8)]('giftPickerModal')[_0xa10636(0x1a6)][_0xa10636(0x123)](_0xa10636(0xef));}),document['getElementById'](_0xd4a46a(0xe5))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>{const _0x1a06b3=_0xd4a46a;giftPickerContext=_0x1a06b3(0x178),renderGiftPicker(),document[_0x1a06b3(0x1d8)](_0x1a06b3(0x1b6))['classList'][_0x1a06b3(0x123)](_0x1a06b3(0xef));}),document['getElementById']('closeGiftPickerBtn')[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1b6))[_0xd4a46a(0x1a6)]['add'](_0xd4a46a(0xef))),document['getElementById'](_0xd4a46a(0x1fa))[_0xd4a46a(0x20f)]('click',()=>document[_0xd4a46a(0x1d8)](_0xd4a46a(0x198))[_0xd4a46a(0x1a6)]['add'](_0xd4a46a(0xef))),document[_0xd4a46a(0x1d8)]('saveEditGiftBtn')['addEventListener'](_0xd4a46a(0x148),async()=>{const _0x616de3=_0xd4a46a,_0x4cbc32=document[_0x616de3(0x1d8)](_0x616de3(0x1a7))[_0x616de3(0x20e)][_0x616de3(0x213)](),_0x3991a6=parseInt(document['getElementById'](_0x616de3(0xde))[_0x616de3(0x20e)]),_0x14f9fa=parseInt(document[_0x616de3(0x1d8)](_0x616de3(0x1de))[_0x616de3(0x20e)]);if(!_0x4cbc32||isNaN(_0x3991a6)||isNaN(_0x14f9fa))return;await updateDoc(doc(db,_0x616de3(0x127),currentEditingGiftId),{'name':_0x4cbc32,'totalQty':_0x3991a6,'remainingQty':_0x14f9fa}),document[_0x616de3(0x1d8)](_0x616de3(0x198))[_0x616de3(0x1a6)][_0x616de3(0xea)](_0x616de3(0xef));}),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x165))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),async()=>{const _0x45787e=_0xd4a46a;await updateDoc(doc(db,_0x45787e(0x144),currentEditingDocId),{'Check_Manager':document[_0x45787e(0x1d8)](_0x45787e(0x18e))[_0x45787e(0x20e)],'Check_Place':document[_0x45787e(0x1d8)]('editEmpTeam')['value']}),document[_0x45787e(0x1d8)](_0x45787e(0xd3))[_0x45787e(0x1a6)][_0x45787e(0xea)](_0x45787e(0xef));}),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1c9))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>{const _0xf404b0=_0xd4a46a,_0x1c490a=document[_0xf404b0(0x1d8)]('searchEmployeeIdInput')['value']['trim'](),_0x246230=allEmployeesData[_0xf404b0(0x10f)](_0x2ea611=>_0x2ea611[_0xf404b0(0x120)]===_0x1c490a);if(_0x246230)editEmp(_0x246230['id']);else document['getElementById'](_0xf404b0(0xf7))['textContent']=_0xf404b0(0x1ea);}),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x21b))[_0xd4a46a(0x20f)](_0xd4a46a(0x1c5),updateTeamTab),document[_0xd4a46a(0x1d8)]('groupViewManagerFilter')[_0xd4a46a(0x20f)](_0xd4a46a(0x1c5),updateGridTab),document[_0xd4a46a(0x1d8)]('managerFilterSelect')[_0xd4a46a(0x20f)]('change',updateEmployeeList),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x170))[_0xd4a46a(0x20f)]('click',()=>{const _0x56cc01=_0xd4a46a,_0x1e9b45=document['getElementById'](_0x56cc01(0x1b0))[_0x56cc01(0x20e)][_0x56cc01(0x213)]();if(!_0x1e9b45)return;teamNames=_0x1e9b45[_0x56cc01(0x15f)](',')['map'](_0x23bbe7=>_0x23bbe7[_0x56cc01(0x213)]())[_0x56cc01(0x1b8)](Boolean),refreshUI();}),document['getElementById'](_0xd4a46a(0x100))[_0xd4a46a(0x20f)](_0xd4a46a(0x148),()=>{const _0x1103df=_0xd4a46a;let _0x4c4c46=_0x1103df(0x1f5);allEmployeesData[_0x1103df(0x1b8)](_0x180b5d=>_0x180b5d[_0x1103df(0x168)])[_0x1103df(0x10e)](_0x45093b=>{const _0x137561=_0x1103df;_0x4c4c46+='\x22'+_0x45093b[_0x137561(0x120)]+_0x137561(0x118)+_0x45093b[_0x137561(0x176)]+_0x137561(0x118)+(_0x45093b[_0x137561(0x119)]||'')+_0x137561(0x118)+(_0x45093b[_0x137561(0x105)]||'')+_0x137561(0x118)+(_0x45093b[_0x137561(0x220)]||'')+'\x22,\x22‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô\x22\x0a';});const _0x4d88f5=new Blob([_0x4c4c46],{'type':_0x1103df(0x186)}),_0x7cf6c6=document[_0x1103df(0x1f8)]('a');_0x7cf6c6[_0x1103df(0x224)]=URL[_0x1103df(0x225)](_0x4d88f5),_0x7cf6c6['download']=_0x1103df(0x1bf),_0x7cf6c6[_0x1103df(0x148)]();}),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x1a0))['addEventListener'](_0xd4a46a(0x148),()=>{const _0x351c6d=_0xd4a46a,_0x153202=allEmployeesData[_0x351c6d(0x1b8)](_0x2664b7=>_0x2664b7[_0x351c6d(0x1bc)])['sort']((_0x1c0506,_0x1eb5b1)=>(_0x1eb5b1['RandomTime']?.[_0x351c6d(0x1d9)]()||0x0)-(_0x1c0506[_0x351c6d(0x1bc)]?.[_0x351c6d(0x1d9)]()||0x0));let _0x969475=_0x351c6d(0x1f1);_0x153202[_0x351c6d(0x10e)](_0x4c0c0c=>{const _0x40fa84=_0x351c6d,_0x8e344b=_0x4c0c0c['RandomTime']?.[_0x40fa84(0x1d9)]()?new Date(_0x4c0c0c[_0x40fa84(0x1bc)]['toMillis']())['toLocaleString']('th-TH'):'-',_0x2766aa=_0x4c0c0c['ReceivedTime']?_0x40fa84(0x20b):_0x40fa84(0xff);_0x969475+='\x22'+_0x4c0c0c[_0x40fa84(0x120)]+_0x40fa84(0x118)+_0x4c0c0c[_0x40fa84(0x176)]+_0x40fa84(0x118)+(_0x4c0c0c[_0x40fa84(0x1d0)]||'')+_0x40fa84(0x118)+(_0x4c0c0c[_0x40fa84(0x119)]||'')+_0x40fa84(0x118)+(_0x4c0c0c[_0x40fa84(0x105)]||'')+'\x22,\x22'+(_0x4c0c0c[_0x40fa84(0x220)]||'')+_0x40fa84(0x118)+_0x2766aa+_0x40fa84(0x118)+_0x8e344b+'\x22\x0a';});const _0x3a2fe0=new Blob([_0x969475],{'type':_0x351c6d(0x186)}),_0x307708=document[_0x351c6d(0x1f8)]('a');_0x307708[_0x351c6d(0x224)]=URL[_0x351c6d(0x225)](_0x3a2fe0),_0x307708[_0x351c6d(0xcd)]=_0x351c6d(0x14b),_0x307708['click']();}),document[_0xd4a46a(0x1d8)](_0xd4a46a(0x203))[_0xd4a46a(0x20f)]('click',()=>{const _0x3a8e21=_0xd4a46a,_0x34a3b3=document[_0x3a8e21(0x1d8)](_0x3a8e21(0x17d)),_0x3964ec=document[_0x3a8e21(0x1d8)](_0x3a8e21(0x14d)),_0x376e52=document[_0x3a8e21(0x1d8)]('confirmInput');_0x3964ec[_0x3a8e21(0x1a6)][_0x3a8e21(0x123)](_0x3a8e21(0xef)),_0x376e52[_0x3a8e21(0x20e)]='',currentConfirmAction=async()=>{const _0xd54955=_0x3a8e21;if(_0x376e52['value'][_0xd54955(0x213)]()[_0xd54955(0x1c1)]()!==_0xd54955(0x12f))return;const _0x1a5a00=writeBatch(db);allEmployeesData[_0xd54955(0x10e)](_0x464175=>{const _0x2dd341=_0xd54955;_0x1a5a00[_0x2dd341(0xc7)](doc(db,'crsg',_0x464175['id']),{'DateLogin':null,'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null});}),await _0x1a5a00[_0xd54955(0x192)](),document[_0xd54955(0x1d8)]('confirmModal')['classList'][_0xd54955(0xea)](_0xd54955(0xef));},document['getElementById'](_0x3a8e21(0x15e))['textContent']=_0x3a8e21(0x11d),document[_0x3a8e21(0x1d8)](_0x3a8e21(0x20a))[_0x3a8e21(0xe1)]=_0x3a8e21(0x12a),document[_0x3a8e21(0x1d8)](_0x3a8e21(0x15b))[_0x3a8e21(0x1a6)][_0x3a8e21(0x123)]('hidden');});}function updateGroupRandomUI(){const _0x46b3a4=_0x43909,_0x33c771=allEmployeesData[_0x46b3a4(0x1b8)](_0xd0f9a2=>_0xd0f9a2[_0x46b3a4(0x168)]&&_0xd0f9a2[_0x46b3a4(0x16c)]===_0x46b3a4(0x16c)),_0x543de2=_0x33c771['filter'](_0x32b23f=>_0x32b23f[_0x46b3a4(0x1bc)])[_0x46b3a4(0x1d5)]((_0x9d7573,_0x53926e)=>(_0x53926e[_0x46b3a4(0x1bc)]?.[_0x46b3a4(0x1d9)]()||0x0)-(_0x9d7573[_0x46b3a4(0x1bc)]?.[_0x46b3a4(0x1d9)]()||0x0)),_0x175911=_0x33c771[_0x46b3a4(0x1b8)](_0x28155e=>!_0x28155e[_0x46b3a4(0x1bc)]);if(document[_0x46b3a4(0x1d8)](_0x46b3a4(0xd9)))document[_0x46b3a4(0x1d8)](_0x46b3a4(0xd9))['textContent']=_0x33c771[_0x46b3a4(0x19a)];if(document[_0x46b3a4(0x1d8)]('grRemainingEligible'))document[_0x46b3a4(0x1d8)](_0x46b3a4(0x164))['textContent']=_0x175911['length'];if(document[_0x46b3a4(0x1d8)]('grTotalWinners'))document[_0x46b3a4(0x1d8)](_0x46b3a4(0x1c4))[_0x46b3a4(0xe1)]=_0x543de2[_0x46b3a4(0x19a)];}
    </script>
</body>

</html>
