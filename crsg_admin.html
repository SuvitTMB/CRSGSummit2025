<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRSG Summit 2025 Dashboard</title>
    <!-- โหลด Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff; /* (แก้ไข) เปลี่ยนเป็นสีขาว */
        }
        /* เพิ่ม: Style สำหรับ Progress Bar */
        .progress-bar-container {
            width: 100%;
            background-color: #e5e7eb;
            border-radius: 0.5rem;
            overflow: hidden;
            height: 1.5rem; /* เพิ่มความสูง */
        }
        .progress-bar {
            height: 100%;
            background-color: #3b82f6;
            width: 0%;
            transition: width 0.3s ease-in-out;
            text-align: center;
            color: white;
            line-height: 1.5rem; /* จัดกลางข้อความแนวตั้ง */
            font-size: 0.875rem; /* ขนาดตัวอักษร */
        }
         /* (เพิ่ม) Style สำหรับ Edit Modal Inputs */
        #editEmployeeModal input[type="text"] {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            margin-top: 0.25rem;
        }
         /* (เพิ่ม) Style สำหรับ Dropdown ฟ้าอ่อน */
        select.light-blue-bg {
             background-color: #ffffff; /* (แก้ไข) เปลี่ยนเป็นสีขาว */
             padding-left: 0.75rem; /* px-3 */
             padding-right: 0.75rem; /* px-3 */
             padding-top: 0.5rem; /* py-2 */
             padding-bottom: 0.5rem; /* py-2 */
        }
         /* (เพิ่ม) Style หัวตารางสีเทา */
        thead.table-header-gray {
             background-color: #e5e7eb; /* gray-200 */
        }
    </style>
    <!-- Chart.js CDN --><script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[90%] max-w-6xl p-0 bg-white rounded-lg"> <!-- (แก้ไข) w-[90%], p-0 -->
        <!-- Header (แก้ไข: จัดกลาง, ปรับ pt) --><div class="flex flex-col items-center mb-6 pt-6 px-8"> <!-- (แก้ไข) pt-6 (1.5rem) -->
            <div class="text-center">
                <!-- (แก้ไข) text-2xl และ style color -->
                <h1 class="text-2xl font-bold" style="color: #0056ff;">CRSG Summit 2025</h1>
               <!-- ลบ Subtitle ออกแล้ว --></div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-600 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation (แก้ไข: ปรับ space, เปลี่ยนชื่อ, เพิ่มแท็บ) --><div class="mb-6 border-b border-gray-200 px-8"> <!-- (แก้ไข) เพิ่ม px-8 -->
            <nav class="-mb-px flex space-x-1" aria-label="Tabs"> <!-- แก้ไข: space-x-1 --><button id="tab-dashboard" class="whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm text-gray-700 bg-gray-300 border-blue-600">
                    ข้อมูล Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ข้อมูลสมาชิกทีม <!-- (แก้ไข) เปลี่ยนชื่อ --></button>
                <!-- (เพิ่ม) แท็บใหม่ -->
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ข้อมูลจัดกลุ่ม
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ข้อมูลพนักงาน CRSG <!-- เพิ่ม: แท็บใหม่ -->
                </button>
                <!-- (เพิ่ม) แท็บใหม่สำหรับลงทะเบียน -->
                <button id="tab-register" class="whitespace-nowrap py-3 px-3 border-b-2 font-medium text-sm text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ลงทะเบียนเข้าร่วมงาน
                </button>
            </nav>
        </div>

        <!-- Dashboard Content --><div id="dashboard-content" class="px-8 pb-8"> <!-- (แก้ไข) เพิ่ม px-8 pb-8 -->
            <!-- ภาพรวมผู้ลงทะเบียน (แก้ไข: โครงสร้างใหม่ 50/50, ปรับกล่องซ้าย) --><h2 class="text-lg font-semibold text-gray-800 mb-4">ภาพรวมผู้ลงทะเบียน</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                
                <!-- กล่องที่ 1 (50%) --><div class="lg:w-1/2"> <!-- (แก้ไข) lg:w-1/2 -->
                     <!-- (แก้ไข) ปรับโครงสร้างกล่องซ้าย -->
                     <div class="space-y-6">
                         <!-- แถว 1: เป้าหมาย + ลงทะเบียนทั้งหมด -->
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center">
                                <p class="text-gray-600 text-sm mb-2">เป้าหมายผู้ร่วมกิจกรรม</p>
                                <p id="targetCountOverall" class="text-4xl font-bold text-blue-800">0</p> 
                                <p class="text-xs text-gray-400 mt-1">(มี Manager & Team)</p> <!-- (แก้ไข) คำอธิบาย -->
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center">
                                <p class="text-gray-600 text-sm mb-2">ผู้ลงทะเบียนทั้งหมด</p>
                                <p id="totalEmployeesCount" class="text-4xl font-bold text-gray-900">0</p>
                                <p class="text-xs text-gray-400 mt-1">(นับจากผู้มี DateLogin)</p>
                            </div>
                         </div>
                         <!-- แถว 2: เข้าร่วม + ร่วมงาน -->
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                             <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center">
                                <p class="text-gray-600 text-sm mb-2">ผู้เข้าร่วมกิจกรรม</p>
                                <p id="participantsCount" class="text-4xl font-bold text-blue-600">0</p>
                                <p class="text-xs text-gray-400 mt-1">(ผู้ลงทะเบียนที่มี Check_Place)</p>
                            </div>
                             <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center"> <!-- (ย้ายมา) ผู้ร่วมงาน -->
                                <p class="text-gray-600 text-sm mb-2">ผู้ร่วมงาน</p>
                                <p id="attendeesCountMoved" class="text-4xl font-bold text-green-600">0</p> <!-- (แก้ไข) เปลี่ยน ID -->
                                <p class="text-xs text-gray-400 mt-1">(ผู้ลงทะเบียนที่ไม่มี Check_Place)</p>
                            </div>
                         </div>
                     </div>
                </div>

                <!-- กล่องที่ 2 (50%) : กราฟวงกลมและสรุปยอด (แก้ไข: เพิ่มกล่อง Participants) --><div class="lg:w-1/2"> <!-- (แก้ไข) lg:w-1/2 -->
                    <div class="flex gap-6 h-full">
                         <!-- กล่องซ้าย (65%) : กราฟวงกลม -->
                         <div class="w-[65%] bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-sm mb-4">เป้าหมายผู้ลงทะเบียน</p>
                            <div class="relative w-48 h-48">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                </div>
                            </div>
                        </div>
                         <!-- กล่องขวา (35%) : สรุปยอด (แก้ไข: ปรับ spacing) -->
                         <div class="w-[35%] flex flex-col justify-between space-y-2"> <!-- (แก้ไข) space-y-2 -->
                            <!-- จำนวนเป้าหมาย --><div class="h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center"> <!-- แก้ไข h-1/4, p-3 -->
                                <p class="text-blue-700 text-xs">จำนวนเป้าหมาย</p> <!-- แก้ไข text-xs -->
                                <p id="targetCount" class="text-lg font-bold text-blue-800 mt-1">0</p> <!-- แก้ไข text-lg -->
                            </div>
                            <!-- (เพิ่ม) ผู้เข้าร่วมกิจกรรม --><div class="h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center"> <!-- แก้ไข h-1/4, p-3 -->
                                <p class="text-green-700 text-xs">ผู้เข้าร่วมกิจกรรม</p> <!-- แก้ไข text-xs -->
                                <p id="participantsCountBox" class="text-lg font-bold text-green-800 mt-1">0</p> <!-- (เพิ่ม) ID ใหม่, แก้ไข text-lg -->
                            </div>
                             <!-- ผู้ร่วมงาน (ย้ายมา) --><div class="h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-yellow-700 text-xs">ผู้ร่วมงาน</p>
                                <p id="attendeesCount" class="text-lg font-bold text-yellow-800 mt-1">0</p>
                            </div>
                            <!-- จำนวนคงเหลือ --><div class="h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center"> <!-- แก้ไข h-1/4, p-3 -->
                                <p class="text-red-700 text-xs">จำนวนคงเหลือ</p> <!-- แก้ไข text-xs -->
                                <p id="remainingCount" class="text-lg font-bold text-red-800 mt-1">0</p> <!-- แก้ไข text-lg -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- สรุปข้อมูลผู้ลงทะเบียน (แก้ไข: ย้ายปุ่ม, แบ่งกราฟเป็น ซ้าย/ขวา) --><div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-lg font-semibold text-gray-800">สรุปข้อมูลผู้ลงทะเบียน</h2>
                     <!-- (แก้ไข) ปรับสไตล์ปุ่ม -->
                     <button id="randomizeButton" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
                         สุ่มเลือกผู้ร่วมงาน
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <!-- แบ่งเป็น 2 คอลัมน์ -->
                    <!-- กล่องซ้าย: กราฟแท่ง 1 -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-sm mb-4">กราฟแสดงข้อมูลสถิติ (ส่วนที่ 1)</p>
                        <div class="h-[25rem]"> <!-- (แก้ไข) เพิ่มความสูง -->
                            <canvas id="teamBarChart1"></canvas> 
                        </div>
                    </div>
                    <!-- กล่องขวา: กราฟแท่ง 2 -->
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-sm mb-4">กราฟแสดงข้อมูลสถิติ (ส่วนที่ 2)</p>
                        <div class="h-[25rem]"> <!-- (แก้ไข) เพิ่มความสูง -->
                            <canvas id="teamBarChart2"></canvas> 
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- สรุปข้อมูลผู้ร่วมงานและรายชื่อล่าสุด (แก้ไข: เพิ่มคอลัมน์) --><h2 class="text-lg font-semibold text-gray-800 mb-4">สรุปข้อมูลผู้ร่วมงานและรายชื่อล่าสุด</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray"> <!-- (แก้ไข) เปลี่ยนจาก bg-gray-50 -->
                            <tr>
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">รหัสพนักงาน</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">กลุ่ม</th> <!-- (BU_th) -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สังกัด</th> <!-- (แก้ไข) Check_Manager -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ทีม</th> <!-- (เพิ่ม) Check_Place -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ลบรายการ</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td colspan="7" class="p-6 text-center text-gray-500">กำลังโหลดข้อมูล...</td> <!-- (แก้ไข) colspan="7" -->
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- (เพิ่ม) Register Content -->
        <div id="register-content" class="hidden pb-8 px-6">
             <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center">
                <h2 class="text-xl font-semibold text-gray-800 text-center mb-6">สแกน QR Code เพื่อลงทะเบียนเข้าร่วมงาน</h2>
                <img 
                    src="./images/QRcode-CRSG.png" 
                    alt="QR Code ลงทะเบียน" 
                    class="rounded-lg shadow-md border border-gray-200" 
                    style=" width:40%;"
                >
             </div>
        </div>

        <!-- (แก้ไข) ลบ </div> ที่ปิดผิดพลาด (เคยอยู่ที่นี่ บรรทัด 228) -->

        <!-- (ลบ) บล็อก HTML ที่เสีย (เคยอยู่ที่นี่ 287-424) -->

        <!-- (เพิ่ม) Team List Content (ที่ขาดหายไปทั้งหมด) -->
        <div id="team-list-content" class="hidden pb-8 px-0"> <!-- (แก้ไข) px-6 -> px-0 -->
            <div class="bg-white overflow-hidden"> <!-- (แก้ไข) ลบ shadow, border, rounded -->
                <!-- Top Stats/Actions Bar -->
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                    <!-- Stat 1: Manager Count -->
                    <div class="bg-blue-50 p-4 rounded-lg text-center">
                        <p class="text-sm text-blue-700">พนักงานที่มี Manager</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <!-- Stat 2: Team Member Count -->
                    <div class="bg-green-50 p-4 rounded-lg text-center">
                        <p class="text-sm text-green-700">พนักงานที่มี Team</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <!-- Stat 3: Defined Teams (Scrollable) -->
                    <div class="bg-gray-50 p-4 rounded-lg overflow-y-auto max-h-24"> 
                        <p class="text-sm text-gray-700 mb-1 font-medium">รายชื่อทีมที่กำหนด:</p>
                        <p id="definedTeamNames" class="text-xs text-gray-600 break-words"></p> 
                    </div>
                </div>

                <!-- Actions Bar (Reset/Create) -->
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-6 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition duration-150 ease-in-out">
                         Reset Team
                     </button>
                     <button id="createTeamButton" class="w-full md:w-auto px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out">
                         Random Team
                     </button>
                </div>
                
                <!-- Progress Bar -->
                <div id="teamCreationProgressContainer" class="hidden p-6 border-b">
                    <p class="text-sm text-gray-600 mb-2">กำลังสร้างทีม...</p>
                    <div class="progress-bar-container">
                        <div id="teamCreationProgressBar" class="progress-bar">0%</div>
                    </div>
                    <p id="teamCreationStatus" class="text-xs text-gray-500 mt-1"></p>
                </div>
                
                <!-- Team Member Table Section -->
                 <div class="p-6">
                     <div class="flex justify-between items-center mb-4">
                         <h3 class="text-lg font-semibold">ข้อมูลสมาชิกในแต่ละทีม</h3>
                         <div>
                             <label for="teamSelect" class="text-sm font-medium mr-2">เลือกทีม:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm light-blue-bg">
                                 <option value="">-- กรุณาเลือก --</option>
                                 <!-- Options will be populated by JS -->
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-lg">
                        <table class="min-w-full text-sm">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ลำดับ</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">รหัสพนักงาน</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สายงาน</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สังกัด</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th>
                                    <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">แก้ไข</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-200">
                                <tr>
                                    <td colspan="7" class="p-6 text-center text-gray-500">กรุณาเลือกทีม</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- (เพิ่ม) Group View Content --><div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                
                <!-- (ย้ายมา) Add Member Section -->
                <div class="p-6 border-b bg-gray-50">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">เพิ่มสมาชิกลงทีม</h3>
                    <!-- (แก้ไข) space-x-2 -->
                    <div class="flex items-end space-x-2">
                        <div class="flex-grow">
                            <label for="searchEmployeeIdInput" class="block text-sm font-medium text-gray-700">รหัสพนักงาน</label>
                            <!-- (แก้ไข) เพิ่ม bg-blue-50 และ style padding -->
                            <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm bg-blue-50" placeholder="ใส่รหัสพนักงาน 5-6 หลัก" style="padding: 5px;">
                        </div>
                        <button id="searchEmployeeButton" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            ค้นหาข้อมูล
                        </button>
                    </div>
                    <p id="searchEmployeeError" class="text-red-600 text-sm mt-2"></p>
                </div>
                
                <!-- (แก้ไข) เพิ่ม Flexbox, Dropdown -->
                <div class="px-6 py-4 border-b flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-semibold">ข้อมูลจัดกลุ่ม (Team View)</h2>
                        <p class="text-sm text-gray-600">แสดงจำนวนสมาชิกในแต่ละทีม (คลิกเพื่อดูรายชื่อ)</p>
                    </div>
                    <div>
                         <label for="groupViewManagerFilter" class="text-sm font-medium mr-2">กรองตามสังกัด:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm light-blue-bg">
                             <option value="">-- ดูทั้งหมด --</option>
                             <!-- Options will be populated by JS -->
                         </select>
                    </div>
                </div>
                
                <!-- (เพิ่ม) Grid for Team Boxes -->
                <div id="teamBoxesContainer" class="p-6 grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <!-- Team boxes will be populated by JS -->
                    <p class="text-gray-500">กำลังโหลดข้อมูล...</p>
                </div>
             </div>
        </div>
        
        <!-- Employee List Content (แก้ไข: ลบกรอบ, ปรับ padding, เพิ่ม filter, แก้ไข table, ปรับ Style) --><div id="employee-list-content" class="hidden pb-8 px-0"> <!-- (แก้ไข) px-0 -->
             <div class="bg-white overflow-hidden"> <!-- (แก้ไข) ลบ shadow, border, rounded -->
                <div class="px-6 py-4 border-b flex justify-between items-center"> <!-- (แก้ไข) เพิ่ม px-6, flex -->
                    <div>
                        <h2 class="text-xl font-semibold">ข้อมูลพนักงาน CRSG ทั้งหมด</h2>
                        <p class="text-sm text-gray-600">แสดงรายชื่อพนักงานทั้งหมดในระบบ</p>
                    </div>
                     <!-- (เพิ่ม) Filter Dropdown -->
                     <div>
                         <label for="managerFilterSelect" class="text-sm font-medium mr-2">กรองตามสังกัด:</label> <!-- (แก้ไข) Label -->
                         <select id="managerFilterSelect" class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm light-blue-bg">
                             <option value="">-- ทั้งหมด --</option>
                             <!-- Manager Options will be populated by JS -->
                         </select>
                     </div>
                </div>
                
                <div class="overflow-x-auto p-6"> <!-- (แก้ไข) เพิ่ม p-6 -->
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray"> <!-- (แก้ไข) เพิ่ม class -->
                            <tr>
                                <!-- (เพิ่ม) คอลัมน์ลำดับที่ -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ลำดับที่</th>
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">รหัส</th> <!-- (แก้ไข) -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th> <!-- (แก้ไข) -->
                                <!-- <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ตำแหน่ง</th> --> <!-- (ลบ) -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ทีม</th> <!-- (แก้ไข) -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th> <!-- (แก้ไข) -->
                                <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">แก้ไข</th> <!-- (เพิ่ม) -->
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-200"> <!-- (แก้ไข) ลบ bg-white -->
                            <tr>
                                <td colspan="6" class="p-6 text-center text-gray-500">กรุณาเลือกสังกัด</td> <!-- (แก้ไข) colspan="6", ข้อความ -->
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <!-- *** เพิ่ม: Lightbox/Modal สำหรับสุ่มเลือก *** --><div id="randomizeModal" class="hidden fixed inset-0 z-40 overflow-y-auto bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-3xl mx-4">
            <!-- แถวที่ 1: Title --><h3 class="text-xl font-semibold text-center text-gray-900 mb-4">ระบบสุ่มเลือกผู้ร่วมกิจกรรม</h3>
            
            <!-- แถวที่ 2: Stats --><div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <p class="text-sm text-blue-700">ผู้เข้าร่วมกิจกรรม (ที่สุ่มได้)</p>
                    <p id="modalParticipantsCount" class="text-3xl font-bold text-blue-900">0</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <p class="text-sm text-green-700">ผู้ได้รับการสุ่มแล้ว</p>
                    <p id="modalDrawnCount" class="text-3xl font-bold text-green-900">0</p>
                </div>
            </div>
            
            <!-- แถวที่ 3: 5 Digits --><div class="flex justify-center space-x-2 mb-6">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-5xl font-mono rounded-lg flex items-center justify-center">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-5xl font-mono rounded-lg flex items-center justify-center">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-5xl font-mono rounded-lg flex items-center justify-center">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-5xl font-mono rounded-lg flex items-center justify-center">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-5xl font-mono rounded-lg flex items-center justify-center">0</div>
            </div>
            
            <!-- แถวที่ 4: Button --><div class="mb-6">
                <button id="startRandomizeButton" class="w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out disabled:bg-gray-400">
                    สุ่มเลือกผู้ร่วมกิจกรรม
                </button>
                <p id="randomizeError" class="text-red-600 text-sm text-center mt-2"></p>
            </div>
            
            <!-- แถวที่ 5: Table --><h4 class="text-lg font-semibold text-gray-800 mb-2">ข้อมูลผู้ที่ได้รับการสุ่มเลือก</h4>
            <div class="h-48 overflow-y-auto border rounded-lg">
                <table class="min-w-full text-sm">
                    <thead class="bg-gray-50 sticky top-0">
                        <tr>
                            <th class="px-4 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">รหัสพนักงาน</th>
                            <th class="px-4 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                            <th class="px-4 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สายงาน (BU)</th>
                            <th class="px-4 py-2 text-center font-medium text-gray-600 uppercase tracking-wider">ยกเลิก</th>
                        </tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- Data will be populated by JS --></tbody>
                </table>
            </div>
            
            <!-- แถวที่ 6: Close Button --><div class="mt-6 text-right">
                <button id="closeRandomizeModalButton" class="px-4 py-2 text-sm bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">
                    ปิดหน้านี้
                </button>
            </div>
        </div>
    </div>
    
    <!-- *** เพิ่ม: Lightbox/Modal 2 สำหรับแสดงผู้ชนะ *** --><div id="winnerDetailModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 m-4 max-w-lg w-full text-center">
            <h3 class="text-2xl font-bold text-blue-600 mb-4">ยินดีด้วย!</h3>
            <p class="text-lg text-gray-700">ผู้โชคดีคือ:</p>
            <p id="winnerName" class="text-3xl font-extrabold text-gray-900 my-2"></p>
            <p id="winnerEmployeeId" class="text-base text-gray-500 mb-1"></p>
            <p id="winnerTeam" class="text-base text-gray-500 mb-1"></p>
            <p id="winnerBU" class="text-base text-gray-500 mb-6"></p>
            
            <div class="flex justify-center space-x-4">
                <button id="cancelWinnerButton" class="px-4 py-2 text-xs bg-red-100 text-red-700 rounded-md hover:bg-red-200">
                    ยกเลิกการสุ่ม
                </button>
                <button id="closeWinnerModalButton" class="px-4 py-2 text-xs bg-blue-600 text-white rounded-md hover:bg-blue-700">
                    ปิดหน้าต่าง
                </button>
            </div>
        </div>
    </div>
    
    <!-- *** เพิ่ม: Lightbox/Modal 3 สำหรับยืนยันการยกเลิก/Reset *** --><div id="confirmModal" class="hidden fixed inset-0 z-[60] overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center"> <!-- (แก้ไข) z-50 -> z-[60] (สูงสุด) -->
        <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-sm w-full">
            <h3 id="confirmTitle" class="text-lg font-semibold text-gray-900 mb-4">ยืนยัน</h3> <!-- (แก้ไข) เพิ่ม ID -->
            <p id="confirmText" class="text-sm text-gray-700 mb-6"></p> <!-- (แก้ไข) เปลี่ยน ID -->
            <div class="flex justify-end space-x-3">
                <button id="closeConfirmButton" class="px-3 py-1.5 text-xs bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">
                    ไม่
                </button> <!-- (แก้ไข) เปลี่ยน ID -->
                <button id="confirmActionButton" class="px-3 py-1.5 text-xs bg-red-600 text-white rounded-md hover:bg-red-700">
                    <!-- Text will be set by JS -->
                </button> <!-- (แก้ไข) เปลี่ยน ID -->
            </div>
        </div>
    </div>

    <!-- *** (เพิ่ม) Lightbox/Modal 4 สำหรับแก้ไขข้อมูลพนักงาน *** -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-lg w-full">
            <h3 class="text-xl font-semibold text-gray-900 mb-4">แก้ไขข้อมูลพนักงาน</h3>
            <div class="space-y-4">
                <div>
                    <span class="text-sm font-medium text-gray-700">รหัสพนักงาน:</span>
                    <span id="editEmpId" class="text-sm text-gray-900 ml-2"></span>
                </div>
                 <div>
                    <span class="text-sm font-medium text-gray-700">ชื่อ-นามสกุล:</span>
                    <span id="editEmpName" class="text-sm text-gray-900 ml-2"></span>
                </div>
                 <div>
                    <label for="editEmpManager" class="block text-sm font-medium text-gray-700">Manager (Check_Manager)</label>
                    <input type="text" id="editEmpManager">
                </div>
                 <div>
                    <label for="editEmpTeam" class="block text-sm font-medium text-gray-700">ทีม (Check_Place)</label>
                    <input type="text" id="editEmpTeam">
                </div>
                <!-- สามารถเพิ่ม Fields อื่นๆ ที่ต้องการแสดง (แต่แก้ไขไม่ได้) ตรงนี้ -->
                 <p id="editError" class="text-red-600 text-sm"></p>
            </div>
            <div class="mt-6 flex justify-end space-x-3">
                 <button id="closeEditModalButton" class="px-4 py-2 text-sm bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">
                    ยกเลิกการแก้ไข
                 </button>
                 <button id="saveEditModalButton" class="px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                    บันทึกรายการ
                 </button>
            </div>
        </div>
    </div>

    <!-- *** (เพิ่ม) Lightbox/Modal 5 สำหรับแก้ไขสมาชิกทีม (จากแท็บ Team List / Group View) (ส่วนนี้ขาดหายไป) *** -->
    <div id="editTeamMemberModal" class="hidden fixed inset-0 z-[51] overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4"> <!-- (แก้ไข) z-50 -> z-[51] -->
        <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-lg w-full">
            <h3 class="text-xl font-semibold text-gray-900 mb-4">แก้ไขข้อมูลสมาชิกทีม</h3>
            <div class="space-y-4">
                <div>
                    <p class="text-sm text-gray-600">รหัสพนักงาน: <span id="editMemberEmpId" class="font-medium text-gray-900"></span></p>
                    <p class="text-sm text-gray-600">ชื่อ: <span id="editMemberEmpName" class="font-medium text-gray-900"></span></p>
                </div>
                <div>
                    <label for="editMemberTeamSelect" class="block text-sm font-medium text-gray-700">ทีม (Check_Place):</label>
                    <select id="editMemberTeamSelect" class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm mt-1 light-blue-bg">
                        <!-- Options populated by JS -->
                    </select>
                </div>
                <p id="editMemberError" class="text-red-600 text-sm"></p>
            </div>
            <div class="mt-6 flex justify-between">
                <div>
                     <button id="deleteEditMemberModalButton" class="px-3 py-1.5 text-xs bg-red-100 text-red-700 rounded-md hover:bg-red-200 disabled:bg-gray-400">
                        ยกเลิกการเป็นสมาชิกทีม <!-- (แก้ไข) เปลี่ยนชื่อปุ่ม -->
                    </button>
                </div>
                <div class="flex space-x-3">
                    <button id="closeEditMemberModalButton" class="px-3 py-1.5 text-xs bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:bg-gray-400">
                        ยกเลิก
                    </button>
                    <button id="saveEditMemberModalButton" class="px-3 py-1.5 text-xs bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400">
                        บันทึกรายการ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- *** (เพิ่ม) Lightbox/Modal 6 สำหรับแสดงสมาชิกในทีม (Group View) *** -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-6xl w-full"> <!-- (แก้ไข) max-w-6xl (กว้างขึ้น) -->
            <div class="flex justify-between items-center mb-4">
                 <h3 id="groupViewModalTitle" class="text-xl font-semibold text-gray-900">สมาชิกในทีม</h3>
                 <!-- (เพิ่ม) ปุ่มปิด -->
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-2xl font-bold">&times;</button>
            </div>
            
            <!-- (เพิ่ม) Table container -->
            <div class="max-h-[60vh] overflow-y-auto border rounded-lg">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0"> <!-- (เพิ่ม) sticky top-0 -->
                        <tr>
                            <!-- (เพิ่ม) ต้องเหมือนกับตารางใน "ข้อมูลสมาชิกทีม" -->
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ลำดับ</th>
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">รหัสพนักงาน</th>
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สายงาน</th>
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สังกัด</th>
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th>
                            <th class="px-4 py-3 text-left font-medium text-gray-600 uppercase tracking-wider">แก้ไข</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-200">
                        <tr><td colspan="7" class="p-6 text-center text-gray-500">กำลังโหลด...</td></tr>
                    </tbody>
                </table>
            </div>
            
        </div>
    </div>

    <!-- (เพิ่ม) Lightbox/Modal 7 สำหรับเพิ่ม/แก้ไขสมาชิก (Group View) -->
    <div id="addMemberModal" class="hidden fixed inset-0 z-[51] overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4"> <!-- z-index 51 -->
        <div class="bg-white rounded-lg shadow-xl p-6 m-4 max-w-lg w-full">
            <h3 class="text-xl font-semibold text-gray-900 mb-4">เพิ่ม/แก้ไข สมาชิกในทีม</h3>
            <div class="space-y-4">
                <!-- ข้อมูลพนักงาน (Read-only) -->
                <div class="bg-gray-50 p-4 rounded-lg border">
                    <p class="text-sm text-gray-600">รหัสพนักงาน: <span id="addMemberEmpId" class="font-medium text-gray-900"></span></p>
                    <p class="text-sm text-gray-600">ชื่อ: <span id="addMemberEmpName" class="font-medium text-gray-900"></span></p>
                    <p class="text-sm text-gray-600">สายงาน: <span id="addMemberEmpBU" class="font-medium text-gray-900"></span></p>
                </div>
                
                <!-- Dropdown สังกัด -->
                <div>
                    <label for="addMemberManagerSelect" class="block text-sm font-medium text-gray-700">สังกัด (Check_Manager):</label>
                    <select id="addMemberManagerSelect" class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm mt-1 bg-white">
                        <!-- Options populated by JS -->
                    </select>
                </div>
                
                <!-- Dropdown ทีม -->
                <div>
                    <label for="addMemberTeamSelect" class="block text-sm font-medium text-gray-700">ทีม (Check_Place):</label>
                    <select id="addMemberTeamSelect" class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm mt-1 bg-white">
                        <!-- Options populated by JS -->
                    </select>
                </div>
                
                <p id="addMemberError" class="text-red-600 text-sm"></p>
            </div>
            <div class="mt-6 flex justify-end space-x-3">
                <button id="closeAddMemberModalButton" class="px-4 py-2 text-sm bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">
                    ยกเลิกรายการ
                </button>
                <button id="saveAddMemberModalButton" class="px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700">
                    บันทึกข้อมูล
                </button>
            </div>
        </div>
    </div>


    <!-- Firebase SDK และการเชื่อมต่อ --><script type="module">
        // นำเข้า Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, collection, query, where, onSnapshot, 
            orderBy, limit, setLogLevel, doc, updateDoc, serverTimestamp, writeBatch, Timestamp // (เพิ่ม) Timestamp
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"; // (เพิ่ม) writeBatch

        // --- *** 1. ใส่ Firebase Config ของคุณที่นี่ (ใช้ตัวเดียวกับ chat.html) *** ---
const _0xd2e353=_0x39dd;(function(_0x3ec6d5,_0x259cae){const _0x1814e2=_0x39dd,_0x45f055=_0x3ec6d5();while(!![]){try{const _0x1084c2=-parseInt(_0x1814e2(0x219))/0x1*(parseInt(_0x1814e2(0x194))/0x2)+-parseInt(_0x1814e2(0x11f))/0x3+-parseInt(_0x1814e2(0x259))/0x4+-parseInt(_0x1814e2(0x157))/0x5+-parseInt(_0x1814e2(0x147))/0x6*(parseInt(_0x1814e2(0x1b1))/0x7)+parseInt(_0x1814e2(0x19f))/0x8+-parseInt(_0x1814e2(0x1b6))/0x9*(-parseInt(_0x1814e2(0x227))/0xa);if(_0x1084c2===_0x259cae)break;else _0x45f055['push'](_0x45f055['shift']());}catch(_0x3f47ac){_0x45f055['push'](_0x45f055['shift']());}}}(_0x412c,0xd7982));const firebaseConfig={'apiKey':_0xd2e353(0x144),'authDomain':'ttb-register.firebaseapp.com','databaseURL':'https://ttb-register-default-rtdb.asia-southeast1.firebasedate.app','projectId':_0xd2e353(0x21b),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0xd2e353(0x1b7),'appId':_0xd2e353(0x1b2),'measurementId':_0xd2e353(0x25c)};let db,auth,donutChart,barChart1,barChart2;const currentDateTimeElement=document[_0xd2e353(0x206)](_0xd2e353(0x14d)),totalEmployeesCount=document[_0xd2e353(0x206)](_0xd2e353(0x1a8)),participantsCount=document[_0xd2e353(0x206)]('participantsCount'),attendeesCountMoved=document[_0xd2e353(0x206)](_0xd2e353(0x220)),attendeesCount=document[_0xd2e353(0x206)](_0xd2e353(0x14e)),latestRegistrationsTableBody=document[_0xd2e353(0x206)]('latestRegistrationsTableBody'),donutPercentage=document[_0xd2e353(0x206)](_0xd2e353(0x124)),targetCountElem=document[_0xd2e353(0x206)]('targetCount'),remainingCountElem=document['getElementById']('remainingCount'),targetCountOverall=document[_0xd2e353(0x206)]('targetCountOverall'),participantsCountBoxElem=document[_0xd2e353(0x206)](_0xd2e353(0x135)),tabDashboard=document[_0xd2e353(0x206)](_0xd2e353(0x25b)),tabTeamList=document['getElementById'](_0xd2e353(0x238)),tabGroupView=document[_0xd2e353(0x206)](_0xd2e353(0x1ec)),tabEmployeeList=document[_0xd2e353(0x206)](_0xd2e353(0x22f)),tabRegister=document[_0xd2e353(0x206)](_0xd2e353(0x23c)),dashboardContent=document['getElementById'](_0xd2e353(0x250)),teamListContent=document[_0xd2e353(0x206)](_0xd2e353(0x1e7)),groupViewContent=document[_0xd2e353(0x206)](_0xd2e353(0x1c0)),employeeListContent=document[_0xd2e353(0x206)]('employee-list-content'),registerContent=document['getElementById']('register-content');let calculatedTarget=0x0;const latestRegistrationsLimit=0x5,teamNames=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','AA','BB','CC','DD','EE','FF','GG','HH','II','JJ','KK','LL','MM','NN','OO','PP','QQ'],teamSize=0xa;let employeesWithManager=[],currentConfirmAction=null;const managerEmployeeCountElem=document['getElementById'](_0xd2e353(0x117)),definedTeamNamesElem=document[_0xd2e353(0x206)](_0xd2e353(0x120)),resetTeamButton=document[_0xd2e353(0x206)](_0xd2e353(0x1c7)),createTeamButton=document[_0xd2e353(0x206)](_0xd2e353(0x16c)),teamCreationProgressContainer=document[_0xd2e353(0x206)](_0xd2e353(0x1f7)),teamCreationProgressBar=document[_0xd2e353(0x206)](_0xd2e353(0x22d)),teamCreationStatus=document[_0xd2e353(0x206)](_0xd2e353(0x119)),teamSelect=document['getElementById']('teamSelect'),selectedTeamTableBody=document[_0xd2e353(0x206)](_0xd2e353(0x19a)),teamMemberCountElem=document[_0xd2e353(0x206)](_0xd2e353(0x1e5)),confirmModal=document[_0xd2e353(0x206)](_0xd2e353(0x127)),confirmTitle=document['getElementById']('confirmTitle'),confirmText=document[_0xd2e353(0x206)](_0xd2e353(0x143)),closeConfirmButton=document['getElementById'](_0xd2e353(0x140)),confirmActionButton=document[_0xd2e353(0x206)](_0xd2e353(0x19d)),editEmployeeModal=document[_0xd2e353(0x206)](_0xd2e353(0x175)),editEmpId=document['getElementById'](_0xd2e353(0x161)),editEmpName=document[_0xd2e353(0x206)](_0xd2e353(0x242)),editEmpManager=document[_0xd2e353(0x206)](_0xd2e353(0x130)),editEmpTeam=document[_0xd2e353(0x206)]('editEmpTeam'),editError=document[_0xd2e353(0x206)](_0xd2e353(0x234)),closeEditModalButton=document[_0xd2e353(0x206)](_0xd2e353(0x1a0)),saveEditModalButton=document['getElementById'](_0xd2e353(0x205));function _0x412c(){const _0x1d9f4e=['#6b7280','update','find','keys','docId','onclick','forEach','filter','dataset','<option\x20value=\x22\x22>--\x20กรุณาเลือก\x20--</option>','bold','addMemberError','error','2-digit','teamMemberCountElem','แก้ไข','team-list-content','addMemberModal','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-green-100\x20text-green-800\x22>ลงทะเบียน</span>','modalParticipantsCount','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','tab-group-view','สำเร็จ','Team\x20member\x20fields\x20blanked\x20successfully.','<p\x20class=\x22text-red-600\x20text-center\x20text-lg\x20mt-10\x22>เกิดข้อผิดพลาดในการเชื่อมต่อฐานข้อมูล:\x20','cancelWinnerButton','digit1','Updating\x20doc\x20','winnerName','สร้างทีมสำเร็จ!','NO_MANAGER','\x20เวลา\x20','teamCreationProgressContainer','Employee\x20data\x20updated\x20successfully.','click','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20text-center\x22>','px-3\x20py-1.5\x20text-xs\x20bg-red-600\x20text-white\x20rounded-md\x20hover:bg-red-700','teamBarChart2','numeric','Error\x20setting\x20up\x20listener:\x20','searchEmployeeIdInput','Teams\x20assignment\x20updated\x20successfully.','reduce','ทีม:\x20','doughnut','remove','saveEditModalButton','getElementById','</td>\x20<!--\x20(เพิ่ม)\x20ลำดับ\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','ลงทะเบียนแล้ว','คุณต้องการยกเลิกการลงทะเบียนของ\x20[','indexOf','Canceling\x20registration\x20for:','toDate','ceil','UNKNOWN','parse','body','addMemberEmpId','padStart','querySelector','</td>\x20<!--\x20(แก้ไข)\x20ใช้\x20FullName_th\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','stringify','border-transparent','groupViewTableBody','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20whitespace-nowrap\x22>','1QpPDov','Invalid\x20employee\x20data\x20for\x20cancel\x20registration.','ttb-register','crsg','disabled','ดำเนินการเสร็จแล้ว','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20text-center\x22></td>\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','attendeesCountMoved','teamBarChart1','randomizeModal','then','label','commit','เกิดข้อผิดพลาด:\x20','45200OHjkGZ','00000','ยกเลิก','BU_th','hover:text-gray-700','hidden','teamCreationProgressBar','Manager\x20counts:','tab-employee-list','เกิดข้อผิดพลาดในการรีเซ็ต:\x20','</td>\x20<!--\x20(เพิ่ม)\x20สังกัด\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','registered','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22p-3\x20text-center\x20bg-gray-100\x20rounded-t-lg\x22>\x20<!--\x20(แก้ไข)\x20พื้นหลังเทา\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xl\x20font-bold\x20text-blue-700\x20text-center\x22>ทีม\x20','editError','button','bg-white','classList','tab-team-list','</td>\x20-->\x20<!--\x20(ลบ)\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','กำลังจัดสรรกลุ่มใหญ่\x20(Rule\x202)...','กำลังดำเนินการ...','tab-register','</td>\x20<!--\x20(แก้ไข)\x20นี่คือ\x20\x22กลุ่ม\x22\x20(BU_th)\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','has','ยืนยัน','</td></tr>','slice','editEmpName','editMemberError','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-green-100\x20text-green-800\x22>ลงทะเบียนแล้ว</span>','digit2','className','Team\x20member\x20team\x20updated\x20successfully.','drawnWinnersTableBody','ยังไม่ลงทะเบียน','innerHTML','bar','th-TH','value','Distributing\x20N=','Employee\x20data\x20updated\x20via\x20Add\x20Member\x20modal.','dashboard-content','ยืนยันการยกเลิกการลงทะเบียน','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','Finished\x20Rule\x203\x20&\x204.\x20Final\x20team\x20assignments:','<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-500\x22>กรุณาเลือกสังกัด</td></tr>','total','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20whitespace-nowrap\x20text-center\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','closeGroupViewModalButton','เกิดข้อผิดพลาดในการบันทึก:\x20','519516IIhPyR','Error\x20listening\x20to\x20snapshot:\x20','tab-dashboard','G-9DJLWJ5LQ1','ไม่พบพนักงานที่เข้าเงื่อนไข\x20(มี\x20Manager\x20และยังไม่มีทีม)\x20สำหรับจัดทีม','datasets','change','ยืนยันการยกเลิกการสุ่ม','Adding\x20remaining\x20','managerEmployeeCount','editTeamMemberModal','teamCreationStatus','textContent','Error\x20resetting\x20teams:\x20','Final\x20teams\x20status:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20whitespace-nowrap\x22>','long','5032365scWGBt','definedTeamNames','สร้างทีมสำเร็จบางส่วน\x20(','--\x20ไม่ระบุทีม\x20--','คุณต้องการยกเลิกการสุ่มของ\x20[','donutPercentage','</td>\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20(เพิ่ม)\x20สถานะ\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','includes','confirmModal','center','#E5E7EB','saveEditMemberModalButton','Error\x20updating\x20team\x20assignments:\x20','</p>\x20<!--\x20(แก้ไข)\x20\x22text-xl\x22\x20(เล็กลง)\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20text-center\x20mt-1\x22>สมาชิก</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20saving\x20employee\x20changes:','border-blue-600','Normal\x20group\x20employees\x20(final):\x20','editEmpManager','createElement','<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-500\x22>ไม่พบข้อมูลพนักงานสำหรับสังกัด:\x20','Registration\x20canceled\x20successfully.','Editing:','participantsCountBox','appendChild','สายงาน:\x20','<tr><td\x20colspan=\x227\x22\x20class=\x22p-6\x20text-center\x20text-gray-500\x22>กรุณาเลือกทีม</td></tr>','text-gray-700','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-gray-100\x20text-gray-800\x22>ยังไม่ลงทะเบียน</span>','วันที่\x20','closeAddMemberModalButton','Position_th','pop','--\x20ไม่ระบุสังกัด\x20--','closeConfirmButton','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20text-center\x22></td>\x20<!--\x20(เพิ่ม)\x20Cell\x20ใหม่สำหรับปุ่ม\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text-gray-500','confirmText','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','</td>\x20<!--\x20(แก้ไข)\x20นี่คือ\x20\x22สังกัด\x22\x20(Check_Manager)\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','closeWinnerModalButton','777792bSDUnL','add','toLocaleString','กำลังบันทึกข้อมูลทีม...','#3B82F6','join','currentDateTime','attendeesCount','\x20for\x20','localeCompare','option[value=\x22NO_MANAGER\x22]','registrationDonutChart','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>','กำลังลบข้อมูล\x20....','เกิดข้อผิดพลาดในการอัปเดต:\x20','text-red-600\x20hover:text-red-800\x20text-xs\x20py-1\x20px-2\x20rounded','1939875myGjvy','Normal\x20group\x20employees\x20(initial):\x20','<tr><td\x20colspan=\x227\x22\x20class=\x22p-6\x20text-center\x20text-gray-500\x22>ไม่พบสมาชิกในทีม\x20','Check_Manager','width','sort','#2563EB','N/A','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20(เพิ่ม)\x20Cell\x20สำหรับปุ่มลบ\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20text-center\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','editMemberTeamSelect','editEmpId','ใช่,\x20ยืนยันยกเลิก','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20text-center\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','querySelectorAll','rounded-lg\x20shadow-sm\x20border\x20border-gray-200\x20cursor-pointer\x20hover:shadow-md\x20transition-shadow\x20overflow-hidden\x20bg-white','randomizeError','Error\x20deleting\x20(blanking)\x20team\x20member:',']\x20หรือไม่?\x20(ข้อมูล\x20ทีม\x20จะถูกล้างค่า)','Firebase\x20initialization\x20failed:','from','ยืนยัน\x20Reset\x20Team','createTeamButton','ไม่เหลือผู้เข้าร่วมกิจกรรมให้สุ่มแล้ว','</p>\x20<!--\x20(แก้ไข)\x20เพิ่ม\x20\x22ทีม\x22,\x20\x22text-xl\x22\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22p-4\x20text-center\x20bg-white\x20rounded-b-lg\x22>\x20<!--\x20(แก้ไข)\x20พื้นหลังขาว\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xl\x20font-bold\x20text-gray-900\x20text-center\x22>','addEventListener','managerFilterSelect','randomizeButton','DateLogin','members','ยืนยันการยกเลิกการเป็นสมาชิกทีม','editEmployeeModal','groupViewManagerFilter','log','addMemberTeamSelect','ไม่','ยกเลิกการลงทะเบียน','labels','teamBoxesContainer','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20members)','FullName_th','Update\x20successful','Could\x20not\x20assign\x20employee\x20(all\x20teams\x20full?):','employeeId','escape','RandomTime','message','Error\x20saving\x20team\x20member\x20changes:','set','function','\x20from\x20','\x20to\x20normal\x20group.','Teams\x20and\x20login\x20status\x20reset\x20successfully.','digit5','กำลังรีเซ็ตข้อมูลทีมและสถานะลงทะเบียน...','.\x20Remaining:\x20','\x20คน','Total\x20to\x20assign:\x20','length','Mismatch\x20in\x20assigned\x20count!','#ffffff','2500812KlPVQS','bg-gray-300','<p\x20class=\x22text-gray-500\x22>ไม่พบข้อมูลทีม</p>','winnerTeam','cells','กำลังจัดสรรกลุ่มปกติ\x20(Rule\x203)...','selectedTeamTableBody','saveAddMemberModalButton','Check_Place','confirmActionButton','Editing\x20team\x20member:','11696104nNQlpz','closeEditModalButton','map','Large\x20group\x20managers:\x20','style',']\x20หรือไม่?\x20(สถานะจะเปลี่ยนเป็น\x20\x27ยังไม่ลงทะเบียน\x27)','toLocaleTimeString','Debug','รหัส:\x20','totalEmployeesCount','ไม่พบรหัสพนักงานนี้ในระบบ','addMemberEmpBU','รีเซ็ตข้อมูลทีมและสถานะลงทะเบียนสำเร็จ!','winnerDetailModal','size','winnerEmployeeId','round','text-white\x20bg-orange-500\x20hover:bg-orange-600\x20text-xs\x20py-1\x20px-3\x20rounded\x20shadow','49CZiiuE','1:1070273157855:web:5c8120e1df27e233d8676a','option','Deleting\x20(blanking)\x20member:','div','7515uRGgaH','1070273157855','trim','managers','เกิดข้อผิดพลาด','getContext','text-white\x20bg-red-500\x20hover:bg-red-600\x20text-xs\x20py-1\x20px-3\x20rounded\x20shadow','groupViewModal','floor','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20font-medium\x22>','group-view-content','<tr><td\x20colspan=\x224\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>ยังไม่มีผู้ได้รับการสุ่ม</td></tr>','80%','contains','dataIndex','data','digit4','resetTeamButton','max','ปิดหน้าต่าง','random','toLocaleDateString','คุณต้องการยกเลิกการเป็นสมาชิกทีมของ\x20[','กำลังเตรียมข้อมูล...','สมาชิกในทีม\x20','Error\x20canceling\x20registration:','closeRandomizeModalButton','push','bg-gray-100','searchEmployeeError','จำนวนผู้เข้าร่วม','addMemberManagerSelect','hover:border-gray-300'];_0x412c=function(){return _0x1d9f4e;};return _0x412c();}let currentEditingDocId=null;const editTeamMemberModal=document[_0xd2e353(0x206)](_0xd2e353(0x118)),editMemberEmpId=document[_0xd2e353(0x206)]('editMemberEmpId'),editMemberEmpName=document[_0xd2e353(0x206)]('editMemberEmpName'),editMemberTeamSelect=document['getElementById'](_0xd2e353(0x160)),editMemberError=document[_0xd2e353(0x206)](_0xd2e353(0x243)),closeEditMemberModalButton=document[_0xd2e353(0x206)]('closeEditMemberModalButton'),saveEditMemberModalButton=document[_0xd2e353(0x206)](_0xd2e353(0x12a)),deleteEditMemberModalButton=document['getElementById']('deleteEditMemberModalButton'),groupViewModal=document[_0xd2e353(0x206)](_0xd2e353(0x1bd)),groupViewModalTitle=document[_0xd2e353(0x206)]('groupViewModalTitle'),closeGroupViewModalButton=document['getElementById'](_0xd2e353(0x257)),groupViewTableBody=document[_0xd2e353(0x206)](_0xd2e353(0x217)),teamBoxesContainer=document['getElementById'](_0xd2e353(0x17c)),groupViewManagerFilter=document[_0xd2e353(0x206)](_0xd2e353(0x176)),addMemberModal=document[_0xd2e353(0x206)](_0xd2e353(0x1e8)),searchEmployeeIdInput=document[_0xd2e353(0x206)](_0xd2e353(0x1ff)),searchEmployeeButton=document[_0xd2e353(0x206)]('searchEmployeeButton'),searchEmployeeError=document[_0xd2e353(0x206)](_0xd2e353(0x1d3)),addMemberEmpId=document['getElementById'](_0xd2e353(0x211)),addMemberEmpName=document[_0xd2e353(0x206)]('addMemberEmpName'),addMemberEmpBU=document['getElementById'](_0xd2e353(0x1aa)),addMemberManagerSelect=document[_0xd2e353(0x206)](_0xd2e353(0x1d5)),addMemberTeamSelect=document[_0xd2e353(0x206)](_0xd2e353(0x178)),addMemberError=document[_0xd2e353(0x206)](_0xd2e353(0x1e2)),closeAddMemberModalButton=document['getElementById'](_0xd2e353(0x13c)),saveAddMemberModalButton=document[_0xd2e353(0x206)](_0xd2e353(0x19b));let currentAddingDocId=null,allEmployeesData=[],currentParticipants=[],availableToDraw=[],alreadyDrawn=[],randomizationInterval=null,docIdToCancel=null;const randomizeButton=document[_0xd2e353(0x206)](_0xd2e353(0x171)),randomizeModal=document[_0xd2e353(0x206)](_0xd2e353(0x222)),closeRandomizeModalButton=document['getElementById'](_0xd2e353(0x1d0)),modalParticipantsCount=document[_0xd2e353(0x206)](_0xd2e353(0x1ea)),modalDrawnCount=document[_0xd2e353(0x206)]('modalDrawnCount'),digits=[document[_0xd2e353(0x206)](_0xd2e353(0x1f1)),document[_0xd2e353(0x206)](_0xd2e353(0x245)),document[_0xd2e353(0x206)]('digit3'),document['getElementById'](_0xd2e353(0x1c6)),document[_0xd2e353(0x206)](_0xd2e353(0x18c))],startRandomizeButton=document[_0xd2e353(0x206)]('startRandomizeButton'),randomizeError=document[_0xd2e353(0x206)](_0xd2e353(0x166)),drawnWinnersTableBody=document[_0xd2e353(0x206)](_0xd2e353(0x248)),winnerDetailModal=document[_0xd2e353(0x206)](_0xd2e353(0x1ac)),winnerName=document[_0xd2e353(0x206)](_0xd2e353(0x1f3)),winnerEmployeeId=document[_0xd2e353(0x206)](_0xd2e353(0x1ae)),winnerTeam=document['getElementById'](_0xd2e353(0x197)),winnerBU=document[_0xd2e353(0x206)]('winnerBU'),cancelWinnerButton=document[_0xd2e353(0x206)](_0xd2e353(0x1f0)),closeWinnerModalButton=document[_0xd2e353(0x206)](_0xd2e353(0x146)),managerFilterSelect=document[_0xd2e353(0x206)](_0xd2e353(0x170));try{const app=initializeApp(firebaseConfig);db=getFirestore(app),auth=getAuth(app),setLogLevel(_0xd2e353(0x1a6)),await signInAnonymously(auth),console[_0xd2e353(0x177)]('Admin\x20Signed\x20in\x20anonymously'),initializeCharts(),populateTeamUI(),listenToAllCrsgData(),setupModalListeners(),setupTeamTabListeners(),setupEmployeeListListeners(),setupEditTeamMemberModalListeners(),setupGroupViewListeners(),setupAddMemberModalListeners(),updateCurrentDateTime(),setInterval(updateCurrentDateTime,0x3e8);}catch(_0x22c8fe){console[_0xd2e353(0x1e3)](_0xd2e353(0x169),_0x22c8fe),document[_0xd2e353(0x210)]['innerHTML']=_0xd2e353(0x1ef)+_0x22c8fe[_0xd2e353(0x185)]+'</p>';}function formatThaiTimestamp(_0x8184f){const _0x78b9e5=_0xd2e353;if(!_0x8184f||typeof _0x8184f[_0x78b9e5(0x149)]!==_0x78b9e5(0x188))return _0x78b9e5(0x15e);return _0x8184f['toLocaleString'](_0x78b9e5(0x24c),{'year':_0x78b9e5(0x1fd),'month':'short','day':_0x78b9e5(0x1fd),'hour':'2-digit','minute':'2-digit','second':'2-digit'});}function updateCurrentDateTime(){const _0x45cbb8=_0xd2e353,_0x4f45c1=new Date();currentDateTimeElement['textContent']=_0x45cbb8(0x13b)+_0x4f45c1[_0x45cbb8(0x1cb)](_0x45cbb8(0x24c),{'day':_0x45cbb8(0x1fd),'month':_0x45cbb8(0x11e),'year':_0x45cbb8(0x1fd)})+_0x45cbb8(0x1f6)+_0x4f45c1[_0x45cbb8(0x1a5)](_0x45cbb8(0x24c),{'hour':'2-digit','minute':_0x45cbb8(0x1e4),'second':_0x45cbb8(0x1e4)});}function initializeCharts(){const _0x3e6f00=_0xd2e353,_0x2d2b6a=document['getElementById'](_0x3e6f00(0x152))[_0x3e6f00(0x1bb)]('2d');donutChart=new Chart(_0x2d2b6a,{'type':_0x3e6f00(0x203),'data':{'labels':[_0x3e6f00(0x208),_0x3e6f00(0x249)],'datasets':[{'data':[0x0,calculatedTarget],'backgroundColor':['#3B82F6',_0x3e6f00(0x129)],'hoverOffset':0x4}]},'options':{'responsive':!![],'maintainAspectRatio':![],'cutout':_0x3e6f00(0x1c2),'plugins':{'legend':{'display':![]},'tooltip':{'callbacks':{'label':_0x2b78c2=>_0x2b78c2[_0x3e6f00(0x224)]+':\x20'+_0x2b78c2['parsed']+_0x3e6f00(0x18f)}}}},'plugins':[ChartDataLabels]});const _0xf83c7f={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'beginAtZero':!![],'stacked':!![],'title':{'display':!![],'text':_0x3e6f00(0x1d4)},'ticks':{'stepSize':0x1}},'y':{'stacked':!![],'title':{'display':![]}}},'plugins':{'legend':{'display':!![],'position':'bottom'},'datalabels':{'anchor':_0x3e6f00(0x128),'align':_0x3e6f00(0x128),'color':_0x39efe2=>{const _0x68e009=_0x3e6f00,_0x11376c=_0x39efe2[_0x68e009(0x1df)][_0x68e009(0x1c5)][_0x39efe2[_0x68e009(0x1c4)]];return _0x11376c>0x0?_0x68e009(0x193):_0x68e009(0x1d7);},'font':{'weight':_0x3e6f00(0x1e1)},'formatter':_0x4fd451=>_0x4fd451>0x0?_0x4fd451:''}}},_0x5b9db4=document['getElementById'](_0x3e6f00(0x221))['getContext']('2d');barChart1=new Chart(_0x5b9db4,{'type':_0x3e6f00(0x24b),'data':{'labels':[],'datasets':[{'label':_0x3e6f00(0x208),'data':[],'backgroundColor':_0x3e6f00(0x14b),'borderColor':_0x3e6f00(0x15d),'borderWidth':0x1},{'label':_0x3e6f00(0x249),'data':[],'backgroundColor':'#BFDBFE','borderColor':'#93C5FD','borderWidth':0x1}]},'options':{..._0xf83c7f},'plugins':[ChartDataLabels]});const _0xaaba65=document[_0x3e6f00(0x206)](_0x3e6f00(0x1fc))[_0x3e6f00(0x1bb)]('2d');barChart2=new Chart(_0xaaba65,{'type':_0x3e6f00(0x24b),'data':{'labels':[],'datasets':[{'label':'ลงทะเบียนแล้ว','data':[],'backgroundColor':'#3B82F6','borderColor':_0x3e6f00(0x15d),'borderWidth':0x1},{'label':'ยังไม่ลงทะเบียน','data':[],'backgroundColor':'#BFDBFE','borderColor':'#93C5FD','borderWidth':0x1}]},'options':{..._0xf83c7f},'plugins':[ChartDataLabels]});}function populateTeamUI(){const _0x58af39=_0xd2e353;definedTeamNamesElem[_0x58af39(0x11a)]=teamNames[_0x58af39(0x14c)](',\x20'),teamSelect['innerHTML']=_0x58af39(0x1e0),teamNames[_0x58af39(0x1dd)](_0x18028d=>{const _0x10b947=_0x58af39,_0x3b2d10=document[_0x10b947(0x131)](_0x10b947(0x1b3));_0x3b2d10['value']=_0x18028d,_0x3b2d10[_0x10b947(0x11a)]=_0x18028d,teamSelect[_0x10b947(0x136)](_0x3b2d10);});}function listenToAllCrsgData(){const _0x30f2b5=_0xd2e353;try{const _0x1c7595='crsg',_0xa66770=collection(db,_0x1c7595);onSnapshot(_0xa66770,_0x1ff35b=>{const _0xf31543=_0x39dd,_0x483bc6=[],_0x449af5=[],_0x338bcf={};let _0x20c9b3=0x0,_0x3e1b7a=0x0,_0x154c78=0x0;const _0x213852=new Set();_0x1ff35b[_0xf31543(0x1dd)](_0x53ab55=>{const _0x186f68=_0xf31543,_0x31cc69=_0x53ab55['data'](),_0xfe3a96=_0x53ab55['id'];_0x483bc6[_0x186f68(0x1d1)]({'id':_0x53ab55['id'],..._0x31cc69});const _0x23928d=_0x31cc69[_0x186f68(0x15a)]&&_0x31cc69[_0x186f68(0x15a)][_0x186f68(0x1b8)]()!=='',_0x39f109=_0x31cc69[_0x186f68(0x19c)]&&_0x31cc69[_0x186f68(0x19c)]['trim']()!=='';_0x23928d&&(_0x20c9b3++,_0x213852['add'](_0x31cc69[_0x186f68(0x15a)][_0x186f68(0x1b8)]()));_0x39f109&&_0x3e1b7a++;_0x23928d&&_0x39f109&&_0x154c78++;const _0x18b1b3=_0x31cc69[_0x186f68(0x19c)];_0x39f109&&_0x18b1b3&&(!_0x338bcf[_0x18b1b3]&&(_0x338bcf[_0x18b1b3]={'total':0x0,'registered':0x0}),_0x31cc69[_0x186f68(0x172)]&&_0x338bcf[_0x18b1b3]['registered']++),_0x31cc69[_0x186f68(0x172)]&&_0x449af5[_0x186f68(0x1d1)]({'id':_0x53ab55['id'],..._0x31cc69});}),_0x483bc6[_0xf31543(0x1dd)](_0xa4be6b=>{const _0x4f41ce=_0xf31543,_0x47c29b=_0xa4be6b[_0x4f41ce(0x19c)];_0x47c29b&&_0x47c29b['trim']()!==''&&_0x338bcf[_0x47c29b]&&_0x338bcf[_0x47c29b][_0x4f41ce(0x255)]++;}),allEmployeesData=_0x483bc6,employeesWithManager=_0x483bc6[_0xf31543(0x1de)](_0x24d71d=>_0x24d71d[_0xf31543(0x15a)]&&_0x24d71d[_0xf31543(0x15a)][_0xf31543(0x1b8)]()!==''),managerEmployeeCountElem[_0xf31543(0x11a)]=employeesWithManager[_0xf31543(0x191)],teamMemberCountElem['textContent']=_0x3e1b7a,populateManagerFilter(_0x213852);const _0x236400=_0x449af5[_0xf31543(0x191)];totalEmployeesCount['textContent']=_0x236400;const _0x588d55=_0x449af5['filter'](_0x509ab2=>_0x509ab2[_0xf31543(0x172)]&&_0x509ab2[_0xf31543(0x19c)]&&_0x509ab2[_0xf31543(0x19c)][_0xf31543(0x1b8)]()!=='');participantsCount[_0xf31543(0x11a)]=_0x588d55[_0xf31543(0x191)];const _0x21f2a6=_0x449af5[_0xf31543(0x1de)](_0x352141=>_0x352141[_0xf31543(0x172)]&&(!_0x352141[_0xf31543(0x19c)]||_0x352141[_0xf31543(0x19c)][_0xf31543(0x1b8)]()===''));attendeesCountMoved['textContent']=_0x21f2a6['length'],attendeesCount['textContent']=_0x21f2a6[_0xf31543(0x191)];!randomizeModal[_0xf31543(0x237)][_0xf31543(0x1c3)](_0xf31543(0x22c))&&(updateRandomizerDataBasedOnAllEmployees(),updateModalUI());const _0x309a72=_0x449af5[_0xf31543(0x191)];calculatedTarget=_0x154c78;const _0x846159=calculatedTarget-_0x309a72,_0x4cfb9a=calculatedTarget>0x0?(_0x309a72/calculatedTarget*0x64)['toFixed'](0x0):0x0;donutChart[_0xf31543(0x1c5)][_0xf31543(0x25e)][0x0]['data']=[_0x309a72,Math[_0xf31543(0x1c8)](0x0,_0x846159)],donutChart['update'](),donutPercentage[_0xf31543(0x11a)]=_0x4cfb9a+'%',targetCountOverall[_0xf31543(0x11a)]=calculatedTarget,targetCountElem[_0xf31543(0x11a)]=calculatedTarget;const _0x257ed4=_0x588d55[_0xf31543(0x191)];participantsCountBoxElem[_0xf31543(0x11a)]=_0x257ed4,remainingCountElem[_0xf31543(0x11a)]=Math[_0xf31543(0x1c8)](0x0,calculatedTarget-_0x257ed4);const _0x15ae80={};teamNames[_0xf31543(0x1dd)](_0x39842a=>{_0x338bcf[_0x39842a]&&(_0x15ae80[_0x39842a]=_0x338bcf[_0x39842a]);});const _0x3d4486=Object[_0xf31543(0x1da)](_0x15ae80),_0x1db93d=_0x3d4486[_0xf31543(0x1a1)](_0x26f87b=>_0x15ae80[_0x26f87b][_0xf31543(0x232)]),_0x1c5515=_0x3d4486[_0xf31543(0x1a1)](_0x440121=>Math[_0xf31543(0x1c8)](0x0,_0x15ae80[_0x440121][_0xf31543(0x255)]-_0x15ae80[_0x440121][_0xf31543(0x232)])),_0x8dae42=Math[_0xf31543(0x20d)](_0x3d4486[_0xf31543(0x191)]/0x2),_0x321bee=_0x3d4486[_0xf31543(0x241)](0x0,_0x8dae42),_0x2b8d00=_0x1db93d[_0xf31543(0x241)](0x0,_0x8dae42),_0x3e59d3=_0x1c5515[_0xf31543(0x241)](0x0,_0x8dae42),_0x442090=_0x3d4486[_0xf31543(0x241)](_0x8dae42),_0x431a64=_0x1db93d[_0xf31543(0x241)](_0x8dae42),_0x249b73=_0x1c5515[_0xf31543(0x241)](_0x8dae42);barChart1['data']['labels']=_0x321bee,barChart1[_0xf31543(0x1c5)]['datasets'][0x0][_0xf31543(0x1c5)]=_0x2b8d00,barChart1[_0xf31543(0x1c5)][_0xf31543(0x25e)][0x1]['data']=_0x3e59d3,barChart1[_0xf31543(0x1d8)](),barChart2['data'][_0xf31543(0x17b)]=_0x442090,barChart2[_0xf31543(0x1c5)]['datasets'][0x0][_0xf31543(0x1c5)]=_0x431a64,barChart2[_0xf31543(0x1c5)][_0xf31543(0x25e)][0x1][_0xf31543(0x1c5)]=_0x249b73,barChart2['update'](),updateLatestRegistrationsTable(_0x449af5),displaySelectedTeamMembers(),updateEmployeeListTable(_0x483bc6),updateGroupView(_0x483bc6);},_0x3cc8ca=>{const _0x50792a=_0x39dd;console[_0x50792a(0x1e3)](_0x50792a(0x25a),_0x3cc8ca);});}catch(_0x40e068){console[_0x30f2b5(0x1e3)](_0x30f2b5(0x1fe),_0x40e068);}}function updateLatestRegistrationsTable(_0x3e2b19){const _0x409384=_0xd2e353;latestRegistrationsTableBody[_0x409384(0x24a)]='';if(_0x3e2b19['length']===0x0){latestRegistrationsTableBody[_0x409384(0x24a)]='<tr><td\x20colspan=\x227\x22\x20class=\x22p-6\x20text-center\x20text-gray-500\x22>ยังไม่มีผู้ลงทะเบียน</td></tr>';return;}_0x3e2b19[_0x409384(0x15c)]((_0xe5c5fd,_0x4f2715)=>{const _0x30e5d0=_0x409384,_0x318e0f=teamNames['indexOf'](_0xe5c5fd[_0x30e5d0(0x19c)]||''),_0x29cd9b=teamNames[_0x30e5d0(0x20a)](_0x4f2715[_0x30e5d0(0x19c)]||''),_0x28dc17=_0xe5c5fd['FullName_th']||'',_0x2387bd=_0x4f2715['FullName_th']||'',_0x37d431=_0x318e0f===-0x1?Infinity:_0x318e0f,_0x55138a=_0x29cd9b===-0x1?Infinity:_0x29cd9b;if(_0x37d431<_0x55138a)return-0x1;if(_0x37d431>_0x55138a)return 0x1;return _0x28dc17[_0x30e5d0(0x150)](_0x2387bd);}),_0x3e2b19[_0x409384(0x1dd)]((_0x592fe2,_0x55513d)=>{const _0x297db2=_0x409384,_0x51ed95=document[_0x297db2(0x131)]('tr');_0x51ed95['className']=_0x55513d%0x2===0x0?_0x297db2(0x236):'bg-gray-100';const _0x499343=!!_0x592fe2['DateLogin'];_0x51ed95[_0x297db2(0x24a)]=_0x297db2(0x252)+(_0x592fe2[_0x297db2(0x182)]||'')+_0x297db2(0x1bf)+(_0x592fe2[_0x297db2(0x17f)]||'')+_0x297db2(0x214)+(_0x592fe2['BU_th']||'')+_0x297db2(0x23d)+(_0x592fe2[_0x297db2(0x15a)]||'')+_0x297db2(0x145)+(_0x592fe2[_0x297db2(0x19c)]||'')+'</td>\x20<!--\x20(เพิ่ม)\x20นี่คือ\x20\x22ทีม\x22\x20(Check_Place)\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20(ลบ)\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>'+(_0x592fe2['Department_th']||'')+_0x297db2(0x125)+(_0x499343?_0x297db2(0x1e9):_0x297db2(0x13a))+_0x297db2(0x15f);const _0x3dae21=document[_0x297db2(0x131)]('button');_0x3dae21[_0x297db2(0x11a)]='ลบรายการ',_0x3dae21[_0x297db2(0x246)]=_0x297db2(0x1bc),_0x3dae21[_0x297db2(0x1dc)]=()=>showConfirmCancelRegistration(_0x592fe2),_0x51ed95[_0x297db2(0x198)][0x6]['appendChild'](_0x3dae21),latestRegistrationsTableBody['appendChild'](_0x51ed95);});}function updateEmployeeListTable(_0x367124){const _0x361099=_0xd2e353,_0x44e8ee=managerFilterSelect[_0x361099(0x24d)];employeeListTableBody['innerHTML']='';const _0x5d350c=_0x44e8ee?_0x367124['filter'](_0x31b337=>{const _0x42c45b=_0x361099;if(_0x44e8ee===_0x42c45b(0x1f5))return!_0x31b337[_0x42c45b(0x15a)]||_0x31b337[_0x42c45b(0x15a)][_0x42c45b(0x1b8)]()==='';return _0x31b337[_0x42c45b(0x15a)]===_0x44e8ee;}):[];if(!_0x44e8ee){employeeListTableBody[_0x361099(0x24a)]=_0x361099(0x254);return;}if(_0x5d350c[_0x361099(0x191)]===0x0){employeeListTableBody['innerHTML']=_0x361099(0x132)+_0x44e8ee+_0x361099(0x240);return;}_0x5d350c[_0x361099(0x15c)]((_0x5bc1c2,_0x271e6e)=>{const _0x12e004=_0x361099,_0x579a42=teamNames[_0x12e004(0x20a)](_0x5bc1c2[_0x12e004(0x19c)]||''),_0x464cf9=teamNames[_0x12e004(0x20a)](_0x271e6e['Check_Place']||''),_0x1a7636=_0x5bc1c2['FullName_th']||'',_0x31b374=_0x271e6e[_0x12e004(0x17f)]||'',_0x2eba9f=_0x579a42===-0x1?Infinity:_0x579a42,_0x285995=_0x464cf9===-0x1?Infinity:_0x464cf9;if(_0x2eba9f<_0x285995)return-0x1;if(_0x2eba9f>_0x285995)return 0x1;if(_0x1a7636<_0x31b374)return-0x1;if(_0x1a7636>_0x31b374)return 0x1;return 0x0;}),_0x5d350c[_0x361099(0x1dd)]((_0x5800ee,_0x4b941f)=>{const _0x513dde=_0x361099,_0x1bab11=document[_0x513dde(0x131)]('tr');_0x1bab11[_0x513dde(0x246)]=_0x4b941f%0x2===0x0?_0x513dde(0x236):_0x513dde(0x1d2);const _0x16a0e1=_0x5800ee[_0x513dde(0x172)]instanceof Timestamp,_0x95b97c=document['createElement']('button');_0x95b97c[_0x513dde(0x11a)]=_0x513dde(0x1e6),_0x95b97c[_0x513dde(0x246)]=_0x513dde(0x1b0),_0x95b97c[_0x513dde(0x1dc)]=()=>showEditModal(_0x5800ee),_0x1bab11[_0x513dde(0x24a)]=_0x513dde(0x1fa)+(_0x4b941f+0x1)+_0x513dde(0x153)+(_0x5800ee[_0x513dde(0x182)]||'')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20font-medium\x22>'+(_0x5800ee[_0x513dde(0x17f)]||'')+_0x513dde(0x1eb)+(_0x5800ee[_0x513dde(0x13d)]||'')+_0x513dde(0x239)+(_0x5800ee[_0x513dde(0x19c)]||'')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x16a0e1?_0x513dde(0x1e9):_0x513dde(0x13a))+_0x513dde(0x21f),_0x1bab11[_0x513dde(0x198)][0x5][_0x513dde(0x136)](_0x95b97c),employeeListTableBody[_0x513dde(0x136)](_0x1bab11);});}function setActiveTab(_0x230136,_0x28d334){const _0x3a64ea=_0xd2e353;[tabDashboard,tabTeamList,tabGroupView,tabEmployeeList,tabRegister][_0x3a64ea(0x1dd)](_0x4087cc=>{const _0x2f5bea=_0x3a64ea;_0x4087cc[_0x2f5bea(0x237)][_0x2f5bea(0x148)](_0x2f5bea(0x1d2),_0x2f5bea(0x216),_0x2f5bea(0x142),_0x2f5bea(0x22b),_0x2f5bea(0x1d6)),_0x4087cc['classList']['remove']('bg-gray-300',_0x2f5bea(0x12e),'text-gray-700');}),[dashboardContent,teamListContent,groupViewContent,employeeListContent,registerContent][_0x3a64ea(0x1dd)](_0x57f21a=>{const _0x5b1bed=_0x3a64ea;_0x57f21a[_0x5b1bed(0x237)]['add'](_0x5b1bed(0x22c));}),_0x230136[_0x3a64ea(0x237)][_0x3a64ea(0x148)](_0x3a64ea(0x195),_0x3a64ea(0x12e),_0x3a64ea(0x139)),_0x230136[_0x3a64ea(0x237)][_0x3a64ea(0x204)]('bg-gray-100','border-transparent',_0x3a64ea(0x142),_0x3a64ea(0x22b),_0x3a64ea(0x1d6)),_0x28d334[_0x3a64ea(0x237)]['remove'](_0x3a64ea(0x22c));}tabDashboard['addEventListener']('click',()=>setActiveTab(tabDashboard,dashboardContent)),tabTeamList[_0xd2e353(0x16f)](_0xd2e353(0x1f9),()=>setActiveTab(tabTeamList,teamListContent)),tabGroupView[_0xd2e353(0x16f)](_0xd2e353(0x1f9),()=>setActiveTab(tabGroupView,groupViewContent)),tabEmployeeList['addEventListener'](_0xd2e353(0x1f9),()=>setActiveTab(tabEmployeeList,employeeListContent)),tabRegister[_0xd2e353(0x16f)](_0xd2e353(0x1f9),()=>setActiveTab(tabRegister,registerContent));function shuffleArray(_0x4ed8f8){const _0x48bad1=_0xd2e353;for(let _0x428ed0=_0x4ed8f8['length']-0x1;_0x428ed0>0x0;_0x428ed0--){const _0x214e5a=Math[_0x48bad1(0x1be)](Math['random']()*(_0x428ed0+0x1));[_0x4ed8f8[_0x428ed0],_0x4ed8f8[_0x214e5a]]=[_0x4ed8f8[_0x214e5a],_0x4ed8f8[_0x428ed0]];}return _0x4ed8f8;}async function handleResetTeam(){const _0x32893e=_0xd2e353;console[_0x32893e(0x177)]('Showing\x20Reset\x20Team\x20confirmation...'),currentConfirmAction=async()=>{const _0x286fc7=_0x32893e;confirmTitle[_0x286fc7(0x11a)]=_0x286fc7(0x23b),confirmText[_0x286fc7(0x11a)]=_0x286fc7(0x154),confirmActionButton[_0x286fc7(0x21d)]=!![],closeConfirmButton['disabled']=!![],teamCreationStatus['textContent']=_0x286fc7(0x18d),teamCreationProgressContainer[_0x286fc7(0x237)]['remove']('hidden'),teamCreationProgressBar[_0x286fc7(0x1a3)]['width']='0%',teamCreationProgressBar[_0x286fc7(0x11a)]='0%',resetTeamButton[_0x286fc7(0x21d)]=!![],createTeamButton['disabled']=!![];try{const _0x307afa=writeBatch(db),_0x1ea59b=allEmployeesData[_0x286fc7(0x191)];let _0x471160=0x0;allEmployeesData[_0x286fc7(0x1dd)](_0x47e451=>{const _0x1357b9=_0x286fc7,_0xb68638=doc(db,_0x1357b9(0x21c),_0x47e451['id']);_0x307afa['update'](_0xb68638,{'Check_Place':'','DateLogin':null}),_0x471160++;const _0x3b0d75=Math[_0x1357b9(0x1af)](_0x471160/_0x1ea59b*0x64);teamCreationProgressBar[_0x1357b9(0x1a3)][_0x1357b9(0x15b)]=_0x3b0d75+'%',teamCreationProgressBar[_0x1357b9(0x11a)]=_0x3b0d75+'%';}),await _0x307afa[_0x286fc7(0x225)](),confirmTitle['textContent']=_0x286fc7(0x1ed),confirmText[_0x286fc7(0x11a)]=_0x286fc7(0x21e),confirmActionButton[_0x286fc7(0x237)][_0x286fc7(0x148)](_0x286fc7(0x22c)),closeConfirmButton[_0x286fc7(0x11a)]=_0x286fc7(0x1c9),closeConfirmButton['disabled']=![],teamCreationStatus['textContent']=_0x286fc7(0x1ab),console[_0x286fc7(0x177)](_0x286fc7(0x18b));}catch(_0x1dc5f3){console[_0x286fc7(0x1e3)](_0x286fc7(0x11b),_0x1dc5f3),confirmTitle[_0x286fc7(0x11a)]=_0x286fc7(0x1ba),confirmText[_0x286fc7(0x11a)]=_0x286fc7(0x226)+_0x1dc5f3[_0x286fc7(0x185)],closeConfirmButton['textContent']=_0x286fc7(0x1c9),closeConfirmButton[_0x286fc7(0x21d)]=![],teamCreationStatus[_0x286fc7(0x11a)]=_0x286fc7(0x230)+_0x1dc5f3[_0x286fc7(0x185)];}finally{resetTeamButton[_0x286fc7(0x21d)]=![],createTeamButton['disabled']=![];}},confirmTitle['textContent']='ยืนยันการ\x20Reset\x20Team',confirmText[_0x32893e(0x11a)]='คุณต้องการลบข้อมูลทีม\x20(Check_Place)\x20และสถานะการลงทะเบียน\x20(DateLogin)\x20ของพนักงานทั้งหมดหรือไม่?\x20(ข้อมูลพนักงานจะไม่ถูกลบ)',confirmActionButton[_0x32893e(0x11a)]=_0x32893e(0x16b),confirmActionButton['className']=_0x32893e(0x1fb),confirmActionButton[_0x32893e(0x21d)]=![],confirmActionButton[_0x32893e(0x237)]['remove'](_0x32893e(0x22c)),confirmActionButton[_0x32893e(0x1dc)]=()=>{const _0x4e473e=_0x32893e;typeof currentConfirmAction===_0x4e473e(0x188)&&currentConfirmAction();},closeConfirmButton[_0x32893e(0x11a)]=_0x32893e(0x179),closeConfirmButton['disabled']=![],closeConfirmButton[_0x32893e(0x237)][_0x32893e(0x204)]('hidden'),confirmModal[_0x32893e(0x237)][_0x32893e(0x204)](_0x32893e(0x22c));}async function handleCreateTeam(){const _0x352360=_0xd2e353;console[_0x352360(0x177)]('Creating\x20teams\x20based\x20on\x20new\x20rules...'),teamCreationStatus[_0x352360(0x11a)]=_0x352360(0x1cd),teamCreationProgressContainer[_0x352360(0x237)][_0x352360(0x204)](_0x352360(0x22c)),teamCreationProgressBar[_0x352360(0x1a3)]['width']='0%',teamCreationProgressBar[_0x352360(0x11a)]='0%',resetTeamButton[_0x352360(0x21d)]=!![],createTeamButton[_0x352360(0x21d)]=!![];const _0x114037=allEmployeesData[_0x352360(0x1de)](_0x29ac09=>_0x29ac09['Check_Manager']&&_0x29ac09['Check_Manager'][_0x352360(0x1b8)]()!==''&&(!_0x29ac09[_0x352360(0x19c)]||_0x29ac09['Check_Place'][_0x352360(0x1b8)]()==='')),_0x1d2197=_0x114037[_0x352360(0x191)];if(_0x1d2197===0x0){teamCreationStatus[_0x352360(0x11a)]=_0x352360(0x25d),resetTeamButton[_0x352360(0x21d)]=![],createTeamButton[_0x352360(0x21d)]=![];return;}const _0x438043=Math[_0x352360(0x20d)](_0x1d2197/teamSize),_0x2e65af=teamNames[_0x352360(0x241)](0x0,_0x438043),_0x5124bb=_0x2e65af[_0x2e65af[_0x352360(0x191)]-0x1];console['log'](_0x352360(0x190)+_0x1d2197+'.\x20Need\x20'+_0x438043+'\x20teams:\x20'+_0x2e65af['join'](',\x20'));const _0x1a0c06=_0x114037['reduce']((_0x202b75,_0x31e7bf)=>{const _0x53c513=_0x352360,_0x4f00cf=_0x31e7bf[_0x53c513(0x15a)]||_0x53c513(0x20e);return _0x202b75[_0x4f00cf]=(_0x202b75[_0x4f00cf]||0x0)+0x1,_0x202b75;},{});console[_0x352360(0x177)](_0x352360(0x22e),_0x1a0c06);const _0x39fc94=new Map(),_0x33973f=[];_0x114037[_0x352360(0x1dd)](_0x144d7e=>{const _0x34f7a5=_0x352360,_0x27444a=_0x144d7e['Check_Manager']||'UNKNOWN';_0x1a0c06[_0x27444a]>_0x438043?(!_0x39fc94[_0x34f7a5(0x23e)](_0x27444a)&&_0x39fc94[_0x34f7a5(0x187)](_0x27444a,[]),_0x39fc94['get'](_0x27444a)[_0x34f7a5(0x1d1)](_0x144d7e)):_0x33973f[_0x34f7a5(0x1d1)](_0x144d7e);}),console[_0x352360(0x177)](_0x352360(0x1a2)+_0x39fc94[_0x352360(0x1ad)]),console['log'](_0x352360(0x158)+_0x33973f[_0x352360(0x191)]);const _0xdbe89e={};_0x2e65af[_0x352360(0x1dd)](_0x4f208e=>{_0xdbe89e[_0x4f208e]={'members':[],'managers':{}};});const _0xebded={};let _0x230c8e=0x0;teamCreationStatus[_0x352360(0x11a)]=_0x352360(0x23a);let _0x3601a4=0x0;for(const [_0x194522,_0x541586]of _0x39fc94['entries']()){console[_0x352360(0x177)]('Processing\x20Large\x20Group:\x20'+_0x194522+'\x20('+_0x541586['length']+_0x352360(0x17e)),shuffleArray(_0x541586);while(_0x541586['length']>_0x438043){const _0x457e5e=_0x541586[_0x352360(0x191)]>_0x438043*0x2?0x2:0x1;console['log'](_0x352360(0x24e)+_0x457e5e+_0x352360(0x14f)+_0x194522+_0x352360(0x18e)+_0x541586[_0x352360(0x191)]);for(let _0x6d3918=0x0;_0x6d3918<_0x438043*_0x457e5e;_0x6d3918++){if(_0x541586[_0x352360(0x191)]===0x0)break;const _0x34f5eb=_0x541586[_0x352360(0x13e)]();let _0x1ed3f4=_0x2e65af[_0x3601a4],_0x2467bf=_0xdbe89e[_0x1ed3f4],_0x3c8464=0x0;while(_0x1ed3f4!==_0x5124bb&&_0x2467bf[_0x352360(0x173)][_0x352360(0x191)]>=teamSize&&_0x3c8464<_0x438043){_0x3601a4=(_0x3601a4+0x1)%_0x438043,_0x1ed3f4=_0x2e65af[_0x3601a4],_0x2467bf=_0xdbe89e[_0x1ed3f4],_0x3c8464++;}_0x1ed3f4!==_0x5124bb&&_0x2467bf[_0x352360(0x173)]['length']>=teamSize&&(_0x1ed3f4=_0x5124bb,_0x2467bf=_0xdbe89e[_0x5124bb]);_0x2467bf[_0x352360(0x173)][_0x352360(0x1d1)](_0x34f5eb),_0x2467bf['managers'][_0x34f5eb[_0x352360(0x15a)]]=(_0x2467bf[_0x352360(0x1b9)][_0x34f5eb['Check_Manager']]||0x0)+0x1,_0xebded[_0x34f5eb['id']]=_0x1ed3f4,_0x230c8e++;const _0x1bb2a8=Math['round'](_0x230c8e/_0x1d2197*0x64);teamCreationProgressBar[_0x352360(0x1a3)][_0x352360(0x15b)]=_0x1bb2a8+'%',teamCreationProgressBar[_0x352360(0x11a)]=_0x1bb2a8+'%',_0x3601a4=(_0x3601a4+0x1)%_0x438043;}}_0x541586[_0x352360(0x191)]>0x0&&(console[_0x352360(0x177)](_0x352360(0x116)+_0x541586[_0x352360(0x191)]+_0x352360(0x189)+_0x194522+_0x352360(0x18a)),_0x33973f['push'](..._0x541586));}console['log']('Finished\x20Rule\x202.\x20Teams\x20status:',JSON[_0x352360(0x20f)](JSON[_0x352360(0x215)](_0xdbe89e))),console[_0x352360(0x177)](_0x352360(0x12f)+_0x33973f[_0x352360(0x191)]),teamCreationStatus[_0x352360(0x11a)]=_0x352360(0x199),shuffleArray(_0x33973f);for(const _0xc5f32a of _0x33973f){let _0xc719de=![];const _0x4cfddf=_0xc5f32a[_0x352360(0x15a)]||_0x352360(0x20e);for(const _0x25183d of _0x2e65af){const _0x42b5db=_0xdbe89e[_0x25183d],_0x39adbe=_0x25183d!==_0x5124bb&&_0x42b5db[_0x352360(0x173)][_0x352360(0x191)]>=teamSize;if(!_0x39adbe&&!_0x42b5db[_0x352360(0x1b9)][_0x4cfddf]){_0x42b5db['members'][_0x352360(0x1d1)](_0xc5f32a),_0x42b5db[_0x352360(0x1b9)][_0x4cfddf]=0x1,_0xebded[_0xc5f32a['id']]=_0x25183d,_0xc719de=!![];break;}}if(!_0xc719de)for(const _0x432740 of _0x2e65af){const _0x40d1d5=_0xdbe89e[_0x432740],_0x2b3407=_0x432740!==_0x5124bb&&_0x40d1d5['members']['length']>=teamSize;if(!_0x2b3407){_0x40d1d5[_0x352360(0x173)][_0x352360(0x1d1)](_0xc5f32a),_0x40d1d5[_0x352360(0x1b9)][_0x4cfddf]=(_0x40d1d5['managers'][_0x4cfddf]||0x0)+0x1,_0xebded[_0xc5f32a['id']]=_0x432740,_0xc719de=!![];break;}}if(_0xc719de){_0x230c8e++;const _0x56d378=Math[_0x352360(0x1af)](_0x230c8e/_0x1d2197*0x64);teamCreationProgressBar['style'][_0x352360(0x15b)]=_0x56d378+'%',teamCreationProgressBar['textContent']=_0x56d378+'%';}else console[_0x352360(0x1e3)](_0x352360(0x181),_0xc5f32a);}console[_0x352360(0x177)](_0x352360(0x253),_0xebded),console[_0x352360(0x177)](_0x352360(0x11c),_0xdbe89e);if(Object[_0x352360(0x1da)](_0xebded)[_0x352360(0x191)]>0x0){teamCreationStatus[_0x352360(0x11a)]=_0x352360(0x14a);try{const _0x5b8aa1=writeBatch(db);Object['keys'](_0xebded)[_0x352360(0x1dd)](_0x13c359=>{const _0x2dee87=_0x352360,_0x46616d=_0xebded[_0x13c359],_0x45b9c2=doc(db,_0x2dee87(0x21c),_0x13c359);_0x5b8aa1[_0x2dee87(0x1d8)](_0x45b9c2,{'Check_Place':_0x46616d});}),await _0x5b8aa1[_0x352360(0x225)](),_0x230c8e<_0x1d2197?(teamCreationStatus[_0x352360(0x11a)]=_0x352360(0x121)+_0x230c8e+'/'+_0x1d2197+').',console['error'](_0x352360(0x192))):teamCreationStatus['textContent']=_0x352360(0x1f4),console[_0x352360(0x177)](_0x352360(0x200)),displaySelectedTeamMembers();}catch(_0x2270e3){console[_0x352360(0x1e3)](_0x352360(0x12b),_0x2270e3),teamCreationStatus['textContent']=_0x352360(0x258)+_0x2270e3[_0x352360(0x185)];}finally{resetTeamButton['disabled']=![],createTeamButton[_0x352360(0x21d)]=![];}}else teamCreationStatus[_0x352360(0x11a)]='ไม่มีพนักงานที่ต้องจัดทีมใหม่',resetTeamButton[_0x352360(0x21d)]=![],createTeamButton[_0x352360(0x21d)]=![];}function _0x39dd(_0x66caa7,_0x24194b){const _0x412c5e=_0x412c();return _0x39dd=function(_0x39ddf8,_0x803fa){_0x39ddf8=_0x39ddf8-0x116;let _0x57191a=_0x412c5e[_0x39ddf8];return _0x57191a;},_0x39dd(_0x66caa7,_0x24194b);}function displaySelectedTeamMembers(){const _0x4067aa=_0xd2e353,_0x53ceeb=teamSelect[_0x4067aa(0x24d)];selectedTeamTableBody[_0x4067aa(0x24a)]='';if(!_0x53ceeb){selectedTeamTableBody['innerHTML']=_0x4067aa(0x138);return;}const _0x198604=allEmployeesData[_0x4067aa(0x1de)](_0x135064=>_0x135064[_0x4067aa(0x19c)]===_0x53ceeb);if(_0x198604[_0x4067aa(0x191)]===0x0){selectedTeamTableBody[_0x4067aa(0x24a)]=_0x4067aa(0x159)+_0x53ceeb+_0x4067aa(0x240);return;}_0x198604[_0x4067aa(0x15c)]((_0x13451a,_0xd84032)=>(_0x13451a[_0x4067aa(0x17f)]||'')[_0x4067aa(0x150)](_0xd84032[_0x4067aa(0x17f)]||'')),_0x198604['forEach']((_0x2999ce,_0x458bf3)=>{const _0x59e678=_0x4067aa,_0x2c493f=document[_0x59e678(0x131)]('tr');_0x2c493f[_0x59e678(0x246)]=_0x458bf3%0x2===0x0?_0x59e678(0x236):'bg-gray-100';const _0xc81064=!!_0x2999ce[_0x59e678(0x172)];_0x2c493f[_0x59e678(0x24a)]=_0x59e678(0x1fa)+(_0x458bf3+0x1)+_0x59e678(0x207)+(_0x2999ce['employeeId']||'')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x20font-medium\x22>'+(_0x2999ce[_0x59e678(0x17f)]||'')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>'+(_0x2999ce['BU_th']||'')+_0x59e678(0x153)+(_0x2999ce[_0x59e678(0x15a)]||'')+_0x59e678(0x231)+(_0xc81064?'<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-green-100\x20text-green-800\x22>ลงทะเบียนแล้ว</span>':'<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-gray-100\x20text-gray-800\x22>ยังไม่ลงทะเบียน</span>')+_0x59e678(0x141);const _0x352ebf=document[_0x59e678(0x131)](_0x59e678(0x235));_0x352ebf[_0x59e678(0x11a)]='แก้ไข',_0x352ebf[_0x59e678(0x246)]=_0x59e678(0x1b0),_0x352ebf[_0x59e678(0x1dc)]=()=>showEditTeamMemberModal(_0x2999ce),_0x2c493f[_0x59e678(0x198)][0x6]['appendChild'](_0x352ebf),selectedTeamTableBody[_0x59e678(0x136)](_0x2c493f);});}function showEditTeamMemberModal(_0x4cd88e){const _0x4cc3cc=_0xd2e353;console[_0x4cc3cc(0x177)](_0x4cc3cc(0x19e),_0x4cd88e),currentEditingDocId=_0x4cd88e['id'],editMemberEmpId[_0x4cc3cc(0x11a)]=_0x4cd88e[_0x4cc3cc(0x182)]||_0x4cc3cc(0x15e),editMemberEmpName[_0x4cc3cc(0x11a)]=_0x4cd88e[_0x4cc3cc(0x17f)]||_0x4cc3cc(0x15e),editMemberError[_0x4cc3cc(0x11a)]='',editMemberTeamSelect[_0x4cc3cc(0x24a)]='';const _0x4e3283=document['createElement'](_0x4cc3cc(0x1b3));_0x4e3283[_0x4cc3cc(0x24d)]='',_0x4e3283[_0x4cc3cc(0x11a)]=_0x4cc3cc(0x122),editMemberTeamSelect[_0x4cc3cc(0x136)](_0x4e3283),teamNames['forEach'](_0x5aeb4b=>{const _0x3d6280=_0x4cc3cc,_0x44a024=document[_0x3d6280(0x131)](_0x3d6280(0x1b3));_0x44a024[_0x3d6280(0x24d)]=_0x5aeb4b,_0x44a024[_0x3d6280(0x11a)]=_0x5aeb4b,editMemberTeamSelect[_0x3d6280(0x136)](_0x44a024);}),editMemberTeamSelect['value']=_0x4cd88e[_0x4cc3cc(0x19c)]||'',editTeamMemberModal[_0x4cc3cc(0x237)][_0x4cc3cc(0x204)](_0x4cc3cc(0x22c));}function closeEditTeamMemberModal(){const _0x520c0f=_0xd2e353;editTeamMemberModal['classList'][_0x520c0f(0x148)](_0x520c0f(0x22c)),currentEditingDocId=null;}async function saveEditTeamMemberChanges(){const _0x2494ee=_0xd2e353;if(!currentEditingDocId)return;const _0x20a3a5=editMemberTeamSelect['value'];editMemberError[_0x2494ee(0x11a)]='',saveEditMemberModalButton[_0x2494ee(0x21d)]=!![],deleteEditMemberModalButton[_0x2494ee(0x21d)]=!![],closeEditMemberModalButton['disabled']=!![];try{const _0x2f9766=doc(db,'crsg',currentEditingDocId);await updateDoc(_0x2f9766,{'Check_Place':_0x20a3a5}),console['log'](_0x2494ee(0x247)),closeEditTeamMemberModal();}catch(_0xa719c4){console[_0x2494ee(0x1e3)](_0x2494ee(0x186),_0xa719c4),editMemberError[_0x2494ee(0x11a)]='เกิดข้อผิดพลาด:\x20'+_0xa719c4[_0x2494ee(0x185)];}finally{saveEditMemberModalButton[_0x2494ee(0x21d)]=![],deleteEditMemberModalButton['disabled']=![],closeEditMemberModalButton[_0x2494ee(0x21d)]=![];}}function handleShowConfirmDeleteMember(){const _0x5509b9=_0xd2e353;if(!currentEditingDocId)return;currentConfirmAction=async()=>{const _0xadb7d0=_0x39dd;console['log'](_0xadb7d0(0x1b4),currentEditingDocId),saveEditMemberModalButton['disabled']=!![],deleteEditMemberModalButton[_0xadb7d0(0x21d)]=!![],closeEditMemberModalButton[_0xadb7d0(0x21d)]=!![];try{const _0x10722c=doc(db,_0xadb7d0(0x21c),currentEditingDocId);await updateDoc(_0x10722c,{'Check_Place':''}),console[_0xadb7d0(0x177)](_0xadb7d0(0x1ee)),closeEditTeamMemberModal(),confirmModal[_0xadb7d0(0x237)][_0xadb7d0(0x148)]('hidden');}catch(_0x347c27){console[_0xadb7d0(0x1e3)](_0xadb7d0(0x167),_0x347c27),editMemberError[_0xadb7d0(0x11a)]=_0xadb7d0(0x226)+_0x347c27[_0xadb7d0(0x185)],confirmModal[_0xadb7d0(0x237)][_0xadb7d0(0x148)]('hidden');}finally{saveEditMemberModalButton['disabled']=![],deleteEditMemberModalButton[_0xadb7d0(0x21d)]=![],closeEditMemberModalButton[_0xadb7d0(0x21d)]=![],currentConfirmAction=null;}},confirmTitle[_0x5509b9(0x11a)]=_0x5509b9(0x174),confirmText['textContent']=_0x5509b9(0x1cc)+editMemberEmpName[_0x5509b9(0x11a)]+_0x5509b9(0x168),confirmActionButton[_0x5509b9(0x11a)]=_0x5509b9(0x23f),confirmActionButton[_0x5509b9(0x246)]=_0x5509b9(0x1fb),confirmActionButton[_0x5509b9(0x21d)]=![],confirmActionButton[_0x5509b9(0x237)]['remove'](_0x5509b9(0x22c)),confirmActionButton[_0x5509b9(0x1dc)]=()=>{typeof currentConfirmAction==='function'&&currentConfirmAction();},closeConfirmButton[_0x5509b9(0x11a)]='ไม่',closeConfirmButton[_0x5509b9(0x21d)]=![],closeConfirmButton[_0x5509b9(0x237)]['remove']('hidden'),confirmModal['classList']['remove'](_0x5509b9(0x22c));}function setupEditTeamMemberModalListeners(){const _0x14bb77=_0xd2e353;closeEditMemberModalButton[_0x14bb77(0x16f)]('click',closeEditTeamMemberModal),saveEditMemberModalButton[_0x14bb77(0x16f)](_0x14bb77(0x1f9),saveEditTeamMemberChanges),deleteEditMemberModalButton[_0x14bb77(0x16f)](_0x14bb77(0x1f9),handleShowConfirmDeleteMember);}function updateGroupView(_0x1cbc20){const _0x1e4b28=_0xd2e353;teamBoxesContainer[_0x1e4b28(0x24a)]='';const _0x3a7c47=groupViewManagerFilter['value'],_0xa4397c=_0x3a7c47?_0x1cbc20['filter'](_0x14db3b=>{const _0x4c2a14=_0x1e4b28;if(_0x3a7c47===_0x4c2a14(0x1f5))return!_0x14db3b[_0x4c2a14(0x15a)]||_0x14db3b[_0x4c2a14(0x15a)][_0x4c2a14(0x1b8)]()==='';return _0x14db3b['Check_Manager']===_0x3a7c47;}):_0x1cbc20,_0x411452=teamNames[_0x1e4b28(0x201)]((_0x4015f8,_0x5cfb0e)=>{return _0x4015f8[_0x5cfb0e]=0x0,_0x4015f8;},{});let _0x29a385=0x0;_0xa4397c[_0x1e4b28(0x1dd)](_0x4088a5=>{const _0x47938e=_0x1e4b28,_0xe14eed=_0x4088a5[_0x47938e(0x19c)];if(_0xe14eed&&teamNames[_0x47938e(0x126)](_0xe14eed))_0x411452[_0xe14eed]++;else(!_0xe14eed||_0xe14eed[_0x47938e(0x1b8)]()==='')&&_0x29a385++;}),teamNames['forEach'](_0x18d10b=>{const _0x1d3b8e=_0x1e4b28,_0x2e485f=_0x411452[_0x18d10b],_0x208a3e=document[_0x1d3b8e(0x131)](_0x1d3b8e(0x1b5));_0x208a3e[_0x1d3b8e(0x246)]=_0x1d3b8e(0x165),_0x208a3e[_0x1d3b8e(0x24a)]=_0x1d3b8e(0x233)+_0x18d10b+_0x1d3b8e(0x16e)+_0x2e485f+_0x1d3b8e(0x12c),_0x208a3e[_0x1d3b8e(0x16f)](_0x1d3b8e(0x1f9),()=>showGroupViewModal(_0x18d10b,_0x1cbc20)),teamBoxesContainer['appendChild'](_0x208a3e);}),teamNames[_0x1e4b28(0x191)]===0x0&&(teamBoxesContainer[_0x1e4b28(0x24a)]=_0x1e4b28(0x196));}function showGroupViewModal(_0x46e81c,_0x3db223){const _0x443bba=_0xd2e353;groupViewModalTitle[_0x443bba(0x11a)]=_0x443bba(0x1ce)+_0x46e81c,groupViewTableBody[_0x443bba(0x24a)]='';const _0x46e1e4=_0x3db223[_0x443bba(0x1de)](_0x37d51b=>_0x37d51b[_0x443bba(0x19c)]===_0x46e81c);if(_0x46e1e4['length']===0x0){groupViewTableBody['innerHTML']=_0x443bba(0x159)+_0x46e81c+_0x443bba(0x240),groupViewModal[_0x443bba(0x237)][_0x443bba(0x204)](_0x443bba(0x22c));return;}_0x46e1e4[_0x443bba(0x15c)]((_0x1fc103,_0x553284)=>{const _0xd6e434=_0x443bba,_0x8ccc8a=_0x1fc103['Check_Manager']||'',_0x390e48=_0x553284[_0xd6e434(0x15a)]||'',_0x153f5f=_0x1fc103['FullName_th']||'',_0x46ea73=_0x553284[_0xd6e434(0x17f)]||'';if(_0x8ccc8a<_0x390e48)return-0x1;if(_0x8ccc8a>_0x390e48)return 0x1;return _0x153f5f['localeCompare'](_0x46ea73);}),_0x46e1e4[_0x443bba(0x1dd)]((_0x752559,_0x5d8b2f)=>{const _0x17714e=_0x443bba,_0x5edc54=document['createElement']('tr');_0x5edc54[_0x17714e(0x246)]=_0x5d8b2f%0x2===0x0?_0x17714e(0x236):'bg-gray-100';const _0x24f5ed=!!_0x752559[_0x17714e(0x172)];_0x5edc54[_0x17714e(0x24a)]=_0x17714e(0x1fa)+(_0x5d8b2f+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-3\x20whitespace-nowrap\x22>'+(_0x752559['employeeId']||'')+_0x17714e(0x1bf)+(_0x752559['FullName_th']||'')+_0x17714e(0x153)+(_0x752559[_0x17714e(0x22a)]||'')+_0x17714e(0x153)+(_0x752559['Check_Manager']||'')+_0x17714e(0x17d)+(_0x24f5ed?_0x17714e(0x244):_0x17714e(0x13a))+_0x17714e(0x163);const _0x25a034=document[_0x17714e(0x131)](_0x17714e(0x235));_0x25a034[_0x17714e(0x11a)]=_0x17714e(0x1e6),_0x25a034[_0x17714e(0x246)]=_0x17714e(0x1b0),_0x25a034[_0x17714e(0x1dc)]=()=>showEditTeamMemberModal(_0x752559),_0x5edc54[_0x17714e(0x198)][0x6][_0x17714e(0x136)](_0x25a034),groupViewTableBody['appendChild'](_0x5edc54);}),groupViewModal[_0x443bba(0x237)][_0x443bba(0x204)](_0x443bba(0x22c));}function setupGroupViewListeners(){const _0x33fcc7=_0xd2e353;closeGroupViewModalButton['addEventListener'](_0x33fcc7(0x1f9),()=>{const _0x3d74c4=_0x33fcc7;groupViewModal[_0x3d74c4(0x237)][_0x3d74c4(0x148)]('hidden');}),groupViewManagerFilter['addEventListener'](_0x33fcc7(0x25f),()=>updateGroupView(allEmployeesData));}function showConfirmCancelRegistration(_0x1bb71c){const _0x399359=_0xd2e353;if(!_0x1bb71c||!_0x1bb71c['id']){console[_0x399359(0x1e3)](_0x399359(0x21a));return;}currentConfirmAction=async()=>{const _0x20af61=_0x399359;console[_0x20af61(0x177)](_0x20af61(0x20b),_0x1bb71c[_0x20af61(0x17f)]),confirmActionButton['disabled']=!![],closeConfirmButton[_0x20af61(0x21d)]=!![];try{const _0x2762f4=doc(db,_0x20af61(0x21c),_0x1bb71c['id']);await updateDoc(_0x2762f4,{'DateLogin':null}),console['log'](_0x20af61(0x133)),confirmModal['classList'][_0x20af61(0x148)](_0x20af61(0x22c));}catch(_0x4d3344){console[_0x20af61(0x1e3)](_0x20af61(0x1cf),_0x4d3344),confirmText[_0x20af61(0x11a)]='เกิดข้อผิดพลาด:\x20'+_0x4d3344[_0x20af61(0x185)],confirmActionButton[_0x20af61(0x21d)]=![],closeConfirmButton[_0x20af61(0x21d)]=![];}finally{currentConfirmAction=null;}},confirmTitle[_0x399359(0x11a)]=_0x399359(0x251),confirmText[_0x399359(0x11a)]=_0x399359(0x209)+_0x1bb71c['FullName_th']+_0x399359(0x1a4),confirmActionButton['textContent']=_0x399359(0x17a),confirmActionButton[_0x399359(0x246)]=_0x399359(0x1fb),confirmActionButton['disabled']=![],confirmActionButton[_0x399359(0x237)][_0x399359(0x204)](_0x399359(0x22c)),confirmActionButton[_0x399359(0x1dc)]=()=>{const _0x59bfbc=_0x399359;typeof currentConfirmAction===_0x59bfbc(0x188)&&currentConfirmAction();},closeConfirmButton[_0x399359(0x11a)]=_0x399359(0x1c9),closeConfirmButton[_0x399359(0x21d)]=![],closeConfirmButton[_0x399359(0x237)][_0x399359(0x204)]('hidden'),confirmModal['classList'][_0x399359(0x204)]('hidden');}function updateRandomizerDataBasedOnAllEmployees(){const _0x51522b=_0xd2e353;currentParticipants=allEmployeesData[_0x51522b(0x1de)](_0x15e5d0=>_0x15e5d0[_0x51522b(0x172)]&&_0x15e5d0[_0x51522b(0x19c)]&&_0x15e5d0['Check_Place'][_0x51522b(0x1b8)]()!==''),availableToDraw=currentParticipants['filter'](_0x5f5051=>!_0x5f5051[_0x51522b(0x184)]),alreadyDrawn=currentParticipants[_0x51522b(0x1de)](_0x2eca9e=>_0x2eca9e['RandomTime']),randomizeError[_0x51522b(0x11a)]='';}function updateModalUI(){const _0x5693ac=_0xd2e353;modalParticipantsCount[_0x5693ac(0x11a)]=availableToDraw['length'],modalDrawnCount['textContent']=alreadyDrawn['length'],renderDrawnWinnersTable(),startRandomizeButton[_0x5693ac(0x21d)]=availableToDraw['length']===0x0;}function renderDrawnWinnersTable(){const _0x4c1b8e=_0xd2e353;drawnWinnersTableBody[_0x4c1b8e(0x24a)]='';if(alreadyDrawn[_0x4c1b8e(0x191)]===0x0){drawnWinnersTableBody[_0x4c1b8e(0x24a)]=_0x4c1b8e(0x1c1);return;}alreadyDrawn[_0x4c1b8e(0x15c)]((_0x398f2c,_0x29d9d2)=>(_0x29d9d2['RandomTime']?_0x29d9d2['RandomTime'][_0x4c1b8e(0x20c)]():0x0)-(_0x398f2c[_0x4c1b8e(0x184)]?_0x398f2c[_0x4c1b8e(0x184)][_0x4c1b8e(0x20c)]():0x0)),alreadyDrawn['forEach'](_0x5085ac=>{const _0x22a107=_0x4c1b8e,_0x14a4e4=document['createElement']('tr');_0x14a4e4[_0x22a107(0x246)]='hover:bg-gray-50';const _0x19a9c2=document[_0x22a107(0x131)]('button');_0x19a9c2[_0x22a107(0x11a)]=_0x22a107(0x229),_0x19a9c2[_0x22a107(0x246)]=_0x22a107(0x156),_0x19a9c2[_0x22a107(0x1dc)]=()=>handleShowConfirmCancelRandom(_0x5085ac['id'],_0x5085ac['FullName_th']),_0x14a4e4[_0x22a107(0x24a)]=_0x22a107(0x11d)+(_0x5085ac[_0x22a107(0x182)]||'')+_0x22a107(0x218)+(_0x5085ac[_0x22a107(0x17f)]||'')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20whitespace-nowrap\x22>'+(_0x5085ac[_0x22a107(0x22a)]||'')+_0x22a107(0x256),_0x14a4e4[_0x22a107(0x198)][0x3][_0x22a107(0x136)](_0x19a9c2),drawnWinnersTableBody[_0x22a107(0x136)](_0x14a4e4);});}async function updateRandomTime(_0x2eccf7,_0x2c0184){const _0x25b7cc=_0xd2e353;if(!_0x2eccf7)return;console[_0x25b7cc(0x177)](_0x25b7cc(0x1f2)+_0x2eccf7+'\x20with\x20RandomTime:',_0x2c0184);try{const _0x2d6158=doc(db,_0x25b7cc(0x21c),_0x2eccf7);await updateDoc(_0x2d6158,{'RandomTime':_0x2c0184}),console[_0x25b7cc(0x177)](_0x25b7cc(0x180));}catch(_0x1adfe6){console[_0x25b7cc(0x1e3)]('Error\x20updating\x20RandomTime:\x20',_0x1adfe6),randomizeError['textContent']=_0x25b7cc(0x155)+_0x1adfe6['message'];}}function handleShowConfirmCancelRandom(_0x5b4b4b,_0x85d1df){const _0x4b84cd=_0xd2e353;docIdToCancel=_0x5b4b4b,currentConfirmAction=async()=>{const _0x5741b9=_0x39dd;await updateRandomTime(docIdToCancel,null),docIdToCancel=null,confirmModal[_0x5741b9(0x237)][_0x5741b9(0x148)](_0x5741b9(0x22c)),!winnerDetailModal[_0x5741b9(0x237)]['contains'](_0x5741b9(0x22c))&&winnerDetailModal['classList'][_0x5741b9(0x148)]('hidden');},confirmTitle['textContent']=_0x4b84cd(0x260),confirmText['textContent']=_0x4b84cd(0x123)+_0x85d1df+']\x20ใช่หรือไม่?\x20(พนักงานจะกลับเข้าไปอยู่ในกลุ่มที่สุ่มได้อีกครั้ง)',confirmActionButton[_0x4b84cd(0x11a)]=_0x4b84cd(0x162),confirmActionButton[_0x4b84cd(0x246)]=_0x4b84cd(0x1fb),confirmActionButton['disabled']=![],confirmActionButton[_0x4b84cd(0x237)][_0x4b84cd(0x204)](_0x4b84cd(0x22c)),confirmActionButton[_0x4b84cd(0x1dc)]=()=>{const _0x1a0e8e=_0x4b84cd;typeof currentConfirmAction===_0x1a0e8e(0x188)&&currentConfirmAction();},closeConfirmButton[_0x4b84cd(0x11a)]=_0x4b84cd(0x179),closeConfirmButton['disabled']=![],closeConfirmButton[_0x4b84cd(0x237)][_0x4b84cd(0x204)](_0x4b84cd(0x22c)),confirmModal[_0x4b84cd(0x237)][_0x4b84cd(0x204)]('hidden');}async function handleRandomization(){const _0x8956d=_0xd2e353;if(availableToDraw[_0x8956d(0x191)]===0x0){randomizeError['textContent']=_0x8956d(0x16d);return;}startRandomizeButton['disabled']=!![],randomizeError[_0x8956d(0x11a)]='';let _0x1c231e=0x0;randomizationInterval=setInterval(()=>{const _0x580cab=_0x8956d;digits[_0x580cab(0x1dd)](_0x3e29d3=>{const _0x203317=_0x580cab;_0x3e29d3['textContent']=Math[_0x203317(0x1be)](Math[_0x203317(0x1ca)]()*0xa);}),_0x1c231e++;if(_0x1c231e>0x14){clearInterval(randomizationInterval);const _0x3af428=availableToDraw[Math[_0x580cab(0x1be)](Math[_0x580cab(0x1ca)]()*availableToDraw['length'])],_0x6fe5f9=(_0x3af428['employeeId']||_0x580cab(0x228))['slice'](-0x5)[_0x580cab(0x212)](0x5,'0');digits[_0x580cab(0x1dd)]((_0x48d530,_0x32f5b3)=>_0x48d530[_0x580cab(0x11a)]=_0x6fe5f9[_0x32f5b3]),updateRandomTime(_0x3af428['id'],serverTimestamp())[_0x580cab(0x223)](()=>{const _0xbd5aa=_0x580cab;winnerName[_0xbd5aa(0x11a)]=_0x3af428[_0xbd5aa(0x17f)]||'N/A',winnerEmployeeId[_0xbd5aa(0x11a)]=_0xbd5aa(0x1a7)+(_0x3af428[_0xbd5aa(0x182)]||_0xbd5aa(0x15e)),winnerTeam['textContent']=_0xbd5aa(0x202)+(_0x3af428['Check_Place']||_0xbd5aa(0x15e)),winnerBU[_0xbd5aa(0x11a)]=_0xbd5aa(0x137)+(_0x3af428[_0xbd5aa(0x22a)]||'N/A'),cancelWinnerButton[_0xbd5aa(0x1df)]['docId']=_0x3af428['id'],winnerDetailModal[_0xbd5aa(0x237)][_0xbd5aa(0x204)](_0xbd5aa(0x22c)),startRandomizeButton['disabled']=![];});}},0x64);}async function handleCancelWinner(){const _0x4df53f=_0xd2e353,_0x4834dc=cancelWinnerButton[_0x4df53f(0x1df)][_0x4df53f(0x1db)],_0x47732e=alreadyDrawn[_0x4df53f(0x1d9)](_0x3ae5ee=>_0x3ae5ee['id']===_0x4834dc);handleShowConfirmCancelRandom(_0x4834dc,_0x47732e?.[_0x4df53f(0x17f)]||_0x4df53f(0x15e));}function setupModalListeners(){const _0x511e0d=_0xd2e353;randomizeButton[_0x511e0d(0x16f)](_0x511e0d(0x1f9),()=>{const _0x4a4eb9=_0x511e0d;updateRandomizerDataBasedOnAllEmployees(),updateModalUI(),randomizeModal[_0x4a4eb9(0x237)][_0x4a4eb9(0x204)]('hidden');}),closeRandomizeModalButton[_0x511e0d(0x16f)](_0x511e0d(0x1f9),()=>{const _0x41676e=_0x511e0d;randomizeModal[_0x41676e(0x237)]['add'](_0x41676e(0x22c));}),startRandomizeButton[_0x511e0d(0x16f)](_0x511e0d(0x1f9),handleRandomization),closeWinnerModalButton[_0x511e0d(0x16f)](_0x511e0d(0x1f9),()=>{const _0x79508=_0x511e0d;winnerDetailModal[_0x79508(0x237)]['add'](_0x79508(0x22c));}),cancelWinnerButton['addEventListener'](_0x511e0d(0x1f9),handleCancelWinner),closeConfirmButton[_0x511e0d(0x16f)]('click',()=>{const _0x2a4841=_0x511e0d;confirmModal[_0x2a4841(0x237)][_0x2a4841(0x148)](_0x2a4841(0x22c)),confirmTitle[_0x2a4841(0x11a)]=_0x2a4841(0x23f),confirmText[_0x2a4841(0x11a)]='',confirmActionButton[_0x2a4841(0x21d)]=![],confirmActionButton[_0x2a4841(0x237)][_0x2a4841(0x204)]('hidden'),closeConfirmButton['textContent']=_0x2a4841(0x179),closeConfirmButton['disabled']=![],currentConfirmAction=null,docIdToCancel=null;});}function setupTeamTabListeners(){const _0x3ab685=_0xd2e353;resetTeamButton[_0x3ab685(0x16f)](_0x3ab685(0x1f9),handleResetTeam),createTeamButton[_0x3ab685(0x16f)](_0x3ab685(0x1f9),handleCreateTeam),teamSelect['addEventListener'](_0x3ab685(0x25f),displaySelectedTeamMembers);}function setupEmployeeListListeners(){const _0x3678d7=_0xd2e353;managerFilterSelect['addEventListener'](_0x3678d7(0x25f),()=>{updateEmployeeListTable(allEmployeesData);}),closeEditModalButton[_0x3678d7(0x16f)](_0x3678d7(0x1f9),closeEditModal),saveEditModalButton[_0x3678d7(0x16f)](_0x3678d7(0x1f9),saveEmployeeChanges);}function populateManagerFilter(_0x444566){const _0x32d175=_0xd2e353,_0x34a602=managerFilterSelect[_0x32d175(0x24d)],_0x4deb33=managerFilterSelect[_0x32d175(0x164)]('option');_0x4deb33[_0x32d175(0x1dd)](_0x4adfba=>{const _0x5c3232=_0x32d175;_0x4adfba['value']!==''&&_0x4adfba[_0x5c3232(0x204)]();});const _0x1b8156=Array[_0x32d175(0x16a)](_0x444566)['sort']();_0x1b8156[_0x32d175(0x1dd)](_0x102325=>{const _0x1f43f9=_0x32d175;if(_0x102325&&_0x102325[_0x1f43f9(0x1b8)]()!==''){const _0x3af412=document[_0x1f43f9(0x131)](_0x1f43f9(0x1b3));_0x3af412[_0x1f43f9(0x24d)]=_0x102325,_0x3af412[_0x1f43f9(0x11a)]=_0x102325,managerFilterSelect[_0x1f43f9(0x136)](_0x3af412);}});if(_0x34a602&&managerFilterSelect[_0x32d175(0x213)]('option[value=\x22'+CSS[_0x32d175(0x183)](_0x34a602)+'\x22]'))managerFilterSelect[_0x32d175(0x24d)]=_0x34a602;else _0x34a602===''&&(managerFilterSelect['value']='');const _0x4a36b4=groupViewManagerFilter[_0x32d175(0x24d)],_0x233671=groupViewManagerFilter[_0x32d175(0x164)](_0x32d175(0x1b3));_0x233671[_0x32d175(0x1dd)](_0x166450=>{const _0x41a76f=_0x32d175;_0x166450[_0x41a76f(0x24d)]!==''&&_0x166450['remove']();});if(!groupViewManagerFilter[_0x32d175(0x213)](_0x32d175(0x151))){const _0x2a9ba4=document[_0x32d175(0x131)](_0x32d175(0x1b3));_0x2a9ba4[_0x32d175(0x24d)]=_0x32d175(0x1f5),_0x2a9ba4['textContent']=_0x32d175(0x13f),groupViewManagerFilter[_0x32d175(0x136)](_0x2a9ba4);}_0x1b8156[_0x32d175(0x1dd)](_0x4c644f=>{const _0x476d69=_0x32d175;if(_0x4c644f&&_0x4c644f[_0x476d69(0x1b8)]()!==''){const _0x3c260d=document['createElement']('option');_0x3c260d[_0x476d69(0x24d)]=_0x4c644f,_0x3c260d['textContent']=_0x4c644f,groupViewManagerFilter[_0x476d69(0x136)](_0x3c260d);}});if(_0x4a36b4&&groupViewManagerFilter[_0x32d175(0x213)]('option[value=\x22'+CSS[_0x32d175(0x183)](_0x4a36b4)+'\x22]'))groupViewManagerFilter['value']=_0x4a36b4;else _0x4a36b4===''&&(groupViewManagerFilter[_0x32d175(0x24d)]='');}function showEditModal(_0x478026){const _0x194be6=_0xd2e353;console[_0x194be6(0x177)](_0x194be6(0x134),_0x478026),currentEditingDocId=_0x478026['id'],editEmpId[_0x194be6(0x11a)]=_0x478026[_0x194be6(0x182)]||_0x194be6(0x15e),editEmpName['textContent']=_0x478026['FullName_th']||_0x194be6(0x15e),editEmpManager[_0x194be6(0x24d)]=_0x478026[_0x194be6(0x15a)]||'',editEmpTeam[_0x194be6(0x24d)]=_0x478026[_0x194be6(0x19c)]||'',editError['textContent']='',editEmployeeModal[_0x194be6(0x237)]['remove'](_0x194be6(0x22c));}function closeEditModal(){const _0x5eb335=_0xd2e353;editEmployeeModal[_0x5eb335(0x237)][_0x5eb335(0x148)](_0x5eb335(0x22c)),currentEditingDocId=null;}async function saveEmployeeChanges(){const _0x15794c=_0xd2e353;if(!currentEditingDocId)return;const _0x249bd3=editEmpManager[_0x15794c(0x24d)],_0x9e0bf0=editEmpTeam[_0x15794c(0x24d)];editError[_0x15794c(0x11a)]='',saveEditModalButton[_0x15794c(0x21d)]=!![];try{const _0x49de21=doc(db,'crsg',currentEditingDocId);await updateDoc(_0x49de21,{'Check_Manager':_0x249bd3,'Check_Place':_0x9e0bf0}),console[_0x15794c(0x177)](_0x15794c(0x1f8)),closeEditModal();}catch(_0x46cf7f){console['error'](_0x15794c(0x12d),_0x46cf7f),editError[_0x15794c(0x11a)]=_0x15794c(0x226)+_0x46cf7f[_0x15794c(0x185)];}finally{saveEditModalButton[_0x15794c(0x21d)]=![];}}function handleSearchEmployee(){const _0x5b6128=_0xd2e353,_0x1cda12=searchEmployeeIdInput['value']['trim']();searchEmployeeError[_0x5b6128(0x11a)]='';if(!_0x1cda12){searchEmployeeError[_0x5b6128(0x11a)]='กรุณาใส่รหัสพนักงาน';return;}const _0x21ffc3=allEmployeesData[_0x5b6128(0x1d9)](_0x85ae58=>_0x85ae58[_0x5b6128(0x182)]===_0x1cda12);_0x21ffc3?showAddMemberModal(_0x21ffc3):searchEmployeeError[_0x5b6128(0x11a)]=_0x5b6128(0x1a9);}function showAddMemberModal(_0x3bbe83){const _0x3d5ce5=_0xd2e353;currentAddingDocId=_0x3bbe83['id'],addMemberError[_0x3d5ce5(0x11a)]='',addMemberEmpId[_0x3d5ce5(0x11a)]=_0x3bbe83['employeeId']||_0x3d5ce5(0x15e),addMemberEmpName['textContent']=_0x3bbe83[_0x3d5ce5(0x17f)]||_0x3d5ce5(0x15e),addMemberEmpBU[_0x3d5ce5(0x11a)]=_0x3bbe83[_0x3d5ce5(0x22a)]||_0x3d5ce5(0x15e),addMemberManagerSelect[_0x3d5ce5(0x24a)]='';const _0x3df676=document[_0x3d5ce5(0x131)](_0x3d5ce5(0x1b3));_0x3df676['value']='',_0x3df676[_0x3d5ce5(0x11a)]='--\x20ไม่ระบุสังกัด\x20--',addMemberManagerSelect[_0x3d5ce5(0x136)](_0x3df676);const _0x52a132=new Set(allEmployeesData[_0x3d5ce5(0x1a1)](_0x1283d7=>_0x1283d7['Check_Manager'])[_0x3d5ce5(0x1de)](Boolean)),_0x352a0e=Array[_0x3d5ce5(0x16a)](_0x52a132)[_0x3d5ce5(0x15c)]();_0x352a0e[_0x3d5ce5(0x1dd)](_0x26c1d1=>{const _0x35597a=_0x3d5ce5,_0x1c31e2=document['createElement']('option');_0x1c31e2[_0x35597a(0x24d)]=_0x26c1d1,_0x1c31e2[_0x35597a(0x11a)]=_0x26c1d1,addMemberManagerSelect[_0x35597a(0x136)](_0x1c31e2);}),addMemberManagerSelect[_0x3d5ce5(0x24d)]=_0x3bbe83[_0x3d5ce5(0x15a)]||'',addMemberTeamSelect[_0x3d5ce5(0x24a)]='';const _0x53ce3b=document[_0x3d5ce5(0x131)]('option');_0x53ce3b[_0x3d5ce5(0x24d)]='',_0x53ce3b['textContent']=_0x3d5ce5(0x122),addMemberTeamSelect[_0x3d5ce5(0x136)](_0x53ce3b),teamNames['forEach'](_0x4af389=>{const _0x96894d=_0x3d5ce5,_0x160fee=document[_0x96894d(0x131)](_0x96894d(0x1b3));_0x160fee['value']=_0x4af389,_0x160fee[_0x96894d(0x11a)]=_0x4af389,addMemberTeamSelect[_0x96894d(0x136)](_0x160fee);}),addMemberTeamSelect[_0x3d5ce5(0x24d)]=_0x3bbe83[_0x3d5ce5(0x19c)]||'',addMemberModal[_0x3d5ce5(0x237)][_0x3d5ce5(0x204)](_0x3d5ce5(0x22c));}function closeAddMemberModal(){const _0x1ff075=_0xd2e353;addMemberModal['classList'][_0x1ff075(0x148)](_0x1ff075(0x22c)),currentAddingDocId=null,searchEmployeeIdInput['value']='',searchEmployeeError[_0x1ff075(0x11a)]='';}async function saveAddMemberChanges(){const _0x18b2b3=_0xd2e353;if(!currentAddingDocId)return;const _0x4dfaf1=addMemberManagerSelect[_0x18b2b3(0x24d)],_0xed085f=addMemberTeamSelect['value'];addMemberError[_0x18b2b3(0x11a)]='',saveAddMemberModalButton[_0x18b2b3(0x21d)]=!![],closeAddMemberModalButton['disabled']=!![];try{const _0x446913=doc(db,_0x18b2b3(0x21c),currentAddingDocId);await updateDoc(_0x446913,{'Check_Manager':_0x4dfaf1,'Check_Place':_0xed085f}),console[_0x18b2b3(0x177)](_0x18b2b3(0x24f)),closeAddMemberModal();}catch(_0x4b7222){console[_0x18b2b3(0x1e3)](_0x18b2b3(0x12d),_0x4b7222),addMemberError['textContent']=_0x18b2b3(0x226)+_0x4b7222['message'];}finally{saveAddMemberModalButton[_0x18b2b3(0x21d)]=![],closeAddMemberModalButton[_0x18b2b3(0x21d)]=![];}}function setupAddMemberModalListeners(){const _0x3fd142=_0xd2e353;searchEmployeeButton[_0x3fd142(0x16f)](_0x3fd142(0x1f9),handleSearchEmployee),closeAddMemberModalButton[_0x3fd142(0x16f)](_0x3fd142(0x1f9),closeAddMemberModal),saveAddMemberModalButton[_0x3fd142(0x16f)]('click',saveAddMemberChanges);}
        
    </script>
</body>
</html>

