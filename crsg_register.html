<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRSG Summit 2025</title>
    <!-- โหลด Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .input-error {
            border-color: #EF4444 !important; /* red-500 */
            border-width: 2px !important;
        }
        /* Animation for showing inputs */
        .fade-in-down {
            animation: fadeInDown 0.3s ease-out forwards;
        }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Custom class สำหรับสถานะ Active (สีน้ำเงิน) ของ OTP */
        .otp-active {
            background-color: #0056ff !important;
            color: white !important;
            border-color: #0056ff !important;
        }
        /* (เพิ่ม) Custom class สำหรับสถานะ Active (สีส้ม) ของ Nickname */
        .nickname-active {
            background-color: #f97316 !important; /* Orange-500 */
            color: white !important;
            border-color: #f97316 !important;
        }
        /* ปรับสี Placeholder ตอนเป็นสีส้มให้อ่านง่ายขึ้น */
        .nickname-active::placeholder {
            color: #ffedd5;
        }
    </style>
</head>
<!-- (แก้ไข) ปรับตำแหน่งให้ห่างจากด้านบน 15% (pt-[15vh]) -->
<body class="bg-white flex flex-col items-center justify-start min-h-screen pt-[10vh] pb-10" style="background-color: #dee1e1;">

    <!-- กล่องลงทะเบียน -->
    <div id="registrationFormContainer" class="w-[95%] max-w-md p-8 space-y-6 bg-gray-50 rounded-lg shadow-md transition-colors duration-300">
        <h1 class="text-2xl font-bold text-center text-gray-900"><center><img src="./images/crsg.png" style="width:120%"></center></h1>
        <p id="eventDate" class="text-sm font-medium text-gray-700 text-center" style="margin: -10px auto 40px auto;">วันที่ 24 พฤศจิกายน 2568</p>
              
        <!-- ส่วนแสดงข้อมูลพนักงาน (ซ่อนไว้ตอนเริ่ม) -->
        <div id="employeeInfoDisplay" class="hidden text-center space-y-2 py-4">
            <p id="infoFullName" class="text-lg font-bold text-gray-900"></p>
            <p id="infoPosition" class="text-sm text-gray-700 hidden"></p>
            <p id="infoDepartment" class="text-sm text-gray-700 hidden"></p>
            <p id="infoBU" class="text-sm text-gray-700"></p>
        </div>

        <!-- ฟอร์มลงทะเบียน -->
        <form id="registrationForm" class="space-y-6" onsubmit="return false;"> <!-- Prevent default submit -->
            <div>
                <!-- 5 Input Boxes -->
                <div class="flex justify-center gap-2" id="otp-container">
                    <input type="tel" maxlength="1" class="otp-input w-12 h-14 text-center text-3xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" data-index="0">
                    <input type="tel" maxlength="1" class="otp-input w-12 h-14 text-center text-3xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" data-index="1">
                    <input type="tel" maxlength="1" class="otp-input w-12 h-14 text-center text-3xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" data-index="2">
                    <input type="tel" maxlength="1" class="otp-input w-12 h-14 text-center text-3xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" data-index="3">
                    <input type="tel" maxlength="1" class="otp-input w-12 h-14 text-center text-3xl font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" data-index="4">
                </div>
                
                <p class="block text-sm font-medium text-gray-700 mt-3 text-center">กรอกรหัสพนักงานของท่าน</p>

                <!-- Loading Indicator -->
                <p id="checkingIdIndicator" class="hidden text-center text-xs text-blue-600 mt-2">กำลังตรวจสอบ...</p>
            </div>
            
            <!-- Nickname Container -->
            <div id="nicknameContainer" class="hidden flex flex-col items-center fade-in-down">
                <input type="text" id="nickname" name="nickname" 
                       class="w-1/2 px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-center transition-colors duration-150" 
                       placeholder="ชื่อเล่น">
                
                <label for="nickname" class="block text-sm font-medium text-gray-700 mt-2 text-center">กรอกชื่อเล่นของคุณ ก่อนลงทะเบียน</label>
            </div>
            
            <!-- ปุ่ม Disabled ไว้ก่อน, กว้าง 70%, จัดกึ่งกลาง, สีพื้นหลัง #002d63 -->
            <button type="button" id="registerButton" disabled
                    class="block mx-auto w-[70%] px-4 py-2 font-medium text-white bg-[#002d63] rounded-md hover:bg-opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out disabled:bg-gray-400 disabled:cursor-not-allowed">
                ลงทะเบียน
            </button>
        </form>
        
        <!-- พื้นที่แสดงข้อความ --><div id="message" class="text-center text-sm"></div>

        <div id="teamDisplay" class="hidden text-center border-t pt-4 mt-4">
            <h2 id="teamNameDisplay" class="text-8xl font-bold text-[#0056ff]"></h2> 
            <p class="text-sm font-medium text-gray-700 mt-1">ทีมของคุณ</p>
            
            <p id="registrationStatusMessage" class="text-sm mt-4"></p>
            <p id="registrationTimestamp" class="text-xs text-gray-500"></p>
        </div>
    </div>

    <!-- ส่วนแสดงสมาชิกในทีม -->
    <div id="teamMembersDisplay" class="hidden w-[95%] max-w-4xl p-6 bg-white rounded-lg shadow-md mt-8">
        <div class="flex flex-col md:flex-row justify-between md:items-center mb-4 gap-3">
            <h3 id="teamMembersHeader" class="text-lg font-semibold text-gray-800">สมาชิกทีม : ...</h3>
            <div class="flex items-center gap-4">
                <div>
                    <label for="teamSelect" class="text-sm font-medium mr-2">เลือกทีม:</label>
                    <select id="teamSelect" class="rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm py-2 px-3">
                        <!-- Options will be populated by JS -->
                    </select>
                </div>
                <span id="teamMembersCount" class="text-sm font-medium text-gray-600">สมาชิก ... คน</span>
            </div>
        </div>
        <div class="overflow-x-auto border rounded-lg">
            <table class="min-w-full text-sm">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สังกัด</th>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th>
                    </tr>
                </thead>
                <tbody id="teamMembersTableBody" class="bg-white divide-y divide-gray-200">
                    <!-- Data will be populated by JS -->
                </tbody>
            </table>
        </div>
    </div>


    <!-- Firebase SDK และการเชื่อมต่อ --><script type="module">
const _0x466658=_0x579f;(function(_0x4cd909,_0x5e2f08){const _0xb42b57=_0x579f,_0x249537=_0x4cd909();while(!![]){try{const _0x3461c4=-parseInt(_0xb42b57(0x1a3))/0x1+parseInt(_0xb42b57(0x179))/0x2+-parseInt(_0xb42b57(0x1c9))/0x3+parseInt(_0xb42b57(0x1d4))/0x4+-parseInt(_0xb42b57(0x1d0))/0x5*(parseInt(_0xb42b57(0x1ac))/0x6)+-parseInt(_0xb42b57(0x1d7))/0x7+parseInt(_0xb42b57(0x1dd))/0x8*(parseInt(_0xb42b57(0x1cd))/0x9);if(_0x3461c4===_0x5e2f08)break;else _0x249537['push'](_0x249537['shift']());}catch(_0x4560df){_0x249537['push'](_0x249537['shift']());}}}(_0x2d6a,0xbbcad));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getFirestore,collection,getDocs,query,where,serverTimestamp,setLogLevel,limit,doc,updateDoc}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';function _0x579f(_0x3872d4,_0x439d3d){const _0x2d6af0=_0x2d6a();return _0x579f=function(_0x579f45,_0x52e586){_0x579f45=_0x579f45-0x167;let _0xa17edc=_0x2d6af0[_0x579f45];return _0xa17edc;},_0x579f(_0x3872d4,_0x439d3d);}const firebaseConfig={'apiKey':'AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','authDomain':_0x466658(0x195),'databaseURL':_0x466658(0x19c),'projectId':_0x466658(0x1d5),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':'1070273157855','appId':_0x466658(0x18e),'measurementId':'G-9DJLWJ5LQ1'},teamNames=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','AA','BB','CC','DD','EE','FF','GG','HH','II','JJ','KK','LL','MM','NN','OO','PP','QQ'];let db,auth,currentEmployeeData=null;const registrationFormContainer=document[_0x466658(0x1da)]('registrationFormContainer'),otpInputs=document[_0x466658(0x1aa)]('.otp-input'),checkingIdIndicator=document[_0x466658(0x1da)](_0x466658(0x1a6)),nicknameContainer=document[_0x466658(0x1da)](_0x466658(0x199)),nicknameInput=document[_0x466658(0x1da)]('nickname'),registerButton=document['getElementById'](_0x466658(0x19d)),messageDiv=document['getElementById'](_0x466658(0x19b)),teamDisplay=document[_0x466658(0x1da)](_0x466658(0x1d8)),teamNameDisplay=document['getElementById'](_0x466658(0x1ba)),regStatusMsg=document[_0x466658(0x1da)](_0x466658(0x1ce)),regTimestamp=document['getElementById'](_0x466658(0x1ad)),eventDate=document[_0x466658(0x1da)]('eventDate'),eventImageContainer=document['getElementById'](_0x466658(0x1b3)),registrationForm=document[_0x466658(0x1da)](_0x466658(0x190)),employeeInfoDisplay=document[_0x466658(0x1da)](_0x466658(0x1a2)),infoFullName=document[_0x466658(0x1da)](_0x466658(0x184)),infoPosition=document[_0x466658(0x1da)]('infoPosition'),infoDepartment=document[_0x466658(0x1da)](_0x466658(0x1d6)),infoBU=document[_0x466658(0x1da)](_0x466658(0x1ca)),teamMembersDisplay=document[_0x466658(0x1da)](_0x466658(0x1d1)),teamMembersHeader=document[_0x466658(0x1da)](_0x466658(0x175)),teamMembersCount=document['getElementById'](_0x466658(0x1a1)),teamMembersTableBody=document[_0x466658(0x1da)](_0x466658(0x189)),teamSelect=document[_0x466658(0x1da)](_0x466658(0x18a));try{const app=initializeApp(firebaseConfig);db=getFirestore(app),auth=getAuth(app),setLogLevel(_0x466658(0x188)),await signInAnonymously(auth),console[_0x466658(0x181)](_0x466658(0x1b9)),populateTeamDropdown(),setupOtpInputs(),otpInputs[0x0]['focus']();}catch(_0x40332b){console[_0x466658(0x1c6)](_0x466658(0x1c3),_0x40332b),document[_0x466658(0x1da)](_0x466658(0x19b))['textContent']=_0x466658(0x186)+_0x40332b['message'];}registerButton[_0x466658(0x16e)]('click',handleRegisterClick),teamSelect[_0x466658(0x16e)]('change',()=>{const _0x23d586=_0x466658,_0x5bce8a=teamSelect[_0x23d586(0x1b5)];fetchAndDisplayTeamMembers(_0x5bce8a);}),nicknameInput['addEventListener'](_0x466658(0x1ab),()=>{const _0x553f01=_0x466658;nicknameInput[_0x553f01(0x1b5)][_0x553f01(0x1ae)]()!==''?nicknameInput['classList']['add'](_0x553f01(0x173)):nicknameInput[_0x553f01(0x183)][_0x553f01(0x18c)](_0x553f01(0x173)),nicknameInput[_0x553f01(0x1b5)]['trim']()!==''&&currentEmployeeData?(registerButton[_0x553f01(0x1cc)]=![],nicknameInput[_0x553f01(0x183)][_0x553f01(0x18c)](_0x553f01(0x17a))):registerButton[_0x553f01(0x1cc)]=!![];});function formatThaiTimestamp(_0x2c25f5){const _0x35ec53=_0x466658;return _0x2c25f5[_0x35ec53(0x1c2)](_0x35ec53(0x1d9),{'dateStyle':'long','timeStyle':_0x35ec53(0x1b8)});}function populateTeamDropdown(){const _0x279b81=_0x466658;teamSelect[_0x279b81(0x1af)]='',teamNames['forEach'](_0xb37759=>{const _0x258e5c=_0x279b81,_0x5055c7=document[_0x258e5c(0x1db)](_0x258e5c(0x177));_0x5055c7[_0x258e5c(0x1b5)]=_0xb37759,_0x5055c7[_0x258e5c(0x1bf)]=_0xb37759,teamSelect[_0x258e5c(0x16a)](_0x5055c7);});}async function getCrsgDoc(_0x5330a3){const _0x4903af=_0x466658,_0x513590=_0x4903af(0x1a8),_0x346005=query(collection(db,_0x513590),where(_0x4903af(0x16b),'==',_0x5330a3),limit(0x1)),_0x5df4e4=await getDocs(_0x346005);if(_0x5df4e4[_0x4903af(0x197)])return null;const _0x46528e=_0x5df4e4[_0x4903af(0x18f)][0x0];return{'id':_0x46528e['id'],'data':_0x46528e[_0x4903af(0x1bb)]()};}function updateInputStyle(_0x2d193e){const _0x3f53fb=_0x466658;_0x2d193e[_0x3f53fb(0x1b5)]['trim']()!==''?_0x2d193e[_0x3f53fb(0x183)][_0x3f53fb(0x16f)]('otp-active'):_0x2d193e['classList']['remove'](_0x3f53fb(0x172));}function setupOtpInputs(){const _0x7d385f=_0x466658;otpInputs[_0x7d385f(0x178)]((_0x1e03c5,_0x5465f5)=>{const _0x327d93=_0x7d385f;_0x1e03c5['addEventListener'](_0x327d93(0x1ab),_0xa7eee7=>{const _0x18e58f=_0x327d93;updateInputStyle(_0x1e03c5),messageDiv[_0x18e58f(0x1bf)]='',otpInputs[_0x18e58f(0x178)](_0x319e21=>_0x319e21[_0x18e58f(0x183)][_0x18e58f(0x18c)](_0x18e58f(0x17a))),currentEmployeeData&&resetRegistrationState(),_0xa7eee7[_0x18e58f(0x1b6)][_0x18e58f(0x1b5)][_0x18e58f(0x182)]===0x1&&(_0x5465f5<otpInputs[_0x18e58f(0x182)]-0x1&&otpInputs[_0x5465f5+0x1]['focus']()),checkOtpComplete();}),_0x1e03c5[_0x327d93(0x16e)](_0x327d93(0x17f),_0x5e54e7=>{const _0x2b56f1=_0x327d93;_0x5e54e7[_0x2b56f1(0x169)]===_0x2b56f1(0x180)&&!_0x5e54e7['target'][_0x2b56f1(0x1b5)]&&_0x5465f5>0x0&&otpInputs[_0x5465f5-0x1]['focus']();}),_0x1e03c5['addEventListener'](_0x327d93(0x1b2),_0x53e9cf=>{const _0x53de93=_0x327d93;_0x53e9cf[_0x53de93(0x16c)]();const _0x23243c=_0x53e9cf[_0x53de93(0x1d2)][_0x53de93(0x16d)](_0x53de93(0x187))['trim']();if(/^\d+$/[_0x53de93(0x1c7)](_0x23243c)){const _0x31bbc1=_0x23243c[_0x53de93(0x19f)]('');otpInputs['forEach']((_0x1e6b6c,_0x11a748)=>{const _0xcf4a9c=_0x53de93;_0x31bbc1[_0x11a748]&&(_0x1e6b6c[_0xcf4a9c(0x1b5)]=_0x31bbc1[_0x11a748],updateInputStyle(_0x1e6b6c));}),checkOtpComplete();const _0x316d0f=Array[_0x53de93(0x1c0)](otpInputs)['find'](_0xc98fe=>!_0xc98fe[_0x53de93(0x1b5)]);if(_0x316d0f)_0x316d0f[_0x53de93(0x1b1)]();else otpInputs[0x4][_0x53de93(0x1b1)]();}});});}function checkOtpComplete(){const _0x3e0d58=_0x466658,_0x1249c8=Array[_0x3e0d58(0x1c0)](otpInputs)['map'](_0x284e21=>_0x284e21['value'])['join']('');_0x1249c8[_0x3e0d58(0x182)]===0x5?validateEmployeeId(_0x1249c8):resetRegistrationState();}function _0x2d6a(){const _0x196bc6=['12213360rpOtHU','Error\x20logging\x20registration:\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','key','appendChild','employeeId','preventDefault','getData','addEventListener','add','DateLogin','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-green-100\x20text-green-800\x22>ลงทะเบียน</span>','otp-active','nickname-active','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-red-500\x22>เกิดข้อผิดพลาดในการโหลดข้อมูล</td></tr>','teamMembersHeader','text-sm\x20mt-4\x20text-yellow-700\x20font-medium','option','forEach','1517870MzdIum','input-error','เกิดข้อผิดพลาด','ลงทะเบียนเข้าร่วมงานสำเร็จ','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-gray-100\x20text-gray-800\x22>ยังไม่ลงทะเบียน</span>','กำลังโหลด...','keydown','Backspace','log','length','classList','infoFullName','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>กำลังโหลดข้อมูล...</td></tr>','เกิดข้อผิดพลาดในการเชื่อมต่อฐานข้อมูล:\x20','text','Debug','teamMembersTableBody','teamSelect','เกิดข้อผิดพลาดในการตรวจสอบข้อมูล','remove','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-3\x20py-2\x20whitespace-nowrap\x22>','1:1070273157855:web:5c8120e1df27e233d8676a','docs','registrationForm','ลงทะเบียน','hidden','text-sm\x20mt-4\x20text-green-600\x20font-medium','Registration\x20Error:\x20','ttb-register.firebaseapp.com','คุณได้ลงทะเบียนไปแล้วเมื่อ','empty','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nicknameContainer','NickName','message','https://ttb-register-default-rtdb.asia-southeast1.firebasedatabase.app','registerButton','text-center\x20text-sm\x20text-red-600','split','สมาชิกทีม\x20:\x20','teamMembersCount','employeeInfoDisplay','705465gOXZia','sort','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>ไม่พบสมาชิกในทีมนี้</td></tr>','checkingIdIndicator','className','crsg','เกิดข้อผิดพลาด:\x20','querySelectorAll','input','168vBoOpd','registrationTimestamp','trim','innerHTML','Check_Manager','focus','paste','eventImageContainer','FullName_th','value','target','localeCompare','medium','Signed\x20in\x20anonymously','teamNameDisplay','data','text-center\x20text-sm\x20text-red-600\x20mt-2','สังกัด:\x20','กำลังบันทึก...','textContent','from','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-3\x20py-2\x20whitespace-nowrap\x22>','toLocaleString','Firebase\x20initialization\x20failed:','push','BU_eng','error','test','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ลงทะเบียนสำเร็จ\x20(ผู้ร่วมงาน)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>และคุณไม่ได้เป็นผู้เข้าร่วมกิจกรรม\x20(ไม่มีทีม)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>','954627mLPDUd','infoBU','Validation\x20Error:','disabled','9CBgjnc','registrationStatusMessage','Check_Place','5640vexNwa','teamMembersDisplay','clipboardData','Error\x20fetching\x20team\x20members:\x20','2597768PjQKuB','ttb-register','infoDepartment','7774144GhzXNn','teamDisplay','th-TH','getElementById','createElement','ไม่พบข้อมูลสังกัด'];_0x2d6a=function(){return _0x196bc6;};return _0x2d6a();}function resetRegistrationState(){const _0x48587e=_0x466658;currentEmployeeData=null,nicknameContainer[_0x48587e(0x183)]['add'](_0x48587e(0x192)),nicknameInput[_0x48587e(0x1b5)]='',nicknameInput['classList'][_0x48587e(0x18c)]('nickname-active'),registerButton[_0x48587e(0x1cc)]=!![];}async function validateEmployeeId(_0x2e56d6){const _0x5526a8=_0x466658;checkingIdIndicator['classList']['remove']('hidden'),otpInputs[_0x5526a8(0x178)](_0x3c9452=>_0x3c9452['disabled']=!![]);try{const _0x4a8650=await getCrsgDoc(_0x2e56d6);_0x4a8650?(currentEmployeeData=_0x4a8650,nicknameContainer[_0x5526a8(0x183)][_0x5526a8(0x18c)]('hidden'),messageDiv['textContent']='',setTimeout(()=>nicknameInput[_0x5526a8(0x1b1)](),0x12c)):(messageDiv[_0x5526a8(0x1bf)]='ไม่พบรหัสพนักงานนี้ในระบบ',messageDiv['className']=_0x5526a8(0x1bc),otpInputs[_0x5526a8(0x178)](_0x41294f=>{const _0x6e26a8=_0x5526a8;_0x41294f[_0x6e26a8(0x1b5)]='',_0x41294f[_0x6e26a8(0x183)]['remove'](_0x6e26a8(0x172)),_0x41294f[_0x6e26a8(0x183)]['add'](_0x6e26a8(0x17a)),_0x41294f[_0x6e26a8(0x1cc)]=![];}),registerButton[_0x5526a8(0x1cc)]=!![],setTimeout(()=>otpInputs[0x0][_0x5526a8(0x1b1)](),0x64));}catch(_0x319107){console[_0x5526a8(0x1c6)](_0x5526a8(0x1cb),_0x319107),messageDiv[_0x5526a8(0x1bf)]=_0x5526a8(0x18b),messageDiv['className']=_0x5526a8(0x1bc),otpInputs['forEach'](_0x343992=>_0x343992[_0x5526a8(0x1cc)]=![]);}finally{checkingIdIndicator[_0x5526a8(0x183)][_0x5526a8(0x16f)]('hidden'),currentEmployeeData&&otpInputs[_0x5526a8(0x178)](_0x57cfdd=>_0x57cfdd['disabled']=![]);}}async function handleRegisterClick(){const _0xd6054a=_0x466658,_0x3cd720=nicknameInput['value'][_0xd6054a(0x1ae)]();if(!currentEmployeeData||!_0x3cd720)return;registerButton[_0xd6054a(0x1cc)]=!![],registerButton[_0xd6054a(0x1bf)]=_0xd6054a(0x1be),otpInputs[_0xd6054a(0x178)](_0x258e37=>_0x258e37[_0xd6054a(0x1cc)]=!![]),nicknameInput['disabled']=!![];const _0x34e812=currentEmployeeData[_0xd6054a(0x1bb)],_0x3db832=currentEmployeeData['id'],_0x508b26=_0x34e812[_0xd6054a(0x1cf)]||'ไม่พบข้อมูลที่นั่ง',_0x50809b=_0x508b26==='ไม่พบข้อมูลที่นั่ง';try{if(_0x34e812[_0xd6054a(0x170)]){const _0x93aa9d=_0x34e812[_0xd6054a(0x170)]['toDate']();if(_0x50809b){messageDiv[_0xd6054a(0x1af)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>คุณได้ลงทะเบียนไปแล้ว</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>และไม่ได้เป็นผู้เข้าร่วมกิจกรรม\x20(ผู้ร่วมงาน)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>'+formatThaiTimestamp(_0x93aa9d)+_0xd6054a(0x168),messageDiv[_0xd6054a(0x1a7)]=_0xd6054a(0x19e),teamDisplay[_0xd6054a(0x183)][_0xd6054a(0x16f)](_0xd6054a(0x192));const _0x2ecaed=teamNames[0x0]||'A';teamSelect[_0xd6054a(0x1b5)]=_0x2ecaed,fetchAndDisplayTeamMembers(_0x2ecaed);}else teamNameDisplay[_0xd6054a(0x1bf)]=_0x508b26,regStatusMsg[_0xd6054a(0x1bf)]=_0xd6054a(0x196),regStatusMsg[_0xd6054a(0x1a7)]=_0xd6054a(0x176),regTimestamp[_0xd6054a(0x1bf)]=formatThaiTimestamp(_0x93aa9d),teamDisplay[_0xd6054a(0x183)][_0xd6054a(0x18c)](_0xd6054a(0x192)),teamSelect[_0xd6054a(0x1b5)]=_0x508b26,fetchAndDisplayTeamMembers(_0x508b26);await updateDoc(doc(db,_0xd6054a(0x1a8),_0x3db832),{'NickName':_0x3cd720}),showSuccessState(_0x34e812,_0x3cd720);return;}const _0x26bb90=await logRegistration(_0x3db832,_0x3cd720);if(_0x50809b){messageDiv[_0xd6054a(0x1af)]=_0xd6054a(0x1c8)+formatThaiTimestamp(_0x26bb90)+_0xd6054a(0x198),messageDiv['className']=_0xd6054a(0x19e),teamDisplay[_0xd6054a(0x183)]['add']('hidden');const _0x4a41cb=teamNames[0x0]||'A';teamSelect['value']=_0x4a41cb,fetchAndDisplayTeamMembers(_0x4a41cb);}else teamNameDisplay['textContent']=_0x508b26,regStatusMsg['textContent']=_0xd6054a(0x17c),regStatusMsg['className']=_0xd6054a(0x193),regTimestamp[_0xd6054a(0x1bf)]=formatThaiTimestamp(_0x26bb90),teamDisplay[_0xd6054a(0x183)][_0xd6054a(0x18c)](_0xd6054a(0x192)),teamSelect['value']=_0x508b26,fetchAndDisplayTeamMembers(_0x508b26);showSuccessState(_0x34e812,_0x3cd720);}catch(_0x42818e){console[_0xd6054a(0x1c6)](_0xd6054a(0x194),_0x42818e),messageDiv['textContent']=_0xd6054a(0x1a9)+_0x42818e[_0xd6054a(0x19b)],messageDiv[_0xd6054a(0x1a7)]='text-center\x20text-sm\x20text-red-600',registerButton['disabled']=![],registerButton[_0xd6054a(0x1bf)]=_0xd6054a(0x191),otpInputs[_0xd6054a(0x178)](_0x15ec29=>_0x15ec29[_0xd6054a(0x1cc)]=![]),nicknameInput[_0xd6054a(0x1cc)]=![];}}function showSuccessState(_0x19c1fa,_0x14f3b6){const _0x456d8b=_0x466658;registrationForm[_0x456d8b(0x183)][_0x456d8b(0x16f)](_0x456d8b(0x192)),eventDate[_0x456d8b(0x183)][_0x456d8b(0x16f)](_0x456d8b(0x192)),eventImageContainer[_0x456d8b(0x183)][_0x456d8b(0x16f)](_0x456d8b(0x192)),infoFullName[_0x456d8b(0x1bf)]=(_0x19c1fa[_0x456d8b(0x1b4)]||'')+'\x20('+(_0x19c1fa[_0x456d8b(0x16b)]||'')+')',infoBU[_0x456d8b(0x1bf)]=_0x456d8b(0x1bd)+(_0x19c1fa[_0x456d8b(0x1c5)]||_0x19c1fa['BU_th']||_0x456d8b(0x1dc)),infoPosition[_0x456d8b(0x183)][_0x456d8b(0x16f)]('hidden'),infoDepartment[_0x456d8b(0x183)]['add'](_0x456d8b(0x192)),employeeInfoDisplay[_0x456d8b(0x183)][_0x456d8b(0x18c)](_0x456d8b(0x192)),teamMembersDisplay['classList'][_0x456d8b(0x18c)](_0x456d8b(0x192));}async function logRegistration(_0x58bfd0,_0x5aa882){const _0x5da4d7=_0x466658,_0x3c6bca=new Date();try{const _0x2fd0f0=doc(db,_0x5da4d7(0x1a8),_0x58bfd0);return await updateDoc(_0x2fd0f0,{'DateLogin':_0x3c6bca,'NickName':_0x5aa882}),console[_0x5da4d7(0x181)]('Registration\x20Logged\x20successfully.'),_0x3c6bca;}catch(_0x164670){console[_0x5da4d7(0x1c6)](_0x5da4d7(0x167),_0x164670);throw _0x164670;}}async function fetchAndDisplayTeamMembers(_0x3848fa){const _0xb87175=_0x466658;if(!_0x3848fa){teamMembersDisplay[_0xb87175(0x183)][_0xb87175(0x16f)](_0xb87175(0x192));return;}teamMembersHeader['textContent']=_0xb87175(0x1a0)+_0x3848fa,teamMembersCount[_0xb87175(0x1bf)]=_0xb87175(0x17e),teamMembersTableBody[_0xb87175(0x1af)]=_0xb87175(0x185);try{const _0x9a77e7='crsg',_0x39e0e4=query(collection(db,_0x9a77e7),where(_0xb87175(0x1cf),'==',_0x3848fa)),_0x3bb593=await getDocs(_0x39e0e4),_0x33393f=[];_0x3bb593[_0xb87175(0x178)](_0x17403c=>{const _0x560bc2=_0xb87175;_0x33393f[_0x560bc2(0x1c4)](_0x17403c[_0x560bc2(0x1bb)]());}),_0x33393f[_0xb87175(0x1a4)]((_0x3e40d7,_0x4fe074)=>(_0x3e40d7[_0xb87175(0x1b4)]||'')[_0xb87175(0x1b7)](_0x4fe074[_0xb87175(0x1b4)]||'')),teamMembersCount['textContent']='สมาชิก\x20'+_0x33393f['length']+'\x20คน';if(_0x33393f['length']===0x0){teamMembersTableBody['innerHTML']=_0xb87175(0x1a5);return;}teamMembersTableBody['innerHTML']='',_0x33393f[_0xb87175(0x178)](_0x45da41=>{const _0x3f6ae4=_0xb87175,_0x58b4bd=!!_0x45da41['DateLogin'],_0x29bb1=_0x58b4bd?_0x3f6ae4(0x171):_0x3f6ae4(0x17d),_0x1dfae4=_0x45da41[_0x3f6ae4(0x19a)]?(_0x45da41[_0x3f6ae4(0x1b4)]||'')+'\x20('+_0x45da41[_0x3f6ae4(0x19a)]+')':_0x45da41[_0x3f6ae4(0x1b4)]||'',_0x1cf0da=document[_0x3f6ae4(0x1db)]('tr');_0x1cf0da['innerHTML']=_0x3f6ae4(0x18d)+_0x1dfae4+_0x3f6ae4(0x1c1)+(_0x45da41[_0x3f6ae4(0x1b0)]||'')+_0x3f6ae4(0x1c1)+_0x29bb1+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',teamMembersTableBody[_0x3f6ae4(0x16a)](_0x1cf0da);});}catch(_0x307796){console[_0xb87175(0x1c6)](_0xb87175(0x1d3),_0x307796),teamMembersTableBody[_0xb87175(0x1af)]=_0xb87175(0x174),teamMembersCount[_0xb87175(0x1bf)]=_0xb87175(0x17b);}}
        
    </script>
</body>
</html>