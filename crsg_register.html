<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ลงทะเบียนพนักงาน</title>
    <!-- โหลด Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<!-- (แก้ไข) ปรับ margin-top (pt-8 = 2rem) -->
<body class="bg-white flex flex-col items-center justify-center min-h-screen pt-8 pb-10" style="background-color: #dee1e1;">

    <!-- กล่องลงทะเบียน -->
    <div id="registrationFormContainer" class="w-[95%] max-w-md p-8 space-y-6 bg-gray-50 rounded-lg shadow-md transition-colors duration-300">
        <h1 class="text-2xl font-bold text-center text-gray-900">CRSG Summit 2025</h1>
        <!-- *** แก้ไข: เพิ่ม id="eventDate" *** -->
        <p id="eventDate" class="text-sm font-medium text-gray-700 text-center" style="margin-top: 2px;">วันที่ 24 พฤศจิกายน 2568</p>

        <!-- *** แก้ไข: เพิ่ม id="eventImageContainer" *** -->
        <div id="eventImageContainer" class="mt-6 w-[70%] mx-auto">
            <img src="./images/crsg.png">
        </div>  
              
        <!-- *** เพิ่ม: ส่วนแสดงข้อมูลพนักงาน (ซ่อนไว้ตอนเริ่ม) *** -->
        <div id="employeeInfoDisplay" class="hidden text-center space-y-2 py-4">
            <p id="infoFullName" class="text-lg font-bold text-gray-900"></p>
            <p id="infoPosition" class="text-sm text-gray-700"></p>
            <p id="infoDepartment" class="text-sm text-gray-700"></p>
            <p id="infoBU" class="text-sm text-gray-700"></p>
        </div>

        <!-- ฟอร์มลงทะเบียน -->
        <form id="registrationForm" class="space-y-4">
            <div>
                <label for="employeeId" class="block text-sm font-medium text-gray-700">รหัสพนักงาน</label>
                <input type="text" id="employeeId" name="employeeId" required
                       class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition-colors duration-150">
            </div>
            
            <div>
                <!-- (แก้ไข) เปลี่ยน "ชื่อ - นามสกุล" เป็น "ชื่อเล่นของคุณ" -->
                <label for="nickname" class="block text-sm font-medium text-gray-700">ชื่อเล่นของคุณ</label>
                <!-- (แก้ไข) เปลี่ยน id และ name -->
                <input type="text" id="nickname" name="nickname" required
                       class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition-colors duration-150">
            </div>
            
            <button type="button" id="registerButton"
                    class="w-full px-4 py-2 font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out disabled:bg-gray-400">
                ลงทะเบียน
            </button>
        </form>
        
        <!-- พื้นที่แสดงข้อความ (สำหรับข้อผิดพลาดหลัก) --><div id="message" class="text-center text-sm"></div>

        <div id="teamDisplay" class="hidden text-center border-t pt-4 mt-4">
            <h2 id="teamNameDisplay" class="text-8xl font-bold text-[#0056ff]"></h2> 
            <p class="text-sm font-medium text-gray-700 mt-1">ทีมของคุณ</p>
            
            <p id="registrationStatusMessage" class="text-sm mt-4"></p>
            <p id="registrationTimestamp" class="text-xs text-gray-500"></p>
        </div>
    </div>

    <!-- (เพิ่ม) ส่วนแสดงสมาชิกในทีม (ซ่อนไว้ตอนเริ่ม) -->
    <!-- (แก้ไข) ปรับ margin-top (mt-8 = 2rem) -->
    <div id="teamMembersDisplay" class="hidden w-[95%] max-w-4xl p-6 bg-white rounded-lg shadow-md mt-8">
        <div class="flex justify-between items-center mb-4">
            <h3 id="teamMembersHeader" class="text-lg font-semibold text-gray-800">สมาชิกทีม : ...</h3>
            <span id="teamMembersCount" class="text-sm font-medium text-gray-600">สมาชิก ... คน</span>
        </div>
        <div class="overflow-x-auto border rounded-lg">
            <table class="min-w-full text-sm">
                <!-- (แก้ไข) ปรับปรุงหัวตาราง -->
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สังกัด</th>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th>
                    </tr>
                </thead>
                <tbody id="teamMembersTableBody" class="bg-white divide-y divide-gray-200">
                    <!-- Data will be populated by JS -->
                </tbody>
            </table>
        </div>
    </div>


    <!-- Firebase SDK และการเชื่อมต่อ --><script type="module">
        // นำเข้า Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, getDocs, query, where, serverTimestamp, setLogLevel, limit, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"; 

        // --- *** ข้อสำคัญ: สำหรับแก้ไข "Missing or insufficient permissions." *** ---
        // (ส่วนนี้เหมือนเดิม)
        // ... (Security Rules comment block) ...
        // --- *************************************************************** ---
const _0x18329d=_0x512f;(function(_0x556c0f,_0x2960c9){const _0x50e068=_0x512f,_0x10a4a7=_0x556c0f();while(!![]){try{const _0xa5a244=-parseInt(_0x50e068(0x166))/0x1+-parseInt(_0x50e068(0x179))/0x2+parseInt(_0x50e068(0x1ab))/0x3+parseInt(_0x50e068(0x174))/0x4+parseInt(_0x50e068(0x1b0))/0x5*(-parseInt(_0x50e068(0x19a))/0x6)+-parseInt(_0x50e068(0x177))/0x7+parseInt(_0x50e068(0x176))/0x8;if(_0xa5a244===_0x2960c9)break;else _0x10a4a7['push'](_0x10a4a7['shift']());}catch(_0x26f790){_0x10a4a7['push'](_0x10a4a7['shift']());}}}(_0x28e9,0xc9dc3));const firebaseConfig={'apiKey':_0x18329d(0x199),'authDomain':_0x18329d(0x165),'databaseURL':_0x18329d(0x1a2),'projectId':_0x18329d(0x185),'storageBucket':_0x18329d(0x183),'messagingSenderId':_0x18329d(0x19c),'appId':_0x18329d(0x19f),'measurementId':'G-9DJLWJ5LQ1'};let db,auth;function _0x512f(_0x42ad79,_0xb75daf){const _0x28e9cd=_0x28e9();return _0x512f=function(_0x512f2b,_0x51bf12){_0x512f2b=_0x512f2b-0x15c;let _0xe20a8e=_0x28e9cd[_0x512f2b];return _0xe20a8e;},_0x512f(_0x42ad79,_0xb75daf);}try{const app=initializeApp(firebaseConfig);db=getFirestore(app),auth=getAuth(app),setLogLevel(_0x18329d(0x1a8)),await signInAnonymously(auth),console['log']('Signed\x20in\x20anonymously');}catch(_0x4ea385){console[_0x18329d(0x195)](_0x18329d(0x1b8),_0x4ea385),document[_0x18329d(0x1a5)](_0x18329d(0x196))[_0x18329d(0x1bb)]=_0x18329d(0x168)+_0x4ea385[_0x18329d(0x196)];}const registrationFormContainer=document['getElementById'](_0x18329d(0x198)),employeeIdInput=document[_0x18329d(0x1a5)]('employeeId'),nicknameInput=document[_0x18329d(0x1a5)](_0x18329d(0x18d)),registerButton=document[_0x18329d(0x1a5)](_0x18329d(0x190)),messageDiv=document[_0x18329d(0x1a5)](_0x18329d(0x196)),teamDisplay=document['getElementById'](_0x18329d(0x1b2)),teamNameDisplay=document[_0x18329d(0x1a5)](_0x18329d(0x172)),regStatusMsg=document[_0x18329d(0x1a5)](_0x18329d(0x1c5)),regTimestamp=document[_0x18329d(0x1a5)](_0x18329d(0x1ad)),eventDate=document[_0x18329d(0x1a5)]('eventDate'),eventImageContainer=document[_0x18329d(0x1a5)](_0x18329d(0x17f)),registrationForm=document['getElementById'](_0x18329d(0x1bf)),employeeInfoDisplay=document[_0x18329d(0x1a5)](_0x18329d(0x163)),infoFullName=document[_0x18329d(0x1a5)](_0x18329d(0x18f)),infoPosition=document['getElementById'](_0x18329d(0x19d)),infoDepartment=document['getElementById'](_0x18329d(0x1c0)),infoBU=document['getElementById'](_0x18329d(0x19e)),teamMembersDisplay=document[_0x18329d(0x1a5)](_0x18329d(0x189)),teamMembersHeader=document['getElementById'](_0x18329d(0x1c4)),teamMembersCount=document[_0x18329d(0x1a5)](_0x18329d(0x17b)),teamMembersTableBody=document[_0x18329d(0x1a5)]('teamMembersTableBody');function _0x28e9(){const _0x3ef374=['infoDepartment','กรุณากรอกข้อมูลให้ครบถ้วน','sort','click','teamMembersHeader','registrationStatusMessage','classList','FullName_th','trim','crsg','localeCompare','value','disabled','employeeInfoDisplay','className','ttb-register.firebaseapp.com','188550RACCOB','Error\x20logging\x20registration:\x20','เกิดข้อผิดพลาดในการเชื่อมต่อฐานข้อมูล:\x20','Check_Place','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-red-500\x22>เกิดข้อผิดพลาดในการโหลดข้อมูล</td></tr>','ไม่พบข้อมูลที่นั่ง','add','innerHTML','DateLogin','สมาชิกทีม\x20:\x20','forEach','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>คุณได้ลงทะเบียนไปแล้ว</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>และไม่ได้เป็นผู้เข้าร่วมกิจกรรม\x20(ผู้ร่วมงาน)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>','teamNameDisplay','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-3\x20py-2\x20whitespace-nowrap\x22>','1007832ytoPEj','employeeId','7244648DWikkP','3658046IMFMKe','medium','800000tzkINB','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>กำลังโหลดข้อมูล...</td></tr>','teamMembersCount','Department_th','hidden','เกิดข้อผิดพลาด','eventImageContainer','empty','data','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-bold\x20text-red-700\x22>เกิดข้อผิดพลาด:\x20ไม่มีสิทธิ์\x20(Missing\x20or\x20insufficient\x20permissions)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mt-2\x20text-sm\x20text-gray-700\x22>ปัญหานี้เกิดจาก\x20Security\x20Rules\x20ใน\x20Firebase\x20ของคุณ</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mt-1\x20text-sm\x20text-gray-700\x22>กรุณาดู\x20<strong\x20class=\x22text-black\x22>\x22ข้อสำคัญ\x22</strong>\x20ในคอมเมนต์\x20(หมายเหตุ)\x20ในไฟล์นี้</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mt-1\x20text-sm\x20text-gray-700\x22>ซึ่งอยู่ที่ประมาณบรรทัดที่\x20113\x20เพื่อดูวิธีแก้ไขครับ</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ttb-register.firebasestorage.app','ไม่พบรหัสพนักงานนี้ในระบบ','ttb-register','ไม่พบข้อมูลตำแหน่ง','Error\x20fetching\x20team\x20members:\x20','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>ไม่พบสมาชิกในทีมนี้</td></tr>','teamMembersDisplay','สมาชิก\x20','border-red-500','remove','nickname','toLocaleString','infoFullName','registerButton','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-gray-100\x20text-gray-800\x22>ยังไม่ลงทะเบียน</span>','permissions','addEventListener','error','message','คุณได้ลงทะเบียนไปแล้วเมื่อ','registrationFormContainer','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','102zGxnxk','docs','1070273157855','infoPosition','infoBU','1:1070273157855:web:5c8120e1df27e233d8676a','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ไม่พบข้อมูล\x20BU','https://ttb-register-default-rtdb.asia-southeast1.firebasedatabase.app','text-center\x20text-sm\x20text-red-600','NickName','getElementById','กำลังตรวจสอบ...','เกิดข้อผิดพลาด:\x20','Debug','appendChild','BU_th','2408748FWFYmn','log','registrationTimestamp','ลงทะเบียนเรียบร้อย','length','6620ZdkPeI','กำลังโหลด...','teamDisplay','Position_th','Registration\x20Logged\x20successfully.','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','long','push','Firebase\x20initialization\x20failed:','ไม่พบข้อมูลแผนก','createElement','textContent','bg-gray-100','Check_Manager','ลงทะเบียน','registrationForm'];_0x28e9=function(){return _0x3ef374;};return _0x28e9();}registerButton[_0x18329d(0x194)](_0x18329d(0x1c3),handleRegisterCheck);function formatThaiTimestamp(_0x37853c){const _0x5846c9=_0x18329d;return _0x37853c[_0x5846c9(0x18e)]('th-TH',{'dateStyle':_0x5846c9(0x1b6),'timeStyle':_0x5846c9(0x178)});}async function getCrsgDoc(_0x524cbf){const _0x46da82=_0x18329d,_0x579b96=_0x46da82(0x15f),_0x237d3c=query(collection(db,_0x579b96),where(_0x46da82(0x175),'==',_0x524cbf)),_0x188f4c=await getDocs(_0x237d3c);if(_0x188f4c[_0x46da82(0x180)])return null;const _0x120adb=_0x188f4c[_0x46da82(0x19b)][0x0];return{'id':_0x120adb['id'],'data':_0x120adb['data']()};}async function handleRegisterCheck(){const _0x3aef27=_0x18329d,_0x1a7107=employeeIdInput[_0x3aef27(0x161)][_0x3aef27(0x15e)](),_0xd8e4f3=nicknameInput[_0x3aef27(0x161)]['trim']();employeeIdInput[_0x3aef27(0x15c)][_0x3aef27(0x18c)]('border-red-500'),nicknameInput[_0x3aef27(0x15c)][_0x3aef27(0x18c)](_0x3aef27(0x18b));if(!_0x1a7107||!_0xd8e4f3){messageDiv[_0x3aef27(0x1bb)]=_0x3aef27(0x1c1),messageDiv[_0x3aef27(0x164)]=_0x3aef27(0x1a3);!_0x1a7107&&employeeIdInput[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x18b));!_0xd8e4f3&&nicknameInput['classList'][_0x3aef27(0x16c)](_0x3aef27(0x18b));return;}registerButton[_0x3aef27(0x162)]=!![],registerButton[_0x3aef27(0x1bb)]=_0x3aef27(0x1a6),employeeIdInput[_0x3aef27(0x162)]=!![],nicknameInput[_0x3aef27(0x162)]=!![],employeeIdInput[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x1bc)),nicknameInput[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x1bc)),messageDiv['textContent']='';try{const _0x115a8b=await getCrsgDoc(_0x1a7107);if(!_0x115a8b){messageDiv[_0x3aef27(0x1bb)]=_0x3aef27(0x184),messageDiv[_0x3aef27(0x164)]=_0x3aef27(0x1a3),registerButton['disabled']=![],registerButton['textContent']=_0x3aef27(0x1be),employeeIdInput[_0x3aef27(0x162)]=![],nicknameInput[_0x3aef27(0x162)]=![],employeeIdInput[_0x3aef27(0x15c)][_0x3aef27(0x18c)]('bg-gray-100'),nicknameInput[_0x3aef27(0x15c)][_0x3aef27(0x18c)]('bg-gray-100'),employeeInfoDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d)),eventDate[_0x3aef27(0x15c)]['remove']('hidden'),eventImageContainer[_0x3aef27(0x15c)]['remove'](_0x3aef27(0x17d)),registrationForm['classList'][_0x3aef27(0x18c)](_0x3aef27(0x17d)),teamMembersDisplay[_0x3aef27(0x15c)]['add'](_0x3aef27(0x17d));return;}const _0x24862e=_0x115a8b[_0x3aef27(0x181)],_0xc3ba81=_0x115a8b['id'],_0x15733a=_0x24862e['Check_Place']||_0x3aef27(0x16b),_0x4c4eb8=_0x15733a==='ไม่พบข้อมูลที่นั่ง';if(_0x24862e[_0x3aef27(0x16e)]){const _0x1a3473=_0x24862e[_0x3aef27(0x16e)]['toDate']();_0x4c4eb8?(messageDiv[_0x3aef27(0x16d)]=_0x3aef27(0x171)+formatThaiTimestamp(_0x1a3473)+_0x3aef27(0x191),messageDiv['className']=_0x3aef27(0x1a3),teamDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d)),teamMembersDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d))):(teamNameDisplay[_0x3aef27(0x1bb)]=_0x15733a,regStatusMsg['textContent']=_0x3aef27(0x197),regStatusMsg[_0x3aef27(0x164)]='text-sm\x20mt-4\x20text-yellow-700\x20font-medium',regTimestamp[_0x3aef27(0x1bb)]=formatThaiTimestamp(_0x1a3473),teamDisplay[_0x3aef27(0x15c)][_0x3aef27(0x18c)]('hidden'),fetchAndDisplayTeamMembers(_0x15733a));registrationForm['classList'][_0x3aef27(0x16c)](_0x3aef27(0x17d)),infoFullName[_0x3aef27(0x1bb)]=(_0x24862e[_0x3aef27(0x15d)]||'')+'\x20('+(_0x24862e[_0x3aef27(0x175)]||'')+')',infoPosition[_0x3aef27(0x1bb)]=_0x24862e[_0x3aef27(0x1b3)]||_0x3aef27(0x186),infoDepartment[_0x3aef27(0x1bb)]=_0x24862e[_0x3aef27(0x17c)]||_0x3aef27(0x1b9),infoBU[_0x3aef27(0x1bb)]=_0x24862e[_0x3aef27(0x1aa)]||_0x3aef27(0x1a1),employeeInfoDisplay['classList'][_0x3aef27(0x18c)](_0x3aef27(0x17d)),registerButton[_0x3aef27(0x1bb)]=_0x3aef27(0x1ae);return;}const _0x3a0e7d=await logRegistration(_0xc3ba81,_0xd8e4f3);_0x4c4eb8?(messageDiv[_0x3aef27(0x16d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ลงทะเบียนสำเร็จ\x20(ผู้ร่วมงาน)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>และคุณไม่ได้เป็นผู้เข้าร่วมกิจกรรม\x20(ไม่มีทีม)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>'+formatThaiTimestamp(_0x3a0e7d)+_0x3aef27(0x1b5),messageDiv[_0x3aef27(0x164)]=_0x3aef27(0x1a3),teamDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d)),teamMembersDisplay[_0x3aef27(0x15c)]['add'](_0x3aef27(0x17d))):(teamNameDisplay[_0x3aef27(0x1bb)]=_0x15733a,regStatusMsg[_0x3aef27(0x1bb)]='ลงทะเบียนเข้าร่วมงานสำเร็จ',regStatusMsg[_0x3aef27(0x164)]='text-sm\x20mt-4\x20text-green-600\x20font-medium',regTimestamp[_0x3aef27(0x1bb)]=formatThaiTimestamp(_0x3a0e7d),teamDisplay[_0x3aef27(0x15c)][_0x3aef27(0x18c)](_0x3aef27(0x17d)),_0x24862e[_0x3aef27(0x1a4)]=_0xd8e4f3,fetchAndDisplayTeamMembers(_0x15733a)),registrationForm[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d)),infoFullName[_0x3aef27(0x1bb)]=(_0x24862e[_0x3aef27(0x15d)]||'')+'\x20('+(_0x24862e['employeeId']||'')+')',infoPosition[_0x3aef27(0x1bb)]=_0x24862e[_0x3aef27(0x1b3)]||_0x3aef27(0x186),infoDepartment[_0x3aef27(0x1bb)]=_0x24862e['Department_th']||_0x3aef27(0x1b9),infoBU[_0x3aef27(0x1bb)]=_0x24862e[_0x3aef27(0x1aa)]||_0x3aef27(0x1a1),employeeInfoDisplay['classList'][_0x3aef27(0x18c)](_0x3aef27(0x17d)),registerButton['textContent']='ลงทะเบียนเรียบร้อย',_0x24862e[_0x3aef27(0x1a4)]=_0xd8e4f3;}catch(_0x44ff44){console[_0x3aef27(0x195)]('Error\x20during\x20registration\x20process:\x20',_0x44ff44),_0x44ff44[_0x3aef27(0x196)]['includes'](_0x3aef27(0x193))?(messageDiv[_0x3aef27(0x16d)]=_0x3aef27(0x182),messageDiv[_0x3aef27(0x164)]='text-center\x20text-sm\x20p-3\x20bg-red-50\x20border\x20border-red-200\x20rounded-md'):(messageDiv['textContent']=_0x3aef27(0x1a7)+_0x44ff44[_0x3aef27(0x196)],messageDiv[_0x3aef27(0x164)]=_0x3aef27(0x1a3)),registerButton[_0x3aef27(0x162)]=![],registerButton[_0x3aef27(0x1bb)]=_0x3aef27(0x1be),teamDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d)),employeeIdInput['disabled']=![],nicknameInput[_0x3aef27(0x162)]=![],employeeIdInput[_0x3aef27(0x15c)]['remove'](_0x3aef27(0x1bc)),nicknameInput['classList'][_0x3aef27(0x18c)](_0x3aef27(0x1bc)),employeeInfoDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d)),eventDate[_0x3aef27(0x15c)]['remove'](_0x3aef27(0x17d)),eventImageContainer[_0x3aef27(0x15c)][_0x3aef27(0x18c)](_0x3aef27(0x17d)),registrationForm[_0x3aef27(0x15c)][_0x3aef27(0x18c)](_0x3aef27(0x17d)),teamMembersDisplay[_0x3aef27(0x15c)][_0x3aef27(0x16c)](_0x3aef27(0x17d));}}async function logRegistration(_0x138068,_0x415b58){const _0x4e006f=_0x18329d,_0x427859=new Date();try{const _0xf99a97=doc(db,_0x4e006f(0x15f),_0x138068);return await updateDoc(_0xf99a97,{'DateLogin':_0x427859,'NickName':_0x415b58}),console[_0x4e006f(0x1ac)](_0x4e006f(0x1b4)),_0x427859;}catch(_0x5d304a){console[_0x4e006f(0x195)](_0x4e006f(0x167),_0x5d304a);throw _0x5d304a;}}async function fetchAndDisplayTeamMembers(_0x6fe147){const _0x554cf4=_0x18329d;if(!_0x6fe147){teamMembersDisplay[_0x554cf4(0x15c)][_0x554cf4(0x16c)]('hidden');return;}teamMembersHeader[_0x554cf4(0x1bb)]=_0x554cf4(0x16f)+_0x6fe147,teamMembersCount[_0x554cf4(0x1bb)]=_0x554cf4(0x1b1),teamMembersTableBody[_0x554cf4(0x16d)]=_0x554cf4(0x17a),teamMembersDisplay[_0x554cf4(0x15c)][_0x554cf4(0x18c)](_0x554cf4(0x17d));try{const _0xd4a7b0='crsg',_0x25f483=query(collection(db,_0xd4a7b0),where(_0x554cf4(0x169),'==',_0x6fe147)),_0x20dfbc=await getDocs(_0x25f483),_0x2508e2=[];_0x20dfbc['forEach'](_0x2bcf49=>{const _0x2127ff=_0x554cf4;_0x2508e2[_0x2127ff(0x1b7)](_0x2bcf49[_0x2127ff(0x181)]());}),_0x2508e2[_0x554cf4(0x1c2)]((_0x264f72,_0x1d4cac)=>(_0x264f72[_0x554cf4(0x175)]||'')[_0x554cf4(0x160)](_0x1d4cac[_0x554cf4(0x175)]||'')),teamMembersCount['textContent']=_0x554cf4(0x18a)+_0x2508e2['length']+'\x20คน';if(_0x2508e2[_0x554cf4(0x1af)]===0x0){teamMembersTableBody['innerHTML']=_0x554cf4(0x188);return;}teamMembersTableBody[_0x554cf4(0x16d)]='',_0x2508e2[_0x554cf4(0x170)](_0x30bd65=>{const _0x85633=_0x554cf4,_0x13f325=!!_0x30bd65[_0x85633(0x16e)],_0x3b0a2b=_0x13f325?'<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-green-100\x20text-green-800\x22>ลงทะเบียน</span>':_0x85633(0x192),_0x3b93f8=_0x30bd65[_0x85633(0x1a4)]?(_0x30bd65[_0x85633(0x15d)]||'')+'\x20('+_0x30bd65[_0x85633(0x1a4)]+')':_0x30bd65['FullName_th']||'',_0x31b401=document[_0x85633(0x1ba)]('tr');_0x31b401[_0x85633(0x16d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-3\x20py-2\x20whitespace-nowrap\x22>'+_0x3b93f8+_0x85633(0x173)+(_0x30bd65[_0x85633(0x1bd)]||'')+_0x85633(0x173)+_0x3b0a2b+_0x85633(0x1a0),teamMembersTableBody[_0x85633(0x1a9)](_0x31b401);});}catch(_0x190c1e){console[_0x554cf4(0x195)](_0x554cf4(0x187),_0x190c1e),teamMembersTableBody[_0x554cf4(0x16d)]=_0x554cf4(0x16a),teamMembersCount[_0x554cf4(0x1bb)]=_0x554cf4(0x17e);}}
        
    </script>
</body>
</html>


