<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ลงทะเบียนพนักงาน</title>
    <!-- โหลด Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<!-- (แก้ไข) ปรับ margin-top (pt-8 = 2rem) -->
<body class="bg-white flex flex-col items-center justify-center min-h-screen pt-8 pb-10" style="background-color: #dee1e1; margin-top: 0rem !important;">

    <!-- กล่องลงทะเบียน -->
    <div id="registrationFormContainer" class="w-[95%] max-w-md p-8 space-y-6 bg-gray-50 rounded-lg shadow-md transition-colors duration-300">
        <h1 class="text-2xl font-bold text-center text-gray-900">CRSG Summit 2025</h1>
        <!-- *** แก้ไข: เพิ่ม id="eventDate" *** -->
        <p id="eventDate" class="text-sm font-medium text-gray-700 text-center" style="margin-top: 2px;">วันที่ 24 พฤศจิกายน 2568</p>

        <!-- *** แก้ไข: เพิ่ม id="eventImageContainer" *** -->
        <div id="eventImageContainer" class="mt-6 w-[70%] mx-auto">
            <img src="./images/crsg.png">
        </div>  
              
        <!-- *** เพิ่ม: ส่วนแสดงข้อมูลพนักงาน (ซ่อนไว้ตอนเริ่ม) *** -->
        <div id="employeeInfoDisplay" class="hidden text-center space-y-2 py-4">
            <p id="infoFullName" class="text-lg font-bold text-gray-900"></p>
            <p id="infoPosition" class="text-sm text-gray-700"></p>
            <p id="infoDepartment" class="text-sm text-gray-700"></p>
            <p id="infoBU" class="text-sm text-gray-700"></p>
        </div>

        <!-- ฟอร์มลงทะเบียน -->
        <form id="registrationForm" class="space-y-4">
            <div>
                <label for="employeeId" class="block text-sm font-medium text-gray-700">รหัสพนักงาน</label>
                <input type="text" id="employeeId" name="employeeId" required
                       class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition-colors duration-150">
            </div>
            
            <div>
                <!-- (แก้ไข) เปลี่ยน "ชื่อ - นามสกุล" เป็น "ชื่อเล่นของคุณ" -->
                <label for="nickname" class="block text-sm font-medium text-gray-700">ชื่อเล่นของคุณ</label>
                <!-- (แก้ไข) เปลี่ยน id และ name -->
                <input type="text" id="nickname" name="nickname" required
                       class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 transition-colors duration-150">
            </div>
            
            <button type="button" id="registerButton"
                    class="w-full px-4 py-2 font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out disabled:bg-gray-400">
                ลงทะเบียน
            </button>
        </form>
        
        <!-- พื้นที่แสดงข้อความ (สำหรับข้อผิดพลาดหลัก) --><div id="message" class="text-center text-sm"></div>

        <div id="teamDisplay" class="hidden text-center border-t pt-4 mt-4">
            <h2 id="teamNameDisplay" class="text-8xl font-bold text-[#0056ff]"></h2> 
            <p class="text-sm font-medium text-gray-700 mt-1">ทีมของคุณ</p>
            
            <p id="registrationStatusMessage" class="text-sm mt-4"></p>
            <p id="registrationTimestamp" class="text-xs text-gray-500"></p>
        </div>
    </div>

    <!-- (เพิ่ม) ส่วนแสดงสมาชิกในทีม (ซ่อนไว้ตอนเริ่ม) -->
    <!-- (แก้ไข) ปรับ margin-top (mt-8 = 2rem) -->
    <div id="teamMembersDisplay" class="hidden w-[95%] max-w-4xl p-6 bg-white rounded-lg shadow-md mt-8">
        <div class="flex justify-between items-center mb-4">
            <h3 id="teamMembersHeader" class="text-lg font-semibold text-gray-800">สมาชิกทีม : ...</h3>
            <span id="teamMembersCount" class="text-sm font-medium text-gray-600">สมาชิก ... คน</span>
        </div>
        <div class="overflow-x-auto border rounded-lg">
            <table class="min-w-full text-sm">
                <!-- (แก้ไข) ปรับปรุงหัวตาราง -->
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">ชื่อ-นามสกุล</th>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สังกัด</th>
                        <th class="px-3 py-2 text-left font-medium text-gray-600 uppercase tracking-wider">สถานะ</th>
                    </tr>
                </thead>
                <tbody id="teamMembersTableBody" class="bg-white divide-y divide-gray-200">
                    <!-- Data will be populated by JS -->
                </tbody>
            </table>
        </div>
    </div>


    <!-- Firebase SDK และการเชื่อมต่อ --><script type="module">
        // นำเข้า Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, getDocs, query, where, serverTimestamp, setLogLevel, limit, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"; 

        // --- *** ข้อสำคัญ: สำหรับแก้ไข "Missing or insufficient permissions." *** ---
        // (ส่วนนี้เหมือนเดิม)
        // ... (Security Rules comment block) ...
        // --- *************************************************************** ---


const _0x1ca84d=_0xb95a;(function(_0x550b5d,_0x145406){const _0x13d95e=_0xb95a,_0x3eba79=_0x550b5d();while(!![]){try{const _0x545b91=parseInt(_0x13d95e(0x23d))/0x1+-parseInt(_0x13d95e(0x1ec))/0x2*(-parseInt(_0x13d95e(0x235))/0x3)+parseInt(_0x13d95e(0x24b))/0x4+parseInt(_0x13d95e(0x21c))/0x5+-parseInt(_0x13d95e(0x229))/0x6+parseInt(_0x13d95e(0x224))/0x7*(-parseInt(_0x13d95e(0x240))/0x8)+-parseInt(_0x13d95e(0x223))/0x9;if(_0x545b91===_0x145406)break;else _0x3eba79['push'](_0x3eba79['shift']());}catch(_0xcced55){_0x3eba79['push'](_0x3eba79['shift']());}}}(_0x4339,0xd9fa3));const firebaseConfig={'apiKey':'AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','authDomain':_0x1ca84d(0x24d),'databaseURL':_0x1ca84d(0x209),'projectId':_0x1ca84d(0x20c),'storageBucket':_0x1ca84d(0x22a),'messagingSenderId':'1070273157855','appId':_0x1ca84d(0x210),'measurementId':_0x1ca84d(0x22e)};let db,auth;try{const app=initializeApp(firebaseConfig);db=getFirestore(app),auth=getAuth(app),setLogLevel(_0x1ca84d(0x1fd)),await signInAnonymously(auth),console[_0x1ca84d(0x243)](_0x1ca84d(0x225));}catch(_0x508bc5){console[_0x1ca84d(0x1f4)](_0x1ca84d(0x207),_0x508bc5),document[_0x1ca84d(0x1fb)](_0x1ca84d(0x23e))[_0x1ca84d(0x217)]=_0x1ca84d(0x219)+_0x508bc5[_0x1ca84d(0x23e)];}const registrationFormContainer=document['getElementById'](_0x1ca84d(0x206)),employeeIdInput=document['getElementById'](_0x1ca84d(0x241)),nicknameInput=document[_0x1ca84d(0x1fb)]('nickname'),registerButton=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x214)),messageDiv=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x23e)),teamDisplay=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x226)),teamNameDisplay=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x222)),regStatusMsg=document['getElementById'](_0x1ca84d(0x1ed)),regTimestamp=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x248)),eventDate=document[_0x1ca84d(0x1fb)]('eventDate'),eventImageContainer=document['getElementById']('eventImageContainer'),registrationForm=document[_0x1ca84d(0x1fb)]('registrationForm'),employeeInfoDisplay=document['getElementById'](_0x1ca84d(0x1ff)),infoFullName=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x21b)),infoPosition=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x1fa)),infoDepartment=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x1f9)),infoBU=document[_0x1ca84d(0x1fb)]('infoBU'),teamMembersDisplay=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x205)),teamMembersHeader=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x249)),teamMembersCount=document['getElementById'](_0x1ca84d(0x21d)),teamMembersTableBody=document[_0x1ca84d(0x1fb)](_0x1ca84d(0x216));registerButton[_0x1ca84d(0x242)](_0x1ca84d(0x21e),handleRegisterCheck);function formatThaiTimestamp(_0x2b231b){const _0x18e369=_0x1ca84d;return _0x2b231b[_0x18e369(0x230)]('th-TH',{'dateStyle':_0x18e369(0x22d),'timeStyle':_0x18e369(0x20d)});}async function getCrsgDoc(_0xadbc1e){const _0x1e241a=_0x1ca84d,_0x23e186='crsg',_0x292fc2=query(collection(db,_0x23e186),where(_0x1e241a(0x241),'==',_0xadbc1e)),_0x3500e6=await getDocs(_0x292fc2);if(_0x3500e6[_0x1e241a(0x1f1)])return null;const _0x24c3de=_0x3500e6[_0x1e241a(0x1f0)][0x0];return{'id':_0x24c3de['id'],'data':_0x24c3de[_0x1e241a(0x20e)]()};}function _0xb95a(_0xd7a51e,_0x240b6e){const _0x433946=_0x4339();return _0xb95a=function(_0xb95a7e,_0x314378){_0xb95a7e=_0xb95a7e-0x1e8;let _0x5df9c7=_0x433946[_0xb95a7e];return _0x5df9c7;},_0xb95a(_0xd7a51e,_0x240b6e);}async function handleRegisterCheck(){const _0xa687ff=_0x1ca84d,_0x25523b=employeeIdInput[_0xa687ff(0x203)][_0xa687ff(0x215)](),_0x477d66=nicknameInput['value'][_0xa687ff(0x215)]();employeeIdInput[_0xa687ff(0x23c)][_0xa687ff(0x247)]('border-red-500'),nicknameInput[_0xa687ff(0x23c)]['remove'](_0xa687ff(0x1f7));if(!_0x25523b||!_0x477d66){messageDiv[_0xa687ff(0x217)]=_0xa687ff(0x20b),messageDiv[_0xa687ff(0x1ea)]=_0xa687ff(0x227);!_0x25523b&&employeeIdInput[_0xa687ff(0x23c)]['add'](_0xa687ff(0x1f7));!_0x477d66&&nicknameInput['classList'][_0xa687ff(0x244)]('border-red-500');return;}registerButton[_0xa687ff(0x1f6)]=!![],registerButton[_0xa687ff(0x217)]=_0xa687ff(0x213),employeeIdInput['disabled']=!![],nicknameInput['disabled']=!![],employeeIdInput[_0xa687ff(0x23c)]['add'](_0xa687ff(0x239)),nicknameInput['classList'][_0xa687ff(0x244)](_0xa687ff(0x239)),messageDiv[_0xa687ff(0x217)]='';try{const _0x54dc1b=await getCrsgDoc(_0x25523b);if(!_0x54dc1b){messageDiv['textContent']=_0xa687ff(0x218),messageDiv[_0xa687ff(0x1ea)]=_0xa687ff(0x227),registerButton['disabled']=![],registerButton['textContent']=_0xa687ff(0x250),employeeIdInput[_0xa687ff(0x1f6)]=![],nicknameInput['disabled']=![],employeeIdInput[_0xa687ff(0x23c)][_0xa687ff(0x247)](_0xa687ff(0x239)),nicknameInput[_0xa687ff(0x23c)]['remove']('bg-gray-100'),employeeInfoDisplay[_0xa687ff(0x23c)][_0xa687ff(0x244)](_0xa687ff(0x1f8)),eventDate[_0xa687ff(0x23c)][_0xa687ff(0x247)](_0xa687ff(0x1f8)),eventImageContainer[_0xa687ff(0x23c)]['remove'](_0xa687ff(0x1f8)),registrationForm['classList'][_0xa687ff(0x247)](_0xa687ff(0x1f8)),teamMembersDisplay[_0xa687ff(0x23c)][_0xa687ff(0x244)]('hidden');return;}const _0x86e6e8=_0x54dc1b[_0xa687ff(0x20e)],_0x367334=_0x54dc1b['id'],_0x1e7329=_0x86e6e8[_0xa687ff(0x23f)]||_0xa687ff(0x1e9),_0x264ebc=_0x1e7329===_0xa687ff(0x1e9);if(_0x86e6e8[_0xa687ff(0x21a)]){const _0xb5c6f2=_0x86e6e8[_0xa687ff(0x21a)][_0xa687ff(0x208)]();_0x264ebc?(messageDiv['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>คุณได้ลงทะเบียนไปแล้ว</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>และไม่ได้เป็นผู้เข้าร่วมกิจกรรม\x20(ผู้ร่วมงาน)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>'+formatThaiTimestamp(_0xb5c6f2)+_0xa687ff(0x24c),messageDiv[_0xa687ff(0x1ea)]=_0xa687ff(0x227),teamDisplay[_0xa687ff(0x23c)][_0xa687ff(0x244)]('hidden'),teamMembersDisplay['classList'][_0xa687ff(0x244)]('hidden')):(teamNameDisplay[_0xa687ff(0x217)]=_0x1e7329,regStatusMsg['textContent']=_0xa687ff(0x22c),regStatusMsg[_0xa687ff(0x1ea)]=_0xa687ff(0x238),regTimestamp[_0xa687ff(0x217)]=formatThaiTimestamp(_0xb5c6f2),teamDisplay[_0xa687ff(0x23c)][_0xa687ff(0x247)]('hidden'),fetchAndDisplayTeamMembers(_0x1e7329));registrationForm[_0xa687ff(0x23c)]['add'](_0xa687ff(0x1f8)),infoFullName[_0xa687ff(0x217)]=(_0x86e6e8[_0xa687ff(0x1eb)]||'')+'\x20('+(_0x86e6e8[_0xa687ff(0x241)]||'')+')',infoBU[_0xa687ff(0x217)]=_0x86e6e8[_0xa687ff(0x233)]||_0xa687ff(0x231),employeeInfoDisplay[_0xa687ff(0x23c)][_0xa687ff(0x247)](_0xa687ff(0x1f8)),registerButton[_0xa687ff(0x217)]=_0xa687ff(0x1f2);return;}const _0x135d35=await logRegistration(_0x367334,_0x477d66);_0x264ebc?(messageDiv['innerHTML']=_0xa687ff(0x1e8)+formatThaiTimestamp(_0x135d35)+_0xa687ff(0x245),messageDiv[_0xa687ff(0x1ea)]=_0xa687ff(0x227),teamDisplay['classList'][_0xa687ff(0x244)](_0xa687ff(0x1f8)),teamMembersDisplay[_0xa687ff(0x23c)][_0xa687ff(0x244)](_0xa687ff(0x1f8))):(teamNameDisplay[_0xa687ff(0x217)]=_0x1e7329,regStatusMsg[_0xa687ff(0x217)]=_0xa687ff(0x1f5),regStatusMsg[_0xa687ff(0x1ea)]=_0xa687ff(0x246),regTimestamp[_0xa687ff(0x217)]=formatThaiTimestamp(_0x135d35),teamDisplay[_0xa687ff(0x23c)][_0xa687ff(0x247)]('hidden'),_0x86e6e8['NickName']=_0x477d66,fetchAndDisplayTeamMembers(_0x1e7329)),registrationForm[_0xa687ff(0x23c)][_0xa687ff(0x244)](_0xa687ff(0x1f8)),infoFullName[_0xa687ff(0x217)]=(_0x86e6e8[_0xa687ff(0x1eb)]||'')+'\x20('+(_0x86e6e8[_0xa687ff(0x241)]||'')+')',infoPosition[_0xa687ff(0x217)]=_0x86e6e8['Position_th']||_0xa687ff(0x228),infoDepartment[_0xa687ff(0x217)]=_0x86e6e8[_0xa687ff(0x1ef)]||_0xa687ff(0x204),infoBU['textContent']=_0x86e6e8['BU_th']||_0xa687ff(0x231),employeeInfoDisplay[_0xa687ff(0x23c)][_0xa687ff(0x247)]('hidden'),registerButton[_0xa687ff(0x217)]=_0xa687ff(0x1f2),_0x86e6e8['NickName']=_0x477d66;}catch(_0x4b9174){console[_0xa687ff(0x1f4)](_0xa687ff(0x24f),_0x4b9174),_0x4b9174[_0xa687ff(0x23e)][_0xa687ff(0x22f)](_0xa687ff(0x234))?(messageDiv[_0xa687ff(0x1ee)]=_0xa687ff(0x24e),messageDiv[_0xa687ff(0x1ea)]='text-center\x20text-sm\x20p-3\x20bg-red-50\x20border\x20border-red-200\x20rounded-md'):(messageDiv[_0xa687ff(0x217)]=_0xa687ff(0x220)+_0x4b9174[_0xa687ff(0x23e)],messageDiv[_0xa687ff(0x1ea)]=_0xa687ff(0x227)),registerButton['disabled']=![],registerButton[_0xa687ff(0x217)]=_0xa687ff(0x250),teamDisplay['classList'][_0xa687ff(0x244)]('hidden'),employeeIdInput['disabled']=![],nicknameInput[_0xa687ff(0x1f6)]=![],employeeIdInput[_0xa687ff(0x23c)][_0xa687ff(0x247)](_0xa687ff(0x239)),nicknameInput[_0xa687ff(0x23c)][_0xa687ff(0x247)](_0xa687ff(0x239)),employeeInfoDisplay[_0xa687ff(0x23c)][_0xa687ff(0x244)](_0xa687ff(0x1f8)),eventDate[_0xa687ff(0x23c)][_0xa687ff(0x247)]('hidden'),eventImageContainer['classList'][_0xa687ff(0x247)](_0xa687ff(0x1f8)),registrationForm['classList'][_0xa687ff(0x247)](_0xa687ff(0x1f8)),teamMembersDisplay[_0xa687ff(0x23c)]['add'](_0xa687ff(0x1f8));}}function _0x4339(){const _0x49f13c=['innerHTML','Department_th','docs','empty','ลงทะเบียนเรียบร้อย','push','error','ลงทะเบียนเข้าร่วมงานสำเร็จ','disabled','border-red-500','hidden','infoDepartment','infoPosition','getElementById','Error\x20fetching\x20team\x20members:\x20','Debug','createElement','employeeInfoDisplay','NickName','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-red-500\x22>เกิดข้อผิดพลาดในการโหลดข้อมูล</td></tr>','appendChild','value','ไม่พบข้อมูลแผนก','teamMembersDisplay','registrationFormContainer','Firebase\x20initialization\x20failed:','toDate','https://ttb-register-default-rtdb.asia-southeast1.firebasedatabase.app','crsg','กรุณากรอกข้อมูลให้ครบถ้วน','ttb-register','medium','data','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-gray-100\x20text-gray-800\x22>ยังไม่ลงทะเบียน</span>','1:1070273157855:web:5c8120e1df27e233d8676a','\x20คน','localeCompare','กำลังตรวจสอบ...','registerButton','trim','teamMembersTableBody','textContent','ไม่พบรหัสพนักงานนี้ในระบบ','เกิดข้อผิดพลาดในการเชื่อมต่อฐานข้อมูล:\x20','DateLogin','infoFullName','5658155tRnBXz','teamMembersCount','click','Registration\x20Logged\x20successfully.','เกิดข้อผิดพลาด:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-3\x20py-2\x20whitespace-nowrap\x22>','teamNameDisplay','6929415XegkLo','7uBsqHo','Signed\x20in\x20anonymously','teamDisplay','text-center\x20text-sm\x20text-red-600','ไม่พบข้อมูลตำแหน่ง','1036380JlCygK','ttb-register.firebasestorage.app','<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>กำลังโหลดข้อมูล...</td></tr>','คุณได้ลงทะเบียนไปแล้วเมื่อ','long','G-9DJLWJ5LQ1','includes','toLocaleString','ไม่พบข้อมูล\x20BU','Error\x20logging\x20registration:\x20','BU_th','permissions','93UBIfSG','length','สมาชิก\x20','text-sm\x20mt-4\x20text-yellow-700\x20font-medium','bg-gray-100','<span\x20class=\x22inline-flex\x20items-center\x20px-2\x20py-0.5\x20rounded-full\x20text-xs\x20font-medium\x20bg-green-100\x20text-green-800\x22>ลงทะเบียน</span>','กำลังโหลด...','classList','1477733hiYClI','message','Check_Place','8221424MqtIyL','employeeId','addEventListener','log','add','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text-sm\x20mt-4\x20text-green-600\x20font-medium','remove','registrationTimestamp','teamMembersHeader','เกิดข้อผิดพลาด','826900AnPhNG','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ttb-register.firebaseapp.com','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-bold\x20text-red-700\x22>เกิดข้อผิดพลาด:\x20ไม่มีสิทธิ์\x20(Missing\x20or\x20insufficient\x20permissions)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mt-2\x20text-sm\x20text-gray-700\x22>ปัญหานี้เกิดจาก\x20Security\x20Rules\x20ใน\x20Firebase\x20ของคุณ</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mt-1\x20text-sm\x20text-gray-700\x22>กรุณาดู\x20<strong\x20class=\x22text-black\x22>\x22ข้อสำคัญ\x22</strong>\x20ในคอมเมนต์\x20(หมายเหตุ)\x20ในไฟล์นี้</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22mt-1\x20text-sm\x20text-gray-700\x22>ซึ่งอยู่ที่ประมาณบรรทัดที่\x20113\x20เพื่อดูวิธีแก้ไขครับ</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20during\x20registration\x20process:\x20','ลงทะเบียน','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-3\x20py-2\x20whitespace-nowrap\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>ลงทะเบียนสำเร็จ\x20(ผู้ร่วมงาน)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>และคุณไม่ได้เป็นผู้เข้าร่วมกิจกรรม\x20(ไม่มีทีม)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-xs\x20text-gray-500\x20mt-2\x22>','ไม่พบข้อมูลที่นั่ง','className','FullName_th','3038oQUKsB','registrationStatusMessage'];_0x4339=function(){return _0x49f13c;};return _0x4339();}async function logRegistration(_0x10b230,_0x47ed37){const _0x1c4fdf=_0x1ca84d,_0x36de23=new Date();try{const _0x1f7dd1=doc(db,_0x1c4fdf(0x20a),_0x10b230);return await updateDoc(_0x1f7dd1,{'DateLogin':_0x36de23,'NickName':_0x47ed37}),console[_0x1c4fdf(0x243)](_0x1c4fdf(0x21f)),_0x36de23;}catch(_0x462cad){console[_0x1c4fdf(0x1f4)](_0x1c4fdf(0x232),_0x462cad);throw _0x462cad;}}async function fetchAndDisplayTeamMembers(_0x1af983){const _0x2d4224=_0x1ca84d;if(!_0x1af983){teamMembersDisplay[_0x2d4224(0x23c)][_0x2d4224(0x244)]('hidden');return;}teamMembersHeader[_0x2d4224(0x217)]='สมาชิกทีม\x20:\x20'+_0x1af983,teamMembersCount['textContent']=_0x2d4224(0x23b),teamMembersTableBody['innerHTML']=_0x2d4224(0x22b),teamMembersDisplay['classList'][_0x2d4224(0x247)](_0x2d4224(0x1f8));try{const _0x136f58=_0x2d4224(0x20a),_0x549c84=query(collection(db,_0x136f58),where(_0x2d4224(0x23f),'==',_0x1af983)),_0x5c778d=await getDocs(_0x549c84),_0x23cfc9=[];_0x5c778d['forEach'](_0x542a43=>{const _0x476578=_0x2d4224;_0x23cfc9[_0x476578(0x1f3)](_0x542a43[_0x476578(0x20e)]());}),_0x23cfc9['sort']((_0x2ade19,_0x1853a6)=>(_0x2ade19['employeeId']||'')[_0x2d4224(0x212)](_0x1853a6[_0x2d4224(0x241)]||'')),teamMembersCount[_0x2d4224(0x217)]=_0x2d4224(0x237)+_0x23cfc9[_0x2d4224(0x236)]+_0x2d4224(0x211);if(_0x23cfc9[_0x2d4224(0x236)]===0x0){teamMembersTableBody[_0x2d4224(0x1ee)]='<tr><td\x20colspan=\x223\x22\x20class=\x22p-4\x20text-center\x20text-gray-500\x22>ไม่พบสมาชิกในทีมนี้</td></tr>';return;}teamMembersTableBody[_0x2d4224(0x1ee)]='',_0x23cfc9['forEach'](_0x79a401=>{const _0x21601d=_0x2d4224,_0x165c9e=!!_0x79a401[_0x21601d(0x21a)],_0x345600=_0x165c9e?_0x21601d(0x23a):_0x21601d(0x20f),_0x3a87ee=_0x79a401[_0x21601d(0x200)]?(_0x79a401['FullName_th']||'')+'\x20('+_0x79a401[_0x21601d(0x200)]+')':_0x79a401[_0x21601d(0x1eb)]||'',_0x1dcaee=document[_0x21601d(0x1fe)]('tr');_0x1dcaee[_0x21601d(0x1ee)]=_0x21601d(0x221)+_0x3a87ee+_0x21601d(0x251)+(_0x79a401['Check_Manager']||'')+_0x21601d(0x251)+_0x345600+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',teamMembersTableBody[_0x21601d(0x202)](_0x1dcaee);});}catch(_0x116f5b){console[_0x2d4224(0x1f4)](_0x2d4224(0x1fc),_0x116f5b),teamMembersTableBody['innerHTML']=_0x2d4224(0x201),teamMembersCount[_0x2d4224(0x217)]=_0x2d4224(0x24a);}}
        
    </script>
</body>
</html>


