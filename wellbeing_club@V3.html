<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE Retail Club</title>
    <!-- ‡πÇ‡∏´‡∏•‡∏î Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Sarabun', sans-serif; 
            background-color: #ffffff;
            letter-spacing: normal !important;
            font-size: 1.125rem;
        }
        * {
            font-family: 'Sarabun', sans-serif !important;
            letter-spacing: normal !important;
            text-transform: none !important;
        }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            margin-top: 0.25rem;
            /* ‡∏õ‡∏£‡∏±‡∏ö font dropdown ‡πÅ‡∏•‡∏∞ input ‡∏•‡∏á 1 ‡∏Ç‡∏±‡πâ‡∏ô */
            font-size: 1rem;
        }
        thead.table-header-gray {
             background-color: #e5e7eb;
        }
        table thead th {
            font-weight: bold !important;
            font-size: 1rem !important;
            /* ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î font-align center */
            text-align: center !important;
        }
        table tbody tr {
            height: 30px !important;
        }
        .winner-row-animate {
            animation: fadeIn 0.5s ease-in-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        button:disabled {
            background-color: #f3f4f6 !important;
            color: #9ca3af !important;
            cursor: not-allowed !important;
            box-shadow: none !important;
            transform: none !important;
        }
        .loading-gif {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 10px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0); }
            100% { transform: rotate(360deg); }
        }
        .sortable-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .sortable-header:hover {
            background-color: #d1d5db;
        }
        .dashboard-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .dashboard-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        /* Pagination Styles */
        .pagination-btn {
            padding: 0.25rem 0.75rem;
            border: 1px solid #d1d5db;
            background-color: #fff;
            color: #374151;
            font-size: 0.875rem;
            border-radius: 0.375rem;
            transition: all 0.2s;
        }
        .pagination-btn:hover:not(:disabled) {
            background-color: #f3f4f6;
        }
        .pagination-btn.active {
            background-color: #0056ff;
            color: #fff;
            border-color: #0056ff;
        }
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body class="flex flex-col items-center min-h-screen py-10 bg-white">

    <div class="w-[95%] max-w-7xl p-0 bg-white rounded-lg">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6 pt-6 px-8">
            <div class="text-center">
                <h1 class="text-2xl font-bold" style="color: #0056ff;">Recog Night White Elegance</h1>
            </div>
            <div class="text-center mt-2">
                <p id="currentDateTime" class="text-sm text-gray-400 font-medium"></p>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div class="mb-6 border-b border-gray-200 px-8">
            <nav class="-mb-px flex space-x-1 overflow-x-auto" aria-label="Tabs">
                <button id="tab-dashboard" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-700 bg-gray-300 border-blue-600">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Dashboard
                </button>
                <button id="tab-team-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°
                </button>
                <button id="tab-group-view" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-employee-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
                </button>
                <button id="tab-gift-management" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
                <button id="tab-register" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    QR Code
                </button>
                <button id="tab-group-random" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                </button>
                <button id="tab-winners-list" class="whitespace-nowrap py-3 px-4 border-b-2 font-medium text-base text-gray-500 bg-gray-100 border-transparent hover:text-gray-700 hover:border-gray-300">
                    ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
                </button>
            </nav>
        </div>

        <!-- Dashboard Content -->
        <div id="dashboard-content" class="px-8 pb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h2>
            <div class="flex flex-col lg:flex-row gap-6 mb-8">
                <div class="lg:w-2/5">
                     <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center h-full">
                         <p class="text-gray-600 text-base mb-4 font-bold">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                         <div class="relative w-64 h-64">
                             <canvas id="registrationBreakdownChart"></canvas>
                             <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                 <span id="breakdownCenterTotal" class="text-2xl font-bold text-gray-900">0</span>
                                 <span class="text-base text-gray-500 font-bold">‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>
                             </div>
                         </div>
                     </div>
                </div>
                <div class="lg:w-3/5">
                    <div class="flex gap-6 h-full">
                         <div class="w-2/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 flex flex-col items-center justify-center">
                            <p class="text-gray-600 text-base mb-4 font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</p>
                            <div class="relative w-64 h-64">
                                <canvas id="registrationDonutChart"></canvas>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="donutPercentage" class="text-2xl font-bold text-gray-900">0%</span>
                                    <span class="text-base text-gray-500 font-bold">%‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                </div>
                            </div>
                        </div>
                         <div class="w-1/3 flex flex-col justify-between space-y-2">
                            <div id="card-total" class="dashboard-card h-1/4 bg-blue-50 p-3 rounded-lg flex flex-col justify-center items-center text-center">
                                <p class="text-blue-700 text-sm font-bold">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                                <p id="targetCount" class="text-2xl font-bold text-blue-800 mt-1">0</p>
                            </div>
                            <div id="card-registered" class="dashboard-card h-1/4 bg-green-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-green-700 text-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
                                <p id="participantsCountBox" class="text-2xl font-bold text-green-800 mt-1">0</p>
                            </div>
                            <div id="card-unregistered" class="dashboard-card h-1/4 bg-red-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-red-700 text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</p>
                                <p id="remainingCount" class="text-2xl font-bold text-red-800 mt-1">0</p>
                            </div>
                            <div id="card-extras" class="dashboard-card h-1/4 bg-yellow-50 p-3 rounded-lg flex flex-col justify-center items-center text-center font-bold">
                                <p class="text-yellow-700 text-sm">‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="attendeesCount" class="text-2xl font-bold text-yellow-800 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Timeline Row Updated with Side Stats -->
            <div class="mb-8 w-full">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
                    <div class="flex flex-col md:flex-row items-center gap-6">
                        <!-- Chart Area (Left) -->
                        <div class="flex-grow h-72 w-full md:w-3/4">
                            <canvas id="registrationTimelineChart"></canvas>
                        </div>
                        
                        <!-- Summary Stats (Right) -->
                        <div class="w-full md:w-1/4 flex flex-col gap-4">
                            <div class="bg-blue-50 border-l-4 border-blue-600 p-4 rounded-r-lg">
                                <p class="text-blue-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</p>
                                <p id="timelineTotalInvite" class="text-2xl font-black text-blue-900 mt-1">0</p>
                                <p class="text-[10px] text-blue-400 font-bold uppercase tracking-widest">(‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded-r-lg">
                                <p class="text-orange-700 text-sm font-bold uppercase">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</p>
                                <p id="timelineTotalExtra" class="text-2xl font-black text-orange-900 mt-1">0</p>
                                <p class="text-[10px] text-orange-400 font-bold uppercase tracking-widest">(‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                     <h2 class="text-xl font-semibold text-gray-800 font-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                     <button id="randomizeButton" class="px-6 py-3 text-base font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow active:scale-95 transition-all font-bold">
                         ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)
                     </button>
                 </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                        <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (A1 - A24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart1"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                         <p class="text-gray-600 text-base mb-4 font-bold text-center">‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á (B1 - B24)</p>
                        <div class="h-[35rem]"><canvas id="teamBarChart2"></canvas></div>
                    </div>
                </div>
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4 font-bold">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö)</h2>
            <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full text-sm">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏´‡∏±‡∏™</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">Member</th>
                                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ ‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á -->
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                <th class="px-4 py-4 text-center font-bold text-gray-600">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="latestRegistrationsTableBody" class="bg-white divide-y divide-gray-100 text-sm">
                            <tr><td colspan="8" class="p-6 text-center text-gray-500 font-bold text-sm">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="mt-8 text-center">
                <button id="downloadCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all">
                    üì• Download CSV Report
                </button>
            </div>
        </div>

        <!-- Team List Content -->
        <div id="team-list-content" class="hidden pb-8 px-0">
            <div class="bg-white overflow-hidden">
                <div class="px-6 py-4 border-b grid grid-cols-1 md:grid-cols-3 gap-4 items-center bg-gray-50">
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm">
                        <p class="text-base text-blue-700 font-bold">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</p>
                        <p id="managerEmployeeCount" class="text-2xl font-bold text-blue-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl text-center border shadow-sm font-bold">
                        <p class="text-base text-green-700">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ó‡∏µ‡∏°</p>
                        <p id="teamMemberCountElem" class="text-2xl font-bold text-green-900 mt-1">0</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border shadow-sm font-bold flex flex-col"> 
                        <p class="text-sm text-gray-400 font-bold mb-1 uppercase tracking-tight">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</p>
                        <textarea id="definedTeamNamesInput" class="!text-xs h-16 resize-none bg-blue-50 border-blue-100 font-mono" placeholder="A,B,C..."></textarea>
                        <button id="updateTeamNamesBtn" class="mt-1 text-[10px] bg-blue-600 text-white py-1 rounded uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</button>
                    </div>
                </div>
                <div class="px-6 py-4 border-b flex flex-col md:flex-row gap-4 justify-center">
                     <button id="resetTeamButton" class="w-full md:w-auto px-8 py-3 text-base font-bold text-white bg-red-600 rounded-md hover:bg-red-700 shadow transition-all">Reset System Data</button>
                </div>
                 <div class="p-6">
                     <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                         <div>
                             <h3 class="text-xl font-bold border-l-4 border-blue-600 pl-3">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h3>
                             <div id="teamStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                                 <span class="px-3 py-1 rounded-md bg-gray-100 text-gray-700 text-sm font-bold border">Total: <span id="teamStatsTotal">0</span></span>
                                 <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">Reg: <span id="teamStatsRegistered">0</span></span>
                             </div>
                         </div>
                         <div class="flex items-center">
                             <label for="teamSelect" class="text-base font-bold text-gray-600 mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á:</label>
                             <select id="teamSelect" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                                 <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏° --</option>
                             </select>
                         </div>
                     </div>
                     <div class="overflow-x-auto border rounded-xl shadow-sm">
                        <table class="min-w-full text-lg">
                            <thead class="table-header-gray">
                                <tr>
                                    <th class="px-4 py-4 text-center font-bold">#</th>
                                    <th class="px-4 py-4 text-left font-bold">Employee ID</th>
                                    <th class="px-4 py-4 text-left font-bold">Full Name</th>
                                    <th class="px-4 py-4 text-left font-bold">Member</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                                    <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                                    <th class="px-4 py-4 text-left font-bold">Status</th>
                                    <th class="px-4 py-4 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                                </tr>
                            </thead>
                            <tbody id="selectedTeamTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                 </div>
            </div>
        </div>
        
        <!-- Group View Content -->
        <div id="group-view-content" class="hidden pb-8 px-6">
             <div class="bg-white overflow-hidden">
                <!-- Search Boxes Container -->
                <div class="flex flex-col md:flex-row gap-6 mb-6">
                    <!-- Box 1: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-gray-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-gray-800 mb-3">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchEmployeeIdInput" class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchEmployeeIdInput" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 5-6 ‡∏´‡∏•‡∏±‡∏Å">
                            </div>
                            <button id="searchEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-blue-600 rounded-md hover:bg-blue-700 shadow transition-all active:scale-95">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
                        </div>
                        <p id="searchEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>

                    <!-- Box 2: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (50% Width) -->
                    <div class="md:w-1/2 p-6 border-b bg-green-50 rounded-xl shadow-inner">
                        <h3 class="text-xl font-bold text-green-800 mb-3 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                        <div class="flex items-end space-x-2">
                            <div class="flex-grow">
                                <label for="searchRegEmployeeIdInput" class="block text-sm font-bold text-green-600 mb-1">‡∏£‡∏´‡∏±‡∏™</label>
                                <input type="text" id="searchRegEmployeeIdInput" class="mt-1 block w-full rounded-md border-green-300 shadow-sm !text-sm p-2" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô">
                            </div>
                            <button id="searchRegEmployeeButton" class="px-8 py-2 !text-sm font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95 uppercase">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
                        </div>
                        <p id="searchRegEmployeeError" class="text-red-600 text-sm mt-2 font-bold h-5"></p>
                    </div>
                </div>

                <div class="px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
                        <div id="gvOverallStatsContainer" class="hidden flex flex-wrap gap-2 mt-2">
                             <span class="px-3 py-1 rounded-md bg-gray-100 text-sm font-bold border">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="gvOverallStatsTotal">0</span></span>
                             <span class="px-3 py-1 rounded-md bg-green-50 text-green-700 text-sm font-bold border border-green-200">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß: <span id="gvOverallStatsRegistered">0</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="groupViewManagerFilter" class="text-base font-bold text-gray-600 mr-2">Manager:</label>
                         <select id="groupViewManagerFilter" class="rounded-md border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                    </div>
                </div>

                <!-- New Layout: Recog Night Header + Seat Grid -->
                <div class="w-full flex justify-center mb-6 px-6">
                    <div class="w-[60%] bg-[#0056ff] text-white text-center py-3 rounded-xl font-bold shadow-md">
                        ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á Recog Night White Elegance
                    </div>
                </div>

                <div class="px-6 flex w-full items-stretch gap-0">
                    <!-- ‡πÇ‡∏ã‡∏ô A (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridA" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                    
                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ö‡πà‡∏á (4%) -->
                    <div class="w-[4%] flex justify-center py-2">
                        <!-- Border 2% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á 4% ‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á -->
                        <div class="w-1 bg-gray-200 rounded-full h-full opacity-50" id="gridDivider"></div>
                    </div>

                    <!-- ‡πÇ‡∏ã‡∏ô B (48%) ‡∏õ‡∏£‡∏±‡∏ö grid-cols-6 -->
                    <div id="teamGridB" class="w-[48%] grid grid-cols-6 gap-4 h-fit"></div>
                </div>
                
                <div class="p-10"></div> <!-- Spacer -->
             </div>
        </div>
        
        <!-- Employee List Content -->
        <div id="employee-list-content" class="hidden pb-8 px-0">
             <div class="bg-white overflow-hidden">
                <div class="px-8 py-6 border-b flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50">
                    <div>
                        <h2 class="text-xl font-bold uppercase">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
                        <div id="empStatsContainer" class="hidden flex flex-wrap gap-2 mt-3">
                            <span class="px-4 py-1.5 rounded-xl bg-gray-100 text-gray-700 text-sm font-black border shadow-sm">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="empStatsTotal">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-green-50 text-green-700 text-sm font-black border border-green-200 shadow-sm">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span id="empStatsRegistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á: <span id="empStatsUnregistered">0</span></span>
                            <span class="px-4 py-1.5 rounded-xl bg-blue-50 text-blue-700 text-sm font-black border border-blue-200 shadow-sm">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô: <span id="empStatsPercent">0%</span></span>
                        </div>
                    </div>
                    <div class="flex items-center">
                         <label for="managerFilterSelect" class="text-base font-bold text-gray-600 mr-2">‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á:</label>
                         <select id="managerFilterSelect" class="rounded-xl border-gray-300 text-sm py-2 px-6 bg-[#f97316] text-white font-bold w-56 focus:ring-0">
                             <option value="">-- ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î --</option>
                         </select>
                     </div>
                </div>
                <div class="overflow-x-auto p-8">
                    <table class="min-w-full text-sm shadow-sm border rounded-2xl overflow-hidden">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold">#</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-id">‡∏£‡∏´‡∏±‡∏™ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-branch">‡∏™‡∏≤‡∏Ç‡∏≤ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-manager">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-nickname">Member ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-gift">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                                <th class="px-4 py-4 text-center font-bold sortable-header" id="sort-emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚ÜïÔ∏è</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="employeeListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                    </table>
                </div>

                <!-- Pagination Container -->
                <div id="empPaginationContainer" class="flex justify-center items-center gap-2 py-6 border-t border-gray-100"></div>

                <!-- ‡∏õ‡∏∏‡πà‡∏° Download CSV ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                <div class="pb-8 text-center">
                    <button id="downloadEmployeeCsvButton" class="px-8 py-3 text-base font-bold text-white bg-[#1f2937] rounded-md hover:bg-black shadow transition-all uppercase">
                        üì• Download Employee CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Gift Management Content -->
        <div id="gift-management-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-blue-600 pl-3">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
                <div class="bg-gray-50 p-6 rounded-2xl border mb-8 max-w-[1000px] shadow-inner">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-grow" style="max-width: 600px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label>
                            <input type="text" id="giftNameInput" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô iPhone 15">
                        </div>
                        <div style="width: 90px;">
                            <label class="block text-sm font-bold text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                            <input type="number" id="giftQtyInput" class="!text-sm text-center" value="1" min="1">
                        </div>
                        <div class="flex items-end">
                            <button id="addGiftBtn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition-all active:scale-95 shadow-lg !text-xs">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto border rounded-xl shadow-sm">
                    <table class="min-w-full text-base">
                        <thead class="table-header-gray">
                            <tr>
                                <th class="px-4 py-4 text-center font-bold w-24">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</th>
                                <th class="px-4 py-4 text-center font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                            </tr>
                        </thead>
                        <tbody id="giftListTableBody" class="divide-y divide-gray-100 bg-white">
                            <tr><td colspan="6" class="p-6 text-center text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Winners List Content -->
        <div id="winners-list-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                <h2 class="text-xl font-bold text-gray-800 mb-6 uppercase border-l-4 border-green-600 pl-3">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</h2>
                <div id="winnersByGiftContainer" class="space-y-12">
                    <div class="p-10 text-center text-gray-400 font-bold italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
                </div>
                <div class="mt-12 text-center">
                    <button id="downloadWinnersCsvButton" class="px-8 py-3 text-base font-bold text-white bg-green-600 rounded-md hover:bg-green-700 shadow transition-all active:scale-95">
                        üì• Download Winners CSV Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Register Content -->
        <div id="register-content" class="hidden pb-8 px-6 text-center">
             <div class="bg-white p-12 rounded-[3rem] shadow-xl border border-gray-100 flex flex-col items-center">
                <h2 class="text-xl font-bold text-gray-800 mb-10 font-black">QR Code</h2>
                <div class="p-6 bg-white border-8 border-blue-600 rounded-[3rem] shadow-2xl mb-4 hover:scale-105 transition-all">
                    <img src="./images/QRcode-CRSG.png" alt="QR Code" class="w-80 h-80" onerror="this.src='https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=REGISTER'">
                </div>
             </div>
        </div>

        <!-- Group Random Content -->
        <div id="group-random-content" class="hidden pb-8 px-6">
            <div class="bg-white rounded-xl border border-gray-200 p-8 shadow-sm">
                
                <div class="flex flex-col md:flex-row gap-4 mb-6 items-stretch">
                    <div class="md:w-[30%] grid grid-cols-1 gap-2">
                        <div class="bg-blue-50 p-3 rounded-xl border border-blue-100 shadow-sm text-center">
                            <p class="text-sm text-blue-700 uppercase font-black">‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            <p id="grTotalEligible" class="text-xl font-black text-blue-900">0</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-xl border border-orange-100 shadow-sm text-center">
                            <p class="text-sm text-orange-700 uppercase font-black">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°</p>
                            <p id="grRemainingEligible" class="text-xl font-black text-orange-900">0</p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-xl border border-green-100 shadow-sm text-center">
                            <p class="text-sm text-green-700 uppercase font-black">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÅ‡∏•‡πâ‡∏ß</p>
                            <p id="grTotalWinners" class="text-xl font-black text-green-900">0</p>
                        </div>
                    </div>

                    <div class="md:w-[70%] flex flex-col gap-3">
                        <div class="bg-gray-50 px-4 py-3 rounded-xl border shadow-sm w-full">
                            <label class="block text-sm font-bold text-gray-400 mb-1 uppercase tracking-wider text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
                            <div id="grGiftBox" class="flex items-center justify-between bg-white border-2 border-dashed border-gray-200 rounded-xl p-3 transition-all">
                                <div class="flex flex-col text-left">
                                    <p id="grGiftDisplayName" class="text-base font-black text-gray-400 leading-tight uppercase">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                                    <p id="grGiftDisplayQty" class="text-sm font-bold text-gray-300 mt-1">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                                </div>
                                <button id="openGroupGiftPickerBtn" class="px-4 py-1.5 rounded-lg bg-blue-50 text-blue-700 text-xs font-black border border-blue-200 shadow-sm shrink-0 active:scale-95 transition-all">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                            </div>
                        </div>

                        <div class="flex items-stretch gap-3 w-full flex-grow min-h-[90px]">
                            <div class="w-[30%] bg-gray-50 p-3 rounded-xl border shadow-sm flex flex-col justify-center items-center text-center">
                                <label class="text-sm font-bold text-gray-500 uppercase mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</label>
                                <input type="number" id="grDrawCount" value="0" min="0" class="w-full text-center text-3xl font-black text-blue-600 bg-white border border-blue-100 rounded-lg focus:border-blue-500 focus:ring-0 py-1 shadow-inner">
                            </div>
                            <div class="w-[70%]">
                                <button id="grStartDrawBtn" class="w-full h-full text-xl font-black text-white bg-[#0056ff] rounded-xl hover:bg-blue-700 shadow-lg transition-all active:scale-95 disabled:bg-gray-400 uppercase tracking-widest flex items-center justify-center">
                                    üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-0 border-t border-gray-100 pt-4">
                    <div class="p-4 border-r border-gray-100">
                        <h4 class="text-xl font-black text-blue-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</h4>
                        <div id="grBoxLeft" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                    <div class="p-4">
                        <h4 class="text-xl font-black text-indigo-600 uppercase mb-3 text-center">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h4>
                        <div id="grBoxRight" class="min-h-[250px] flex flex-col space-y-1.5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->

    <!-- LIGHTBOX: Manual Registration -->
    <div id="manualRegisterModal" class="hidden fixed inset-0 z-[140] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-lg border-t-8 border-green-600">
            <h3 class="text-xl font-bold mb-6 uppercase border-b pb-3 text-gray-800 text-center">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h3>
            <div id="regEmpDetail" class="space-y-4 mb-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="regEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="regEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏≤‡∏Ç‡∏≤ (Branch)</label><p id="regEmpBranch" class="text-sm font-bold text-gray-700"></p></div>
                <div class="flex justify-between items-center bg-gray-50 p-2 rounded-lg"><label class="text-xs font-bold text-gray-400 uppercase">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Manager)</label><p id="regEmpManager" class="text-sm font-bold text-gray-700"></p></div>

                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (NickName) -->
                <div>
                    <label class="text-sm font-bold text-gray-400 mb-1 block">Member</label>
                    <input type="text" id="regEmpNickname" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="Member">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label>
                        <input type="text" id="regEmpSeat" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base" placeholder="‡πÄ‡∏ä‡πà‡∏ô A1, A2">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 mb-1 block">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="regEmpInviteStatus" class="bg-gray-50 font-bold border-2 focus:border-green-500 outline-none p-3 rounded-xl text-base">
                            <option value="">-- ‡∏ß‡πà‡∏≤‡∏á --</option>
                            <option value="invite">invite</option>
                        </select>
                    </div>
                </div>
                <p id="regManualError" class="text-red-600 text-sm font-black italic h-4"></p>
            </div>
            <div class="flex justify-end gap-3 font-bold">
                <button id="closeManualRegModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveManualRegButton" class="px-8 py-2 bg-green-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-green-700 uppercase">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Group Detail -->
    <div id="groupViewModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="groupViewModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°</h3>
                     <div id="groupViewStatsContainer" class="flex flex-wrap gap-2 mt-2">
                         <span class="px-3 py-1 rounded-full bg-gray-100 text-sm font-bold border uppercase">Total: <span id="groupViewStatsTotal">0</span></span>
                         <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-sm font-bold border border-green-200 uppercase">Reg: <span id="groupViewStatsRegistered">0</span></span>
                     </div>
                 </div>
                 <button id="closeGroupViewModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">ID</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">Member</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-left font-bold text-sm">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="px-4 py-4 text-center font-bold text-sm">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>
                        </tr>
                    </thead>
                    <tbody id="groupViewTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- LIGHTBOX: Dashboard List Detail -->
    <div id="dashboardListModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-[90%] max-h-[90vh] flex flex-col border-t-8 border-blue-600 text-center">
            <div class="flex justify-between items-start mb-4 border-b pb-4">
                 <div class="text-left">
                     <h3 id="dashboardListModalTitle" class="text-xl font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
                     <p class="text-sm text-gray-400 font-bold mt-1 uppercase tracking-tight">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="dashboardListCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                 </div>
                 <button id="closeDashboardListModalButton" class="text-gray-400 hover:text-gray-600 text-4xl font-light transition-all">&times;</button>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-lg shadow-inner bg-gray-50">
                 <table class="min-w-full text-sm">
                    <thead class="table-header-gray sticky top-0 z-10">
                        <tr>
                            <th class="px-4 py-4 text-center font-bold">‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà</th>
                            <th class="px-4 py-4 text-center font-bold">‡∏£‡∏´‡∏±‡∏™</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏≤‡∏Ç‡∏≤</th>
                            <th class="px-4 py-4 text-left font-bold">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>
                            <th class="px-4 py-4 text-center font-bold">‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>
                            <th class="px-4 py-4 text-center font-bold" id="dashListRegHeader">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                            <th class="px-4 py-4 text-center font-bold">Admin</th>
                        </tr>
                    </thead>
                    <tbody id="dashboardListTableBody" class="divide-y divide-gray-100 bg-white"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- MODAL: Lucky Draw Individual -->
    <div id="randomizeModal" class="hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-8 w-[75%] h-[80vh] flex flex-col mx-4 border-t-8 border-blue-600 relative">
            <button id="closeRandomizeModalButtonX" class="absolute top-2 right-4 text-gray-400 hover:text-gray-600 text-5xl font-light transition-all z-10">&times;</button>
            <h3 class="text-xl font-bold text-center text-gray-900 mb-6 uppercase">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</h3>
            <div class="max-w-lg mx-auto mb-8 w-full">
                <label class="block text-sm font-bold text-gray-400 mb-2 text-center">‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏∏‡πà‡∏°</label>
                <div id="indGiftBox" class="flex items-center justify-between bg-blue-50 border-2 border-dashed border-blue-200 rounded-2xl p-3 transition-colors">
                    <div class="flex flex-col text-left">
                        <p id="indGiftDisplayName" class="text-lg font-black text-blue-400 leading-tight">-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• --</p>
                        <p id="indGiftDisplayQty" class="text-sm text-black-400 mt-2">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: - ‡∏ä‡∏¥‡πâ‡∏ô</p>
                    </div>
                    <button id="openGiftPickerBtn" class="px-4 py-1.5 rounded-xl bg-red-50 text-red-700 text-sm font-black border border-red-200 shadow-sm">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-blue-700 uppercase">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</p><p id="modalParticipantsCount" class="text-2xl font-bold">0</p></div>
                <div class="bg-green-50 p-4 rounded-xl text-center border font-bold"><p class="text-base text-green-700 uppercase">‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß</p><p id="modalDrawnCount" class="text-2xl font-bold">0</p></div>
            </div>
            <div class="flex justify-center space-x-2 mb-6 shrink-0">
                <div id="digit1" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit2" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit3" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit4" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
                <div id="digit5" class="w-16 h-20 bg-black text-white text-4xl font-mono font-bold rounded-lg flex items-center justify-center shadow-lg">0</div>
            </div>
            <div class="mb-6 flex flex-col items-center shrink-0">
                <button id="startRandomizeButton" class="w-[40%] px-6 py-4 text-base text-white bg-blue-600 rounded-lg font-bold hover:bg-blue-700 shadow-xl active:scale-95 disabled:bg-gray-400 uppercase" disabled>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</button>
                <p id="randomizeError" class="text-red-600 text-base mt-3 font-bold uppercase"></p>
            </div>
            <div class="flex-grow overflow-y-auto border rounded-xl bg-gray-50 font-bold">
                <table class="min-w-full text-base">
                    <thead class="bg-gray-200 sticky top-0 uppercase text-gray-700">
                        <tr><th class="px-4 py-4 text-left">‡∏£‡∏´‡∏±‡∏™</th><th class="px-4 py-4 text-left">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ</th><th class="px-4 py-4 text-left">‡∏™‡∏≤‡∏Ç‡∏≤/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th><th class="px-4 py-4 text-center">Action</th></tr>
                    </thead>
                    <tbody id="drawnWinnersTableBody" class="bg-white divide-y"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- MODAL: Gift Picker -->
    <div id="giftPickerModal" class="hidden fixed inset-0 z-[100] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-6 w-[70%] modal-enter flex flex-col border-t-8 border-orange-500">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="giftPickerTitle" class="text-xl font-black text-gray-800 uppercase">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
                <button id="closeGiftPickerBtn" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div class="overflow-y-auto max-h-[60vh] space-y-2" id="giftPickerList"></div>
        </div>
    </div>

    <!-- POPUP WINNER Detail -->
    <div id="winnerDetailModal" class="hidden fixed inset-0 z-[200] bg-gray-900 bg-opacity-95 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-12 max-w-xl w-full text-center border-t-8 border-blue-600 transform scale-110">
            <h3 class="text-xl font-black text-blue-600 mb-4 uppercase">üéä WINNER üéä</h3>
            <div class="text-6xl mb-6">üèÜ</div>
            <p id="winnerName" class="text-2xl font-black text-gray-900 my-4 leading-tight uppercase"></p>
            <p id="winnerGiftText" class="text-xl font-bold text-orange-600 mb-6"></p>
            <div class="bg-blue-50 p-6 rounded-[2rem] mb-10 border border-blue-100 shadow-inner text-center">
                <p id="winnerEmployeeId" class="text-xl font-black text-blue-800 font-mono"></p>
                <p id="winnerBU" class="text-lg font-bold text-gray-600 mt-2 uppercase"></p>
                <p id="winnerTeam" class="text-base font-medium text-gray-400 mt-2 uppercase"></p>
            </div>
            <div class="flex flex-col gap-4">
                <button id="cancelWinnerButton" class="text-base font-bold text-red-400 hover:text-red-600 hover:underline transition-all uppercase">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Cancel)</button>
                <button id="closeWinnerModalButton" class="px-12 py-3 text-base font-black bg-blue-600 text-white rounded-[1.5rem] hover:bg-blue-700 shadow-2xl active:scale-95 transition-all">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Profile -->
    <div id="editEmployeeModal" class="hidden fixed inset-0 z-[120] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center"><label class="text-sm font-bold text-gray-400 uppercase">Emp ID</label><p id="editEmpId" class="text-xl font-bold text-blue-700 font-mono"></p></div>
                <div class="flex justify-between items-start flex-col"><label class="text-sm font-bold text-gray-400 uppercase mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label><p id="editEmpName" class="font-black text-gray-900 text-lg"></p></div>
                
                <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (NickName) ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
                <div>
                    <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Member</label>
                    <input type="text" id="editEmpNickname" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base" placeholder="Member">
                </div>

                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Manager / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="editEmpManager" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">Team / ‡∏ú‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</label><input type="text" id="editEmpTeam" class="bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl text-base"></div>
                <p id="editError" class="text-red-600 text-sm font-black italic mt-2"></p>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditModalButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditModalButton" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Edit Gift -->
    <div id="editGiftModal" class="hidden fixed inset-0 z-[150] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-10 w-full max-w-md border-b-8 border-orange-500">
            <h3 class="text-xl font-bold mb-8 uppercase border-b pb-3 text-gray-800 font-bold text-center">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h3>
            <div class="space-y-6">
                <div><label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</label><input type="text" id="editGiftName" class="!text-sm" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏µ‡∏ß‡∏µ 50 ‡∏ô‡∏¥‡πâ‡∏ß"></div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
                        <input type="number" id="editGiftTotalQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="1">
                    </div>
                    <div>
                        <label class="text-sm font-bold text-gray-400 uppercase mb-1 block font-bold">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</label>
                        <input type="number" id="editGiftRemainingQty" class="!text-sm text-center w-full bg-gray-50 font-bold border-2 focus:border-blue-500 outline-none p-3 rounded-xl" min="0">
                    </div>
                </div>
            </div>
            <div class="mt-10 flex justify-end gap-3 font-bold">
                <button id="closeEditGiftModalBtn" class="px-6 py-2 bg-gray-100 rounded-xl text-sm uppercase transition-all hover:bg-gray-200">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button id="saveEditGiftBtn" class="px-8 py-2 bg-blue-600 text-white rounded-xl text-sm font-black shadow-lg transition-all hover:bg-blue-700 uppercase">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Confirmation Center -->
    <div id="confirmModal" class="hidden fixed inset-0 z-[300] bg-gray-900 bg-opacity-80 flex items-center justify-center p-4">
        <div id="confirmModalInner" class="bg-white rounded-2xl p-10 max-w-lg w-full shadow-2xl text-center transition-all duration-300">
            <h3 id="confirmTitle" class="text-xl font-black mb-4 uppercase text-red-600">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô?</h3>
            <p id="confirmText" class="text-gray-600 font-bold mb-6 leading-relaxed italic text-base"></p>
            
            <div id="confirmInputContainer" class="hidden mb-10">
                <p class="text-sm text-gray-500 mb-2">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ <span class="font-bold text-red-600 uppercase">Reset</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                <input type="text" id="confirmInput" class="text-center border-2 border-red-200 rounded-lg p-2 w-full focus:border-red-500 outline-none text-sm font-bold uppercase" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...">
            </div>

            <div class="flex justify-center gap-4">
                <button id="closeConfirmButton" class="px-6 py-2 bg-gray-100 rounded-xl text-sm font-bold hover:bg-gray-200 uppercase">‡πÑ‡∏°‡πà</button>
                <button id="confirmActionButton" class="px-8 py-2 bg-red-600 text-white rounded-xl text-sm font-black shadow-lg hover:bg-red-700 uppercase">‡πÉ‡∏ä‡πà</button>
            </div>
        </div>
    </div>

    <!-- Script Section -->
    <script type="module">
const _0x2e17b2=_0x3793;(function(_0x2762df,_0x363a19){const _0x49af28=_0x3793,_0x2e9646=_0x2762df();while(!![]){try{const _0x48e7e9=-parseInt(_0x49af28(0x2fa))/0x1+parseInt(_0x49af28(0x21a))/0x2+parseInt(_0x49af28(0x2c4))/0x3+parseInt(_0x49af28(0x260))/0x4+-parseInt(_0x49af28(0x328))/0x5+-parseInt(_0x49af28(0x2c1))/0x6+-parseInt(_0x49af28(0x1a7))/0x7*(parseInt(_0x49af28(0x1e8))/0x8);if(_0x48e7e9===_0x363a19)break;else _0x2e9646['push'](_0x2e9646['shift']());}catch(_0x41d2e2){_0x2e9646['push'](_0x2e9646['shift']());}}}(_0x471a,0xcdaac));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';import{getAuth,signInAnonymously}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';import{getFirestore,collection,onSnapshot,doc,updateDoc,setDoc,addDoc,deleteDoc,serverTimestamp,writeBatch}from'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';const firebaseConfig={'apiKey':_0x2e17b2(0x1e2),'authDomain':_0x2e17b2(0x2a3),'projectId':_0x2e17b2(0x216),'storageBucket':'ttb-register.firebasestorage.app','messagingSenderId':_0x2e17b2(0x344),'appId':_0x2e17b2(0x257)};let db,auth,allEmployeesData=[],allGiftsData=[],selectedIndGiftId=null,selectedGroupGiftId=null,giftPickerContext=_0x2e17b2(0x2b9),teamNames=['A1','A2','A3','A4','A5','A6','A7','A8','A9',_0x2e17b2(0x29c),_0x2e17b2(0x1f1),'A12',_0x2e17b2(0x1e1),_0x2e17b2(0x1c2),_0x2e17b2(0x1fd),_0x2e17b2(0x330),_0x2e17b2(0x1c9),_0x2e17b2(0x25f),'A19','A20',_0x2e17b2(0x318),_0x2e17b2(0x293),_0x2e17b2(0x1a9),_0x2e17b2(0x1af),'B1','B2','B3','B4','B5','B6','B7','B8','B9',_0x2e17b2(0x310),_0x2e17b2(0x246),_0x2e17b2(0x2a5),_0x2e17b2(0x1a5),_0x2e17b2(0x261),_0x2e17b2(0x25e),_0x2e17b2(0x2dd),_0x2e17b2(0x1ad),_0x2e17b2(0x34b),_0x2e17b2(0x26d),_0x2e17b2(0x31d),_0x2e17b2(0x238),_0x2e17b2(0x281),'B23',_0x2e17b2(0x2aa)],charts={},currentConfirmAction=null,currentEditingDocId=null,currentEditingGiftId=null,drawInterval=null,empSortField=_0x2e17b2(0x1d3),empSortDir='desc',empCurrentPage=0x1;const empPageSize=0x64;((async()=>{const _0x327059=_0x2e17b2;try{const _0xde574b=initializeApp(firebaseConfig);db=getFirestore(_0xde574b),auth=getAuth(_0xde574b),await signInAnonymously(auth),initCharts(),setupTabs(),setupListeners(),startListening(),startListeningGifts(),document['getElementById'](_0x327059(0x32d))[_0x327059(0x2ef)]=teamNames['join'](','),setInterval(()=>{const _0x570e08=_0x327059,_0xe29ab1=new Date();document[_0x570e08(0x342)](_0x570e08(0x23a))[_0x570e08(0x279)]=_0xe29ab1[_0x570e08(0x273)]('th-TH',{'year':_0x570e08(0x1c1),'month':'long','day':'numeric','hour':_0x570e08(0x1df),'minute':_0x570e08(0x1df),'second':_0x570e08(0x1df)});},0x3e8);}catch(_0x160040){console[_0x327059(0x235)](_0x160040);}})());function setupTabs(){const _0x4c724d=_0x2e17b2,_0x4dad7a={'tab-dashboard':_0x4c724d(0x1b1),'tab-team-list':'team-list-content','tab-group-view':_0x4c724d(0x2fc),'tab-employee-list':_0x4c724d(0x1f3),'tab-gift-management':_0x4c724d(0x1f8),'tab-register':'register-content','tab-group-random':'group-random-content','tab-winners-list':_0x4c724d(0x2f0)};Object[_0x4c724d(0x2bd)](_0x4dad7a)['forEach'](_0x399b0e=>{const _0x2e6b56=_0x4c724d,_0x58bba5=document[_0x2e6b56(0x342)](_0x399b0e);if(!_0x58bba5)return;_0x58bba5[_0x2e6b56(0x2ee)](_0x2e6b56(0x2c2),function(){const _0x193f6c=_0x2e6b56;Object[_0x193f6c(0x2bd)](_0x4dad7a)[_0x193f6c(0x278)](_0x454c79=>{const _0x231844=_0x193f6c,_0x4db3de=document[_0x231844(0x342)](_0x454c79),_0xec28a1=document[_0x231844(0x342)](_0x4dad7a[_0x454c79]);if(_0x4db3de)_0x4db3de['classList'][_0x231844(0x1e4)]('bg-gray-300',_0x231844(0x33f));if(_0xec28a1)_0xec28a1[_0x231844(0x32e)][_0x231844(0x32a)](_0x231844(0x1b8));}),this[_0x193f6c(0x32e)]['replace'](_0x193f6c(0x33f),_0x193f6c(0x239)),document[_0x193f6c(0x342)](_0x4dad7a[_0x399b0e])?.[_0x193f6c(0x32e)][_0x193f6c(0x252)](_0x193f6c(0x1b8)),window['dispatchEvent'](new Event(_0x193f6c(0x22b)));});});}function initCharts(){const _0x1e38d6=_0x2e17b2,_0x462483={'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':![]},'datalabels':{'color':_0x1e38d6(0x2d6),'font':{'weight':_0x1e38d6(0x2ec),'size':0xc},'formatter':_0x4ece3b=>_0x4ece3b>0x0?_0x4ece3b:''}}};charts[_0x1e38d6(0x2b6)]=new Chart(document[_0x1e38d6(0x342)](_0x1e38d6(0x28e)),{'type':'doughnut','data':{'labels':['Invite',_0x1e38d6(0x2a6)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x1e38d6(0x24e),_0x1e38d6(0x237)]}]},'options':{..._0x462483,'cutout':_0x1e38d6(0x1dc)},'plugins':[ChartDataLabels]}),charts[_0x1e38d6(0x322)]=new Chart(document[_0x1e38d6(0x342)](_0x1e38d6(0x298)),{'type':_0x1e38d6(0x1f6),'data':{'labels':['Registered',_0x1e38d6(0x2cb)],'datasets':[{'data':[0x0,0x0],'backgroundColor':[_0x1e38d6(0x263),_0x1e38d6(0x34d)]}]},'options':{..._0x462483,'cutout':_0x1e38d6(0x1dc)},'plugins':[ChartDataLabels]});const _0x65ed95={'indexAxis':'y','responsive':!![],'maintainAspectRatio':![],'scales':{'x':{'stacked':!![]},'y':{'stacked':!![]}},'plugins':{'legend':{'display':!![],'position':_0x1e38d6(0x27f),'labels':{'font':{'size':0xc}}},'datalabels':{'color':'#fff'}}};charts[_0x1e38d6(0x205)]=new Chart(document['getElementById']('teamBarChart1'),{'type':_0x1e38d6(0x2f2),'data':{'labels':[],'datasets':[{'label':_0x1e38d6(0x27b),'data':[],'backgroundColor':_0x1e38d6(0x24e)},{'label':_0x1e38d6(0x22e),'data':[],'backgroundColor':'#BFDBFE'}]},'options':_0x65ed95,'plugins':[ChartDataLabels]}),charts[_0x1e38d6(0x217)]=new Chart(document[_0x1e38d6(0x342)]('teamBarChart2'),{'type':_0x1e38d6(0x2f2),'data':{'labels':[],'datasets':[{'label':_0x1e38d6(0x27b),'data':[],'backgroundColor':'#3B82F6'},{'label':_0x1e38d6(0x22e),'data':[],'backgroundColor':_0x1e38d6(0x2dc)}]},'options':_0x65ed95,'plugins':[ChartDataLabels]}),charts[_0x1e38d6(0x22c)]=new Chart(document[_0x1e38d6(0x342)](_0x1e38d6(0x2e8)),{'type':_0x1e38d6(0x339),'data':{'labels':Array[_0x1e38d6(0x288)]({'length':0x18},(_0x9eafca,_0x233133)=>_0x233133[_0x1e38d6(0x1ba)]()[_0x1e38d6(0x20b)](0x2,'0')+_0x1e38d6(0x264)),'datasets':[{'label':'‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢','data':Array(0x18)[_0x1e38d6(0x2b3)](0x0),'borderColor':_0x1e38d6(0x24e),'backgroundColor':_0x1e38d6(0x24e),'tension':0.1},{'label':_0x1e38d6(0x224),'data':Array(0x18)[_0x1e38d6(0x2b3)](0x0),'borderColor':_0x1e38d6(0x237),'backgroundColor':'#F59E0B','tension':0.1}]},'options':{'responsive':!![],'maintainAspectRatio':![],'plugins':{'legend':{'display':!![],'position':_0x1e38d6(0x1fe)},'datalabels':{'display':![]}},'scales':{'y':{'beginAtZero':!![],'ticks':{'stepSize':0x1,'precision':0x0}}}}});}function startListening(){const _0x1677dc=_0x2e17b2;onSnapshot(collection(db,_0x1677dc(0x1c3)),_0x171706=>{const _0x4474c2=_0x1677dc;allEmployeesData=_0x171706[_0x4474c2(0x2be)]['map'](_0x41363d=>({'id':_0x41363d['id'],..._0x41363d[_0x4474c2(0x2fd)]()})),refreshUI();},_0x74f39d=>console['error'](_0x74f39d));}function startListeningGifts(){const _0xa49dec=_0x2e17b2;onSnapshot(collection(db,_0xa49dec(0x1c5)),_0x35094f=>{const _0x463d40=_0xa49dec,_0x1b9a35=_0x35094f[_0x463d40(0x2be)][_0x463d40(0x1a6)](_0x1c95a0=>({'id':_0x1c95a0['id'],..._0x1c95a0[_0x463d40(0x2fd)]()}));allGiftsData=_0x1b9a35[_0x463d40(0x20a)]((_0x1b9853,_0x5a82a8)=>(_0x1b9853[_0x463d40(0x2b5)]||0x0)-(_0x5a82a8[_0x463d40(0x2b5)]||0x0)),renderGiftTable(),refreshIndGiftState(),refreshGroupGiftState(),updateWinnersList();},_0xe17b9e=>console[_0xa49dec(0x235)](_0xe17b9e));}function refreshUI(){const _0x2ccb80=_0x2e17b2,_0x4bddee=allEmployeesData[_0x2ccb80(0x1da)](_0x1ae2ae=>_0x1ae2ae[_0x2ccb80(0x2df)]),_0x358c80=allEmployeesData[_0x2ccb80(0x1da)](_0x1f625b=>_0x1f625b[_0x2ccb80(0x2df)]&&_0x1f625b[_0x2ccb80(0x34e)]===_0x2ccb80(0x34e)),_0x5c0a52=allEmployeesData[_0x2ccb80(0x1da)](_0x555f37=>_0x555f37[_0x2ccb80(0x2df)]&&_0x555f37['invite']!=='invite'),_0x5bf3ed=allEmployeesData['filter'](_0x1a9178=>_0x1a9178['invite']==='invite');document['getElementById'](_0x2ccb80(0x334))[_0x2ccb80(0x279)]=allEmployeesData['filter'](_0x15de3b=>_0x15de3b[_0x2ccb80(0x254)])[_0x2ccb80(0x270)],document[_0x2ccb80(0x342)](_0x2ccb80(0x1b3))[_0x2ccb80(0x279)]=allEmployeesData[_0x2ccb80(0x1da)](_0x2682e1=>_0x2682e1[_0x2ccb80(0x2ff)])[_0x2ccb80(0x270)];const _0x2c9d15=allEmployeesData[_0x2ccb80(0x1da)](_0x148e6d=>_0x148e6d[_0x2ccb80(0x2ff)]&&_0x148e6d['Check_Place'][_0x2ccb80(0x2b7)]()!==''),_0x2c4bca=_0x2c9d15[_0x2ccb80(0x270)],_0x48c334=_0x2c9d15[_0x2ccb80(0x1da)](_0x3dbcca=>_0x3dbcca[_0x2ccb80(0x2df)])[_0x2ccb80(0x270)],_0x21af8b=_0x2c4bca-_0x48c334,_0x2a254b=_0x2c4bca>0x0?Math['round'](_0x48c334/_0x2c4bca*0x64):0x0;document[_0x2ccb80(0x342)]('empStatsContainer')&&(document[_0x2ccb80(0x342)](_0x2ccb80(0x1b2))[_0x2ccb80(0x279)]=_0x2c4bca,document[_0x2ccb80(0x342)](_0x2ccb80(0x22f))[_0x2ccb80(0x279)]=_0x48c334,document[_0x2ccb80(0x342)]('empStatsUnregistered')['textContent']=_0x21af8b,document[_0x2ccb80(0x342)](_0x2ccb80(0x31c))[_0x2ccb80(0x279)]=_0x2a254b+'%',document[_0x2ccb80(0x342)](_0x2ccb80(0x1b4))[_0x2ccb80(0x32e)][_0x2ccb80(0x252)](_0x2ccb80(0x1b8)));document[_0x2ccb80(0x342)](_0x2ccb80(0x24b))[_0x2ccb80(0x279)]=_0x5bf3ed[_0x2ccb80(0x270)],document[_0x2ccb80(0x342)]('participantsCountBox')[_0x2ccb80(0x279)]=_0x358c80[_0x2ccb80(0x270)],document[_0x2ccb80(0x342)]('attendeesCount')[_0x2ccb80(0x279)]=_0x5c0a52['length'],document[_0x2ccb80(0x342)](_0x2ccb80(0x234))['textContent']=Math[_0x2ccb80(0x1f7)](0x0,_0x5bf3ed[_0x2ccb80(0x270)]-_0x358c80[_0x2ccb80(0x270)]),document['getElementById']('breakdownCenterTotal')[_0x2ccb80(0x279)]=_0x4bddee[_0x2ccb80(0x270)],document[_0x2ccb80(0x342)](_0x2ccb80(0x2d1))['textContent']=_0x5bf3ed['length']?Math[_0x2ccb80(0x222)](_0x358c80[_0x2ccb80(0x270)]/_0x5bf3ed[_0x2ccb80(0x270)]*0x64)+'%':'0%';charts[_0x2ccb80(0x2b6)]&&(charts[_0x2ccb80(0x2b6)][_0x2ccb80(0x2fd)]['datasets'][0x0][_0x2ccb80(0x2fd)]=[_0x358c80[_0x2ccb80(0x270)],_0x5c0a52[_0x2ccb80(0x270)]],charts[_0x2ccb80(0x2b6)][_0x2ccb80(0x2eb)]());charts[_0x2ccb80(0x322)]&&(charts[_0x2ccb80(0x322)][_0x2ccb80(0x2fd)][_0x2ccb80(0x312)][0x0][_0x2ccb80(0x2fd)]=[_0x358c80[_0x2ccb80(0x270)],Math[_0x2ccb80(0x1f7)](0x0,_0x5bf3ed[_0x2ccb80(0x270)]-_0x358c80[_0x2ccb80(0x270)])],charts[_0x2ccb80(0x322)][_0x2ccb80(0x2eb)]());if(charts['timeline']){const _0x1514c0=Array(0x18)[_0x2ccb80(0x2b3)](0x0),_0x5318f2=Array(0x18)[_0x2ccb80(0x2b3)](0x0);let _0x47e912=0x0,_0x1ee1a6=0x0;_0x4bddee['forEach'](_0xf7f4ee=>{const _0x4d86f7=_0x2ccb80;if(_0xf7f4ee[_0x4d86f7(0x2df)]){const _0x5606fc=new Date(_0xf7f4ee[_0x4d86f7(0x2df)][_0x4d86f7(0x308)]()),_0x37f36f=_0x5606fc[_0x4d86f7(0x343)]();_0xf7f4ee[_0x4d86f7(0x34e)]===_0x4d86f7(0x34e)?(_0x1514c0[_0x37f36f]++,_0x47e912++):(_0x5318f2[_0x37f36f]++,_0x1ee1a6++);}}),charts['timeline'][_0x2ccb80(0x2fd)][_0x2ccb80(0x312)][0x0][_0x2ccb80(0x2fd)]=_0x1514c0,charts[_0x2ccb80(0x22c)]['data']['datasets'][0x1][_0x2ccb80(0x2fd)]=_0x5318f2,charts['timeline'][_0x2ccb80(0x2eb)](),document[_0x2ccb80(0x342)](_0x2ccb80(0x2cf))[_0x2ccb80(0x279)]=_0x47e912,document[_0x2ccb80(0x342)](_0x2ccb80(0x210))['textContent']=_0x1ee1a6;}const _0x12a52a={};teamNames[_0x2ccb80(0x278)](_0x116b36=>_0x12a52a[_0x116b36]={'r':0x0,'t':0x0}),allEmployeesData[_0x2ccb80(0x278)](_0x409838=>{const _0x4852d6=_0x2ccb80;if(_0x409838['Check_Place']&&_0x12a52a[_0x409838[_0x4852d6(0x2ff)]]){_0x12a52a[_0x409838[_0x4852d6(0x2ff)]]['t']++;if(_0x409838[_0x4852d6(0x2df)])_0x12a52a[_0x409838[_0x4852d6(0x2ff)]]['r']++;}});const _0x4e59f2=Math[_0x2ccb80(0x331)](teamNames[_0x2ccb80(0x270)]/0x2);charts[_0x2ccb80(0x205)]&&(charts[_0x2ccb80(0x205)][_0x2ccb80(0x2fd)][_0x2ccb80(0x33b)]=teamNames[_0x2ccb80(0x30f)](0x0,_0x4e59f2),charts[_0x2ccb80(0x205)]['data'][_0x2ccb80(0x312)][0x0][_0x2ccb80(0x2fd)]=teamNames[_0x2ccb80(0x30f)](0x0,_0x4e59f2)[_0x2ccb80(0x1a6)](_0x5752dd=>_0x12a52a[_0x5752dd]['r']),charts[_0x2ccb80(0x205)][_0x2ccb80(0x2fd)][_0x2ccb80(0x312)][0x1]['data']=teamNames['slice'](0x0,_0x4e59f2)[_0x2ccb80(0x1a6)](_0x5c4d63=>_0x12a52a[_0x5c4d63]['t']-_0x12a52a[_0x5c4d63]['r']),charts[_0x2ccb80(0x205)][_0x2ccb80(0x2eb)]());charts[_0x2ccb80(0x217)]&&(charts[_0x2ccb80(0x217)][_0x2ccb80(0x2fd)][_0x2ccb80(0x33b)]=teamNames[_0x2ccb80(0x30f)](_0x4e59f2),charts[_0x2ccb80(0x217)][_0x2ccb80(0x2fd)][_0x2ccb80(0x312)][0x0]['data']=teamNames['slice'](_0x4e59f2)[_0x2ccb80(0x1a6)](_0x501f90=>_0x12a52a[_0x501f90]['r']),charts[_0x2ccb80(0x217)][_0x2ccb80(0x2fd)]['datasets'][0x1]['data']=teamNames[_0x2ccb80(0x30f)](_0x4e59f2)[_0x2ccb80(0x1a6)](_0x148741=>_0x12a52a[_0x148741]['t']-_0x12a52a[_0x148741]['r']),charts[_0x2ccb80(0x217)][_0x2ccb80(0x2eb)]());const _0x1eeb3b=[..._0x4bddee]['sort']((_0x38e076,_0xc451dc)=>(_0xc451dc[_0x2ccb80(0x2df)]?.[_0x2ccb80(0x308)]()||0x0)-(_0x38e076[_0x2ccb80(0x2df)]?.['toMillis']()||0x0))['slice'](0x0,0x1e);document[_0x2ccb80(0x342)](_0x2ccb80(0x208))[_0x2ccb80(0x223)]=_0x1eeb3b[_0x2ccb80(0x1a6)](_0x561163=>_0x2ccb80(0x250)+_0x561163[_0x2ccb80(0x209)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20uppercase\x20font-bold\x20text-left\x20text-sm\x22>'+_0x561163[_0x2ccb80(0x2f6)]+_0x2ccb80(0x1c7)+(_0x561163[_0x2ccb80(0x314)]||'-')+_0x2ccb80(0x275)+(_0x561163['Check_Place']||'-')+_0x2ccb80(0x323)+(_0x561163[_0x2ccb80(0x21d)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-left\x20text-sm\x20text-sm\x22>'+(_0x561163[_0x2ccb80(0x254)]||'-')+_0x2ccb80(0x2a2)+_0x561163['id']+'\x27,\x20\x27'+_0x561163[_0x2ccb80(0x2f6)]+_0x2ccb80(0x304))[_0x2ccb80(0x285)](''),updateTeamTab(),updateGridTab(),updateEmployeeList(),updateGroupRandomUI(),updateLuckyDrawStats(),updateWinnersList();}function updateWinnersList(){const _0x292170=_0x2e17b2,_0x5d949d=document[_0x292170(0x342)](_0x292170(0x324));if(!_0x5d949d)return;const _0x15c452=allEmployeesData['filter'](_0x371bef=>_0x371bef[_0x292170(0x23b)]);if(_0x15c452[_0x292170(0x270)]===0x0){_0x5d949d[_0x292170(0x223)]='<div\x20class=\x22p-10\x20text-center\x20text-gray-400\x20font-bold\x20italic\x22>--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--</div>';return;}_0x5d949d[_0x292170(0x223)]=allGiftsData[_0x292170(0x1a6)](_0x20220e=>{const _0x504b58=_0x292170,_0xd2da4e=_0x15c452[_0x504b58(0x1da)](_0x34e049=>_0x34e049[_0x504b58(0x25a)]===_0x20220e['id']||_0x34e049[_0x504b58(0x2f1)]===_0x20220e['name']&&!_0x34e049[_0x504b58(0x25a)]);if(_0xd2da4e['length']===0x0)return'';return _0xd2da4e[_0x504b58(0x20a)]((_0x4b02cf,_0x51f184)=>(_0x51f184[_0x504b58(0x23b)]?.[_0x504b58(0x308)]()||0x0)-(_0x4b02cf[_0x504b58(0x23b)]?.[_0x504b58(0x308)]()||0x0)),_0x504b58(0x24f)+_0x20220e['name']+_0x504b58(0x2d8)+_0xd2da4e[_0x504b58(0x270)]+'\x20‡∏ó‡πà‡∏≤‡∏ô</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22overflow-x-auto\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x22min-w-full\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead\x20class=\x22table-header-gray\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏£‡∏´‡∏±‡∏™</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏≤‡∏Ç‡∏≤</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-left\x20font-bold\x20text-gray-600\x22>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<th\x20class=\x22px-4\x20py-4\x20text-center\x20font-bold\x20text-gray-600\x22>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody\x20class=\x22divide-y\x20divide-gray-100\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0xd2da4e[_0x504b58(0x1a6)]((_0xda29e5,_0x5739ce)=>{const _0x74bc52=_0x504b58,_0x5ec419=_0xda29e5[_0x74bc52(0x20e)]?!![]:![],_0x209816=_0x5ec419?_0x74bc52(0x2f9):'‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö',_0x5547d9=_0x5ec419?_0x74bc52(0x1ea):'bg-red-500\x20text-white\x20cursor-pointer\x20hover:bg-red-600',_0x32c281=_0x5ec419?'':_0x74bc52(0x2ac)+_0xda29e5['id']+'\x27)\x22';return _0x74bc52(0x201)+(_0x5739ce+0x1)+_0x74bc52(0x2a9)+_0xda29e5[_0x74bc52(0x209)]+_0x74bc52(0x338)+_0xda29e5[_0x74bc52(0x2f6)]+_0x74bc52(0x346)+(_0xda29e5['Branch_eng']||'-')+_0x74bc52(0x346)+(_0xda29e5[_0x74bc52(0x254)]||'-')+_0x74bc52(0x34a)+(_0xda29e5[_0x74bc52(0x2ff)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20'+_0x32c281+'\x20class=\x22px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-black\x20transition-all\x20shadow-sm\x20'+_0x5547d9+'\x22>'+_0x209816+_0x74bc52(0x23d)+_0xda29e5['id']+'\x27)\x22\x20class=\x22px-3\x20py-0\x20bg-red-100\x20text-red-600\x20rounded-lg\x20text-xs\x20font-black\x20hover:bg-red-600\x20hover:text-white\x20transition-all\x20uppercase\x22>‡∏•‡∏ö</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';})[_0x504b58(0x285)]('')+_0x504b58(0x32c);})[_0x292170(0x285)]('');}window[_0x2e17b2(0x1c6)]=async _0x1ff081=>{const _0x204475=_0x2e17b2;try{await updateDoc(doc(db,'crsg',_0x1ff081),{'ReceivedTime':serverTimestamp()});}catch(_0x2b1a31){console[_0x204475(0x235)](_0x2b1a31);}},window[_0x2e17b2(0x251)]=_0x3401be=>{const _0x4bf2c5=_0x2e17b2;let _0x3d50b8='',_0x2c4259=[];if(_0x3401be===_0x4bf2c5(0x282))_0x3d50b8=_0x4bf2c5(0x267),_0x2c4259=allEmployeesData[_0x4bf2c5(0x1da)](_0x4f9156=>_0x4f9156['invite']==='invite');else{if(_0x3401be===_0x4bf2c5(0x2d0))_0x3d50b8=_0x4bf2c5(0x325),_0x2c4259=allEmployeesData[_0x4bf2c5(0x1da)](_0x237f19=>_0x237f19[_0x4bf2c5(0x2df)]&&_0x237f19['invite']===_0x4bf2c5(0x34e));else{if(_0x3401be==='unregistered')_0x3d50b8=_0x4bf2c5(0x228),_0x2c4259=allEmployeesData[_0x4bf2c5(0x1da)](_0x2f7ab6=>!_0x2f7ab6[_0x4bf2c5(0x2df)]&&_0x2f7ab6[_0x4bf2c5(0x34e)]===_0x4bf2c5(0x34e));else _0x3401be===_0x4bf2c5(0x243)&&(_0x3d50b8=_0x4bf2c5(0x268),_0x2c4259=allEmployeesData[_0x4bf2c5(0x1da)](_0x23c5d8=>_0x23c5d8[_0x4bf2c5(0x2df)]&&_0x23c5d8[_0x4bf2c5(0x34e)]!=='invite'));}}document[_0x4bf2c5(0x342)](_0x4bf2c5(0x287))[_0x4bf2c5(0x279)]=_0x3d50b8,document['getElementById'](_0x4bf2c5(0x1cc))[_0x4bf2c5(0x279)]=_0x2c4259[_0x4bf2c5(0x270)];const _0x18dfb3=document[_0x4bf2c5(0x342)](_0x4bf2c5(0x2a0));_0x18dfb3[_0x4bf2c5(0x223)]=_0x2c4259['map']((_0x247841,_0x48d09a)=>{const _0x1fc682=_0x4bf2c5,_0x163ff8=_0x247841[_0x1fc682(0x2df)]?!![]:![],_0x22aeec=_0x163ff8?_0x1fc682(0x291):'-';return _0x1fc682(0x349)+(_0x48d09a+0x1)+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-mono\x20font-bold\x20text-blue-700\x20text-center\x22>'+_0x247841[_0x1fc682(0x209)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-left\x20uppercase\x22>'+_0x247841['FullName_th']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>'+(_0x247841[_0x1fc682(0x21d)]||'-')+_0x1fc682(0x1c0)+(_0x247841[_0x1fc682(0x254)]||'-')+_0x1fc682(0x258)+(_0x247841[_0x1fc682(0x2ff)]||'-')+_0x1fc682(0x244)+_0x22aeec+_0x1fc682(0x255)+_0x247841['id']+_0x1fc682(0x2a8)+_0x247841['FullName_th']+_0x1fc682(0x2ed)+(_0x163ff8?'':_0x1fc682(0x321))+_0x1fc682(0x1ee)+(_0x163ff8?'bg-red-600\x20text-white\x20hover:bg-red-700':'bg-gray-100\x20text-gray-400')+_0x1fc682(0x307);})[_0x4bf2c5(0x285)]('')||_0x4bf2c5(0x2fb),document[_0x4bf2c5(0x342)](_0x4bf2c5(0x1e6))[_0x4bf2c5(0x32e)][_0x4bf2c5(0x252)](_0x4bf2c5(0x1b8));};async function addGift(){const _0x10cfef=_0x2e17b2,_0x5f1f71=document['getElementById'](_0x10cfef(0x302))[_0x10cfef(0x2ef)][_0x10cfef(0x2b7)](),_0x42bc03=parseInt(document['getElementById'](_0x10cfef(0x20d))[_0x10cfef(0x2ef)]);if(!_0x5f1f71||isNaN(_0x42bc03))return;const _0x20cbc2=allGiftsData[_0x10cfef(0x25d)]((_0x3f9626,_0x34e640)=>Math['max'](_0x3f9626,_0x34e640[_0x10cfef(0x2b5)]||0x0),0x0);await addDoc(collection(db,_0x10cfef(0x1c5)),{'name':_0x5f1f71,'totalQty':_0x42bc03,'remainingQty':_0x42bc03,'status':'on','order':_0x20cbc2+0x1,'createdAt':serverTimestamp()}),document[_0x10cfef(0x342)](_0x10cfef(0x302))[_0x10cfef(0x2ef)]='',document['getElementById'](_0x10cfef(0x20d))[_0x10cfef(0x2ef)]='1';}function renderGiftTable(){const _0x5c4670=_0x2e17b2,_0x3107d7=document[_0x5c4670(0x342)]('giftListTableBody');if(allGiftsData[_0x5c4670(0x270)]===0x0){_0x3107d7[_0x5c4670(0x223)]=_0x5c4670(0x259);return;}_0x3107d7[_0x5c4670(0x223)]=allGiftsData['map']((_0x12879a,_0x3dfb09)=>_0x5c4670(0x2f5)+(_0x12879a[_0x5c4670(0x2b5)]||_0x3dfb09+0x1)+_0x5c4670(0x26b)+_0x12879a['id']+'\x27,\x20this.value)\x22\x20class=\x22w-16\x20p-1\x20text-center\x20border\x20rounded\x20font-bold\x20text-blue-600\x22\x20min=\x221\x22></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-sm\x20font-normal\x22>'+_0x12879a[_0x5c4670(0x266)]+_0x5c4670(0x1ce)+_0x12879a[_0x5c4670(0x1fb)]+_0x5c4670(0x21c)+_0x12879a[_0x5c4670(0x34f)]+_0x5c4670(0x2b2)+_0x12879a['id']+_0x5c4670(0x2a8)+_0x12879a['status']+'\x27)\x22\x20class=\x22px-4\x20py-1\x20rounded-full\x20text-xs\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x20border\x20'+(_0x12879a[_0x5c4670(0x1d3)]==='on'?_0x5c4670(0x347):'bg-gray-200\x20text-gray-600')+'\x22>'+(_0x12879a[_0x5c4670(0x1d3)]==='on'?'ON':_0x5c4670(0x271))+'</button></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><span\x20onclick=\x22editGift(\x27'+_0x12879a['id']+_0x5c4670(0x220)+_0x12879a['id']+'\x27,\x20\x27'+_0x12879a['name']+_0x5c4670(0x340))[_0x5c4670(0x285)]('');}window['updateGiftOrder']=async(_0x290289,_0x2baad2)=>{const _0x378039=_0x2e17b2,_0x19b63f=parseInt(_0x2baad2);if(!isNaN(_0x19b63f))await updateDoc(doc(db,_0x378039(0x1c5),_0x290289),{'order':_0x19b63f});},window[_0x2e17b2(0x26a)]=async(_0x1decf5,_0x4403bd)=>{const _0x8539e7=_0x2e17b2;await updateDoc(doc(db,_0x8539e7(0x1c5),_0x1decf5),{'status':_0x4403bd==='on'?_0x8539e7(0x23f):'on'});},window['editGift']=_0x424f71=>{const _0x5ae7a4=_0x2e17b2,_0x230931=allGiftsData[_0x5ae7a4(0x276)](_0x3efdeb=>_0x3efdeb['id']===_0x424f71);if(!_0x230931)return;currentEditingGiftId=_0x424f71,document[_0x5ae7a4(0x342)](_0x5ae7a4(0x2b1))[_0x5ae7a4(0x2ef)]=_0x230931[_0x5ae7a4(0x266)],document[_0x5ae7a4(0x342)](_0x5ae7a4(0x1a8))[_0x5ae7a4(0x2ef)]=_0x230931['totalQty'],document[_0x5ae7a4(0x342)]('editGiftRemainingQty')[_0x5ae7a4(0x2ef)]=_0x230931[_0x5ae7a4(0x34f)],document[_0x5ae7a4(0x342)](_0x5ae7a4(0x1d2))[_0x5ae7a4(0x32e)][_0x5ae7a4(0x252)](_0x5ae7a4(0x1b8));},window[_0x2e17b2(0x2a4)]=(_0x490d66,_0x2d765c)=>{const _0x31da17=_0x2e17b2,_0x1f17d8=document[_0x31da17(0x342)](_0x31da17(0x272));_0x1f17d8[_0x31da17(0x1b7)]='bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center\x20transition-all\x20duration-300',currentConfirmAction=async()=>{const _0x1bd2a4=_0x31da17;await deleteDoc(doc(db,_0x1bd2a4(0x1c5),_0x490d66)),document[_0x1bd2a4(0x342)](_0x1bd2a4(0x1c4))[_0x1bd2a4(0x32e)]['add'](_0x1bd2a4(0x1b8));},document[_0x31da17(0x342)]('confirmTitle')['textContent']=_0x31da17(0x301),document[_0x31da17(0x342)](_0x31da17(0x305))['textContent']=_0x31da17(0x26f)+_0x2d765c+_0x31da17(0x1d6),document[_0x31da17(0x342)]('confirmInputContainer')[_0x31da17(0x32e)][_0x31da17(0x32a)](_0x31da17(0x1b8)),document[_0x31da17(0x342)](_0x31da17(0x1c4))[_0x31da17(0x32e)]['remove'](_0x31da17(0x1b8));};function renderGiftPicker(){const _0x479940=_0x2e17b2,_0x281b03=document[_0x479940(0x342)](_0x479940(0x28a)),_0x3153ea=allGiftsData[_0x479940(0x1da)](_0x12d147=>_0x12d147[_0x479940(0x1d3)]==='on'&&_0x12d147[_0x479940(0x34f)]>0x0);document[_0x479940(0x342)](_0x479940(0x336))[_0x479940(0x279)]=giftPickerContext===_0x479940(0x2b9)?_0x479940(0x33c):_0x479940(0x289);if(!_0x3153ea['length']){_0x281b03[_0x479940(0x223)]=_0x479940(0x2f7);return;}const _0xd3e8bc=giftPickerContext===_0x479940(0x2b9)?selectedIndGiftId:selectedGroupGiftId;_0x281b03[_0x479940(0x223)]=_0x3153ea[_0x479940(0x1a6)](_0x362b78=>{const _0xe6eee7=_0x479940,_0xc8bb2=_0x362b78['id']===_0xd3e8bc;return _0xe6eee7(0x32b)+_0x362b78['id']+_0xe6eee7(0x1b0)+(_0xc8bb2?_0xe6eee7(0x1ed):_0xe6eee7(0x1e7))+_0xe6eee7(0x1fa)+(_0xc8bb2?_0xe6eee7(0x286):_0xe6eee7(0x1de))+_0xe6eee7(0x2e1)+_0x362b78[_0xe6eee7(0x266)]+_0xe6eee7(0x2ea)+(_0xc8bb2?_0xe6eee7(0x245):_0xe6eee7(0x2f4))+_0xe6eee7(0x2a1)+_0x362b78['remainingQty']+_0xe6eee7(0x2d4)+(_0xc8bb2?'bg-blue-600\x20text-white':'bg-gray-100\x20text-gray-500')+_0xe6eee7(0x2de)+(_0xc8bb2?_0xe6eee7(0x27c):_0xe6eee7(0x1dd))+_0xe6eee7(0x2e3);})[_0x479940(0x285)]('');}window[_0x2e17b2(0x22a)]=_0x2ab295=>{const _0x1efea4=_0x2e17b2;giftPickerContext===_0x1efea4(0x2b9)?(selectedIndGiftId=_0x2ab295,refreshIndGiftState()):(selectedGroupGiftId=_0x2ab295,document[_0x1efea4(0x342)]('teamGridA')[_0x1efea4(0x223)]='',document[_0x1efea4(0x342)]('teamGridB')[_0x1efea4(0x223)]='',refreshGroupGiftState()),document['getElementById'](_0x1efea4(0x316))[_0x1efea4(0x32e)][_0x1efea4(0x32a)](_0x1efea4(0x1b8));};function _0x471a(){const _0x411ec9=['onclick=\x22markAsReceived(\x27','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-700\x20text-center\x20text-sm\x22>','asc','groupViewModal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-600\x20text-sm\x20text-sm\x22>','editGiftName','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><button\x20onclick=\x22toggleGiftStatus(\x27','fill','editEmployeeModal','order','breakdown','trim','winnerDetailModal','ind','loader','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x20text-[10px]\x20font-normal\x20text-xs\x20text-sm\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','</td><td\x20class=\x22px-4\x20py-4\x20text-xm\x20font-bold\x20text-gray-500\x20uppercase\x20text-left\x20text-sm\x22>','keys','docs','regEmpBranch','downloadCsvButton','3757062tqcEKd','click','bg-yellow-50','3320022ZfuZfn','sort-emp-nickname','groupViewStatsTotal','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏±‡∏ö','\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)','openGiftPickerBtn','bg-red-100\x20text-red-700\x20hover:bg-red-200','Remaining','<span\x20class=\x22px-1\x20text-gray-400\x22>...</span>','‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î:\x20','<option\x20value=\x22\x22>--\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°\x20--</option>','timelineTotalInvite','registered','donutPercentage','teamStatsContainer','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x20text-center\x20text-sm\x22>','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22px-4\x20py-1\x20','closeGiftPickerBtn','#fff','teamStatsRegistered','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-indigo-600\x20text-white\x20px-3\x20py-1\x20rounded-full\x20text-xs\x20font-bold\x20uppercase\x22>','download','editEmpNickname','saveEditGiftBtn','#BFDBFE','B16','\x20rounded-lg\x20text-sm\x20font-black\x20uppercase\x22>','DateLogin','downloadWinnersCsvButton','\x20uppercase\x20text-sm\x22>','\x20hover:bg-gray-50\x20text-center\x20text-sm\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-gray-400\x20text-xs\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ç‡∏≠‡∏á\x20[','text/csv;charset=utf-8;','href','<button\x20class=\x22pagination-btn\x20','registrationTimelineChart','Winners_Report.csv','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22','update','bold','\x27)\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','addEventListener','value','winners-list-content','AwardedGift','bar','modalDrawnCount','text-gray-500','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22><input\x20type=\x22number\x22\x20value=\x22','FullName_th','<p\x20class=\x22text-center\x20py-10\x20text-gray-400\x20font-bold\x20italic\x20text-sm\x22>--\x20‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠\x20--</p>','loading-gif','‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß','663900yjivDO','<tr><td\x20colspan=\x228\x22\x20class=\x22p-10\x20text-center\x20text-gray-400\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>','group-view-content','data','\x27)\x22\x20class=\x22bg-red-50\x20text-white\x20px-3\x20py-1\x20rounded\x20cursor-pointer\x20text-sm\x20font-bold\x22>‡∏•‡∏ö</span></td></tr>','Check_Place','addGiftBtn','‡∏•‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','giftNameInput','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x22>','\x27)\x22\x20class=\x22text-red-600\x20hover:text-red-700\x20cursor-pointer\x20font-black\x20text-xs\x22>‡∏•‡∏ö</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','confirmText','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-2\x20py-0.5\x20rounded\x20text-[10px]\x20font-normal\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','\x20px-4\x20py-1\x20rounded\x20text-[10px]\x20font-black\x20uppercase\x20transition-all\x20shadow-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toMillis','regEmpManager','startRandomizeButton','randomizeButton','‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','\x27)\x22\x20class=\x22bg-red-500\x20text-white\x20px-3\x20py-0.5\x20rounded\x20text-[10px]\x20font-bold\x20uppercase\x20cursor-pointer\x22>Edit</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','closeGroupViewModalButton','slice','B10','</td><td\x20class=\x22px-4\x20py-4\x20text-center\x22><span\x20onclick=\x22removeLuckyWinner(\x27','datasets','#loader','NickName','winnerGiftText','giftPickerModal','bg-gray-100\x20text-gray-400','A21','th-TH','<option\x20value=\x22\x22>--\x20‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','empStatsPercent','B20','regManualError','<span\x20class=\x22px-3\x20py-1\x20bg-green-100\x20text-green-700\x20rounded-md\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å','disabled','goal','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-left\x20text-sm\x20text-sm\x22>','winnersByGiftContainer','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß','options','‡∏™‡∏≤‡∏Ç‡∏≤:\x20','6085690ZebNBd','manager','add','<div\x20onclick=\x22pickGift(\x27','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','definedTeamNamesInput','classList','winnerTeam','A16','ceil','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all\x20text-sm','bg-green-100','managerEmployeeCount','indGiftDisplayQty','giftPickerTitle','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-black\x20uppercase\x20text-left\x22>','line','editEmpTeam','labels','‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--','teamSelect','bg-gray-100','\x27)\x22\x20class=\x22text-red-500\x20hover:text-red-700\x20font-bold\x20text-xs\x20uppercase\x20text-sm\x22>Delete</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','localeCompare','getElementById','getHours','1070273157855','--\x20‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•\x20--','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20uppercase\x20text-left\x22>','bg-green-400\x20text-white\x20border-green-600','groupViewModalTitle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-gray-400\x20font-bold\x20text-xs\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-blue-600\x20font-bold\x20uppercase\x20text-center\x22>','B18','searchRegEmployeeButton','#E5E7EB','invite','remainingQty','group','querySelector','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22','sort-emp-branch','\x27)\x22\x20class=\x22text-red-400\x20hover:text-red-600\x20cursor-pointer\x20font-bold\x20text-lg\x20ml-3\x20text-sm\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','text-base\x20font-black\x20text-blue-600\x20leading-tight\x20uppercase\x20text-sm','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27','card-total','B13','map','21YHtfwM','editGiftTotalQty','A23','<tr><td\x20class=\x22px-4\x20py-4\x20font-mono\x20font-black\x20text-blue-700\x20text-center\x20text-sm\x22>','\x20‡∏ä‡∏¥‡πâ‡∏ô','createElement','B17','searchRegEmployeeError','A24','\x27)\x22\x20class=\x22flex\x20items-center\x20justify-between\x20p-4\x20border\x20rounded-xl\x20hover:bg-blue-50\x20cursor-pointer\x20transition-all\x20','dashboard-content','empStatsTotal','teamMemberCountElem','empStatsContainer','‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏∏‡πâ‡∏ô','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-400\x20text-sm\x20text-sm\x22>','className','hidden','\ufeff‡∏•‡∏≥‡∏î‡∏±‡∏ö,‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô,‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a','toString','unregistered','selectedTeamTableBody','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','editEmpManager','searchEmployeeButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-left\x20text-gray-600\x22>','numeric','A14','crsg','confirmModal','crsg_gift','markAsReceived','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-left\x20text-sm\x22>','text-base\x20font-black\x20text-gray-400\x20leading-tight\x20uppercase\x20text-sm','A17','RESET','card-registered','dashboardListCount','sort-emp-status','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-sm\x22>','<tr\x20class=\x22','flex\x20items-center\x20justify-between\x20bg-blue-50\x20border-2\x20border-blue-300\x20rounded-xl\x20p-3\x20transition-all','gift','editGiftModal','status','randomizeModal','grGiftDisplayName',']\x20?','\x22\x20onclick=\x22changeEmpPage(','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20-\x20‡∏ä‡∏¥‡πâ‡∏ô','editEmpId','filter','regEmpId','75%','Select','text-base\x20text-gray-800','2-digit','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','A13','AIzaSyAgWMzWcZPzyzoBu5eQzj2y59nKsxTWurQ','\ufeff‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•,‡∏™‡∏≤‡∏Ç‡∏≤,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á,‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö\x0a','replace','</span>','dashboardListModal','bg-white\x20border-gray-100','211664xuavYg','text-sm\x20font-bold\x20text-gray-300\x20mt-1\x20text-sm','bg-green-500\x20text-white','nickname',')\x22>‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','bg-blue-100\x20border-blue-500\x20shadow-md','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22','regEmpName','grGiftDisplayQty','A11','regEmpNickname','employee-list-content','changeEmpPage','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20justify-between\x20bg-blue-50\x20p-2.5\x20rounded-xl\x20border\x20border-blue-100\x20winner-row-animate\x20shadow-sm\x20mb-1.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22flex\x20items-center\x20gap-2.5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22bg-blue-600\x20text-white\x20w-5\x20h-5\x20flex\x20items-center\x20justify-center\x20rounded-full\x20text-[9px]\x20font-bold\x22>','doughnut','max','gift-management-content','startsWith','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22font-black\x20','totalQty','confirmTitle','A15','top','regEmpInviteStatus','text-base\x20font-black\x20text-red-400\x20leading-tight\x20uppercase\x20text-sm','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22hover:bg-gray-50\x20transition-colors\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-bold\x20text-gray-400\x20text-xs\x22>','saveManualRegButton','manualRegisterModal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20onclick=\x22openGroupDetail(\x27','bar1',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22removeLuckyWinner(\x27','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-blue-800\x22>','latestRegistrationsTableBody','employeeId','sort','padStart','grBoxLeft','giftQtyInput','ReceivedTime','grGiftBox','timelineTotalExtra','searchEmployeeIdInput','drawnWinnersTableBody','editGiftRemainingQty','winnerEmployeeId','<option\x20value=\x22\x22>--\x20‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\x20--</option>','ttb-register','bar2','grDrawCount','saveEditModalButton','2100294RhsnJo','teamGridB','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x20text-blue-600\x20font-bold\x20text-sm\x22>','Branch_eng','grRemainingEligible','‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-bold\x20text-xs\x20uppercase\x20mr-2\x20text-sm\x22>Edit</span>|\x20<span\x20onclick=\x22deleteGift(\x27','gvOverallStatsRegistered','round','innerHTML','‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô','empPaginationContainer','bg-orange-100','flex\x20items-center\x20justify-between\x20bg-white\x20border-2\x20border-dashed\x20border-gray-200\x20rounded-xl\x20p-3\x20transition-all','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','searchRegEmployeeIdInput','pickGift','resize','timeline',']\x20‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\x20(‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏•‡∏±‡∏á)','‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á','empStatsRegistered','card-unregistered',')\x22>','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-gray-600\x20text-left\x22>','grBoxRight','remainingCount','error','employeeListTableBody','#F59E0B','B21','bg-gray-300','currentDateTime','RandomTime','downloadEmployeeCsvButton','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22removeLuckyWinner(\x27','\x27)\x22\x20class=\x22text-orange-500\x20hover:text-orange-700\x20cursor-pointer\x20font-black\x20text-xs\x20uppercase\x20shadow-sm\x22>Edit</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>','off','‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô','\x22,\x22','desc','extras','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-center\x22>','text-blue-600','B11','</option>','change','\x20aspect-square\x20rounded-full\x20border\x20border-gray-200\x20flex\x20flex-col\x20items-center\x20justify-center\x20cursor-pointer\x20hover:shadow-lg\x20hover:scale-105\x20transition-all\x20active:scale-95\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-[12px]\x20font-bold\x20text-blue-700\x20leading-none\x20text-xs\x20font-bold\x22>','\x20onclick=\x22changeEmpPage(','targetCount','confirmActionButton','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20text-left\x20text-sm\x20text-sm\x22>','#3B82F6','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-white\x20border\x20border-gray-100\x20rounded-2xl\x20overflow-hidden\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22bg-gray-50\x20px-6\x20py-4\x20border-b\x20flex\x20justify-between\x20items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22text-lg\x20font-black\x20text-indigo-700\x20uppercase\x22>üéÅ\x20‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20text-sm\x22>','openDashboardList','remove','‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x200','Check_Manager','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20onclick=\x22cancelReg(\x27','grTotalEligible','1:1070273157855:web:5c8120e1df27e233d8676a','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-2\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x22>','<tr><td\x20colspan=\x226\x22\x20class=\x22p-6\x20text-center\x20text-gray-400\x20font-bold\x22>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</td></tr>','AwardedGiftId','winnerBU','‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß','reduce','B15','A18','5088720yPgBdV','B14','active','#10B981',':00','managerFilterSelect','name','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î','‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô','‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô','toggleGiftStatus','\x22\x20onchange=\x22updateGiftOrder(\x27','branch','B19','Employee_List_Report.csv','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö\x20[','length','OFF','confirmModalInner','toLocaleString','grTotalWinners','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-600\x20text-center\x20text-sm\x20font-bold\x20text-blue-600\x22>','find','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20uppercase\x20font-bold\x20text-left\x20text-sm\x22>','forEach','textContent','card-extras','‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß','Selected','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22text-xm\x20font-black\x20text-gray-800\x20uppercase\x20text-left\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20','bottom','floor','B22','total','random','‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:\x20','join','text-blue-800','dashboardListModalTitle','from','‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°:\x20‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•','giftPickerList','groupViewManagerFilter','<tr><td\x20colspan=\x228\x22\x20class=\x22p-10\x20text-center\x20text-sm\x20text-sm\x22>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</td></tr>','closeRandomizeModalButtonX','registrationBreakdownChart','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20class=\x22','createObjectURL','<span\x20class=\x22bg-green-100\x20text-green-700\x20px-3\x20py-0.5\x20rounded-full\x20text-[10px]\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span>','\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x22>','A22','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','sort-emp-manager','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-center\x20text-orange-600\x20text-sm\x20text-sm\x22>','\x27)\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','registrationDonutChart','Registration_Report.csv','indGiftDisplayName','<option\x20value=\x22','A10','regEmpSeat','digit','teamGridA','dashboardListTableBody','\x20font-bold\x20text-sm\x22>‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20class=\x22px-3\x20py-0\x20bg-green-100\x20text-green-700\x20rounded-full\x20text-[10px]\x20font-black\x20uppercase\x22>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</span></td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22cancelReg(\x27','ttb-register.firebaseapp.com','deleteGift','B12','Non-Invite','toUpperCase','\x27,\x20\x27','</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-mono\x20font-black\x20text-blue-700\x22>','B24','grStartDrawBtn'];_0x471a=function(){return _0x411ec9;};return _0x471a();}function refreshIndGiftState(){const _0xed3ca9=_0x2e17b2,_0x1817fd=document[_0xed3ca9(0x342)](_0xed3ca9(0x29a)),_0x585f23=document[_0xed3ca9(0x342)](_0xed3ca9(0x335)),_0x40c252=document[_0xed3ca9(0x342)](_0xed3ca9(0x30a));if(!selectedIndGiftId){_0x1817fd[_0xed3ca9(0x279)]=_0xed3ca9(0x345),_0x585f23[_0xed3ca9(0x279)]=_0xed3ca9(0x1d8),_0x40c252[_0xed3ca9(0x321)]=!![];return;}const _0x4ec5c6=allGiftsData[_0xed3ca9(0x276)](_0x542a06=>_0x542a06['id']===selectedIndGiftId);!_0x4ec5c6||_0x4ec5c6[_0xed3ca9(0x34f)]<=0x0?(_0x1817fd[_0xed3ca9(0x279)]=_0x4ec5c6?_0x4ec5c6[_0xed3ca9(0x266)]+_0xed3ca9(0x2c8):_0xed3ca9(0x33d),_0x585f23['textContent']=_0xed3ca9(0x253),_0x40c252[_0xed3ca9(0x321)]=!![]):(_0x1817fd[_0xed3ca9(0x279)]=_0x4ec5c6['name'],_0x585f23[_0xed3ca9(0x279)]=_0xed3ca9(0x1bd)+_0x4ec5c6[_0xed3ca9(0x34f)]+_0xed3ca9(0x1ab),_0x40c252[_0xed3ca9(0x321)]=![]);}function refreshGroupGiftState(){const _0x56ca49=_0x2e17b2,_0x3e88a7=document[_0x56ca49(0x342)](_0x56ca49(0x1d5)),_0x1927e5=document['getElementById'](_0x56ca49(0x1f0)),_0x3c6483=document[_0x56ca49(0x342)](_0x56ca49(0x20f)),_0x3f8f3d=document[_0x56ca49(0x342)](_0x56ca49(0x2ab)),_0x3cd99b=document[_0x56ca49(0x342)](_0x56ca49(0x218));if(!selectedGroupGiftId){_0x3e88a7[_0x56ca49(0x279)]=_0x56ca49(0x345),_0x3e88a7[_0x56ca49(0x1b7)]=_0x56ca49(0x1c8),_0x1927e5[_0x56ca49(0x279)]=_0x56ca49(0x1d8),_0x1927e5['className']=_0x56ca49(0x1e9),_0x3c6483[_0x56ca49(0x1b7)]=_0x56ca49(0x332),_0x3cd99b['value']=0x0,_0x3f8f3d[_0x56ca49(0x321)]=!![];return;}const _0x94d4ff=allGiftsData[_0x56ca49(0x276)](_0x25974d=>_0x25974d['id']===selectedGroupGiftId);!_0x94d4ff||_0x94d4ff['remainingQty']<=0x0?(_0x3e88a7['textContent']=_0x94d4ff?_0x94d4ff[_0x56ca49(0x266)]+'\x20(‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß)':'--\x20‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö\x20--',_0x3e88a7[_0x56ca49(0x1b7)]=_0x56ca49(0x200),_0x1927e5[_0x56ca49(0x279)]=_0x56ca49(0x253),_0x3c6483[_0x56ca49(0x1b7)]=_0x56ca49(0x227),_0x3cd99b[_0x56ca49(0x2ef)]=0x0,_0x3f8f3d['disabled']=!![]):(_0x3e88a7[_0x56ca49(0x279)]=_0x94d4ff[_0x56ca49(0x266)],_0x3e88a7[_0x56ca49(0x1b7)]=_0x56ca49(0x1a2),_0x1927e5[_0x56ca49(0x279)]='‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:\x20'+_0x94d4ff['remainingQty']+_0x56ca49(0x1ab),_0x1927e5[_0x56ca49(0x1b7)]='text-sm\x20font-bold\x20text-gray-600\x20mt-1\x20text-sm',_0x3c6483['className']=_0x56ca49(0x1d0),_0x3cd99b[_0x56ca49(0x2ef)]=_0x94d4ff[_0x56ca49(0x34f)],_0x3cd99b[_0x56ca49(0x1f7)]=_0x94d4ff[_0x56ca49(0x34f)],_0x3f8f3d[_0x56ca49(0x321)]=![]);}async function startGroupRandomDraw(){const _0x2dac1b=_0x2e17b2,_0x2735ef=parseInt(document[_0x2dac1b(0x342)](_0x2dac1b(0x218))['value'])||0x0,_0x5d1570=allEmployeesData[_0x2dac1b(0x1da)](_0x44de8c=>_0x44de8c['DateLogin']&&_0x44de8c[_0x2dac1b(0x34e)]===_0x2dac1b(0x34e)&&!_0x44de8c[_0x2dac1b(0x23b)]);if(!selectedGroupGiftId)return;const _0x346479=allGiftsData[_0x2dac1b(0x276)](_0x297051=>_0x297051['id']===selectedGroupGiftId);if(_0x2735ef<=0x0||_0x5d1570[_0x2dac1b(0x270)]<_0x2735ef||_0x346479[_0x2dac1b(0x34f)]<_0x2735ef)return;const _0x539784=document['getElementById'](_0x2dac1b(0x2ab));_0x539784[_0x2dac1b(0x321)]=!![];const _0xecce2b=document['getElementById'](_0x2dac1b(0x20c)),_0x4b0778=document[_0x2dac1b(0x342)](_0x2dac1b(0x233));_0xecce2b['innerHTML']='',_0x4b0778['innerHTML']='';const _0x11236a=[..._0x5d1570]['sort'](()=>0.5-Math[_0x2dac1b(0x283)]())['slice'](0x0,_0x2735ef);await updateDoc(doc(db,'crsg_gift',selectedGroupGiftId),{'remainingQty':_0x346479[_0x2dac1b(0x34f)]-_0x2735ef});const _0x297d10=Math[_0x2dac1b(0x331)](_0x2735ef/0x2),_0x275eb0=_0x11236a['slice'](0x0,_0x297d10),_0x4b87dc=_0x11236a['slice'](_0x297d10),_0x51620a=_0x52cbca=>{const _0x1d76cc=_0x2dac1b,_0x509b6d=document[_0x1d76cc(0x1ac)]('div');_0x509b6d['id']=_0x1d76cc(0x2ba),_0x509b6d[_0x1d76cc(0x1b7)]=_0x1d76cc(0x2f8),_0x52cbca['appendChild'](_0x509b6d);},_0x2d368a=_0x4b2a7d=>{const _0x2cb163=_0x2dac1b,_0xa3c9c5=_0x4b2a7d[_0x2cb163(0x351)](_0x2cb163(0x313));if(_0xa3c9c5)_0xa3c9c5[_0x2cb163(0x252)]();};for(let _0x40be33=0x0;_0x40be33<_0x275eb0[_0x2dac1b(0x270)];_0x40be33++){_0x51620a(_0xecce2b),await new Promise(_0x2d102a=>setTimeout(_0x2d102a,0x3e8)),_0x2d368a(_0xecce2b);const _0x57ea8b=_0x275eb0[_0x40be33];_0xecce2b[_0x2dac1b(0x223)]+=createWinnerItemHTML(_0x40be33+0x1,_0x57ea8b),await updateWinnerInDB(_0x57ea8b,_0x346479[_0x2dac1b(0x266)],selectedGroupGiftId);}for(let _0x45c7e9=0x0;_0x45c7e9<_0x4b87dc[_0x2dac1b(0x270)];_0x45c7e9++){_0x51620a(_0x4b0778),await new Promise(_0x5ef87c=>setTimeout(_0x5ef87c,0x3e8)),_0x2d368a(_0x4b0778);const _0x1a0e86=_0x4b87dc[_0x45c7e9];_0x4b0778[_0x2dac1b(0x223)]+=createWinnerItemHTML(_0x297d10+_0x45c7e9+0x1,_0x1a0e86),await updateWinnerInDB(_0x1a0e86,_0x346479[_0x2dac1b(0x266)],selectedGroupGiftId);}_0x539784[_0x2dac1b(0x321)]=![],confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}});}function createWinnerItemHTML(_0x2caa33,_0x4944b9){const _0x3c0a4a=_0x2e17b2;return _0x3c0a4a(0x1f5)+_0x2caa33+_0x3c0a4a(0x27d)+_0x4944b9[_0x3c0a4a(0x2f6)]+'\x20('+_0x4944b9[_0x3c0a4a(0x209)]+_0x3c0a4a(0x206)+_0x4944b9['id']+_0x3c0a4a(0x1a1);}async function updateWinnerInDB(_0x4bc3d4,_0x3841df,_0x401b1e){const _0x568e94=_0x2e17b2;await updateDoc(doc(db,_0x568e94(0x1c3),_0x4bc3d4['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x3841df,'AwardedGiftId':_0x401b1e});}async function runIndividualLuckyDraw(){const _0x4a2ff4=_0x2e17b2,_0xc308e=document[_0x4a2ff4(0x342)]('randomizeError');_0xc308e[_0x4a2ff4(0x279)]='';const _0x1dbe0f=allEmployeesData[_0x4a2ff4(0x1da)](_0x2ad10f=>_0x2ad10f[_0x4a2ff4(0x2df)]&&_0x2ad10f[_0x4a2ff4(0x34e)]==='invite'&&!_0x2ad10f[_0x4a2ff4(0x23b)]);if(!selectedIndGiftId){_0xc308e['textContent']='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Å‡πà‡∏≠‡∏ô';return;}if(!_0x1dbe0f['length']){_0xc308e['textContent']=_0x4a2ff4(0x1b5);return;}const _0x579cf1=allGiftsData[_0x4a2ff4(0x276)](_0xb75082=>_0xb75082['id']===selectedIndGiftId);if(!_0x579cf1||_0x579cf1[_0x4a2ff4(0x34f)]<=0x0){_0xc308e['textContent']=_0x4a2ff4(0x25c);return;}const _0x478df5=document[_0x4a2ff4(0x342)](_0x4a2ff4(0x30a));_0x478df5['disabled']=!![];const _0x45fd3e=[0x1,0x2,0x3,0x4,0x5][_0x4a2ff4(0x1a6)](_0x5167e2=>document[_0x4a2ff4(0x342)](_0x4a2ff4(0x29e)+_0x5167e2));let _0x381954=0x0;drawInterval=setInterval(()=>{const _0x1c843d=_0x4a2ff4;_0x45fd3e[_0x1c843d(0x278)](_0x1cfdca=>_0x1cfdca[_0x1c843d(0x279)]=Math[_0x1c843d(0x280)](Math[_0x1c843d(0x283)]()*0xa));if(++_0x381954>0x28){clearInterval(drawInterval);const _0x3a49bf=_0x1dbe0f[Math['floor'](Math[_0x1c843d(0x283)]()*_0x1dbe0f[_0x1c843d(0x270)])],_0x861396=String(_0x3a49bf[_0x1c843d(0x209)])['slice'](-0x5)[_0x1c843d(0x20b)](0x5,'0');_0x45fd3e[_0x1c843d(0x278)]((_0xf04beb,_0x4a211d)=>_0xf04beb[_0x1c843d(0x279)]=_0x861396[_0x4a211d]),setTimeout(async()=>{const _0x382a59=_0x1c843d;await updateDoc(doc(db,_0x382a59(0x1c5),selectedIndGiftId),{'remainingQty':_0x579cf1[_0x382a59(0x34f)]-0x1}),await updateDoc(doc(db,_0x382a59(0x1c3),_0x3a49bf['id']),{'RandomTime':serverTimestamp(),'AwardedGift':_0x579cf1['name'],'AwardedGiftId':selectedIndGiftId}),document['getElementById']('winnerName')[_0x382a59(0x279)]=_0x3a49bf[_0x382a59(0x2f6)]+'\x20('+_0x3a49bf['employeeId']+')',document[_0x382a59(0x342)](_0x382a59(0x315))[_0x382a59(0x279)]=_0x382a59(0x284)+_0x579cf1[_0x382a59(0x266)],document[_0x382a59(0x342)](_0x382a59(0x214))['textContent']='‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:\x20'+_0x3a49bf[_0x382a59(0x209)],document[_0x382a59(0x342)](_0x382a59(0x25b))['textContent']=_0x382a59(0x327)+(_0x3a49bf['Branch_eng']||'-'),document['getElementById'](_0x382a59(0x32f))[_0x382a59(0x279)]=_0x382a59(0x2cd)+(_0x3a49bf[_0x382a59(0x254)]||'-'),document[_0x382a59(0x342)](_0x382a59(0x2b8))[_0x382a59(0x32e)][_0x382a59(0x252)](_0x382a59(0x1b8)),confetti({'particleCount':0x96,'spread':0x64,'origin':{'y':0.6}}),_0x478df5[_0x382a59(0x321)]=![],updateLuckyDrawStats();},0x1f4);}},0x32);}function _0x3793(_0x4a1f96,_0x486d20){_0x4a1f96=_0x4a1f96-0x1a0;const _0x471ade=_0x471a();let _0x37934b=_0x471ade[_0x4a1f96];return _0x37934b;}window['removeLuckyWinner']=async _0x230a74=>{const _0x58d00b=_0x2e17b2,_0x20e1cf=allEmployeesData['find'](_0x28319b=>_0x28319b['id']===_0x230a74);if(!_0x20e1cf)return;if(_0x20e1cf[_0x58d00b(0x25a)]){const _0x615e18=allGiftsData[_0x58d00b(0x276)](_0x593765=>_0x593765['id']===_0x20e1cf[_0x58d00b(0x25a)]);if(_0x615e18)await updateDoc(doc(db,'crsg_gift',_0x615e18['id']),{'remainingQty':_0x615e18['remainingQty']+0x1});}await updateDoc(doc(db,_0x58d00b(0x1c3),_0x230a74),{'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null}),document[_0x58d00b(0x342)](_0x58d00b(0x2b8))[_0x58d00b(0x32e)][_0x58d00b(0x32a)](_0x58d00b(0x1b8));};function updateLuckyDrawStats(){const _0x41de32=_0x2e17b2,_0x2585fd=allEmployeesData['filter'](_0x38bea3=>_0x38bea3[_0x41de32(0x2df)]&&_0x38bea3['invite']===_0x41de32(0x34e)),_0x5839b5=_0x2585fd['filter'](_0x503bce=>_0x503bce['RandomTime'])['sort']((_0xc8c321,_0x5034f4)=>(_0x5034f4[_0x41de32(0x23b)]?.[_0x41de32(0x308)]()||0x0)-(_0xc8c321[_0x41de32(0x23b)]?.[_0x41de32(0x308)]()||0x0));document[_0x41de32(0x342)]('modalParticipantsCount')[_0x41de32(0x279)]=_0x2585fd[_0x41de32(0x1da)](_0x5c9e4d=>!_0x5c9e4d['RandomTime'])[_0x41de32(0x270)],document['getElementById'](_0x41de32(0x2f3))[_0x41de32(0x279)]=_0x5839b5[_0x41de32(0x270)],document[_0x41de32(0x342)](_0x41de32(0x212))[_0x41de32(0x223)]=_0x5839b5[_0x41de32(0x1a6)](_0x293efe=>_0x41de32(0x1aa)+_0x293efe['employeeId']+'</td><td\x20class=\x22px-4\x20py-4\x20uppercase\x20font-bold\x20text-xm\x20text-left\x20text-sm\x20text-sm\x20text-sm\x22>'+_0x293efe[_0x41de32(0x2f6)]+(_0x293efe['AwardedGift']?'<br/><span\x20class=\x22text-sm\x20text-orange-600\x20text-xs\x22>üéÅ\x20'+_0x293efe[_0x41de32(0x2f1)]+_0x41de32(0x1e5):'')+_0x41de32(0x2bc)+(_0x293efe['Branch_eng']||'-')+_0x41de32(0x311)+_0x293efe['id']+_0x41de32(0x2fe))[_0x41de32(0x285)]('');}function updateTeamTab(){const _0x494743=_0x2e17b2,_0x21a20=document[_0x494743(0x342)]('teamSelect'),_0x154bfe=_0x21a20[_0x494743(0x2ef)];_0x21a20[_0x494743(0x223)]=_0x494743(0x2ce)+teamNames['map'](_0x433761=>_0x494743(0x29b)+_0x433761+'\x22>'+_0x433761+_0x494743(0x247))[_0x494743(0x285)](''),_0x21a20[_0x494743(0x2ef)]=teamNames['includes'](_0x154bfe)?_0x154bfe:'';if(_0x21a20[_0x494743(0x2ef)]){const _0x491f98=allEmployeesData[_0x494743(0x1da)](_0x7a22f6=>_0x7a22f6[_0x494743(0x2ff)]===_0x21a20[_0x494743(0x2ef)]);document[_0x494743(0x342)]('teamStatsTotal')['textContent']=_0x491f98['length'],document[_0x494743(0x342)](_0x494743(0x2d7))[_0x494743(0x279)]=_0x491f98['filter'](_0x3eeb33=>_0x3eeb33['DateLogin'])['length'],document['getElementById'](_0x494743(0x2d2))[_0x494743(0x32e)][_0x494743(0x252)](_0x494743(0x1b8)),document[_0x494743(0x342)](_0x494743(0x1bc))[_0x494743(0x223)]=_0x491f98['map']((_0x49fabd,_0xfee8ed)=>_0x494743(0x352)+(_0x49fabd['DateLogin']?_0x494743(0x2c3):'')+_0x494743(0x292)+(_0xfee8ed+0x1)+_0x494743(0x207)+_0x49fabd[_0x494743(0x209)]+_0x494743(0x303)+_0x49fabd['FullName_th']+_0x494743(0x232)+(_0x49fabd[_0x494743(0x314)]||'-')+_0x494743(0x232)+(_0x49fabd['Branch_eng']||'-')+_0x494743(0x232)+(_0x49fabd[_0x494743(0x254)]||'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x20font-black\x20uppercase\x20text-xs\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x49fabd[_0x494743(0x2df)]?_0x494743(0x31f):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22><span\x20onclick=\x22editEmp(\x27'+_0x49fabd['id']+_0x494743(0x23e))[_0x494743(0x285)]('');}else document[_0x494743(0x342)]('teamStatsContainer')[_0x494743(0x32e)][_0x494743(0x32a)](_0x494743(0x1b8));}function updateGridTab(){const _0x52b63a=_0x2e17b2,_0x5666c0=document[_0x52b63a(0x342)](_0x52b63a(0x28b))[_0x52b63a(0x2ef)],_0x441150=[...new Set(allEmployeesData[_0x52b63a(0x1a6)](_0x5712b3=>_0x5712b3[_0x52b63a(0x254)])['filter'](Boolean))][_0x52b63a(0x20a)](),_0x145dcc=document['getElementById'](_0x52b63a(0x28b));_0x145dcc[_0x52b63a(0x326)][_0x52b63a(0x270)]!==_0x441150['length']+0x1&&(_0x145dcc[_0x52b63a(0x223)]=_0x52b63a(0x215)+_0x441150[_0x52b63a(0x1a6)](_0x4ed785=>'<option\x20value=\x22'+_0x4ed785+'\x22>'+_0x4ed785+_0x52b63a(0x247))[_0x52b63a(0x285)](''));_0x145dcc[_0x52b63a(0x2ef)]=_0x5666c0;const _0x5d869b=_0x5666c0?allEmployeesData['filter'](_0x3b56a7=>_0x3b56a7[_0x52b63a(0x254)]===_0x5666c0):allEmployeesData,_0x5623c2=_0x5d869b[_0x52b63a(0x1da)](_0x282efc=>_0x282efc[_0x52b63a(0x34e)]==='invite');document[_0x52b63a(0x342)]('gvOverallStatsTotal')[_0x52b63a(0x279)]=_0x5623c2[_0x52b63a(0x270)],document[_0x52b63a(0x342)](_0x52b63a(0x221))[_0x52b63a(0x279)]=_0x5623c2[_0x52b63a(0x1da)](_0x404157=>_0x404157[_0x52b63a(0x2df)])[_0x52b63a(0x270)],document[_0x52b63a(0x342)]('gvOverallStatsContainer')[_0x52b63a(0x32e)][_0x52b63a(0x252)](_0x52b63a(0x1b8));const _0x176ea6={};teamNames[_0x52b63a(0x278)](_0x4a01d2=>_0x176ea6[_0x4a01d2]={'r':0x0,'t':0x0}),_0x5d869b[_0x52b63a(0x1da)](_0x3c6177=>_0x3c6177[_0x52b63a(0x2ff)])[_0x52b63a(0x278)](_0x34d211=>{const _0x23a18d=_0x52b63a;if(_0x176ea6[_0x34d211[_0x23a18d(0x2ff)]]){_0x176ea6[_0x34d211[_0x23a18d(0x2ff)]]['t']++;if(_0x34d211[_0x23a18d(0x2df)])_0x176ea6[_0x34d211['Check_Place']]['r']++;}});const _0x364cb9=document[_0x52b63a(0x342)](_0x52b63a(0x29f)),_0xd2483d=document['getElementById'](_0x52b63a(0x21b));_0x364cb9[_0x52b63a(0x223)]='',_0xd2483d['innerHTML']='',teamNames['forEach'](_0x487785=>{const _0x3a164e=_0x52b63a,_0x5e74c4=_0x176ea6[_0x487785];let _0x47734d=_0x3a164e(0x33f);if(_0x5e74c4['t']>0x0){if(_0x5e74c4['r']===_0x5e74c4['t'])_0x47734d=_0x3a164e(0x333);else{if(_0x5e74c4['r']>0x0)_0x47734d=_0x3a164e(0x226);}}const _0x2381bb=_0x3a164e(0x204)+_0x487785+'\x27)\x22\x20class=\x22'+_0x47734d+_0x3a164e(0x249)+_0x487785+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-sm\x20font-black\x20text-gray-900\x20mt-0.5\x20text-sm\x22>'+_0x5e74c4['r']+'/'+_0x5e74c4['t']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';if(_0x487785['startsWith']('A'))_0x364cb9['innerHTML']+=_0x2381bb;else{if(_0x487785[_0x3a164e(0x1f9)]('B'))_0xd2483d[_0x3a164e(0x223)]+=_0x2381bb;}});}function updateEmployeeList(){const _0x2ad4bc=_0x2e17b2,_0x462142=document['getElementById']('managerFilterSelect')[_0x2ad4bc(0x2ef)],_0x231408=[...new Set(allEmployeesData['map'](_0x51dfb0=>_0x51dfb0[_0x2ad4bc(0x254)])[_0x2ad4bc(0x1da)](Boolean))][_0x2ad4bc(0x20a)](),_0x2fd645=document[_0x2ad4bc(0x342)](_0x2ad4bc(0x265));_0x2fd645['options']['length']!==_0x231408[_0x2ad4bc(0x270)]+0x1&&(_0x2fd645[_0x2ad4bc(0x223)]=_0x2ad4bc(0x31a)+_0x231408[_0x2ad4bc(0x1a6)](_0x11fb4c=>_0x2ad4bc(0x29b)+_0x11fb4c+'\x22>'+_0x11fb4c+_0x2ad4bc(0x247))[_0x2ad4bc(0x285)](''));_0x2fd645[_0x2ad4bc(0x2ef)]=_0x462142;let _0x419432=allEmployeesData['filter'](_0x5993be=>_0x5993be[_0x2ad4bc(0x2ff)]&&_0x5993be[_0x2ad4bc(0x2ff)][_0x2ad4bc(0x2b7)]()!==''||_0x5993be[_0x2ad4bc(0x2df)]);if(_0x462142)_0x419432=_0x419432[_0x2ad4bc(0x1da)](_0x4df3bc=>_0x4df3bc['Check_Manager']===_0x462142);_0x419432[_0x2ad4bc(0x20a)]((_0x48f32d,_0x18b52d)=>{const _0x39c33c=_0x2ad4bc;let _0x2f4f3a,_0x7e8958;switch(empSortField){case _0x39c33c(0x1d3):_0x2f4f3a=_0x48f32d[_0x39c33c(0x2df)]?0x1:0x0,_0x7e8958=_0x18b52d[_0x39c33c(0x2df)]?0x1:0x0;break;case _0x39c33c(0x266):return empSortDir==='asc'?_0x48f32d[_0x39c33c(0x2f6)][_0x39c33c(0x341)](_0x18b52d[_0x39c33c(0x2f6)],'th'):_0x18b52d[_0x39c33c(0x2f6)]['localeCompare'](_0x48f32d['FullName_th'],'th');case _0x39c33c(0x26c):_0x2f4f3a=_0x48f32d[_0x39c33c(0x21d)]||'',_0x7e8958=_0x18b52d[_0x39c33c(0x21d)]||'';break;case _0x39c33c(0x329):_0x2f4f3a=_0x48f32d[_0x39c33c(0x254)]||'',_0x7e8958=_0x18b52d[_0x39c33c(0x254)]||'';break;case'nickname':_0x2f4f3a=_0x48f32d[_0x39c33c(0x314)]||'',_0x7e8958=_0x18b52d[_0x39c33c(0x314)]||'';break;case _0x39c33c(0x1d1):_0x2f4f3a=_0x48f32d[_0x39c33c(0x2f1)]?0x1:0x0,_0x7e8958=_0x18b52d[_0x39c33c(0x2f1)]?0x1:0x0;break;default:_0x2f4f3a=_0x48f32d['employeeId'],_0x7e8958=_0x18b52d[_0x39c33c(0x209)];}if(_0x2f4f3a<_0x7e8958)return empSortDir===_0x39c33c(0x2ae)?-0x1:0x1;if(_0x2f4f3a>_0x7e8958)return empSortDir===_0x39c33c(0x2ae)?0x1:-0x1;return 0x0;});const _0x4fadd7=_0x419432[_0x2ad4bc(0x270)],_0x5d3c6d=_0x419432[_0x2ad4bc(0x1da)](_0x2be4c1=>_0x2be4c1[_0x2ad4bc(0x2df)])[_0x2ad4bc(0x270)],_0x5d17ec=_0x4fadd7-_0x5d3c6d,_0x41c15b=_0x4fadd7>0x0?Math[_0x2ad4bc(0x222)](_0x5d3c6d/_0x4fadd7*0x64):0x0;document[_0x2ad4bc(0x342)]('empStatsTotal')[_0x2ad4bc(0x279)]=_0x4fadd7,document[_0x2ad4bc(0x342)](_0x2ad4bc(0x22f))[_0x2ad4bc(0x279)]=_0x5d3c6d,document[_0x2ad4bc(0x342)]('empStatsUnregistered')[_0x2ad4bc(0x279)]=_0x5d17ec,document[_0x2ad4bc(0x342)](_0x2ad4bc(0x31c))[_0x2ad4bc(0x279)]=_0x41c15b+'%',document[_0x2ad4bc(0x342)]('empStatsContainer')[_0x2ad4bc(0x32e)][_0x2ad4bc(0x252)]('hidden');const _0x4c59ee=Math['ceil'](_0x4fadd7/empPageSize);if(empCurrentPage>_0x4c59ee&&_0x4c59ee>0x0)empCurrentPage=_0x4c59ee;const _0x4684c6=_0x419432[_0x2ad4bc(0x30f)]((empCurrentPage-0x1)*empPageSize,empCurrentPage*empPageSize);document[_0x2ad4bc(0x342)](_0x2ad4bc(0x236))[_0x2ad4bc(0x223)]=_0x4684c6[_0x2ad4bc(0x1a6)]((_0x305a9b,_0xcf0014)=>{const _0x437bd8=_0x2ad4bc,_0x3235e5=_0x305a9b[_0x437bd8(0x2df)]?!![]:![];return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr\x20class=\x22'+(_0x3235e5?_0x437bd8(0x2c3):'')+'\x20hover:bg-gray-50\x20transition-colors\x20text-center\x20text-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-gray-400\x20text-center\x20text-xs\x22>'+((empCurrentPage-0x1)*empPageSize+(_0xcf0014+0x1))+_0x437bd8(0x2d3)+_0x305a9b[_0x437bd8(0x209)]+_0x437bd8(0x24d)+_0x305a9b[_0x437bd8(0x2f6)]+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-normal\x20text-left\x20text-gray-600\x20text-sm\x20text-sm\x22>'+(_0x305a9b[_0x437bd8(0x21d)]||'-')+_0x437bd8(0x2b0)+(_0x305a9b['Check_Manager']||'-')+_0x437bd8(0x1b6)+(_0x305a9b[_0x437bd8(0x314)]||'-')+_0x437bd8(0x296)+(_0x305a9b[_0x437bd8(0x2f1)]?_0x437bd8(0x31b):'-')+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20font-bold\x20text-blue-500\x20uppercase\x20text-center\x20text-sm\x20text-sm\x22>'+(_0x305a9b['Check_Place']||'-')+_0x437bd8(0x294)+(_0x3235e5?_0x437bd8(0x2bb):'-')+_0x437bd8(0x1a3)+_0x305a9b['id']+_0x437bd8(0x2a8)+_0x305a9b[_0x437bd8(0x2f6)]+_0x437bd8(0x297)+(_0x3235e5?'':_0x437bd8(0x321))+_0x437bd8(0x28f)+(_0x3235e5?_0x437bd8(0x2ca):_0x437bd8(0x317))+'\x20px-3\x20py-1\x20rounded\x20text-[10px]\x20font-normal\x20uppercase\x20cursor-pointer\x20transition-all\x20text-xs\x20text-sm\x22>Delete</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';})['join'](''),renderEmpPagination(_0x4c59ee);}function renderEmpPagination(_0x2f6120){const _0x5d1ab7=_0x2e17b2,_0x42d372=document[_0x5d1ab7(0x342)](_0x5d1ab7(0x225));if(_0x2f6120<=0x1){_0x42d372[_0x5d1ab7(0x223)]='';return;}let _0x3c1df5='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22pagination-btn\x22\x20'+(empCurrentPage===0x1?_0x5d1ab7(0x321):'')+_0x5d1ab7(0x24a)+(empCurrentPage-0x1)+')\x22>‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';for(let _0x3fdb90=0x1;_0x3fdb90<=_0x2f6120;_0x3fdb90++){if(_0x3fdb90===0x1||_0x3fdb90===_0x2f6120||_0x3fdb90>=empCurrentPage-0x2&&_0x3fdb90<=empCurrentPage+0x2)_0x3c1df5+=_0x5d1ab7(0x2e7)+(_0x3fdb90===empCurrentPage?_0x5d1ab7(0x262):'')+_0x5d1ab7(0x1d7)+_0x3fdb90+_0x5d1ab7(0x231)+_0x3fdb90+'</button>';else(_0x3fdb90===empCurrentPage-0x3||_0x3fdb90===empCurrentPage+0x3)&&(_0x3c1df5+=_0x5d1ab7(0x2cc));}_0x3c1df5+=_0x5d1ab7(0x27e)+(empCurrentPage===_0x2f6120?'disabled':'')+_0x5d1ab7(0x24a)+(empCurrentPage+0x1)+_0x5d1ab7(0x1ec),_0x42d372[_0x5d1ab7(0x223)]=_0x3c1df5;}window[_0x2e17b2(0x1f4)]=_0x2ed0e2=>{empCurrentPage=_0x2ed0e2,updateEmployeeList();},window['cancelReg']=(_0x3ab07e,_0x532446)=>{const _0x2c1f69=_0x2e17b2,_0x4c1ee4=allEmployeesData[_0x2c1f69(0x276)](_0x54be1c=>_0x54be1c['id']===_0x3ab07e);if(!_0x4c1ee4)return;const _0x356b45=document['getElementById']('confirmModalInner');_0x356b45[_0x2c1f69(0x1b7)]='bg-white\x20rounded-2xl\x20p-10\x20max-w-lg\x20w-full\x20shadow-2xl\x20text-center',currentConfirmAction=async()=>{const _0x113c2b=_0x2c1f69;try{const _0x126156={'DateLogin':null,'MobileId':'','AwardedGift':'','AwardedGiftId':null,'RandomTime':null,'ReceivedTime':null};if(_0x4c1ee4[_0x113c2b(0x25a)]){const _0x73a583=allGiftsData[_0x113c2b(0x276)](_0x3e90a8=>_0x3e90a8['id']===_0x4c1ee4[_0x113c2b(0x25a)]);_0x73a583&&await updateDoc(doc(db,'crsg_gift',_0x73a583['id']),{'remainingQty':(_0x73a583[_0x113c2b(0x34f)]||0x0)+0x1});}await updateDoc(doc(db,_0x113c2b(0x1c3),_0x3ab07e),_0x126156),document[_0x113c2b(0x342)](_0x113c2b(0x1c4))[_0x113c2b(0x32e)][_0x113c2b(0x32a)](_0x113c2b(0x1b8));}catch(_0x10ccea){console[_0x113c2b(0x235)](_0x10ccea);}},document[_0x2c1f69(0x342)](_0x2c1f69(0x1fc))[_0x2c1f69(0x279)]='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',document[_0x2c1f69(0x342)](_0x2c1f69(0x305))[_0x2c1f69(0x279)]=_0x2c1f69(0x2e4)+_0x532446+_0x2c1f69(0x22d),document[_0x2c1f69(0x342)]('confirmInputContainer')[_0x2c1f69(0x32e)][_0x2c1f69(0x32a)](_0x2c1f69(0x1b8)),document['getElementById'](_0x2c1f69(0x1c4))['classList'][_0x2c1f69(0x252)]('hidden');},window['openGroupDetail']=_0x86676f=>{const _0x2af09f=_0x2e17b2,_0x479db2=allEmployeesData['filter'](_0x1b1a9f=>_0x1b1a9f[_0x2af09f(0x2ff)]===_0x86676f);document['getElementById'](_0x2af09f(0x348))[_0x2af09f(0x279)]='‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°\x20'+_0x86676f,document[_0x2af09f(0x342)](_0x2af09f(0x2c6))[_0x2af09f(0x279)]=_0x479db2[_0x2af09f(0x270)],document[_0x2af09f(0x342)]('groupViewStatsRegistered')[_0x2af09f(0x279)]=_0x479db2[_0x2af09f(0x1da)](_0x480da0=>_0x480da0['DateLogin'])['length'],document['getElementById']('groupViewTableBody')[_0x2af09f(0x223)]=_0x479db2[_0x2af09f(0x1a6)]((_0xc38057,_0x5ba3c3)=>{const _0x54810d=_0x2af09f;return _0x54810d(0x1cf)+(_0xc38057[_0x54810d(0x2df)]?_0x54810d(0x2c3):'')+_0x54810d(0x2e2)+(_0x5ba3c3+0x1)+_0x54810d(0x2ad)+_0xc38057[_0x54810d(0x209)]+_0x54810d(0x277)+_0xc38057['FullName_th']+'</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-left\x20text-gray-400\x20text-sm\x22>'+(_0xc38057['NickName']||'-')+_0x54810d(0x337)+(_0xc38057['Branch_eng']||'-')+_0x54810d(0x337)+(_0xc38057[_0x54810d(0x254)]||'-')+_0x54810d(0x1e0)+(_0xc38057[_0x54810d(0x2df)]?_0x54810d(0x306):'-')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</td>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=\x22px-4\x20py-0\x20text-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20onclick=\x22editEmp(\x27'+_0xc38057['id']+_0x54810d(0x30d);})['join']('')||_0x2af09f(0x28c),document[_0x2af09f(0x342)](_0x2af09f(0x2af))[_0x2af09f(0x32e)][_0x2af09f(0x252)]('hidden');},window['editEmp']=_0x5aa7d5=>{const _0x5239c6=_0x2e17b2,_0x516b9a=allEmployeesData[_0x5239c6(0x276)](_0x4d648d=>_0x4d648d['id']===_0x5aa7d5);if(!_0x516b9a)return;currentEditingDocId=_0x5aa7d5,document[_0x5239c6(0x342)](_0x5239c6(0x1d9))['textContent']=_0x516b9a[_0x5239c6(0x209)],document[_0x5239c6(0x342)]('editEmpName')['textContent']=_0x516b9a[_0x5239c6(0x2f6)],document[_0x5239c6(0x342)](_0x5239c6(0x2da))[_0x5239c6(0x2ef)]=_0x516b9a['NickName']||'',document[_0x5239c6(0x342)](_0x5239c6(0x1be))[_0x5239c6(0x2ef)]=_0x516b9a['Check_Manager']||'',document['getElementById'](_0x5239c6(0x33a))[_0x5239c6(0x2ef)]=_0x516b9a[_0x5239c6(0x2ff)]||'',document[_0x5239c6(0x342)](_0x5239c6(0x2b4))['classList'][_0x5239c6(0x252)](_0x5239c6(0x1b8));};function searchForRegistration(){const _0x5572f8=_0x2e17b2,_0x366769=document[_0x5572f8(0x342)]('searchRegEmployeeIdInput')[_0x5572f8(0x2ef)]['trim'](),_0x3db644=document[_0x5572f8(0x342)](_0x5572f8(0x1ae));_0x3db644[_0x5572f8(0x279)]='';if(!_0x366769){_0x3db644[_0x5572f8(0x279)]='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';return;}const _0x24a4cd=allEmployeesData[_0x5572f8(0x276)](_0x37617b=>_0x37617b[_0x5572f8(0x209)]===_0x366769);_0x24a4cd?(currentEditingDocId=_0x24a4cd['id'],document[_0x5572f8(0x342)](_0x5572f8(0x1db))[_0x5572f8(0x279)]=_0x24a4cd[_0x5572f8(0x209)],document[_0x5572f8(0x342)](_0x5572f8(0x1ef))['textContent']=_0x24a4cd[_0x5572f8(0x2f6)],document[_0x5572f8(0x342)](_0x5572f8(0x2bf))[_0x5572f8(0x279)]=_0x24a4cd['Branch_eng']||'-',document[_0x5572f8(0x342)](_0x5572f8(0x309))[_0x5572f8(0x279)]=_0x24a4cd[_0x5572f8(0x254)]||'-',document[_0x5572f8(0x342)](_0x5572f8(0x1f2))[_0x5572f8(0x2ef)]=_0x24a4cd[_0x5572f8(0x314)]||'',document[_0x5572f8(0x342)](_0x5572f8(0x29d))['value']=_0x24a4cd[_0x5572f8(0x2ff)]||'',document[_0x5572f8(0x342)](_0x5572f8(0x1ff))[_0x5572f8(0x2ef)]=_0x24a4cd[_0x5572f8(0x34e)]||'',document[_0x5572f8(0x342)](_0x5572f8(0x203))[_0x5572f8(0x32e)]['remove']('hidden'),document[_0x5572f8(0x342)]('regManualError')[_0x5572f8(0x279)]=''):_0x3db644[_0x5572f8(0x279)]='‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';}async function saveManualRegistration(){const _0x3840d9=_0x2e17b2,_0x122961=document[_0x3840d9(0x342)]('regEmpNickname')['value']['trim'](),_0x327dd2=document[_0x3840d9(0x342)](_0x3840d9(0x29d))['value'][_0x3840d9(0x2b7)](),_0x13ec9b=document[_0x3840d9(0x342)](_0x3840d9(0x1ff))['value'],_0x324108=document['getElementById'](_0x3840d9(0x31e));try{await updateDoc(doc(db,_0x3840d9(0x1c3),currentEditingDocId),{'NickName':_0x122961,'Check_Place':_0x327dd2,'invite':_0x13ec9b,'DateLogin':serverTimestamp()}),document['getElementById'](_0x3840d9(0x203))[_0x3840d9(0x32e)][_0x3840d9(0x32a)](_0x3840d9(0x1b8)),document[_0x3840d9(0x342)](_0x3840d9(0x229))[_0x3840d9(0x2ef)]='';}catch(_0x4f5378){console['error'](_0x4f5378),_0x324108[_0x3840d9(0x279)]=_0x3840d9(0x320);}}function handleEmpSort(_0x2a1c63){const _0x4c525a=_0x2e17b2;empSortField===_0x2a1c63?empSortDir=empSortDir===_0x4c525a(0x2ae)?_0x4c525a(0x242):_0x4c525a(0x2ae):(empSortField=_0x2a1c63,empSortDir=_0x4c525a(0x2ae)),empCurrentPage=0x1,updateEmployeeList();}function setupListeners(){const _0x37d4f5=_0x2e17b2;document[_0x37d4f5(0x342)](_0x37d4f5(0x30b))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x59ad66=_0x37d4f5;updateLuckyDrawStats(),document[_0x59ad66(0x342)](_0x59ad66(0x1d4))['classList'][_0x59ad66(0x252)](_0x59ad66(0x1b8));}),document[_0x37d4f5(0x342)](_0x37d4f5(0x28d))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x1d4))['classList']['add'](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)](_0x37d4f5(0x30a))[_0x37d4f5(0x2ee)]('click',runIndividualLuckyDraw),document['getElementById']('grStartDrawBtn')[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),startGroupRandomDraw),document[_0x37d4f5(0x342)](_0x37d4f5(0x30e))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x2af))[_0x37d4f5(0x32e)][_0x37d4f5(0x32a)](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)]('closeWinnerModalButton')[_0x37d4f5(0x2ee)]('click',()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x2b8))[_0x37d4f5(0x32e)]['add'](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)]('closeEditModalButton')['addEventListener'](_0x37d4f5(0x2c2),()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x2b4))[_0x37d4f5(0x32e)][_0x37d4f5(0x32a)]('hidden')),document[_0x37d4f5(0x342)]('closeConfirmButton')[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x1c4))[_0x37d4f5(0x32e)][_0x37d4f5(0x32a)](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)](_0x37d4f5(0x1a4))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>openDashboardList(_0x37d4f5(0x282))),document[_0x37d4f5(0x342)](_0x37d4f5(0x1cb))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>openDashboardList(_0x37d4f5(0x2d0))),document[_0x37d4f5(0x342)](_0x37d4f5(0x230))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>openDashboardList(_0x37d4f5(0x1bb))),document['getElementById'](_0x37d4f5(0x27a))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>openDashboardList(_0x37d4f5(0x243))),document[_0x37d4f5(0x342)]('closeDashboardListModalButton')['addEventListener'](_0x37d4f5(0x2c2),()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x1e6))[_0x37d4f5(0x32e)][_0x37d4f5(0x32a)](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)]('sort-emp-id')['addEventListener'](_0x37d4f5(0x2c2),()=>handleEmpSort('id')),document['getElementById']('sort-emp-name')[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>handleEmpSort(_0x37d4f5(0x266))),document[_0x37d4f5(0x342)](_0x37d4f5(0x1a0))[_0x37d4f5(0x2ee)]('click',()=>handleEmpSort(_0x37d4f5(0x26c))),document[_0x37d4f5(0x342)](_0x37d4f5(0x295))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>handleEmpSort(_0x37d4f5(0x329))),document[_0x37d4f5(0x342)](_0x37d4f5(0x2c5))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>handleEmpSort(_0x37d4f5(0x1eb))),document['getElementById']('sort-emp-gift')['addEventListener'](_0x37d4f5(0x2c2),()=>handleEmpSort(_0x37d4f5(0x1d1))),document['getElementById'](_0x37d4f5(0x1cd))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>handleEmpSort(_0x37d4f5(0x1d3))),document[_0x37d4f5(0x342)](_0x37d4f5(0x34c))[_0x37d4f5(0x2ee)]('click',searchForRegistration),document[_0x37d4f5(0x342)]('closeManualRegModalButton')['addEventListener']('click',()=>document[_0x37d4f5(0x342)]('manualRegisterModal')[_0x37d4f5(0x32e)][_0x37d4f5(0x32a)](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)](_0x37d4f5(0x202))['addEventListener']('click',saveManualRegistration),document['getElementById'](_0x37d4f5(0x24c))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),async()=>{if(currentConfirmAction)await currentConfirmAction();}),document[_0x37d4f5(0x342)](_0x37d4f5(0x300))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),addGift),document[_0x37d4f5(0x342)](_0x37d4f5(0x2c9))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x4532fb=_0x37d4f5;giftPickerContext='ind',renderGiftPicker(),document[_0x4532fb(0x342)]('giftPickerModal')[_0x4532fb(0x32e)][_0x4532fb(0x252)](_0x4532fb(0x1b8));}),document[_0x37d4f5(0x342)]('openGroupGiftPickerBtn')[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x34bf57=_0x37d4f5;giftPickerContext=_0x34bf57(0x350),renderGiftPicker(),document[_0x34bf57(0x342)](_0x34bf57(0x316))['classList'][_0x34bf57(0x252)](_0x34bf57(0x1b8));}),document[_0x37d4f5(0x342)](_0x37d4f5(0x2d5))['addEventListener']('click',()=>document[_0x37d4f5(0x342)]('giftPickerModal')['classList'][_0x37d4f5(0x32a)](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)]('closeEditGiftModalBtn')['addEventListener'](_0x37d4f5(0x2c2),()=>document[_0x37d4f5(0x342)](_0x37d4f5(0x1d2))['classList']['add'](_0x37d4f5(0x1b8))),document[_0x37d4f5(0x342)](_0x37d4f5(0x2db))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),async()=>{const _0x1fb834=_0x37d4f5,_0xab0f6d=document['getElementById'](_0x1fb834(0x2b1))[_0x1fb834(0x2ef)]['trim'](),_0x3d7594=parseInt(document[_0x1fb834(0x342)](_0x1fb834(0x1a8))[_0x1fb834(0x2ef)]),_0xbbbd25=parseInt(document[_0x1fb834(0x342)](_0x1fb834(0x213))[_0x1fb834(0x2ef)]);if(!_0xab0f6d||isNaN(_0x3d7594)||isNaN(_0xbbbd25))return;await updateDoc(doc(db,_0x1fb834(0x1c5),currentEditingGiftId),{'name':_0xab0f6d,'totalQty':_0x3d7594,'remainingQty':_0xbbbd25}),document[_0x1fb834(0x342)](_0x1fb834(0x1d2))[_0x1fb834(0x32e)][_0x1fb834(0x32a)]('hidden');}),document['getElementById'](_0x37d4f5(0x219))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),async()=>{const _0x3e7eac=_0x37d4f5;await updateDoc(doc(db,'crsg',currentEditingDocId),{'NickName':document[_0x3e7eac(0x342)]('editEmpNickname')[_0x3e7eac(0x2ef)],'Check_Manager':document['getElementById'](_0x3e7eac(0x1be))[_0x3e7eac(0x2ef)],'Check_Place':document[_0x3e7eac(0x342)]('editEmpTeam')[_0x3e7eac(0x2ef)]}),document[_0x3e7eac(0x342)](_0x3e7eac(0x2b4))[_0x3e7eac(0x32e)]['add'](_0x3e7eac(0x1b8));}),document[_0x37d4f5(0x342)](_0x37d4f5(0x1bf))['addEventListener'](_0x37d4f5(0x2c2),()=>{const _0x29718f=_0x37d4f5,_0x3347ce=document['getElementById']('searchEmployeeError');_0x3347ce[_0x29718f(0x279)]='';const _0x3bcf3f=document[_0x29718f(0x342)](_0x29718f(0x211))[_0x29718f(0x2ef)][_0x29718f(0x2b7)]();if(!_0x3bcf3f){_0x3347ce[_0x29718f(0x279)]=_0x29718f(0x30c);return;}const _0x53e16a=allEmployeesData['find'](_0x1001d1=>_0x1001d1[_0x29718f(0x209)]===_0x3bcf3f);_0x53e16a?(editEmp(_0x53e16a['id']),document[_0x29718f(0x342)](_0x29718f(0x211))['value']=''):_0x3347ce[_0x29718f(0x279)]=_0x29718f(0x240);}),document['getElementById'](_0x37d4f5(0x33e))[_0x37d4f5(0x2ee)]('change',updateTeamTab),document[_0x37d4f5(0x342)]('groupViewManagerFilter')[_0x37d4f5(0x2ee)](_0x37d4f5(0x248),updateGridTab),document[_0x37d4f5(0x342)]('managerFilterSelect')[_0x37d4f5(0x2ee)](_0x37d4f5(0x248),()=>{empCurrentPage=0x1,updateEmployeeList();}),document[_0x37d4f5(0x342)]('updateTeamNamesBtn')[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x4ec216=_0x37d4f5,_0x2f4d19=document[_0x4ec216(0x342)](_0x4ec216(0x32d))[_0x4ec216(0x2ef)]['trim']();if(!_0x2f4d19)return;teamNames=_0x2f4d19['split'](',')[_0x4ec216(0x1a6)](_0x5aaf75=>_0x5aaf75['trim']())[_0x4ec216(0x1da)](Boolean),refreshUI();}),document['getElementById'](_0x37d4f5(0x2c0))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x321e2c=_0x37d4f5;let _0x2b749f='\ufeff‡∏£‡∏´‡∏±‡∏™,‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•,\x20NickName,\x20‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á,\x20‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô,‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞\x0a';allEmployeesData[_0x321e2c(0x1da)](_0x4d6273=>_0x4d6273[_0x321e2c(0x2df)])[_0x321e2c(0x278)](_0x3d16ab=>{const _0x3ae788=_0x321e2c;_0x2b749f+='\x22'+_0x3d16ab[_0x3ae788(0x209)]+_0x3ae788(0x241)+_0x3d16ab[_0x3ae788(0x2f6)]+_0x3ae788(0x241)+(_0x3d16ab[_0x3ae788(0x314)]||'')+_0x3ae788(0x241)+(_0x3d16ab[_0x3ae788(0x2ff)]||'')+'\x22,\x22'+(_0x3d16ab['Branch_eng']||'')+_0x3ae788(0x241)+(_0x3d16ab['Check_Manager']||'')+'\x22,\x22‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô\x22\x0a';});const _0x2cc4e4=new Blob([_0x2b749f],{'type':_0x321e2c(0x2e5)}),_0x1b4b9c=document[_0x321e2c(0x1ac)]('a');_0x1b4b9c[_0x321e2c(0x2e6)]=URL[_0x321e2c(0x290)](_0x2cc4e4),_0x1b4b9c[_0x321e2c(0x2d9)]=_0x321e2c(0x299),_0x1b4b9c[_0x321e2c(0x2c2)]();}),document[_0x37d4f5(0x342)](_0x37d4f5(0x23c))['addEventListener'](_0x37d4f5(0x2c2),()=>{const _0x3df91e=_0x37d4f5,_0x269f4c=document['getElementById'](_0x3df91e(0x265))['value'];let _0x4e52d2=allEmployeesData[_0x3df91e(0x1da)](_0x130ad7=>_0x130ad7[_0x3df91e(0x2ff)]&&_0x130ad7[_0x3df91e(0x2ff)][_0x3df91e(0x2b7)]()!==''||_0x130ad7[_0x3df91e(0x2df)]);if(_0x269f4c)_0x4e52d2=_0x4e52d2[_0x3df91e(0x1da)](_0x531bd4=>_0x531bd4[_0x3df91e(0x254)]===_0x269f4c);let _0x4d4e33=_0x3df91e(0x1b9);_0x4e52d2['forEach']((_0x46df9a,_0x418d23)=>{const _0x117a16=_0x3df91e,_0x458277=_0x46df9a[_0x117a16(0x2df)]?_0x117a16(0x269):'-',_0x14a15f=_0x46df9a[_0x117a16(0x314)]||'-',_0x7bf5b4=_0x46df9a['AwardedGift']?_0x117a16(0x31b):'-';_0x4d4e33+='\x22'+(_0x418d23+0x1)+'\x22,\x22'+_0x46df9a[_0x117a16(0x209)]+_0x117a16(0x241)+_0x46df9a[_0x117a16(0x2f6)]+_0x117a16(0x241)+(_0x46df9a[_0x117a16(0x21d)]||'-')+_0x117a16(0x241)+(_0x46df9a[_0x117a16(0x254)]||'-')+_0x117a16(0x241)+_0x14a15f+_0x117a16(0x241)+_0x7bf5b4+'\x22,\x22'+(_0x46df9a[_0x117a16(0x2ff)]||'-')+_0x117a16(0x241)+_0x458277+'\x22\x0a';});const _0x3a255b=new Blob([_0x4d4e33],{'type':_0x3df91e(0x2e5)}),_0x3b7c59=document[_0x3df91e(0x1ac)]('a');_0x3b7c59[_0x3df91e(0x2e6)]=URL['createObjectURL'](_0x3a255b),_0x3b7c59[_0x3df91e(0x2d9)]=_0x3df91e(0x26e),_0x3b7c59[_0x3df91e(0x2c2)]();}),document['getElementById'](_0x37d4f5(0x2e0))[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x529872=_0x37d4f5,_0x39da26=allEmployeesData['filter'](_0x439bda=>_0x439bda[_0x529872(0x23b)])[_0x529872(0x20a)]((_0x5243a5,_0x3c9bba)=>(_0x3c9bba['RandomTime']?.[_0x529872(0x308)]()||0x0)-(_0x5243a5[_0x529872(0x23b)]?.[_0x529872(0x308)]()||0x0));let _0x16914b=_0x529872(0x1e3);_0x39da26[_0x529872(0x278)](_0x519ede=>{const _0x3085ab=_0x529872,_0x3c0886=_0x519ede[_0x3085ab(0x23b)]?.[_0x3085ab(0x308)]()?new Date(_0x519ede[_0x3085ab(0x23b)]['toMillis']())[_0x3085ab(0x273)](_0x3085ab(0x319)):'-',_0x551601=_0x519ede[_0x3085ab(0x20e)]?_0x3085ab(0x2f9):_0x3085ab(0x2c7);_0x16914b+='\x22'+_0x519ede[_0x3085ab(0x209)]+_0x3085ab(0x241)+_0x519ede[_0x3085ab(0x2f6)]+_0x3085ab(0x241)+(_0x519ede['AwardedGift']||'')+_0x3085ab(0x241)+(_0x519ede[_0x3085ab(0x21d)]||'')+'\x22,\x22'+(_0x519ede['Check_Manager']||'')+'\x22,\x22'+(_0x519ede[_0x3085ab(0x2ff)]||'')+_0x3085ab(0x241)+_0x551601+_0x3085ab(0x241)+_0x3c0886+'\x22\x0a';});const _0x4edfa1=new Blob([_0x16914b],{'type':_0x529872(0x2e5)}),_0xff3817=document[_0x529872(0x1ac)]('a');_0xff3817[_0x529872(0x2e6)]=URL['createObjectURL'](_0x4edfa1),_0xff3817['download']=_0x529872(0x2e9),_0xff3817['click']();}),document[_0x37d4f5(0x342)]('resetTeamButton')[_0x37d4f5(0x2ee)](_0x37d4f5(0x2c2),()=>{const _0x949874=_0x37d4f5,_0x5bb806=document[_0x949874(0x342)](_0x949874(0x272)),_0x34a1ac=document['getElementById']('confirmInputContainer'),_0xd77f88=document['getElementById']('confirmInput');_0x34a1ac[_0x949874(0x32e)]['remove']('hidden'),_0xd77f88[_0x949874(0x2ef)]='',currentConfirmAction=async()=>{const _0x3e8945=_0x949874;if(_0xd77f88[_0x3e8945(0x2ef)]['trim']()[_0x3e8945(0x2a7)]()!==_0x3e8945(0x1ca))return;const _0x5ac1c4=writeBatch(db);allEmployeesData[_0x3e8945(0x278)](_0x432596=>{const _0x5f0018=_0x3e8945;_0x5ac1c4[_0x5f0018(0x2eb)](doc(db,_0x5f0018(0x1c3),_0x432596['id']),{'DateLogin':null,'RandomTime':null,'AwardedGift':'','AwardedGiftId':null,'ReceivedTime':null,'MobileId':''});}),allGiftsData['forEach'](_0x1ad856=>{const _0x519391=_0x3e8945;_0x5ac1c4[_0x519391(0x2eb)](doc(db,'crsg_gift',_0x1ad856['id']),{'remainingQty':_0x1ad856['totalQty']||0x1});}),await _0x5ac1c4['commit'](),document[_0x3e8945(0x342)](_0x3e8945(0x1c4))['classList'][_0x3e8945(0x32a)](_0x3e8945(0x1b8));},document[_0x949874(0x342)](_0x949874(0x1fc))[_0x949874(0x279)]=_0x949874(0x21f),document['getElementById'](_0x949874(0x305))[_0x949874(0x279)]='‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?\x20(‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)',document['getElementById'](_0x949874(0x1c4))[_0x949874(0x32e)][_0x949874(0x252)]('hidden');});}function updateGroupRandomUI(){const _0x1cb86f=_0x2e17b2,_0x1d2ffd=allEmployeesData[_0x1cb86f(0x1da)](_0x1c1744=>_0x1c1744[_0x1cb86f(0x2df)]&&_0x1c1744[_0x1cb86f(0x34e)]===_0x1cb86f(0x34e)),_0x46b897=_0x1d2ffd[_0x1cb86f(0x1da)](_0x4f8402=>_0x4f8402[_0x1cb86f(0x23b)])[_0x1cb86f(0x20a)]((_0x2bfddd,_0x904484)=>(_0x904484[_0x1cb86f(0x23b)]?.[_0x1cb86f(0x308)]()||0x0)-(_0x2bfddd[_0x1cb86f(0x23b)]?.[_0x1cb86f(0x308)]()||0x0)),_0x3d64ec=_0x1d2ffd[_0x1cb86f(0x1da)](_0x99b536=>!_0x99b536[_0x1cb86f(0x23b)]);if(document['getElementById'](_0x1cb86f(0x256)))document[_0x1cb86f(0x342)]('grTotalEligible')[_0x1cb86f(0x279)]=_0x1d2ffd['length'];if(document[_0x1cb86f(0x342)](_0x1cb86f(0x21e)))document[_0x1cb86f(0x342)](_0x1cb86f(0x21e))[_0x1cb86f(0x279)]=_0x3d64ec[_0x1cb86f(0x270)];if(document['getElementById'](_0x1cb86f(0x274)))document[_0x1cb86f(0x342)](_0x1cb86f(0x274))[_0x1cb86f(0x279)]=_0x46b897[_0x1cb86f(0x270)];}
    </script>
</body>

</html>
